      ****************************************************************
      *SISTEMA:  FUTD      Futura Desarrollo - Versión 22.0          *
      *PROGRAMA: TRPLAN64  Acreditador de recaudo                    *
      *COMPAÑIA: Pullservi Internacional, S.A.                       *
      *USUARIO:  JVARGAS                                             *
      *FECHA:    24/05/02  17:09:12                                  *
      *GENERADOR:SNAP Release 4.5                                    *
      ****************************************************************
     H DECEDIT('0,') DATEDIT(*DMY.)
     FAFIAR2    IF   E           K DISK
     FAFIARC    UF A E           K DISK    COMMIT
     FAFIARC01  IF   E           K DISK
     FAFIAR1    UF A E           K DISK    COMMIT
     FCOMAR2    UF A E             DISK    COMMIT
     FCOMAR5    UF A E           K DISK    COMMIT
     FCONAR2    UF A E           K DISK    COMMIT
     FCONAR202  IF   E           K DISK
     FCONAR203  UF A E           K DISK    COMMIT
     FCONAR205  UF A E           K DISK    COMMIT
     FCONARC    IF   E           K DISK
     FCUEARC    UF A E           K DISK    COMMIT
     FDEPAR3    UF A E           K DISK    COMMIT
     FDETAR302  IF   E           K DISK
     FDETAR2    UF A E           K DISK    COMMIT
     FDETAR201  UF A E           K DISK    COMMIT
     FDETARC    UF A E           K DISK    COMMIT
     FDEUARC    UF A E           K DISK    COMMIT
     FDEUARC03  IF   E           K DISK
     FDEUARC04  IF   E           K DISK
     FDEUARC08  UF A E           K DISK    COMMIT
     FDEUARC10  UF A E           K DISK    COMMIT
     FDEUARC51  IF   E           K DISK
     FDIAAR1    UF A E           K DISK    COMMIT
     FDISAR1    UF A E           K DISK    COMMIT
     FEMPAR204  IF   E           K DISK
     FESTAR1    UF A E           K DISK    COMMIT
     FHISA01    UF A E           K DISK    COMMIT
     FHISAR1    IF   E           K DISK
     FHISAR7    UF A E           K DISK    COMMIT
     FINFAR402  IF   E           K DISK
     FLOTAR5    UF A E           K DISK    COMMIT
     FMOVARC    UF A E           K DISK    COMMIT
     FMOVARC06  IF   E           K DISK
     FMOVAR2    UF A E             DISK    COMMIT
     FPAGARC    UF A E           K DISK    COMMIT
     FPAGARC06  UF A E           K DISK    COMMIT
     FPLAARC    UF A E           K DISK    COMMIT
     FPLAARC04  IF   E           K DISK
     FPLAARC15  IF   E           K DISK
     FPLAAR601  IF   E           K DISK
     FPLAAR603  IF   E           K DISK
     FREZARC    UF A E           K DISK    COMMIT
     FREZARC01  IF   E           K DISK
     FREZARC18  IF   E           K DISK
     FREZARC19  IF   E           K DISK
     FREZARC20  IF   E           K DISK
     FREZARC21  IF   E           K DISK
     FPRN198    O    F  198        PRINTER OFLIND(*INOF)
     FPRN80     O    F   80        PRINTER OFLIND(*INOA)
     FPRN198B   O    F  198        PRINTER OFLIND(*INOB)
     FPRN198C   O    F  198        PRINTER OFLIND(*INOC)
     FPRN132    O    F  132        PRINTER OFLIND(*INOD)
     D $0              S             12  0 DIM(100)                             A$AR  [100]
     D $1              S             12  0 DIM(200)                             A$CO  [2,100]
     D $2              S             12  0 DIM(100)                             A$CVA [100]
     D $3              S             12  0 DIM(100)                             A$CVE [100]
     D $4              S             12  0 DIM(200)                             A$FS  [2,100]
     D $5              S             12  0 DIM(200)                             A$IFS [2,100]
     D $6              S             12  0 DIM(500)                             A$INT [5,100]
     D $7              S             12  0 DIM(100)                             A$REN [100]
     D $8              S             21  8 DIM(100)                             ACUAR [100]
     D $9              S             21  8 DIM(200)                             ACUCO [2,100]
     D $A              S             21  8 DIM(100)                             ACUCVA[100]
     D $B              S             21  8 DIM(100)                             ACUCVE[100]
     D $C              S             21  8 DIM(200)                             ACUFS [2,100]
     D $D              S             21  8 DIM(200)                             ACUIFS[2,100]
     D $E              S             21  8 DIM(500)                             ACUINT[5,100]
     D $F              S             21  8 DIM(100)                             ACUREN[100]
     D $G              S              8    DIM(100)                             AFECDE[100]
     D $H              S             21  8 DIM(100)                             CDIAR [100]
     D $I              S             21  8 DIM(198)                             CDICO [2,99]
     D $J              S             21  8 DIM(99)                              CDICVA[99]
     D $K              S             21  8 DIM(99)                              CDICVE[99]
     D $L              S             21  8 DIM(198)                             CDIFS [2,99]
     D $M              S             21  8 DIM(200)                             CDIIFS[2,100]
     D $N              S             21  8 DIM(500)                             CDIINT[5,100]
     D $O              S             21  8 DIM(100)                             CDIREN[100]
     D $P              S             12  0 DIM(100)                             VDIAR [100]
     D $Q              S             12  0 DIM(200)                             VDICO [2,100]
     D $R              S             12  0 DIM(100)                             VDICVA[100]
     D $S              S             12  0 DIM(100)                             VDICVE[100]
     D $T              S             12  0 DIM(200)                             VDIFS [2,100]
     D $U              S             12  0 DIM(200)                             VDIIFS[2,100]
     D $V              S             12  0 DIM(500)                             VDIINT[5,100]
     D $W              S             12  0 DIM(100)                             VDIREN[100]
     D $X              S             12  0 DIM(100)                             ZAR$RE[100]
     D $Y              S             21  8 DIM(100)                             ZARCRE[100]
     D $Z              S              8    DIM(100)                             ZARFRE[100]
     D $H1             S              1    DIM(256)                             Hilera de Traba
     D $H2             S              1    DIM(256)                             Hilera de Traba
     D $HIL            S             79    DIM(150) CTDATA PERRCD(1)            Hileras > 8
     D*Definicion de Entidades SQL o Estructuras de datos (DS) Externas
     D*Definición de Registros de Archivos Externos
     D** -----
     D** ----- Hoja I entidad - - CONA34 -
     D** -----
     D $$CNAF          DS
     D** ----- ZCNN22 P 9 0 (Campo)
     D  ZCNN22                 1      9  0
     D** ----- ZCNT37 A 3 0 (Campo)
     D  ZCNT37                10     12
     D** ----- ZCNN23 P 11 0 (Campo)
     D  ZCNN23                13     23  0
     D** ----- ZCNC48 P 3 0 (Campo)
     D  ZCNC48                24     26  0
     D** ----- ZCNT38 A 1 0 (Campo)
     D  ZCNT38                27     27
     D** ----- ZCNF84 A 8 0 (Campo)
     D  ZCNF84                28     35
     D** ----- ZCNF85 A 8 0 (Campo)
     D  ZCNF85                36     43
     D** ----- ZCNV18 P 15 2 (Campo)
     D  ZCNV18                44     58  2
     D** ----- ZCNIBC P 15 2 (Campo)
     D  ZCNIBC                59     73  2
     D** ----- ZCNNOV A 1 0 (Campo)
     D  ZCNNOV                74     74
     D** ----- ZCNF86 A 8 0 (Campo)
     D  ZCNF86                75     82
     D** ----- ZCNU25 A 10 0 (Campo)
     D  ZCNU25                83     92
     D** ----- ZCNI15 A 1 0 (Campo)
     D  ZCNI15                93     93
     D** ----- ZCNH16 A 6 0 (Campo)
     D  ZCNH16                94     99
     D** ----- ZCNFIL A 255 0 (Campo)
     D  ZCNFIL               100    354
     D** ----- ZCNACC A 1 0 (Campo)
     D  ZCNACC               355    355
     D** ----- ZCNERR A 1 0 (Campo)
     D  ZCNERR               356    356
     D** ----- ZCNSQL P 9 0 (Campo)
     D  ZCNSQL               357    365  0
     D** -----
     D** ----- Parámetros CONARC - TRCONF61
     D** -----
     D $$CONF          DS
     D** ----- ZFEIN2 A 8 0 (Campo)
     D  ZFEIN2                 1      8
     D** ----- ZTAINX A 5 0 (Campo)
     D  ZTAINX                 9     13
     D** ----- ZINDMS A 1 0 (Campo)
     D  ZINDMS                14     14
     D** ----- ZSEMAX A 2 0 (Campo)
     D  ZSEMAX                15     16
     D** ----- ZDIS1X A 2 0 (Campo)
     D  ZDIS1X                17     18
     D** ----- ZDIS2X A 2 0 (Campo)
     D  ZDIS2X                19     20
     D** ----- ZDIS3X A 2 0 (Campo)
     D  ZDIS3X                21     22
     D** ----- ZDIS4X A 2 0 (Campo)
     D  ZDIS4X                23     24
     D** ----- ZPFGPL A 1 0 (Campo)
     D  ZPFGPL                25     25
     D** ----- ZPFSPL A 1 0 (Campo)
     D  ZPFSPL                26     26
     D** ----- ZFONDX A 3 0 (Campo)
     D  ZFONDX                27     29
     D** ----- ZREGCX A 1 0 (Campo)
     D  ZREGCX                30     30
     D** ----- ZINCES A 1 0 (Campo)
     D  ZINCES                31     31
     D** ----- ZININA A 1 0 (Campo)
     D  ZININA                32     32
     D** ----- ZFUEIN A 3 0 (Campo)
     D  ZFUEIN                33     35
     D** ----- ZVARDX A 8 0 (Campo)
     D  ZVARDX                36     43
     D** ----- ZENTIX A 9 0 (Campo)
     D  ZENTIX                44     52
     D** ----- ZACRVO A 1 0 (Campo)
     D  ZACRVO                53     53
     D** ----- ZFECOM A 1 0 (Campo)
     D  ZFECOM                54     54
     D** ----- ZACRCD A 1 0 (Campo)
     D  ZACRCD                55     55
     D** ----- ZPEFUS A 6 0 (Campo)
     D  ZPEFUS                56     61
     D** ----- ZFECFU A 8 0 (Campo)
     D  ZFECFU                62     69
     D** ----- ZVCFFX A 21 0 (Campo)
     D  ZVCFFX                70     90
     D** ----- ZINDSX A 1 0 (Campo)
     D  ZINDSX                91     91
     D** ----- ZFUCDA A 1 0 (Campo)
     D  ZFUCDA                92     92
     D** ----- ZFUCHO A 1 0 (Campo)
     D  ZFUCHO                93     93
     D** ----- ZAMNPA A 1 0 (Campo)
     D  ZAMNPA                94     94
     D** ----- ZBDINT A 1 0 (Campo)
     D  ZBDINT                95     95
     D** ----- ZINPEE A 1 0 (Campo)
     D  ZINPEE                96     96
     D** ----- ZANDEP A 1 0 (Campo)
     D  ZANDEP                97     97
     D** ----- ZPLCPR A 4 0 (Campo)
     D  ZPLCPR                98    101
     D** ----- ZPORDX A 5 0 (Campo)
     D  ZPORDX               102    106
     D** ----- ZFERIN A 8 0 (Campo)
     D  ZFERIN               107    114
     D** ----- ZPOAIX A 5 0 (Campo)
     D  ZPOAIX               115    119
     D** ----- ZPONIX A 5 0 (Campo)
     D  ZPONIX               120    124
     D** ----- ZANUDE A 1 0 (Campo)
     D  ZANUDE               125    125
     D** ----- ZNUMPX A 2 0 (Campo)
     D  ZNUMPX               126    127
     D** ----- ZPEVIG A 6 0 (Campo)
     D  ZPEVIG               128    133
     D** ----- ZFEVIG A 8 0 (Campo)
     D  ZFEVIG               134    141
     D** ----- ZFEREF A 8 0 (Campo)
     D  ZFEREF               142    149
     D** ----- ZPEREF A 6 0 (Campo)
     D  ZPEREF               150    155
     D** ----- ZPREFI A 4 0 (Campo)
     D  ZPREFI               156    159
     D** ----- INDMRX A 5 0 (Campo)
     D  INDMRX               160    164
     D** ----- ZINPAX A 1 0 (Campo)
     D  ZINPAX               165    165
     D** ----- ZDELTX A 21 0 (Campo)
     D  ZDELTX               166    186
     D** ----- ZPERVI A 6 0 (Campo)
     D  ZPERVI               187    192
     D** ----- ZACTEM A 1 0 (Campo)
     D  ZACTEM               193    193
     D** ----- ZGENPE A 1 0 (Campo)
     D  ZGENPE               194    194
     D** ----- ZDESDB A 1 0 (Campo)
     D  ZDESDB               195    195
     D** ----- ZERROX A 67 0 (Campo)
     D  ZERROX               196    262
     D** ----- ZSALIX A 1 0 (Campo)
     D  ZSALIX               263    263
     D** ----- ZFEREC A 8 0 (Campo)
     D  ZFEREC               264    271
     D** -----
     D** ----- Documento de certificación
     D** -----
     D $$D             DS
     D** ----- ZPORBT P 5 0 (Campo)
     D  ZPORBT                 1      5  0
     D** ----- ZPORSB P 5 0 (Campo)
     D  ZPORSB                 6     10  0
     D** ----- ZPORRE P 5 0 (Campo)
     D  ZPORRE                11     15  0
     D** ----- ZDOCUM A 3 0 (Campo)
     D  ZDOCUM                16     18
     D** ----- ZFONDO A 3 0 (Campo)
     D  ZFONDO                19     21
     D** ----- ZFVIN1 A 8 0 (Campo)
     D  ZFVIN1                22     29
     D** ----- ZFVFI1 A 8 0 (Campo)
     D  ZFVFI1                30     37
     D** ----- ZFVIN2 A 8 0 (Campo)
     D  ZFVIN2                38     45
     D** ----- ZFVFI2 A 8 0 (Campo)
     D  ZFVFI2                46     53
     D** ----- ZFEFON A 8 0 (Campo)
     D  ZFEFON                54     61
     D** -----
     D** ----- Parámetros de ingreso TRDISF53.
     D** -----
     D $$DI53          DS
     D** ----- Z05FOR A 3 0 (Campo)
     D  Z05FOR                 1      3
     D** ----- Z05PLA P 12 0 (Campo)
     D  Z05PLA                 4     15  0
     D** ----- Z05PAG P 3 0 (Campo)
     D  Z05PAG                16     18  0
     D** ----- Z05SEC P 3 0 (Campo)
     D  Z05SEC                19     21  0
     D** ----- Z05CON P 3 0 (Campo)
     D  Z05CON                22     24  0
     D** ----- Z05FED A 8 0 (Campo)
     D  Z05FED                25     32
     D** ----- Z05COI P 9 0 (Campo)
     D  Z05COI                33     41  0
     D** ----- Z05TIB A 3 0 (Campo)
     D  Z05TIB                42     44
     D** ----- Z05NIB P 11 0 (Campo)
     D  Z05NIB                45     55  0
     D** ----- Z05TIP A 3 0 (Campo)
     D  Z05TIP                56     58
     D** ----- Z05TIE A 1 0 (Campo)
     D  Z05TIE                59     59
     D** ----- Z05CER P 5 0 (Campo)
     D  Z05CER                60     64  0
     D** -----
     D** ----- Hoja I Entidad -- DATA32 --
     D** -----
     D $$DRAF          DS
     D** ----- ZDRPLA P 12 0 (Campo)
     D  ZDRPLA                 1     12  0
     D** ----- ZDRPAG P 3 0 (Campo)
     D  ZDRPAG                13     15  0
     D** ----- ZDRSEC P 3 0 (Campo)
     D  ZDRSEC                16     18  0
     D** ----- ZDRPER A 6 0 (Campo)
     D  ZDRPER                19     24
     D** ----- ZDRTID A 3 0 (Campo)
     D  ZDRTID                25     27
     D** ----- ZDRNID P 11 0 (Campo)
     D  ZDRNID                28     38  0
     D** ----- ZDRCDI P 9 0 (Campo)
     D  ZDRCDI                39     47  0
     D** ----- ZDRREZ A 2 0 (Campo)
     D  ZDRREZ                48     49
     D** ----- ZDRFSI A 8 0 (Campo)
     D  ZDRFSI                50     57
     D** ----- ZDRACC A 1 0 (Campo)
     D  ZDRACC                58     58
     D** ----- ZDRERR A 1 0 (Campo)
     D  ZDRERR                59     59
     D** -----
     D** ----- Parámetros de salida TRDISF51
     D** -----
     D $$DS51          DS
     D** ----- Z01CCO P 21 8 (Campo)
     D  Z01CCO                 1     21  8
     D** ----- Z01CVA P 21 8 (Campo)
     D  Z01CVA                22     42  8
     D** ----- Z01CVE P 21 8 (Campo)
     D  Z01CVE                43     63  8
     D** ----- Z01CIN P 21 8 (Campo)
     D  Z01CIN                64     84  8
     D** ----- Z01CRE P 21 8 (Campo)
     D  Z01CRE                85    105  8
     D** ----- Z01CBO P 21 8 (Campo)
     D  Z01CBO               106    126  8
     D** ----- Z01CAR P 21 8 (Campo)
     D  Z01CAR               127    147  8
     D** ----- Z01HCO P 15 2 (Campo)
     D  Z01HCO               148    162  2
     D** ----- Z01HVA P 15 2 (Campo)
     D  Z01HVA               163    177  2
     D** ----- Z01HVE P 15 2 (Campo)
     D  Z01HVE               178    192  2
     D** ----- Z01HIN P 15 2 (Campo)
     D  Z01HIN               193    207  2
     D** ----- Z01HRE P 15 2 (Campo)
     D  Z01HRE               208    222  2
     D** ----- Z01HBN P 15 2 (Campo)
     D  Z01HBN               223    237  2
     D** ----- Z01HAR P 15 2 (Campo)
     D  Z01HAR               238    252  2
     D** -----
     D** ----- parametros  Decreto 558 COVID19
     D** -----
     D $$D558          DS
     D** ----- ZPARAD A 41 0 (Campo)
     D  ZPARAD                 1     41
     D** ----- ZI0P14 P 5 2 (SubCampo)
     D  ZI0P14                 1      5  2
     D** ----- ZI0P15 P 7 5 (SubCampo)
     D  ZI0P15                 6     12  5
     D** ----- ZI0P16 P 7 5 (SubCampo)
     D  ZI0P16                13     19  5
     D** ----- ZI0P18 P 5 2 (SubCampo)
     D  ZI0P18                20     24  2
     D** ----- ZI0P20 P 5 2 (SubCampo)
     D  ZI0P20                25     29  2
     D** ----- ZI0INT P 5 2 (SubCampo)
     D  ZI0INT                30     34  2
     D** ----- ZI0P21 P 5 2 (SubCampo)
     D  ZI0P21                35     39  2
     D** ----- ZI0N12 P 2 0 (SubCampo)
     D  ZI0N12                40     41  0
     D** -----
     D** ----- Hoja I - FSPARC
     D** -----
     D $$FSP           DS
     D** ----- ZFOFSP A 3 0 (Campo)
     D  ZFOFSP                 1      3
     D** ----- ZPLFSP P 12 0 (Campo)
     D  ZPLFSP                 4     15  0
     D** ----- ZPAFSP P 3 0 (Campo)
     D  ZPAFSP                16     18  0
     D** ----- ZSEFSP P 3 0 (Campo)
     D  ZSEFSP                19     21  0
     D** ----- ZCOFSP P 5 0 (Campo)
     D  ZCOFSP                22     26  0
     D** ----- ZINFSP P 9 0 (Campo)
     D  ZINFSP                27     35  0
     D** ----- ZPLCFS P 12 0 (Campo)
     D  ZPLCFS                36     47  0
     D** ----- ZINDFS A 1 0 (Campo)
     D  ZINDFS                48     48
     D** ----- ZLDFSP P 7 0 (Campo)
     D  ZLDFSP                49     55  0
     D** ----- ZNDFSP P 7 0 (Campo)
     D  ZNDFSP                56     62  0
     D** ----- ZCDFSP P 5 0 (Campo)
     D  ZCDFSP                63     67  0
     D** ----- ZZAFSP P 15 2 (Campo)
     D  ZZAFSP                68     82  2
     D** ----- ZZUFSP P 21 8 (Campo)
     D  ZZUFSP                83    103  8
     D** ----- ZVZFSP P 15 2 (Campo)
     D  ZVZFSP               104    118  2
     D** ----- ZCSFSP P 21 8 (Campo)
     D  ZCSFSP               119    139  8
     D** ----- ZVIFSP P 15 2 (Campo)
     D  ZVIFSP               140    154  2
     D** ----- ZCIFSP P 21 8 (Campo)
     D  ZCIFSP               155    175  8
     D** ----- ZVISUB P 15 2 (Campo)
     D  ZVISUB               176    190  2
     D** ----- ZCISUB P 21 8 (Campo)
     D  ZCISUB               191    211  8
     D** ----- ZUSFSP A 10 0 (Campo)
     D  ZUSFSP               212    221
     D** ----- ZFEFSP A 8 0 (Campo)
     D  ZFEFSP               222    229
     D** ----- ZHOFSP A 6 0 (Campo)
     D  ZHOFSP               230    235
     D** ----- ZACFSP A 1 0 (Campo)
     D  ZACFSP               236    236
     D** ----- ZEXFSP A 1 0 (Campo)
     D  ZEXFSP               237    237
     D** -----
     D** ----- Hoja i datos para TRHIPO51 Liquida licen
     D** -----
     D $$HI51          DS
     D** ----- ZE P 9 0 (Campo)
     D  ZE                     1      9  0
     D** ----- ZFD A 8 0 (Campo)
     D  ZFD                   10     17
     D** ----- ZNJ A 1 0 (Campo)
     D  ZNJ                   18     18
     D** ----- ZCOT P 9 0 (Campo)
     D  ZCOT                  19     27  0
     D** ----- Z51 A 8 0 (Campo)
     D  Z51                   28     35
     D** ----- ZTI A 3 0 (Campo)
     D  ZTI                   36     38
     D** ----- ZNI P 11 0 (Campo)
     D  ZNI                   39     49  0
     D** -----
     D** ----- Estructura Registro INFA48
     D** -----
     D $$INFA          DS
     D** ----- ZNFCL2 A 1 0 (Campo)
     D  ZNFCL2                 1      1
     D** ----- ZNFCV3 P 9 0 (Campo)
     D  ZNFCV3                 2     10  0
     D** ----- ZNFCV4 P 9 0 (Campo)
     D  ZNFCV4                11     19  0
     D** ----- ZNFC24 P 9 0 (Campo)
     D  ZNFC24                20     28  0
     D** ----- ZNFC25 P 9 0 (Campo)
     D  ZNFC25                29     37  0
     D** ----- ZNFDE7 P 9 0 (Campo)
     D  ZNFDE7                38     46  0
     D** ----- ZNFDE8 P 9 0 (Campo)
     D  ZNFDE8                47     55  0
     D** ----- ZNFDE9 P 9 0 (Campo)
     D  ZNFDE9                56     64  0
     D** ----- ZNFDI8 P 2 0 (Campo)
     D  ZNFDI8                65     66  0
     D** ----- ZNFDI9 P 9 0 (Campo)
     D  ZNFDI9                67     75  0
     D** ----- ZNFD01 P 2 0 (Campo)
     D  ZNFD01                76     77  0
     D** ----- ZNFES8 A 3 0 (Campo)
     D  ZNFES8                78     80
     D** ----- ZNFFS2 P 9 0 (Campo)
     D  ZNFFS2                81     89  0
     D** ----- ZNFI17 A 2 0 (Campo)
     D  ZNFI17                90     91
     D** ----- ZNFI18 P 2 0 (Campo)
     D  ZNFI18                92     93  0
     D** ----- ZNFI19 A 1 0 (Campo)
     D  ZNFI19                94     94
     D** ----- ZNFI20 A 1 0 (Campo)
     D  ZNFI20                95     95
     D** ----- ZNFI21 A 1 0 (Campo)
     D  ZNFI21                96     96
     D** ----- ZNFI22 P 9 0 (Campo)
     D  ZNFI22                97    105  0
     D** ----- ZNFI23 P 9 0 (Campo)
     D  ZNFI23               106    114  0
     D** ----- ZNFI24 A 2 0 (Campo)
     D  ZNFI24               115    116
     D** ----- ZNFLO2 A 15 0 (Campo)
     D  ZNFLO2               117    131
     D** ----- ZNFNI3 P 11 0 (Campo)
     D  ZNFNI3               132    142  0
     D** ----- ZNFN35 P 12 0 (Campo)
     D  ZNFN35               143    154  0
     D** ----- ZNFN36 P 11 0 (Campo)
     D  ZNFN36               155    165  0
     D** ----- ZNFN37 P 11 0 (Campo)
     D  ZNFN37               166    176  0
     D** ----- ZNFN38 P 9 0 (Campo)
     D  ZNFN38               177    185  0
     D** ----- ZNFN39 A 1 0 (Campo)
     D  ZNFN39               186    186
     D** ----- ZNFPA4 P 3 0 (Campo)
     D  ZNFPA4               187    189  0
     D** ----- ZNFP08 A 6 0 (Campo)
     D  ZNFP08               190    195
     D** ----- ZNFP09 A 20 0 (Campo)
     D  ZNFP09               196    215
     D** ----- ZNFP10 A 20 0 (Campo)
     D  ZNFP10               216    235
     D** ----- ZNFP11 P 5 2 (Campo)
     D  ZNFP11               236    240  2
     D** ----- ZNFP12 P 5 2 (Campo)
     D  ZNFP12               241    245  2
     D** ----- ZNFS22 P 3 0 (Campo)
     D  ZNFS22               246    248  0
     D** ----- ZNFS23 A 20 0 (Campo)
     D  ZNFS23               249    268
     D** ----- ZNFS24 A 20 0 (Campo)
     D  ZNFS24               269    288
     D** ----- ZNFS25 P 9 0 (Campo)
     D  ZNFS25               289    297  0
     D** ----- ZNFS26 P 2 0 (Campo)
     D  ZNFS26               298    299  0
     D** ----- ZNFT26 A 3 0 (Campo)
     D  ZNFT26               300    302
     D** ----- ZNFT27 A 2 0 (Campo)
     D  ZNFT27               303    304
     D** ----- ZNFT28 A 2 0 (Campo)
     D  ZNFT28               305    306
     D** ----- ZNFT29 A 1 0 (Campo)
     D  ZNFT29               307    307
     D** ----- ZNFT30 P 1 0 (Campo)
     D  ZNFT30               308    308  0
     D** ----- ZNFT31 P 2 0 (Campo)
     D  ZNFT31               309    310  0
     D** ----- ZNFT32 A 3 0 (Campo)
     D  ZNFT32               311    313
     D** ----- ZNFV82 P 9 0 (Campo)
     D  ZNFV82               314    322  0
     D** ----- ZNFV83 P 9 0 (Campo)
     D  ZNFV83               323    331  0
     D** ----- ZNFV84 P 9 0 (Campo)
     D  ZNFV84               332    340  0
     D** ----- ZNFV85 P 9 0 (Campo)
     D  ZNFV85               341    349  0
     D** ----- ZNFV86 P 9 0 (Campo)
     D  ZNFV86               350    358  0
     D** ----- ZNFV87 P 9 0 (Campo)
     D  ZNFV87               359    367  0
     D** ----- ZNF001 A 8 0 (Campo)
     D  ZNF001               368    375
     D** ----- ZNF002 A 8 0 (Campo)
     D  ZNF002               376    383
     D** -----
     D** ----- Ingreso diverso
     D** -----
     D $$INGA          DS
     D** ----- ZNGNUM P 12 0 (Campo)
     D  ZNGNUM                 1     12  0
     D** ----- ZNGPLA P 12 0 (Campo)
     D  ZNGPLA                13     24  0
     D** ----- ZNGCO2 P 5 0 (Campo)
     D  ZNGCO2                25     29  0
     D** ----- ZNGPAG P 3 0 (Campo)
     D  ZNGPAG                30     32  0
     D** ----- ZNGSE1 P 3 0 (Campo)
     D  ZNGSE1                33     35  0
     D** ----- ZNGFEC A 8 0 (Campo)
     D  ZNGFEC                36     43
     D** ----- ZNGFE1 A 8 0 (Campo)
     D  ZNGFE1                44     51
     D** ----- ZNGTIP P 1 0 (Campo)
     D  ZNGTIP                52     52  0
     D** ----- ZNGVLR P 9 0 (Campo)
     D  ZNGVLR                53     61  0
     D** ----- ZNGCUO P 21 8 (Campo)
     D  ZNGCUO                62     82  8
     D** ----- ZNGVL1 P 9 0 (Campo)
     D  ZNGVL1                83     91  0
     D** ----- ZNGVL2 P 9 0 (Campo)
     D  ZNGVL2                92    100  0
     D** -----
     D** ----- liquidacion de intereses
     D** -----
     D $$LIQI          DS
     D** ----- ZINS A 77 0 (Campo)
     D  ZINS                   1     77
     D** ----- ZIITFS P 11 0 (SubCampo)
     D  ZIITFS                 1     11  0
     D** ----- ZIITSF P 11 0 (SubCampo)
     D  ZIITSF                12     22  0
     D** ----- ZIITER P 11 0 (SubCampo)
     D  ZIITER                23     33  0
     D** ----- ZIICVA P 11 0 (SubCampo)
     D  ZIICVA                34     44  0
     D** ----- ZIICVE P 11 0 (SubCampo)
     D  ZIICVE                45     55  0
     D** ----- ZIITAR P 11 0 (SubCampo)
     D  ZIITAR                56     66  0
     D** ----- ZIITFG P 11 0 (SubCampo)
     D  ZIITFG                67     77  0
     D** ----- ZINC A 105 0 (Campo)
     D  ZINC                  78    182
     D** ----- ZTCTFS P 15 2 (SubCampo)
     D  ZTCTFS                78     92  2
     D** ----- ZTCTSF P 15 2 (SubCampo)
     D  ZTCTSF                93    107  2
     D** ----- ZTCTER P 15 2 (SubCampo)
     D  ZTCTER               108    122  2
     D** ----- ZTCCVA P 15 2 (SubCampo)
     D  ZTCCVA               123    137  2
     D** ----- ZTCCVE P 15 2 (SubCampo)
     D  ZTCCVE               138    152  2
     D** ----- ZTCTAR P 15 2 (SubCampo)
     D  ZTCTAR               153    167  2
     D** ----- ZTCTFG P 15 2 (SubCampo)
     D  ZTCTFG               168    182  2
     D** -----
     D** ----- Modificación historia laboral TRMOHL50
     D** -----
     D $$MOHL          DS
     D** ----- ZMDCO3 P 9 0 (Campo)
     D  ZMDCO3                 1      9  0
     D** ----- ZMDTI7 A 3 0 (Campo)
     D  ZMDTI7                10     12
     D** ----- ZMDNU7 P 11 0 (Campo)
     D  ZMDNU7                13     23  0
     D** ----- ZMDFE7 A 8 0 (Campo)
     D  ZMDFE7                24     31
     D** ----- ZMDFE8 A 8 0 (Campo)
     D  ZMDFE8                32     39
     D** ----- ZMDHO4 A 6 0 (Campo)
     D  ZMDHO4                40     45
     D** ----- ZMDACC A 1 0 (Campo)
     D  ZMDACC                46     46
     D** -----
     D** ----- Pago en exceso original PAGA22
     D** -----
     D $$PAGA          DS
     D** ----- ZAGPL5 P 12 0 (Campo)
     D  ZAGPL5                 1     12  0
     D** ----- ZAGF95 A 8 0 (Campo)
     D  ZAGF95                13     20
     D** ----- ZAGF97 A 8 0 (Campo)
     D  ZAGF97                21     28
     D** ----- ZAGV56 P 15 2 (Campo)
     D  ZAGV56                29     43  2
     D** ----- ZAG019 P 21 8 (Campo)
     D  ZAG019                44     64  8
     D** ----- ZAGS16 P 15 2 (Campo)
     D  ZAGS16                65     79  2
     D** ----- ZAG020 P 21 8 (Campo)
     D  ZAG020                80    100  8
     D** ----- ZAGV57 P 15 2 (Campo)
     D  ZAGV57               101    115  2
     D** ----- ZAG021 P 21 8 (Campo)
     D  ZAG021               116    136  8
     D** ----- ZAGS17 P 15 2 (Campo)
     D  ZAGS17               137    151  2
     D** ----- ZAG022 P 21 8 (Campo)
     D  ZAG022               152    172  8
     D** ----- ZAGV58 P 15 2 (Campo)
     D  ZAGV58               173    187  2
     D** -----
     D** ----- Hoja I entidad - - PAGAR1 -
     D** -----
     D $$PAGR          DS
     D** ----- Z59TI2 A 2 0 (Campo)
     D  Z59TI2                 1      2
     D** ----- Z59FE9 A 8 0 (Campo)
     D  Z59FE9                 3     10
     D** ----- Z59PLA P 12 0 (Campo)
     D  Z59PLA                11     22  0
     D** ----- Z59SUB A 2 0 (Campo)
     D  Z59SUB                23     24
     D** ----- Z59F01 A 8 0 (Campo)
     D  Z59F01                25     32
     D** ----- Z59VA2 P 15 2 (Campo)
     D  Z59VA2                33     47  2
     D** ----- Z59CU5 P 21 8 (Campo)
     D  Z59CU5                48     68  8
     D** ----- Z59F02 A 8 0 (Campo)
     D  Z59F02                69     76
     D** ----- Z59US2 A 10 0 (Campo)
     D  Z59US2                77     86
     D** ----- Z59F03 A 8 0 (Campo)
     D  Z59F03                87     94
     D** ----- Z59FIL A 255 0 (Campo)
     D  Z59FIL                95    349
     D** ----- Z59ACC A 1 0 (Campo)
     D  Z59ACC               350    350
     D** ----- Z59ERR A 1 0 (Campo)
     D  Z59ERR               351    351
     D** ----- Z59SQL P 9 0 (Campo)
     D  Z59SQL               352    360  0
     D** -----
     D** ----- Estructura Registro PLAA55
     D** -----
     D $$PLAA          DS
     D** ----- ZLAAGE A 5 0 (Campo)
     D  ZLAAGE                 1      5
     D** ----- ZLABA7 A 10 0 (Campo)
     D  ZLABA7                 6     15
     D** ----- ZLACI8 A 30 0 (Campo)
     D  ZLACI8                16     45
     D** ----- ZLACI9 A 5 0 (Campo)
     D  ZLACI9                46     50
     D** ----- ZLAD08 A 50 0 (Campo)
     D  ZLAD08                51    100
     D** ----- ZLAD09 A 30 0 (Campo)
     D  ZLAD09               101    130
     D** ----- ZLAD10 P 9 0 (Campo)
     D  ZLAD10               131    139  0
     D** ----- ZLAD11 A 5 0 (Campo)
     D  ZLAD11               140    144
     D** ----- ZLAE08 A 3 0 (Campo)
     D  ZLAE08               145    147
     D** ----- ZLAE09 A 3 0 (Campo)
     D  ZLAE09               148    150
     D** ----- ZLAF39 A 8 0 (Campo)
     D  ZLAF39               151    158
     D** ----- ZLAF40 A 1 0 (Campo)
     D  ZLAF40               159    159
     D** ----- ZLAF41 A 8 0 (Campo)
     D  ZLAF41               160    167
     D** ----- ZLAF42 A 8 0 (Campo)
     D  ZLAF42               168    175
     D** ----- ZLAF43 A 8 0 (Campo)
     D  ZLAF43               176    183
     D** ----- ZLAF44 A 8 0 (Campo)
     D  ZLAF44               184    191
     D** ----- ZLAI21 A 1 0 (Campo)
     D  ZLAI21               192    192
     D** ----- ZLAI22 P 15 2 (Campo)
     D  ZLAI22               193    207  2
     D** ----- ZLAI23 P 15 2 (Campo)
     D  ZLAI23               208    222  2
     D** ----- ZLALO8 A 15 0 (Campo)
     D  ZLALO8               223    237
     D** ----- ZLAP29 A 6 0 (Campo)
     D  ZLAP29               238    243
     D** ----- ZLAP30 A 6 0 (Campo)
     D  ZLAP30               244    249
     D** ----- ZLAP31 A 6 0 (Campo)
     D  ZLAP31               250    255
     D** ----- ZLAP32 A 6 0 (Campo)
     D  ZLAP32               256    261
     D** ----- ZLAR68 P 15 2 (Campo)
     D  ZLAR68               262    276  2
     D** ----- ZLAS09 P 15 2 (Campo)
     D  ZLAS09               277    291  2
     D** ----- ZLAS10 P 15 2 (Campo)
     D  ZLAS10               292    306  2
     D** ----- ZLAS11 P 15 2 (Campo)
     D  ZLAS11               307    321  2
     D** ----- ZLAS12 P 15 2 (Campo)
     D  ZLAS12               322    336  2
     D** ----- ZLATE9 A 12 0 (Campo)
     D  ZLATE9               337    348
     D** ----- ZLAU05 A 10 0 (Campo)
     D  ZLAU05               349    358
     D** ----- ZLAVL6 P 15 2 (Campo)
     D  ZLAVL6               359    373  2
     D** ----- ZLAV16 P 15 2 (Campo)
     D  ZLAV16               374    388  2
     D** ----- ZLAV17 P 15 2 (Campo)
     D  ZLAV17               389    403  2
     D** ----- ZLAV18 P 15 2 (Campo)
     D  ZLAV18               404    418  2
     D** ----- ZLA112 P 12 0 (Campo)
     D  ZLA112               419    430  0
     D** ----- ZLA113 P 12 0 (Campo)
     D  ZLA113               431    442  0
     D** ----- ZLA114 A 2 0 (Campo)
     D  ZLA114               443    444
     D** ----- ZLA115 A 2 0 (Campo)
     D  ZLA115               445    446
     D** ----- ZLA116 P 11 0 (Campo)
     D  ZLA116               447    457  0
     D** ----- ZLA117 P 9 0 (Campo)
     D  ZLA117               458    466  0
     D** ----- ZLA118 A 3 0 (Campo)
     D  ZLA118               467    469
     D** ----- ZLA119 P 12 0 (Campo)
     D  ZLA119               470    481  0
     D** ----- ZLA120 A 120 0 (Campo)
     D  ZLA120               482    601
     D** ----- ZLA121 A 50 0 (Campo)
     D  ZLA121               602    651
     D** ----- ZLA122 A 3 0 (Campo)
     D  ZLA122               652    654
     D** ----- ZLA123 P 11 0 (Campo)
     D  ZLA123               655    665  0
     D** ----- ZLA124 A 50 0 (Campo)
     D  ZLA124               666    715
     D** ----- ZLA125 A 1 0 (Campo)
     D  ZLA125               716    716
     D** ----- ZLA126 A 10 0 (Campo)
     D  ZLA126               717    726
     D** ----- ZLA127 P 5 0 (Campo)
     D  ZLA127               727    731  0
     D** ----- ZLA128 P 5 0 (Campo)
     D  ZLA128               732    736  0
     D** ----- ZLA129 A 5 0 (Campo)
     D  ZLA129               737    741
     D** ----- ZLA130 P 7 0 (Campo)
     D  ZLA130               742    748  0
     D** ----- ZLA131 P 7 0 (Campo)
     D  ZLA131               749    755  0
     D** ----- ZLA132 P 5 0 (Campo)
     D  ZLA132               756    760  0
     D** ----- ZLA133 A 5 0 (Campo)
     D  ZLA133               761    765
     D** ----- ZLA134 A 3 0 (Campo)
     D  ZLA134               766    768
     D** ----- ZLA135 A 3 0 (Campo)
     D  ZLA135               769    771
     D** ----- ZLA136 P 2 0 (Campo)
     D  ZLA136               772    773  0
     D** ----- ZLA137 P 15 2 (Campo)
     D  ZLA137               774    788  2
     D** ----- ZLA138 P 15 2 (Campo)
     D  ZLA138               789    803  2
     D** ----- ZLA139 P 15 2 (Campo)
     D  ZLA139               804    818  2
     D** ----- ZLA140 P 15 2 (Campo)
     D  ZLA140               819    833  2
     D** ----- ZLA141 P 15 2 (Campo)
     D  ZLA141               834    848  2
     D** ----- ZLA142 P 15 2 (Campo)
     D  ZLA142               849    863  2
     D** ----- ZLA143 P 12 0 (Campo)
     D  ZLA143               864    875  0
     D** ----- ZLA144 P 15 2 (Campo)
     D  ZLA144               876    890  2
     D** ----- ZLA145 P 5 0 (Campo)
     D  ZLA145               891    895  0
     D** ----- ZLA146 P 15 2 (Campo)
     D  ZLA146               896    910  2
     D** ----- ZLA147 A 10 0 (Campo)
     D  ZLA147               911    920
     D** ----- ZLA148 A 17 0 (Campo)
     D  ZLA148               921    937
     D** ----- ZLA149 P 21 8 (Campo)
     D  ZLA149               938    958  8
     D** ----- ZLA150 P 15 2 (Campo)
     D  ZLA150               959    973  2
     D** ----- ZLA151 P 15 2 (Campo)
     D  ZLA151               974    988  2
     D** ----- ZLA152 P 9 0 (Campo)
     D  ZLA152               989    997  0
     D** ----- ZLA153 P 21 8 (Campo)
     D  ZLA153               998   1018  8
     D** ----- ZLA154 P 15 2 (Campo)
     D  ZLA154              1019   1033  2
     D** ----- ZLA155 P 15 2 (Campo)
     D  ZLA155              1034   1048  2
     D** ----- ZLA156 P 15 2 (Campo)
     D  ZLA156              1049   1063  2
     D** ----- ZLA157 P 21 8 (Campo)
     D  ZLA157              1064   1084  8
     D** ----- ZLA158 A 4 0 (Campo)
     D  ZLA158              1085   1088
     D** ----- ZLA159 A 1 0 (Campo)
     D  ZLA159              1089   1089
     D** ----- ZLAI24 A 1 0 (Campo)
     D  ZLAI24              1090   1090
     D** -----
     D** ----- Hoja I entidad RECA53
     D** -----
     D $$REDH          DS
     D** ----- ZFON53 A 3 0 (Campo)
     D  ZFON53                 1      3
     D** ----- ZPLA53 P 12 0 (Campo)
     D  ZPLA53                 4     15  0
     D** ----- ZPAG53 P 3 0 (Campo)
     D  ZPAG53                16     18  0
     D** ----- ZSEC53 P 3 0 (Campo)
     D  ZSEC53                19     21  0
     D** ----- ZCON53 P 5 0 (Campo)
     D  ZCON53                22     26  0
     D** ----- ZINT53 P 9 0 (Campo)
     D  ZINT53                27     35  0
     D** ----- ZDTA53 P 2 0 (Campo)
     D  ZDTA53                36     37  0
     D** ----- ZDLA53 P 2 0 (Campo)
     D  ZDLA53                38     39  0
     D** ----- ZDTC53 P 2 0 (Campo)
     D  ZDTC53                40     41  0
     D** ----- ZDLC53 P 2 0 (Campo)
     D  ZDLC53                42     43  0
     D** ----- ZTIG53 A 1 0 (Campo)
     D  ZTIG53                44     44
     D** ----- ZUSU53 A 10 0 (Campo)
     D  ZUSU53                45     54
     D** ----- ZFEC53 A 8 0 (Campo)
     D  ZFEC53                55     62
     D** ----- ZHOR53 A 6 0 (Campo)
     D  ZHOR53                63     68
     D** ----- ZACC53 A 1 0 (Campo)
     D  ZACC53                69     69
     D** ----- ZEXI53 A 1 0 (Campo)
     D  ZEXI53                70     70
     D** -----
     D** ----- histórico de parámetros
     D** -----
     D $$REG1          DS
     D** ----- ZHPPE1 A 6 0 (Campo)
     D  ZHPPE1                 1      6
     D** ----- ZHPPOR P 5 2 (Campo)
     D  ZHPPOR                 7     11  2
     D** ----- ZHPPO1 P 7 5 (Campo)
     D  ZHPPO1                12     18  5
     D** ----- ZHPPO2 P 7 5 (Campo)
     D  ZHPPO2                19     25  5
     D** ----- ZHPPO3 P 5 2 (Campo)
     D  ZHPPO3                26     30  2
     D** ----- ZHPPO4 P 5 2 (Campo)
     D  ZHPPO4                31     35  2
     D** ----- ZHPPO5 P 5 2 (Campo)
     D  ZHPPO5                36     40  2
     D** ----- ZHPP49 P 5 2 (Campo)
     D  ZHPP49                41     45  2
     D** ----- ZHPINT P 5 2 (Campo)
     D  ZHPINT                46     50  2
     D** ----- ZHPP50 P 5 2 (Campo)
     D  ZHPP50                51     55  2
     D** ----- ZHPN05 P 2 0 (Campo)
     D  ZHPN05                56     57  0
     D** ----- ZHPN24 P 2 0 (Campo)
     D  ZHPN24                58     59  0
     D** ----- ZHPMAX P 2 0 (Campo)
     D  ZHPMAX                60     61  0
     D** ----- ZHPVA2 P 9 0 (Campo)
     D  ZHPVA2                62     70  0
     D** ----- ZHPV14 P 9 0 (Campo)
     D  ZHPV14                71     79  0
     D** ----- ZHPDE1 P 6 0 (Campo)
     D  ZHPDE1                80     85  0
     D** ----- ZHPDE3 P 6 0 (Campo)
     D  ZHPDE3                86     91  0
     D** ----- ZHPN26 P 3 0 (Campo)
     D  ZHPN26                92     94  0
     D** ----- ZHPDIA P 2 0 (Campo)
     D  ZHPDIA                95     96  0
     D** ----- ZHPDI2 P 2 0 (Campo)
     D  ZHPDI2                97     98  0
     D** ----- ZHPDI3 P 2 0 (Campo)
     D  ZHPDI3                99    100  0
     D** ----- ZHPDI4 P 2 0 (Campo)
     D  ZHPDI4               101    102  0
     D** ----- ZHPDI5 P 2 0 (Campo)
     D  ZHPDI5               103    104  0
     D** ----- ZHPDI6 P 2 0 (Campo)
     D  ZHPDI6               105    106  0
     D** ----- ZHPDI7 P 2 0 (Campo)
     D  ZHPDI7               107    108  0
     D** ----- ZHPDI8 P 2 0 (Campo)
     D  ZHPDI8               109    110  0
     D** ----- ZHPDI9 P 2 0 (Campo)
     D  ZHPDI9               111    112  0
     D** ----- ZHPD01 P 2 0 (Campo)
     D  ZHPD01               113    114  0
     D** ----- ZHPIND A 1 0 (Campo)
     D  ZHPIND               115    115
     D** -----
     D** ----- $$SIMR Hoja I entidad - - SIMAR1 -
     D** -----
     D $$SIMR          DS
     D** ----- ZSMLOT A 15 0 (Campo)
     D  ZSMLOT                 1     15
     D** ----- ZSMPLA P 12 0 (Campo)
     D  ZSMPLA                16     27  0
     D** ----- ZSMPAG P 3 0 (Campo)
     D  ZSMPAG                28     30  0
     D** ----- ZSMSEC P 3 0 (Campo)
     D  ZSMSEC                31     33  0
     D** ----- ZSMPER A 6 0 (Campo)
     D  ZSMPER                34     39
     D** ----- ZSMTID A 3 0 (Campo)
     D  ZSMTID                40     42
     D** ----- ZSMNID P 11 0 (Campo)
     D  ZSMNID                43     53  0
     D** ----- ZSMCDI P 9 0 (Campo)
     D  ZSMCDI                54     62  0
     D** ----- ZSMREZ A 2 0 (Campo)
     D  ZSMREZ                63     64
     D** ----- ZSMNOV A 1 0 (Campo)
     D  ZSMNOV                65     65
     D** ----- ZSMACC A 1 0 (Campo)
     D  ZSMACC                66     66
     D** ----- ZSMERR A 1 0 (Campo)
     D  ZSMERR                67     67
     D** -----
     D** ----- Vector de novedades
     D** -----
     D $$VECN          DS
     D** ----- ZVECNO A 12 0 (Campo)
     D  ZVECNO                 1     12
     D** ----- ZNOING A 1 0 (SubCampo)
     D  ZNOING                 1      1
     D** ----- ZNORET A 1 0 (SubCampo)
     D  ZNORET                 2      2
     D** ----- ZNOTDA A 1 0 (SubCampo)
     D  ZNOTDA                 3      3
     D** ----- ZNOTAA A 1 0 (SubCampo)
     D  ZNOTAA                 4      4
     D** ----- ZNOVSP A 1 0 (SubCampo)
     D  ZNOVSP                 5      5
     D** ----- ZNOVTE A 1 0 (SubCampo)
     D  ZNOVTE                 6      6
     D** ----- ZNOVST A 1 0 (SubCampo)
     D  ZNOVST                 7      7
     D** ----- ZNOSLN A 1 0 (SubCampo)
     D  ZNOSLN                 8      8
     D** ----- ZNOIGE A 1 0 (SubCampo)
     D  ZNOIGE                 9      9
     D** ----- ZNOLMA A 1 0 (SubCampo)
     D  ZNOLMA                10     10
     D** ----- ZNOVAC A 1 0 (SubCampo)
     D  ZNOVAC                11     11
     D** ----- ZNOAVP A 1 0 (SubCampo)
     D  ZNOAVP                12     12
     D D$CHAR          DS
     D  V$BIN                  1      2B 0 INZ(0)
     D  V$CAR                  2      2
     C**
     C                   EXSR      MAIN
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C*==================================================================
     C*==  Instrucciones de compilación                                ==
     C*==                                                              ==
     C*==================================================================
     C     COMPIL        BEGSR
     C* INSTRUCCIONES DE COMPILACION:
     C* 1. Modificar y compilar por SNAP
     C* 2. Sacar copia en la biblioteca QRPGLESRC, eliminar el fuente ac
     C*    y luego convertir a ILE con el siguiente comando:
     C*    CVTRPGSRC FROMFILE(FUTPROP210/QRPGSRC) FROMMBR(TRPLAN64)
     C*    TOFILE(FUTPROP210/QRPGLESRC) TOMBR(TRPLAN64)
     C* 3. Compilar el ILE con opción 14
     C******************************************************************
     C                   ENDSR
     C*==================================================================
     C*==  Imprime reporte detallado movimiento                        ==
     C*==                                                              ==
     C*==================================================================
     C     DET@01        BEGSR
     C* Transacción
     C*MOVER ZTRANS MOVCO1
     C                   MOVE      MOVCO1        ZTRANS
     C* Concepto
     C*MOVER ZCONCE MOVTIP
     C                   MOVE      MOVTIP        ZCONCE
     C* Planilla
     C*MOVER ZPLANI MOVNU2
     C                   Z-ADD     MOVNU2        ZPLANI
     C* Página
     C*MOVER ZPAG   MOVPAG
     C                   Z-ADD     MOVPAG        ZPAG
     C* Secuencia
     C*MOVER ZSEC   MOVSEC
     C                   Z-ADD     MOVSEC        ZSEC
     C* Planilla de cancelación
     C*MOVER ZPLACA MOVPLA
     C                   Z-ADD     MOVPLA        ZPLACA
     C* Tipo de rezago
     C*LIMPIAR ZTIRE
     C                   CLEAR                   ZTIRE
     C* Número identificación
     C*MOVER ZNROID DETNU2
     C                   Z-ADD     DETNU2        ZNROID
     C* Valor C.O.
     C*MOVER ZRCO   MOVCOT
     C                   Z-ADD     MOVCOT        ZRCO
     C* Valor A.R.
     C*MOVER ZRAR   MOVC24
     C                   Z-ADD     MOVC24        ZRAR
     C* Valor C.V.A.
     C*MOVER ZRCVA  MOVCO5
     C                   Z-ADD     MOVCO5        ZRCVA
     C* Valor C.V.E.
     C*MOVER ZRCVE  MOVCO6
     C                   Z-ADD     MOVCO6        ZRCVE
     C* Intereses + Rendimientos
     C*CALCULAR ZRREIN = MOVVA4 + MOVINT + MOVI05
     C     MOVVA4        ADD       MOVINT        V$CA1           030 9
     C     V$CA1         ADD       MOVI05        ZRREIN
     C* Comisión C.O + FGPM
     C*CALCULAR ZRCCO = MOVCOM + MOVV12
     C     MOVCOM        ADD       MOVV12        ZRCCO
     C* Prima de seguros
     C*MOVER ZRPS   MOVVAL
     C                   Z-ADD     MOVVAL        ZRPS
     C* Comisión C.V.E.
     C*CALCULAR ZRCOCV = MOVCO7 + MOVC27
     C     MOVCO7        ADD       MOVC27        ZRCOCV
     C* F. solidaridad + subsistencia
     C*CALCULAR ZRFS = MOVCO8 + MOVV13
     C     MOVCO8        ADD       MOVV13        ZRFS
     C* Int. fondo sol. + Int subsis.
     C*CALCULAR ZRIFS = MOVIN2 + MOVI06
     C     MOVIN2        ADD       MOVI06        ZRIFS
     C*LIMPIAR ZRDERE ZRPEEM
     C                   CLEAR                   ZRDERE
     C                   CLEAR                   ZRPEEM
     C*SI FPG
     C     *INOF         IFEQ      '1'
     C*IMPRIMIR FMT@E1
     C                   EXCEPT    FMT@E1
     C*IMPRIMIR FMT@TI
     C                   EXCEPT    FMT@TI
     C*FIN
     C                   END
     C*IMPRIMIR FMT@D1
     C                   EXCEPT    FMT@D1
     C                   ENDSR
     C*==================================================================
     C*==  Imprime reporte detallado detalle de deudas                 ==
     C*==                                                              ==
     C*==================================================================
     C     DET@02        BEGSR
     C* Planilla
     C*MOVER ZPLANI DETNU9
     C                   Z-ADD     DETNU9        ZPLANI
     C* Página
     C*MOVER ZPAG   DETPA2
     C                   Z-ADD     DETPA2        ZPAG
     C* Secuencia
     C*MOVER ZSEC   DETSE4
     C                   Z-ADD     DETSE4        ZSEC
     C* Tipo de rezago
     C*LIMPIAR ZTIRE
     C                   CLEAR                   ZTIRE
     C* Número identificación
     C*MOVER ZNROID DETNR1
     C                   Z-ADD     DETNR1        ZNROID
     C* Valor C.O.
     C*CALCULAR ZRCO = DETSA1 - DETS17
     C     DETSA1        SUB       DETS17        ZRCO
     C* Valor A.R.
     C*MOVER ZRAR   DETS17
     C                   Z-ADD     DETS17        ZRAR
     C* Valor C.V.A.
     C*MOVER ZRCVA  DETSA3
     C                   Z-ADD     DETSA3        ZRCVA
     C* Valor C.V.E.
     C*MOVER ZRCVE  DETSA7
     C                   Z-ADD     DETSA7        ZRCVE
     C* Intereses + Rendimientos + int. FGPM
     C*CALCULAR ZRREIN = DETS01 + DETSA5 + DETS96 + DET125 + DET126
     C     DETS01        ADD       DETSA5        V$CA1           030 9
     C     V$CA1         ADD       DETS96        V$CA1
     C     V$CA1         ADD       DET125        V$CA1
     C     V$CA1         ADD       DET126        ZRREIN
     C* Comisión C.O. + F.G.P.M
     C*MOVER ZRCCO  DETS95
     C                   Z-ADD     DETS95        ZRCCO
     C* Prima de seguros
     C*MOVER ZRPS   *CERO
     C                   MOVE      *ZERO         ZRPS
     C* Comisión C.V.E.
     C*MOVER ZRCOCV *CERO
     C                   MOVE      *ZERO         ZRCOCV
     C* Fondo de solidaridad + Subsis
     C*CALCULAR ZRFS = DETSA4 + DETS97
     C     DETSA4        ADD       DETS97        ZRFS
     C* Int. fondo sol. + Int.subis
     C*CALCULAR ZRIFS= DETS07 + DETS98 + DET120 + DET127
     C     DETS07        ADD       DETS98        V$CA1           030 9
     C     V$CA1         ADD       DET120        V$CA1
     C     V$CA1         ADD       DET127        ZRIFS
     C*LIMPIAR ZRDERE ZRPEEM
     C                   CLEAR                   ZRDERE
     C                   CLEAR                   ZRPEEM
     C*SI FPG
     C     *INOF         IFEQ      '1'
     C*IMPRIMIR FMT@E1
     C                   EXCEPT    FMT@E1
     C*IMPRIMIR FMT@TI
     C                   EXCEPT    FMT@TI
     C*FIN
     C                   END
     C*IMPRIMIR FMT@D1
     C                   EXCEPT    FMT@D1
     C                   ENDSR
     C*==================================================================
     C*==  Imprime reporte detallado rezagos                           ==
     C*==                                                              ==
     C*==================================================================
     C     DET@03        BEGSR
     C* Si planilla no es CERO
     C*SI REZNRO != *CERO
     C     REZNRO        IFNE      *ZERO
     C* Transacción
     C*MOVER ZTRANS '05'
     C                   MOVE      '05'          ZTRANS
     C* Concepto
     C*MOVER ZCONCE '31'
     C                   MOVE      '31'          ZCONCE
     C* Planilla
     C*MOVER ZPLANI REZNRO
     C                   Z-ADD     REZNRO        ZPLANI
     C* Página
     C*MOVER ZPAG   REZNR1
     C                   Z-ADD     REZNR1        ZPAG
     C* Secuencia
     C*MOVER ZSEC   REZNR2
     C                   Z-ADD     REZNR2        ZSEC
     C* Planilla de cancelación
     C*MOVER ZPLACA *CERO
     C                   MOVE      *ZERO         ZPLACA
     C* Tipo de rezago
     C*MOVER ZTIRE  REZTI3
     C                   MOVE      REZTI3        ZTIRE
     C* Número identificación
     C*MOVER ZNROID REZNR3
     C                   Z-ADD     REZNR3        ZNROID
     C* Valor C.O.
     C*MOVER ZRCO   REZCOT
     C                   Z-ADD     REZCOT        ZRCO
     C* Valor A.R.
     C*MOVER ZRAR   *CERO
     C                   MOVE      *ZERO         ZRAR
     C* Valor C.V.A.
     C*MOVER ZRCVA  REZCO1
     C                   Z-ADD     REZCO1        ZRCVA
     C* Valor C.V.E.
     C*MOVER ZRCVE  REZCO2
     C                   Z-ADD     REZCO2        ZRCVE
     C* Intereses + Rendimientos
     C*CALCULAR ZRREIN = REZINT + REZVA1
     C     REZINT        ADD       REZVA1        ZRREIN
     C* Comisión C.O.
     C*MOVER ZRCCO  *CERO
     C                   MOVE      *ZERO         ZRCCO
     C* Prima de seguros
     C*MOVER ZRPS   *CERO
     C                   MOVE      *ZERO         ZRPS
     C* Comisión C.V.E.
     C*MOVER ZRCOCV *CERO
     C                   MOVE      *ZERO         ZRCOCV
     C* Fondo de solidaridad
     C*MOVER ZRFS   REZCO4
     C                   Z-ADD     REZCO4        ZRFS
     C* Valor intereses fondo sol.
     C*MOVER ZRIFS  REZIN9
     C                   Z-ADD     REZIN9        ZRIFS
     C* Deuda rezagos
     C*MOVER ZRDERE REZDEU
     C                   Z-ADD     REZDEU        ZRDERE
     C* Valor P.E. empleador
     C*MOVER ZRPEEM REZVA3
     C                   Z-ADD     REZVA3        ZRPEEM
     C*SI FPG
     C     *INOF         IFEQ      '1'
     C*IMPRIMIR FMT@E1
     C                   EXCEPT    FMT@E1
     C*IMPRIMIR FMT@TI
     C                   EXCEPT    FMT@TI
     C*FIN
     C                   END
     C*IMPRIMIR FMT@D1
     C                   EXCEPT    FMT@D1
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Imprime reporte detallado pagos en exceso                   ==
     C*==                                                              ==
     C*==================================================================
     C     DET@04        BEGSR
     C*SI ZT@002 ]= '3'
     C     ZT@002        IFNE      '3'
     C* Transacción
     C*MOVER ZTRANS '04'
     C                   MOVE      '04'          ZTRANS
     C* Concepto
     C*MOVER ZCONCE '34'
     C                   MOVE      '34'          ZCONCE
     C*SINO
     C                   ELSE
     C* Transacción
     C*MOVER ZTRANS '04'
     C                   MOVE      '04'          ZTRANS
     C* Concepto
     C*MOVER ZCONCE '35'
     C                   MOVE      '35'          ZCONCE
     C*FIN
     C                   END
     C* Planilla
     C*MOVER ZPLANI PLANU1
     C                   Z-ADD     PLANU1        ZPLANI
     C* Página
     C*MOVER ZPAG   *CERO
     C                   MOVE      *ZERO         ZPAG
     C* Secuencia
     C*MOVER ZSEC   *CERO
     C                   MOVE      *ZERO         ZSEC
     C* Planilla de cancelación
     C*MOVER ZPLACA *CERO
     C                   MOVE      *ZERO         ZPLACA
     C* Tipo de rezago
     C*MOVER ZTIRE  *BLANCO
     C                   MOVE      *BLANK        ZTIRE
     C* Número identificación
     C*MOVER ZNROID PLANU4
     C                   Z-ADD     PLANU4        ZNROID
     C* Valor C.O.
     C*MOVER ZRCO   *CERO
     C                   MOVE      *ZERO         ZRCO
     C* Valor A.R.
     C*MOVER ZRAR   *CERO
     C                   MOVE      *ZERO         ZRAR
     C* Valor C.V.A.
     C*MOVER ZRCVA  *CERO
     C                   MOVE      *ZERO         ZRCVA
     C* Valor C.V.E.
     C*MOVER ZRCVE  *CERO
     C                   MOVE      *ZERO         ZRCVE
     C* Intereses + Rendimientos
     C*MOVER ZRREIN *CERO
     C                   MOVE      *ZERO         ZRREIN
     C* Comisión C.O.
     C*MOVER ZRCCO  *CERO
     C                   MOVE      *ZERO         ZRCCO
     C* Prima de seguros
     C*MOVER ZRPS   *CERO
     C                   MOVE      *ZERO         ZRPS
     C* Comisión C.V.E.
     C*MOVER ZRCOCV *CERO
     C                   MOVE      *ZERO         ZRCOCV
     C* Fondo de solidaridad
     C*MOVER ZRFS   *CERO
     C                   MOVE      *ZERO         ZRFS
     C* Valor intereses fondo sol.
     C*MOVER ZRIFS  *CERO
     C                   MOVE      *ZERO         ZRIFS
     C* Deuda rezagos
     C*MOVER ZRDERE *CERO
     C                   MOVE      *ZERO         ZRDERE
     C* Valor P.E. empleador
     C*MOVER ZRPEEM ZVRPE
     C                   Z-ADD     ZVRPE         ZRPEEM
     C*SI FPG
     C     *INOF         IFEQ      '1'
     C*IMPRIMIR FMT@E1
     C                   EXCEPT    FMT@E1
     C*IMPRIMIR FMT@TI
     C                   EXCEPT    FMT@TI
     C*FIN
     C                   END
     C*IMPRIMIR FMT@D1
     C                   EXCEPT    FMT@D1
     C* Valor P.E. reporte totales
     C*SUMAR ZVRPE ZPEEMP
     C                   ADD       ZVRPE         ZPEEMP
     C* Cuotas P.E. reporte totales
     C*SUMAR ZCUPE ZCUPEE
     C                   ADD       ZCUPE         ZCUPEE
     C                   ENDSR
     C*==================================================================
     C*==  Imprime detalle de deudas anuladas por delta                ==
     C*==                                                              ==
     C*==================================================================
     C     DET@05        BEGSR
     C*SI FPG (PRN198B)
     C     *INOB         IFEQ      '1'
     C*IMPRIMIR FMT@E5
     C                   EXCEPT    FMT@E5
     C*IMPRIMIR FMT@T5
     C                   EXCEPT    FMT@T5
     C*SUMAR 1 ZPAGE5
     C                   ADD       1             ZPAGE5
     C*FIN
     C                   END
     C* Total planilla
     C*MOVER ZPLTO8 PLATO8
     C                   Z-ADD     PLATO8        ZPLTO8
     C*IMPRIMIR FMT@D5
     C                   EXCEPT    FMT@D5
     C* Observaciones no anulación
     C*LIMPIAR ZOBSER
     C                   CLEAR                   ZOBSER
     C                   ENDSR
     C*==================================================================
     C*==  Imprime detalle de reporte de deudas no anuladas            ==
     C*==                                                              ==
     C*==================================================================
     C     DET@06        BEGSR
     C* Si fin de página reporte
     C*SI FPG (PRN198C)
     C     *INOC         IFEQ      '1'
     C* Encabezamiento
     C*IMPRIMIR FMT@E6
     C                   EXCEPT    FMT@E6
     C* Titulos sobre linea detalle
     C*IMPRIMIR FMT@T6
     C                   EXCEPT    FMT@T6
     C* Páginas rep. deudas no anul.
     C*SUMAR 1 ZPAGE6
     C                   ADD       1             ZPAGE6
     C*FIN
     C                   END
     C*IMPRIMIR FMT@D6
     C                   EXCEPT    FMT@D6
     C* Observaciones no anulación
     C*LIMPIAR ZOBSER
     C                   CLEAR                   ZOBSER
     C                   ENDSR
     C*==================================================================
     C*==  Imprime encabezados reportes                                ==
     C*==                                                              ==
     C*==================================================================
     C     ENC@@1        BEGSR
     C*IMPRIMIR FMT@E2
     C                   EXCEPT    FMT@E2
     C*IMPRIMIR FMT@E1
     C                   EXCEPT    FMT@E1
     C*IMPRIMIR FMT@TI
     C                   EXCEPT    FMT@TI
     C*IMPRIMIR FMT@E3
     C                   EXCEPT    FMT@E3
     C*IMPRIMIR FMT@T3
     C                   EXCEPT    FMT@T3
     C                   ENDSR
     C*==================================================================
     C*==  Imprime encabezados reportes de anulación deudas por delta  ==
     C*==                                                              ==
     C*==================================================================
     C     ENC@@2        BEGSR
     C* Núm. pág. reporte deuda anuladas
     C*MOVER ZPAGE5 1
     C                   Z-ADD     1             ZPAGE5
     C* Núm. pág. reporte deuda no anulada
     C*MOVER ZPAGE6 1
     C                   Z-ADD     1             ZPAGE6
     C*IMPRIMIR FMT@E5
     C                   EXCEPT    FMT@E5
     C*IMPRIMIR FMT@E6
     C                   EXCEPT    FMT@E6
     C*IMPRIMIR FMT@T5
     C                   EXCEPT    FMT@T5
     C*IMPRIMIR FMT@T6
     C                   EXCEPT    FMT@T6
     C                   ENDSR
     C*==================================================================
     C*==  Seguridad y documentación                                   ==
     C*==                                                              ==
     C*==================================================================
     C     INICIA        BEGSR
     C*             Nombre del programa
     C*OBTENER (0) FUNCIO = 'TR' || *PRGNOM
     C                   CLEAR                   FUNCIO
     C     'TR'          CAT       'PLAN64':0    FUNCIO
     C*
     C*
     C*             recupera los valores del sistema
     C*LLAMAR RPVALSIS (ZHORA ZFESIS ZFECED USUÑÑÑ)
     C                   CALL      'RPVALSIS'
     C                   PARM                    ZHORA
     C                   PARM                    ZFESIS
     C                   PARM                    ZFECED
     C                   PARM                    USUÑÑÑ
     C*ASIGNAR SEG$$$ 'N'
     C                   MOVEL     'N'           SEG$$$
     C*LIMPIAR ZRENTR
     C                   CLEAR                   ZRENTR
     C*FUNCION QHORA (ZHOR)
     C                   CALL      'F012SNAP'                                   QHORA
     C     ZHOR          PARM      ZHOR          F$301             6
     C*
     C*LLAMAR TRINIFY1 (SEG$$$ NSIÑÑÑ NCOÑÑÑ)
     C                   CALL      'TRINIFY1'
     C                   PARM                    SEG$$$
     C                   PARM                    NSIÑÑÑ
     C                   PARM                    NCOÑÑÑ
     C*    Verifique concurrencia SI EL PROCESO LO EXIGE, de lo contrari
     C*LIMPIAR OK ZMODO
     C                   CLEAR                   OK
     C                   CLEAR                   ZMODO
     C* Acreditación Planillas
     C*SI ZT@002 = '1'
     C     ZT@002        IFEQ      '1'
     C* Acreditación masiva
     C*SI ZT@001 = *BLANCO Y ZT@007 = *BLANCO
     C     ZT@001        IFEQ      *BLANK
     C     ZT@007        ANDEQ     *BLANK
     C* Modo de ejecución masivo para concurrencia
     C*PASAR ZMODO 'M'
     C                   MOVEL     'M'           ZMODO
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LLAMAR TRCTPR50 (FUNCIO ZMODO OK USUÑÑÑ ZNRTRA)
     C                   CALL      'TRCTPR50'
     C                   PARM                    FUNCIO
     C                   PARM                    ZMODO
     C                   PARM                    OK
     C                   PARM                    USUÑÑÑ
     C                   PARM                    ZNRTRA
     C* Error procesos concurrentes
     C*SI OK = '1'
     C     OK            IFEQ      '1'
     C* Finaliza proceso
     C*LLAMAR TRCTPR51 (FUNCIO ZMODO ZNRTRA)
     C                   CALL      'TRCTPR51'
     C                   PARM                    FUNCIO
     C                   PARM                    ZMODO
     C                   PARM                    ZNRTRA
     C*TERMINAR
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C*FIN
     C                   END
     C*LIMPIAR OK
     C                   CLEAR                   OK
     C*SQL
     C/EXEC SQL
     C+  SET TRANSACTION ISOLATION LEVEL CHG
     C/END-EXEC
     C* Completar transacción
     C*FUNCION QLEEALD (ZT@COM 1024 1)
     C                   CALL      'F079SNAP'                                   QLEEALD
     C     ZT@COM        PARM      ZT@COM        F$371           250
     C                   PARM      1024          F$372             4 0
     C                   PARM      1             F$373             4 0
     C*
     C* ================================================================
     C*
     C* DESCRIPCIÓN: Dependiendo de los parámetros que le llegan toma un
     C*              varias planillas y genera la acreditación, esto es
     C*              generación del movimiento del afiliado, rezagos, pa
     C*              en exceso, deudas y las otras entidades relacionada
     C*
     C*              Cuando el llamado es tipo 2 indica que es cancelaci
     C*              de deudas con pago en exceso. En este caso se utili
     C*              los parámetros 3,4 y 5 con el número de planilla qu
     C*              se desea cancelar, si los parámetros 4 y 5 vienen e
     C*              cero significa que cancela toda la deuda, sino solo
     C*              detalle
     C*
     C* Ruta architect : Acreditación/acreditación de recaudo
     C*
     C* AUTOR  : Alvaro Hernando Rojas Munévar
     C* FECHA  : Octubre 21 de 1.996
     C* VERSIÓN: 3.02
     C* PARAMETROS: ZT@001 - Número de planilla fisico
     C*             ZT@002 - Tipo de llamado
     C*             ZT@003 - Nro. planilla de la deuda
     C*             ZT@004 - Pagina del detalle de deuda
     C*             ZT@005 - Secuencia del detalle de deuda
     C*             ZT@006 - Tipo de identificación
     C*             ZT@007 - Número de identificación
     C*             ZT@008 - Usuario
     C*             ZT@009 - Tipo de deuda
     C*
     C* FECHA : Agosto 03 de 2015
     C* AUTOR : Javier Rivera R
     C* TEXTO : Se modifica modulo M00010, para mover el M00050 antes de
     C*         validar ZSALIR, ya que debe ser limpiada la variable
     C*         por cada planilla
     C* REQUE : 11841
     C*
     C* FECHA : Agosto 04 de 2015
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se realizan varios cambios para permitir la acreditación
     C*         planillas (Voluntarias retroactivas, estado COP para mas
     C*         crear rezago 08 o crear relación abierta)
     C*         Módulos M00010 M14066 M11106 M14047
     C* REQUE : 11149 Grupobase 17.0
     C*
     C* FECHA : Septiembre 03 de 2015
     C* AUTOR : Javier Rivera R
     C* TEXTO : Se modifica el proceso de acreditación para incluir que
     C*         planillas con afiliados fusionados no se tengan que divi
     C*         y eliminar el proceso de Pre-acreditación
     C* REQUE : 11614
     C*
     C* FECHA : Noviembre 12 de 2015
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se condiciona no recalcular salario para planillas 03-09
     C*         Módulos M11100
     C*         Se ajusta para que asigne correctamente los dias en canc
     C*         deuda para planillas declaracion y no pago
     C* REQUE : 11927 Corrección Grupobase 17.0
     C*
     C* FECHA : Diciembre 02 de 2015
     C* AUTOR : David M. Beltran
     C* TEXTO : Se ajusta en modulo M14309 de manera que recupere el det
     C*         lle de planilla los valores de dias y los asigne al camp
     C*         movnum previamente
     C* REQUE : 11950
     C*
     C* FECHA : Diciembre 23 de 2015
     C* AUTOR : Hugo Vinck
     C* TEXTO : En el cursor de planillas (acreditación por fecha) se as
     C*         ra acreditar una sola vez cada planilla CON que se proce
     C*         Módulos M00017
     C* REQUE : 11950 Modificación urgente 17.0
     C*
     C* FECHA : Enero 19 de 2016
     C* AUTOR : Javier Rivera R
     C* TEXTO : Se limpia $$REG1 en MAIN
     C* REQUE : 11983
     C*
     C* FECHA : Enero 21 de 2016
     C* AUTOR : Javier Rivera R
     C* TEXTO : Se elimina funcionalidad de variable GENCMN
     C* REQUE : 11922 - 2
     C*
     C* FECHA : Febrero 17 2016
     C* AUTOR : David M Beltran Pardo
     C* TEXTO : Se modifica para que unicamente actualice dias de movimi
     C*         y diaar1 si es el primer movimiento de cancelacion deuda
     C*         abono de pago en exceso a una planilla declaracion y no
     C*         pago, para cancelaciones o abonos posteriores debe queda
     C*         en cero el numero de dias y no debe actualizar diaar1
     C* REQUE : 12024
     C*
     C* FECHA : Febrero 25 de 2016
     C* AUTOR : Diana Esperanza Garzón Castañeda
     C* TEXTO : Se modifica módulo M00060 y M21500 para validar el sub-
     C*         estado del detalle de deuda, para empleadores que tengan
     C*         acuerdo de cobro jurídico.
     C* REQUE : 11994
     C*
     C* FECHA : Marzo 4 de 2016
     C* AUTOR : Yineth Avila Moya
     C* TEXTO : Se modifica para que cuando se envíe el masivo y recorra
     C*         cursor posteriomente se valide si la planilla se encuent
     C*         en estado CON antes de procesarla
     C* REQUE : 12033
     C*
     C* FECHA : Febrero 17 2016
     C* AUTOR : David M Beltran Pardo
     C* TEXTO : Se modifica para tener en cuenta los dias de licencia pa
     C*         el calculo de topes maximos y minimos al momento de proy
     C*         tar el salario segun los dias
     C* REQUE : 11503
     C*
     C* FECHA : Abril 25 2016
     C* AUTOR : David M Beltran Pardo
     C* TEXTO : Se modifica para tener en cuenta los dias de licencia pa
     C*         el calculo de la nueva fecha inicio relacion  cuando se
     C*         resuelven automaticamente rezagos de tipo 08
     C* REQUE : 12093
     C*
     C* FECHA : Mayo 17 2016
     C* AUTOR : David M Beltran Pardo
     C* TEXTO : Se modifica para tener en cuenta los dias de licencia pa
     C*         el calculo de fecha find de relacion cuando hay retiro
     C* REQUE : 12123
     C*
     C* FECHA : Mayo 18 de 2014
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se incluye la funcionalidad división de acreditación rez
     C*         Se cambia lógica de recuperar variables de configuración
     C*         Hoja I $$CONF, Módulos MAIN, M00008 M00004 M00016 M00000
     C*         M00018 M00019 M00006 M00020 M00022 M00050 M00100 M12010
     C*         M12040 M14040 M14080 M14300 M14309 M14350 M51105 M74140
     C*         M00003 M00005 M00007 M00013 M00015 M00030 M00070 M00025
     C*         M00071 M00072 M00073 M00074 M00035 M00130 M14041 M14042
     C*         M15570 M11101 M11110 M14020 M09000 M14385
     C*         Programas TRCONF61 TRCORZ50 CLREZA60I Entidad elim CONAR
     C* REQU:   11995 Grupobase 17.0
     C*
     C* FECHA : Julio 27 2016
     C* AUTOR : David M Beltran Pardo
     C* TEXTO : Se ajusta modulo M77000 para que al calcular el FGPM use
     C*         salario calculado DETVA7
     C* REQUE : 12151
     C*
     C* FECHA : Agosto 05 2016
     C* AUTOR : David M Beltran Pardo
     C* TEXTO : Se ajusta para que el proceso envie nuevos parametros
     C*         de planilla pagina y secuencia a TRHIPO50
     C* REQUE : 12044
     C*
     C* FECHA : Agosto 29 de 2016
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se limpia la variable ZSALDT para evitar acumulación de
     C*         saldos de deuda en un proceso masivo de pago deuda con P
     C*         Módulos M00050
     C* REQUE : 12183 Corrección Grupobase 17.0
     C*
     C* FECHA : Agosto 31 de 2016
     C* AUTOR : Gabriel Alejandro Medellín
     C* TEXTO : Se modifica para crear contrato a planillas de terceros
     C*         contratistas cuando viene marcada la novedad de ingreso
     C*         Módulos M14044
     C* REQUE : 12097
     C*
     C* FECHA : Noviembre 10 de 2016
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se controla el bloqueo de registro con sentencia RECUPER
     C* REQUE : 12239 Corrección Grupobase 17.0
     C*
     C* FECHA : Noviembre 28 de 2016
     C* AUTOR : Yineth Avila Moya
     C* TEXTO : Se modifica el manejo de las variables para actualizar
     C*         INGARC
     C* REQUE : 12216
     C*
     C* FECHA : Diciembre 15 de 2016
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se verifica registro de DEUARC y COMAR5 antes de su lect
     C*         para permitir su acreditación Módulos M21001 y M15027
     C* REQUE : 12290 Corrección Grupobase 17.0
     C*
     C* FECHA : Enero 16 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se asigna fecha de depósito de PLAARC PLAFEC si esta sig
     C*         en blanco para permitir la acreditación de rezagos gener
     C*         en la reversión movimiento por ajustes fusión Módulo M11
     C* REQUE : 11433 Especial Protección 17.0
     C*
     C* FECHA : Febrero 08 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se asegura generar la deuda real sin arrastrar el valor
     C*         saldo de la deuda presunta que se anula
     C*         Módulo M15015
     C* REQUE : 12378 Corrección Grupobase 17.0
     C*
     C* FECHA : Marzo 03 de 2017
     C* AUTOR : Gabriel Alejandro Medellín
     C* TEXTO : Se modifica para que se genere la relación A-E con tipo
     C*         afiliado 2-Independiente cuando se procesa una planilla
     C*         de terceros contratistas 07-07 donde el afiliado ya tien
     C*         relación pero con tipo de afiliado 4-Voluntario
     C*         Modulo M14043
     C* REQUE : 12397 Corrección Grupobase 17.0
     C*
     C* FECHA : Marzo 09 de 2017
     C* AUTOR : David M. Beltran Pardo
     C* TEXTO : Se modifica para retirar logica de proyeccion de salario
     C*         maximos usando dias M11100
     C* REQUE : 12409 Corrección Grupobase 17.0
     C*
     C* FECHA : Abril 05 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se modifica para no generar rezago 08 si previamente gen
     C*         movimiento. Además se debe correr la fecha inicial relac
     C*         Esto si periodo planilla menor a fecha inicial en planil
     C*         dependientes Módulo M14047 M14044
     C* REQUE : 12138 Grupobase 17.0
     C*
     C* FECHA : Abril 28 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se modifica para que en rezagos actualice código interno
     C*         afiliado forzosamente si DETN04 = 0 y especial 11433 act
     C*         También se modifica para que en rezagos se complete o de
     C*         vuelva cambios por registro, no por bloque de planillas
     C*         Módulos M00000 M70000 M72000 M73000 M74000 M00071 M71000
     C*         M00072 M72100 M00073 M73100 M00074 M74100 M00025 Nvo M00
     C* REQUE : 11433 Especiales Protección 17.0
     C*
     C* FECHA : Mayo 31 de 2017
     C* AUTOR : Gabriel Alejandro Medellín
     C* TEXTO : Se modifica proceso para que al procesar una cancelación
     C*         deuda con PE el proceso tome correctamente los campos
     C*         código interno empleador y tipo de planilla, cuando la
     C*         planilla de la deuda es de fusión PLAA55, INFA48 o Colme
     C*         Modulo M00003 M00006 M14309
     C* REQUE : 12254 - 1 Especial Protección 17.0
     C*
     C* FECHA : Junio 12 2017
     C* AUTOR : David M Beltran Pardo
     C* TEXTO : Se modifica para que permita procesar PE en planillas
     C*         de terceros
     C* REQUE : 12361
     C*
     C* FECHA : Junio 20 2017
     C* AUTOR : David M Beltran Pardo
     C* TEXTO : Se modifica para que registre en el area de datos el nom
     C*         de trabajo ACRED.MASI cuando esta area de datos este en
     C*              blanco
     C* REQUE : 12101
     C*
     C* FECHA : Junio 21 2017
     C* AUTOR : David M Beltran Pardo
     C* TEXTO : Se modifica para que al presentarse IBC pequeños no deje
     C*         cotizacion obligatoria negativa al restar el fondo de
     C*              garantia
     C* REQUE : 12458
     C*
     C* FECHA : Julio 13 2017
     C* AUTOR : David M Beltran Pardo
     C* TEXTO : Se modifica para ajustar calculo de intereses al acredit
     C*         rezagos de tipo 07-14 ya que esta generando error de div
     C*         por cero
     C* REQUE : 12519
     C*
     C* FECHA : Agosto 03 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se asegura la generación correcta de pago de rezagos al
     C*         acreditar un rezago cuando para la misma planilla existe
     C*         varios rezagos y estos generan el PE. Se ajusta la tx 04
     C*         en PAGA04 para que se actualice la página y la secuencia
     C*         Módulos M00009 M15023 M00150 M15021
     C* REQUE : 12534
     C*
     C* FECHA : Agosto 22 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se asegura la actualización a estado FIN así el rezago s
     C*         haya acreditado pero encontró un error al generar deuda
     C*         o al generar transacción
     C*         Módulos M00025
     C* REQUE : 12547
     C*
     C* FECHA : Agosto 30 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Solo para especial 12541, variable GENCON en 'S', planil
     C*         '02', novedad de ingreso, se debe modificar relación AFI
     C*         tipo '4' en tipo '2' para el afiliado, empleador 0 y mis
     C*         fecha inicial
     C*         Módulos M00016 M00008 M14044 M14047
     C* REQUE : 12541 Especial Colfondos 17.0
     C*
     C* FECHA : Septiembre 04 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se corrige el cálculo del pago exceso generado por rezag
     C*         aún cuando el rezago fue generado por acreditación de pl
     C*         nilla con más de un depósito
     C*         Módulos M71120 M72120 M73120 M00009
     C* REQUE : 12560
     C*
     C* FECHA : Septiembre 04 de 2017
     C* AUTOR : Yineth Avila Moya
     C* TEXTO : Se corrige el manejo de redondeos en la actualización de
     C*         INGARC para el cruce de P.E fusionados con deuda
     C* REQUE : 12254
     C*
     C* FECHA : Septiembre 11 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se implementa funcionalidad planillas terceros retroacti
     C*         Módulos M10000 M11000 M12207 M14407 M12200 M14000 M14015
     C*         M00140 M00001 M15010 Nuevo M00170 M00180
     C* REQUE : 12062-2 Grupobase 17.0
     C*
     C* FECHA : Octubre 03 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se ajusta procesamiento de relaciones AFIAR1 para planil
     C*         07-07 y 02-01 para que cuando encuentre relación tipo '2
     C*         no lea un AFIAR1 anterior ya que este registro lo actual
     C*         la acreditación. Para acreditación de rezagos se control
     C*         no generar PEE si previamente se generó deuda para pla,p
     C*         y sec
     C*         Módulos M14047 M15023
     C* REQUE : 12582
     C*
     C* FECHA : Octubre 04 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se controla actualización o creación de contratos para p
     C*         nillas 02 o 07-07, nuevo programa TRCNAF53
     C*         Módulos M14040 M14043 Nuevo M00110
     C* REQUE : 12062-3 Grupobase 17.0
     C*
     C* FECHA : Octubre 25 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se limpian variables ZVRDEU y ZINDRS por cada planilla l
     C*         da de rezagos para garantizar el correcto recálculo de
     C*         salario en planillas 03-01 y la generación de pago exces
     C*         Módulos M00140
     C* REQUE : 12604 Grupobase 17.0
     C*
     C* FECHA : Noviembre 14 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se asegura crear el aportante del contrato con el aporta
     C*         de la planilla
     C*         Módulos M00110
     C* REQUE : 12630 Grupobase 17.0
     C*
     C* FECHA : Noviembre 30 de 2017
     C* AUTOR : Hugo Vinck
     C* TEXTO : Al devolver cambios en acreditación de rezago se lee reg
     C*         tro rezago antes de preguntar estado COP para pasar a FI
     C*         Módulos M00025
     C* REQUE : 12649 Grupobase 17.0
     C*
     C* FECHA : Noviembre 09 de 2017
     C* AUTOR : Diego Gonzalez
     C* TEXTO : Se modifican los parametros de TRHIPO50 para que ahora
     C*         se acredite con nueva funcionalidad(TRHIPO51).
     C*         Módulos M14027 M00008 M77000 M00VAR
     C* REQUE : 12354 Grupobase 17.0
     C*
     C* FECHA : Diciembre 15 de 2017
     C* AUTOR : Gabriel Alejandro Medellín
     C* TEXTO : Se agrega llamado a programa de servicio TRMOHL50 para g
     C*         nerar registro mod. en hist. laboral MODAR6
     C*         Módulos: M00009
     C* REQUE : 12496 Grupobase 17.0
     C*
     C* FECHA : Enero 23 de 2017
     C* AUTOR : Yineth Avila Moya
     C* TEXTO : Se modifica en el cruce de P.E con deuda para que en el
     C*         so en que el P.E sea de detalle de N.V para que tome la
     C*         fo de INFAR4 y para que actualice PAGA28 desgastando los
     C*         detalles en PAGA28 de acuerdo a lo actualizado en PAGARC
     C* REQUE : 12467
     C*
     C* FECHA : Febrero 16 de 2018
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se asegura crear el aportante del contrato con el aporta
     C*         de la planilla
     C*         Módulos M00110
     C* REQUE : 12718 Grupobase 17.0
     C*
     C* FECHA : Febrero 22 de 2018
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se reemplaza búsqueda % licencia HIS588 por llamado a pg
     C*         TRHILI50 especial Colfondos por TipoEmpresa ' ' y 3 Mixt
     C*         Módulo M00020
     C* REQUE : 12683
     C*
     C* FECHA : Marzo 20 de 2018
     C* AUTOR : Hugo Vinck
     C* TEXTO : Se obtiene y valida nuevas fechas de vigencia aportes vo
     C*         tarios por reforma, llamado pgm TRCONF62 nuevos parámetr
     C*         de fecha para TRDAPV58
     C*         Módulo M00008 M00023 MAIN M00000 M00006 M14330 M14350
     C*         M09000 M51100 M61000 M71120 M73120 M51110 M14300 M14308
     C*         M31105 $$DOCU Nuevos M00190 M00210
     C* REQUE : 12350-4
     C*
     C* FECHA : Julio 04 de 2018
     C* AUTOR : Hugo Vinck
     C* TEXTO : Para rezagos de planilla 05 y con voluntarias nunca se c
     C*         cula retención cuando crea el movimiento, eso lo hace el
     C*         proceso de acreditación de voluntarias TRDAPV58
     C*         Módulo M14300 M73120
     C* REQUE : 12839
     C*
     C* FECHA : Noviembre 28 2018
     C* AUTOR : Nidia Patricia Moreno
     C* TEXTO : Se modifica módulo M61000 para mover los módulos en dond
     C*         se acumulan M14380, M14385 para realizarlo luego que se
     C*         realice la acreditación de voluntarias TRDAPV58
     C* REQUE : 12964
     C*
     C* FECHA : Diciembre 6 de 2018
     C* AUTOR : Maria Katherine Ladino
     C* TEXTO : Se modifica módulo M73000 para que cuando el indicador
     C*         ZT@COM sea diferente de N realice el completar, de lo
     C*         contrario, no realiza confirmacion de los cambios
     C* REQUE : 12538-5
     C*
     C* FECHA : Mayo 10 2019
     C* AUTOR : David M Beltran Pardo
     C* TEXTO : Se modifica proceso para mejora de performance
     C* REQUE : 13075
     C*
     C* FECHA : Mayo 31 de 2019
     C* AUTOR : Jimmy Alexander Vargas Castro
     C* TEXTO : Se modifica módulo M14045 para calcular de forma correct
     C*         la fecha de inicio relación cuando el mes es Febrero y s
     C*         reportan 29 días de cotización en año no bisiesto. Se mo
     C*         fica módulo M14044 para que se genere fecha de fin de re
     C*         ción afiliado-empleador para planillas tipo independient
     C* REQUE : 13025
     C*
     C* FECHA : Junio 21 2019
     C* AUTOR : David M Beltran Pardo
     C* TEXTO : Se modifica para ajustar bloqueo de LIQAR3
     C* REQUE : 13075-4
     C*
     C* FECHA : Julio 08 de 2019
     C* AUTOR : Nicolas Benavides Fiesco
     C* TEXTO : Se modifica para que en el momento de devolver error al
     C*         grabar en HISAR4 por medio del TRPLAN6I, no llame al
     C*         de reporte de errores sino que llame al programa TRPLANB
     C*         que actualiza el temporal HIS782. Modificado M00055
     C* REQUE : 13055-2
     C*
     C* FECHA : Julio
     C* AUTOR : SPV
     C* TEXTO : Se modifica el modulo M14040 para solucionar el errro  d
     C*         grabar en AFIAR1 por no estar el registro disponile
     C* REQUE : 13075-5
     C*
     C* FECHA : Agosto 5 de 2019
     C* AUTOR : Jimmy Alexander Vargas Castro
     C* TEXTO : Se modifica para acreditación masiva por rango de fechas
     C*         Modulos MAIN y M80000.
     C* REQUE : 13136
     C*
     C* FECHA : Septiembre 13 de 2019
     C* AUTOR : Jimmy Alexander Vargas Castro
     C* TEXTO : Se modifica para que cuando una planilla 01-09 esté marc
     C*         en DETA68 sin aporte original, el tipo de pago del movi-
     C*         miento generado sea '01', y que en DIAAR1 reporte los dí
     C*         cotizandos en la planilla. M14038, M14395, M81000, M1407
     C* REQUE : 12664-1. Caso 7.
     C*
     C* FECHA : Octubre 8 de 2019
     C* AUTOR : Jimmy Alexander Vargas Castro
     C* TEXTO : Se modifica para que cuando se genere nuevo tipo de reza
     C*         '35', este no se tome como rezago por reversión de movim
     C*         to. Modulos modificados: M14066, M15029.
     C* REQUE : 12664-1. Caso 9.
     C*
     C* FECHA : Noviembre 14 de 2019
     C* AUTOR : Juan Gabriel Ruiz Lara
     C* TEXTO : Se incluye un nuevo parámetro en el llamado al programa
     C*         servicio TRDELA50, por impacto al proceso de anulación d
     C*         deudas por delta. No tiene impacto en cálculos
     C*         Módulo M15530
     C* REQUE : 13105
     C*
     C* Fecha : Noviembre 25 de 2019
     C* Autor : David Beltran
     C* Texto : Se modifica para cambiar tama¦os de variables de totales
     C*         para evitar desbordamiento al acreditar planillas de mas
     C*         de 130 mil millones
     C* Reque : 13284
     C*
     C* FECHA : Diciembre 17 de 2019
     C* AUTOR : Gabriel Alejandro Medellín
     C* TEXTO : Se modifica para evitar actualizar la relación afiliado
     C*         pleador con fecha fin menor a fecha inicio cuando se con
     C*         ta la fecha fin en los contratos M14047
     C* REQUE : 13261
     C*
     C* FECHA : Enero 24 de 2020
     C* AUTOR : Gabriel Alejandro Medellín
     C* TEXTO : Se modifica para que se registren días acreditados en el
     C*         movimiento y actualizar la relación afiliado empleador p
     C*         planillas de retroactivos 01-09, 04-10, 04-11 cuando no
     C*         existe detalle de planilla original
     C*         M14038, M14048, M14300, M14075
     C* REQUE : 13045
     C*
     C* FECHA : Marzo 19 de 2020
     C* AUTOR : Chrystian Romero
     C* TEXTO : Se modifica proceso (M00006). Se crea M80100. Se recuper
     C*         fecha depósito de INFA48, si está en blanco, recupera de
     C*         de la planilla original de COLMENA, si está en blanco,
     C*         recupera del movimiento MOVAR8.
     C* REQUE : 13269
     C*
     C* FECHA : Abril 18 2020
     C* AUTOR : David M Beltran
     C* TEXTO: Se modifica por decreto 558 de abril 12 2020 cotizacion 3
     C*        por emergencia nacional COVID19
     C* REQUE : 13392
     C*
     C* FECHA : Mayo 29  2020
     C* AUTOR : David M Beltran
     C* TEXTO: Se modifica para ajuste de redondeos 0.00000001 ctas
     C*        cuando al finalizar la acreditacion exista esta diferenci
     C* REQUE : 13392
     C*
     C* FECHA : Junio 1 2020
     C* AUTOR : Mauricio Castillo
     C* TEXTO: Se modifica para incluir SQL en M80100 para consultar fec
     C*        de pago en el ambiente de fusión Colmena
     C* REQUE : 13326-3
     C*
     C* FECHA : Junio 25 2020
     C* AUTOR : David M Beltran Pardo
     C* TEXTO: Se modifica para que al acreditar una planilla retroactiv
     C*        que reporte el 13% no cobre prima ni comision puesto
     C*        que estos conceptos se pagaron en la planilla original
     C* REQUE : 13392
     C*
     C* FECHA : Julio 2 2020
     C* AUTOR : Luis Felipe Vasco
     C* TEXTO: Se incluye validación de desarrollo especial de req. 1342
     C*        para determinar si el detalle de planila a acreditar tien
     C*        novedad de ingreso (I) o ingreso y retiro (O) simulada co
     C*        el objetivo de no generar rezago tipo 07 o 08.
     C* REQUE : 13422
     C*
     C* FECHA : Julio 3 de 2020
     C* AUTOR : Jimmy Alexander Vargas Castro
     C* TEXTO : Se modifica para acreditación de planillas tipo J según
     C*         parámetros de validación almacenados en archivo CONA86.
     C*         Módulos: MAIN, M00000, M00010, M12207, M12240, M11000,
     C*         M82000.
     C* REQUE : 13327-3.
     C*
     C* FECHA : Julio 24 de 2020
     C* AUTOR : Jimmy Alexander Vargas Castro
     C* TEXTO : Se modifica para cálculo especial de intereses en planil
     C*         tipo O. Modificados: M00000, M00008, M12207, M83000.
     C* REQUE : 13327-5.
     C*
     C* FECHA : Julio 28 de 2020
     C* AUTOR : Luis Felipe Vasco
     C* TEXTO: Se incluye validación de desarrollo especial de req. 1342
     C*        para la solución de rezagos 04,05,14 y 15.
     C* REQUE : 13422-3
     C*
     C* FECHA : Septiembre 23 de 2020
     C* AUTOR : Luis Felipe Vasco
     C* TEXTO: Se ajusta proceso para solo dejar una relación afiliado p
     C*        afiliado independiente. Asegurar que se cree contrato par
     C*        el periodo acreditado. Modulo afectado M14047
     C* REQUE : 13422-4
     C*
     C* FECHA: Octubre 1 de 2020
     C* AUTOR: David M Beltran Pardo
     C* TEXTO: Se modifica para leer la entidad CONA86 por planilla
     C* REQ  : 13327-2
     C*
     C* FECHA: Octubre 5 de 2020
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica generación de movimientos de deuda para que n
     C*        se haga a nivel de encabezado sino a nivel de detalle, de
     C*        esa forma se evita que se dejen movimientos sin página y
     C*        secuencia.
     C* REQUE: 13393-6
     C*
     C* FECHA :Octubre 16 de 2020
     C* AUTOR :Luis Felipe Vasco
     C* TEXTO: Se ajusta para que si el afiliado es RES y reporta o simu
     C*        novedad ingreso se aplique tambien novedad de retiro para
     C*        cerrar la relación A-E. (Modulo M14020 y M14042)
     C*        Adicionar llamado nuevo proceso de depuración de relacion
     C*        de independientes. (M00119)
     C* REQUE: 13422-4
     C*
     C* FECHA :Febrero 8 de 2021
     C* AUTOR :Luis Felipe Vasco
     C* TEXTO: Se ajusta proceso para asegurar que las relaciones cierre
     C*        con el ultimo dia de febrero cuando se procese novedad de
     C*        o Ingreso/Retiro y se reporten 30 dias cotizados (M14058)
     C*        Controlar que se calculen correctamente la fecha inicio y
     C*        fecha termino de contraton cuando los dias cotizados es c
     C*        (M14045).
     C* REQUE: 13590-2
     C*
     C* FECHA: Febrero 11 de 2021
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para agregar/eliminar registros a entidad PAG
     C*        para cruces automaticos de PE generagos por un rezago con
     C*        deudas de la misma planilla.
     C* REQUE: 13325-3.3.
     C*
     C* FECHA: Abril 19 2021
     C* AUTOR: David M Beltran Pardo
     C* TEXTO: Se modifica para que al generar PE por rezago genere el P
     C*        incluso cuando no exista valor en pesos para el mismo
     C* REQUE: 13677
     C*
     C* FECHA: Mayo 03 de 2021
     C* AUTOR: Gabriel Medellín
     C* TEXTO: Se modifica para agregar registros en la entidad PAGA30
     C*        para cruces automaticos de PE cuando se genera deuda desd
     C*        acreditación de rezagos y existe PE para la planilla
     C* REQUE: 13325-3.10
     C*
     C* FECHA: Mayo 07 de 2021
     C* AUTOR: Gabriel Medellín
     C* TEXTO: Se modifica para agregar registros en la entidad PAGA30
     C*        para cruces automaticos de PE cuando se genera deuda desd
     C*        acreditación de rezagos y existe PE para planillas de fus
     C* REQUE: 13556-4.1
     C*
     C* FECHA: Junio 09 2021
     C* AUTOR: David Beltran
     C* TEXTO: Se modifica para acreditar tarifas especiales de decreto
     C* REQUE: 13683
     C*
     C* FECHA: Julio 08 2021
     C* AUTOR: David Beltran
     C* TEXTO: Se modifica para que al acreditar aportes del 3% reversad
     C*        genere DIAAR1 con los dias en tipo acred D y en cero
     C*        con tipo de acreditacion en blanco
     C* REQUE: 13683-3
     C*
     C* FECHA: Julio 30 de 2021
     C* AUTOR: David M Beltran Pardo
     C* TEXTO: se modifica para que permita acreditar rezagos de decreto
     C*        376
     C* REQUE: 13683-4
     C*
     C* FECHA: 06 de Julio de 2021
     C* AUTOR: Nidia Patricia Moreno
     C* TEXTO: Se modifica llamado al programa TRCONF62 para enviar como
     C*        proceso R. Se modifica para no validar variable FVIRET.
     C*        Se modifican parámetros de llamado TRDAPV58 y hoja I $$DO
     C* REQUE: 13626-3
     C*
     C* FECHA: 23 de Julio de 2021
     C* AUTOR: Nidia Patricia Moreno
     C* TEXTO: Se modifica M77000 para limpias FSP si no viene reportado
     C*        valor en el detalle.
     C* REQUE: 13498
     C*
     C* FECHA: 24 de Agosto de 2021
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica módulo M31000 para limpiar variables ZVSFSP y
     C*        ZVFGPM ya que se estban quedando pegados los valores, oca
     C*        nando errores en acreditación de planillas extraordinaria
     C* REQUE: 13626-4.3.
     C*
     C* FECHA: 16 de Septiembre de 2021
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica módulo M14045 para calcular correctamente la
     C*        cha de inicio de relación para cotizaciones del periodo d
     C*        Febrero.
     C* REQUE: 13720
     C*
     C* FECHA: 17 de noviembre de 2021
     C* AUTOR: Nidia Patricia Moreno
     C* TEXTO: Se modifica para realizar el nuevo cálculo del delta diná
     C*        co si el desarrollo especial se encuentra activo.
     C* REQUE: 13783 D.E Protección
     C*
     C* FECHA: Febrero 17 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para que al procesar planillas tipo J, los
     C*        cálculos relacionados con intereses se hagan con el valor
     C*        que le corresponde a cada detalle y no el de toda la plan
     C*        lla.
     C* REQUE: 13863
     C*
     C* FECHA: Febrero 21 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica proceso para que se recalculen días realmente
     C*        pagados en el aporte para su registro en MOVARC, DETARC y
     C*        DIAAR1.
     C* REQUE: 13344-3
     C*
     C* FECHA: Febrero 24 de 2022
     C* AUTOR: Lissette Carolina Salazar Amaya
     C* TEXTO: Se modifica proceso para que no se calcule FGPM cuando un
     C*        planilla retroactiva solo cotiza alto riesgo.
     C* REQUE: 13801-1
     C* MODM.: M11100, M14075
     C*
     C* FECHA: Agosto 9 2022
     C* AUTOR: David Beltran
     C* TEXTO: Se ajsuta para calculo de FGPM en acreditaciones cambio d
     C*        tarifa del 4%, Se cod en clientes directo por cruce 13344
     C* REQUE: 13986
     C*
     C* FECHA: Abril 1 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica proceso para que al cruzar excesos con deudas
     C*        tengan en cuenta los registros existentes en INGARC para
     C*        misma planilla de deuda y fecha fondo al generar tx 04-99
     C* REQUE: 13799
     C*
     C* FECHA: Mayo 10 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para que cuando se asignen días por defecto a
     C*        campo de días en MOVARC se asignen los reportados.
     C* REQUE: 13344-4
     C*
     C* FECHA: julio 18 2022
     C* AUTOR: David Beltran
     C* TEXTO: Se modifica para que llame nuevo proceso que valida tipos
     C*        planilla validos para recalculo
     C* REQUE: 13961
     C*
     C* FECHA: Agosto 22 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para que cuando se procesen pagos adelantados
     C*        haga recalculo de días en solo uno de los movimientos que
     C*        genere.
     C* REQUE: 13961-4
     C*
     C* FECHA: Septiembre 12 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para que al validar fecha de pago de planilla
     C*        variable DIAREC se haga no con PLAFEC sino una variable
     C*        diferente para casos en que se haga pago a deuda de INFAR
     C* REQUE: 13961-7
     C*
     C* FECHA: Septiembre 14 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para que al sumar días a DIAAR1 de movimiento
     C*        02-34 no se valide tipo de planilla PLATIP='01' ya que se
     C*        abrió el parámetro para que se procesen otros tipos.
     C* REQUE: 13961-9
     C*
     C* FECHA: Septiembre 21 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para que al cruzar excesos con deuda no se va
     C*        de TIPA18 para la palanilla del pago en exceso, se modifi
     C*        para que en DIAAR1 el salario mensual se acumule respecto
     C*        días calculados y no los reportados.
     C* REQUE: 13961-10
     C*
     C* FECHA: Septiembre 02 de 2022  (B0PLAN64)
     C* AUTOR: Adrian Amado Martínez
     C* TEXTO: Se modifica para excluir nuevos rezagos de 41 en adelante
     C*        como rezago de reversión por movimiento (31 <---> 40)
     C* REQUE: 13962
     C*
     C* FECHA: Septiembre 15 de 2022
     C* AUTOR: Marcela Leal Aponte
     C* TEXTO: Se modifica para que antes de hacer las validaciones de f
     C*        chas y registro en el RECA53, verifique si la fecha de pa
     C*        es menor a la fecha de la variable DIAREC, si es asi, se
     C*        lida que el movimiento no haya sido reversado anteriormen
     C*        si no ha sido reversado, se debe registrar en el RECA53.
     C* REQUE: 14006 - Desarrollo Especial Colfondos
     C*
     C* FECHA: Septiembre 30 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para que en DIAAR1 el salario mensual se acum
     C*        proyectando días reportados y no los recalculados.
     C* REQUE: 13961-11
     C*
     C* FECHA: Octubre 20 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para que en DIAAR1 se sumen salarios para mov
     C*        de declaración y no pago solo cuando no se haya sumado an
     C*        con otras cancelaciones de deuda.
     C* REQUE: 13961-14
     C*
     C* FECHA: Octubre 15 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para validar registro disponible al leer DEUA
     C*        en módulo M00006.
     C* REQUE: 13860-1.2.2
     C*
     C* FECHA: Octubre 25 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para registrar tx en temporal HIS782 si es
     C*        llamado desde cruce de deuda con PE masivo(proceso cierre
     C* REQUE: 13860-1.2.3
     C*
     C* FECHA: Octubre 27 de 2022
     C* AUTOR: Marcela Leal Aponte
     C* TEXTO: Se incluye validación del Tipo generacion RECA53 sea dife
     C*        te de 'A' y de 'G' para limpiar la variable de existencia
     C*        registro en TIPA18 para permitir recalcular dias a planil
     C*        de pago de deuda.
     C* REQUE: 14006 SD272079
     C*
     C* FECHA: Octubre 28 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica control de FSP por decreto 1858.
     C* REQUE: 13860-1.3
     C*
     C* FECHA: Noviembre 11 de 2022
     C* AUTOR: Gabriel Alejandro Medellín
     C* TEXTO: Se corrige error que permitir generar movimiento de acre-
     C*        ditación y rezago para un mismo detalle de planilla
     C* REQUE: 14051
     C*
     C* FECHA: Noviembre 30 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para que cuando se trabajen con n depositos e
     C*        registro del FSPARC se haga con el primer movimiento ACR.
     C* REQUE: 13860-1.3
     C*
     C* FECHA: Noviembre 22 de 2022
     C* AUTOR: Nidia Patricia Moreno
     C* TEXTO: Se modifica para verificar si la planilla se encuentra
     C*        registrada con validación especial en TIPA19 llamando al
     C*        programa de servicio RPTPVE50.
     C* REQUE: 13863-2
     C*
     C* FECHA: Diciembre 15 de 2022
     C* AUTOR: Gabriel Alejandro Medellín, Jimmy Vargas.
     C* TEXTO: Se modifica para generar correctamente pagos en exceso
     C*        cuando se acredita más de un rezago donde todo su valor s
     C*        va para exceso
     C*        Se modifica para validar depósitos en estados ACR por FSP
     C*        sin reversar.
     C* MODUL: M14302, M10000, M12010
     C* REQUE: 13860-3
     C*
     C* FECHA: Diciembre 19 de 2022
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para validar FSP sin reversar en generación y
     C*        acreditación de rezagos.
     C* REQUE: 14048-2
     C*
     C* FECHA: Enero 10 de 2023
     C* AUTOR: Gabriel Alejandro Medellín
     C* TEXTO: Se modifica para que no se realice borrado del archivo
     C*        DETA31 por detalle procesado, solo hasta recorrer todos l
     C*        rezagos de la misma planilla 07-07
     C* MODMO: M00025 M71000 M72100 M73100 M74100 M00250
     C* MODNU: M00250
     C* REQUE: 14048-2
     C*
     C* FECHA: febrero 27 de 2023
     C* AUTOR: Nidia Patricia Moreno
     C* TEXTO: Se modifica M12207 para asignar los intereses simples y c
     C*        puestos luego de llamar al programa TRPLAN6N.
     C* REQUE: 14102
     C*
     C* FECHA: Marzo 10 de 2023
     C* AUTOR: Nidia Patricia Moreno
     C* TEXTO: Se modifica M71000 y M74100 para que se haga el llamado a
     C*        progrema RPHDEC558X solo si el perido es COVIT.
     C* REQUE: 14072
     C*
     C* FECHA: Marzo 16 de 2023
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para limpiar valores de cotización de FSP cua
     C*        se vaya a generar movimiento 02-50. M14030.
     C* REQUE: 14114
     C*
     C* FECHA: Abril 10 de 2023
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para tomar periodo del rezago para actualizar
     C*        días y relaciones si se acreditan rezagos.
     C* REQUE: 14048-8
     C*
     C* FECHA: Mayo 16 de 2023
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica hoja I de RECA53 para agregar campos fondo, c
     C*        secutivo y cod. interno, se cambia tipo llamado a RPREDH5
     C* REQUE: 14086
     C*
     C* FECHA: Julio 26 de 2023
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para que al calcular saldo de compensación se
     C*        tenga en cuenta valores registrados en FSPARC.
     C* REQUE: 14169-4
     C*
     C* FECHA: Julio 28 de 2023
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para que al validar TIPA18 para planilla a la
     C*        que se cancela deuda, se recupere su tipo de planilla pil
     C* REQUE: 14201
     C*
     C* FECHA: Agosto 14 de 2023
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para que al acreditar varios rezagos de una
     C*        misma planilla, el pago en exceso se genere al final del
     C*        procesamiento de todos, también se modifica para que cuan
     C*        no haya DISAR1 se acumulen las cuotas de los rezagos.
     C* REQUE: 14201-2
     C*
     C* FECHA: Septiembre 15 de 2023
     C* AUTOR: Dolly Marcela Padilla Baños
     C* TEXTO: Se modifica para calcular porcentaje comision planilla Z
     C*        en planillas extraordinarias tipo Z
     C*        Se incluye actualizacion de rangos de omisos a Pagado
     C* MODUL: M00000 M00009 M00011
     C* REQUE: 14184-2
     C*
     C* FECHA: Septiembre 27 de 2023
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para incluir parámetro de validación por defe
     C*        del TIPA19 en el llamado a programa RPTPVE50.
     C* REQUE: 13965-1
     C*
     C* FECHA: Octubre 24 de 2023
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para comparar correctamente valor de rezago v
     C*        valor de movimiento en acreditación de rezagos conciliado
     C*        con más de un depósito.
     C* REQUE: 14245
     C*
     C* FECHA: Octubre 26 de 2023
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para control de casos de acreditación con val
     C*        ción por defecto.
     C* REQUE: 13965-2
     C*
     C* FECHA: Noviembre 21 de 2023
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica proceso para validar FSPARC con número de pla
     C*        lla física y no la interna.
     C* REQUE: 14269-2
     C*
     C* FECHA: Noviembre 29 de 2023
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para crear relaciones afiliado empleador cuan
     C*        todos los días reportados corresponden a licencia.
     C*        Se corrige el proceso para que en el caso de acreditar un
     C*        rezago donde su valor total debe irse a PE se actualice
     C*        correctamente el PAGARC
     C* REQUE: 14085-1
     C*
     C* FECHA: Enero 22 de 2024
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para que al calcular alto riesgo se valide %
     C*        cotización para vacaciones.
     C* REQUE: 14085-2
     C*
     C* FECHA: Enero 25 de 2024
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para limpiar variables de cálculo de P.E de r
     C*        zagos cuando se acreditan los tipo 31.
     C* REQUE: 14085
     C*
     C* FECHA: Marzo 21 de 2024
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para limpiar variables de cálculo de P.E de r
     C*        zagos cuando se acreditan los tipo 31 cuando cambie el
     C*        número de planilla.
     C* REQUE: 14349
     C*
     C* FECHA: Abril 1 de 2024
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para actualizar fecha fin de relación y contr
     C*        si planilla independiente reporta novedad de retiro.
     C* REQUE: 13747
     C*
     C* FECHA: Abril 12 de 2024
     C* AUTOR: Jesús Fernando Becerra Cardozo
     C* TEXTO: Se modifica de manera que al procesar una planilla Z se c
     C*        sulte el periodo original en el archivo SBPLAA66 para que
     C*        se tenga en cuenta para la actualización del archivo RANA
     C*        para el afiliado, empleador y periodo original.
     C* REQUE: 14297-4
     C*
     C* FECHA: Abril 22 de 2024
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para acumular valores distribuidos de ACR rez
     C*        gos antes de actualizar relaciones.
     C* REQUE: 14369
     C*
     C* FECHA: Mayo 2 de 2024
     C* AUTOR: Jimmy Alexander Vargas Castro
     C* TEXTO: Se modifica para limpiar variables de valor y cuotas de P
     C*        por cada planilla procesada en acreditación de rezagos.
     C* REQUE: 14369
     C******************************************************************
     C*     IMPORTANTE: VER MODULO COMPIL
     C*-----------------------------------------------------------------
     C                   ENDSR
     C*==================================================================
     C*==  INICIO DEL PROGRAMA                                         ==
     C*==                                                              ==
     C*==================================================================
     C     MAIN          BEGSR
     C                   CALL      'TRSNPMSF'
     C                   PARM      'TRPLAN64'    PG@@              8
     C                   PARM                    ID@@              2
     C                   PARM                    MSGF@@           10
     C*PARAMETROS (ZT@001 ZT@002 ZT@003 ZT@004 ZT@005 ZT@006 ZT@007 ZT@0
     C     *ENTRY        PLIST
     C                   PARM                    ZT@001
     C                   PARM                    ZT@002
     C                   PARM                    ZT@003
     C                   PARM                    ZT@004
     C                   PARM                    ZT@005
     C                   PARM                    ZT@006
     C                   PARM                    ZT@007
     C                   PARM                    ZT@008
     C                   PARM                    ZT@009
     C*LIMPIAR $$REG1
     C                   CLEAR                   $$REG1
     C* Llamado módulo sentencia
     C*FUNCION QLEEALD (ZPROCJ 400 1)
     C                   CALL      'F079SNAP'                                   QLEEALD
     C     ZPROCJ        PARM      ZPROCJ        F$371           250
     C                   PARM      400           F$372             4 0
     C                   PARM      1             F$373             4 0
     C* Tipo llamado masivo
     C*SI ZT@002 = 'W' O ZT@002 = 'X' O ZT@002 = 'Z'
     C     ZT@002        IFEQ      'W'
     C     ZT@002        OREQ      'X'
     C     ZT@002        OREQ      'Z'
     C* Pasa tipo llamado a temporal
     C*PASAR ZTLLAM ZT@002
     C                   MOVEL     ZT@002        ZTLLAM
     C* Pasa tipo llamado a temporal proc.masivo
     C*PASAR ZTIPXX ZT@002
     C                   CLEAR                   ZTIPXX
     C                   MOVEL     ZT@002        ZTIPXX
     C* Tipo ejecucion planilla normal
     C*PASAR ZT@002 '1'
     C                   MOVEL     '1'           ZT@002
     C* Pasa número de planilla a temporal planilla inicial
     C*PASAR ZPLINI ZT@001
     C                   MOVEL     ZT@001        ZPLINI
     C* Limpia número de planilla
     C*LIMPIAR ZT@001
     C                   CLEAR                   ZT@001
     C* Pasa número de planilla a temporal planilla Final
     C*PASAR ZPLFIN ZT@003
     C                   MOVEL     ZT@003        ZPLFIN
     C* Limpia número de planilla
     C*LIMPIAR ZT@003
     C                   CLEAR                   ZT@003
     C* Obtiene nombre del proceso sometido
     C*LLAMAR CLDATDP (ZNOMTR ZNUMTR ZUSUAR)
     C                   CALL      'CLDATDP'
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C* Asigna indicador de generación
     C*PASAR ZESTPR 'G'
     C                   MOVEL     'G'           ZESTPR
     C* Llama prog.generac registro archivo trabajos
     C*LLAMAR TRPLAN22(ZESTPR ZNOMTR ZNUMTR ZUSUAR)
     C                   CALL      'TRPLAN22'
     C                   PARM                    ZESTPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C*LIMPIAR ZTRABN
     C                   CLEAR                   ZTRABN
     C* Recupera nombre trabajo
     C*FUNCION QLEEALD (ZTRABN 292 10)
     C                   CALL      'F079SNAP'                                   QLEEALD
     C     ZTRABN        PARM      ZTRABN        F$371           250
     C                   PARM      292           F$372             4 0
     C                   PARM      10            F$373             4 0
     C*SI ZTRABN=' '
     C     ZTRABN        IFEQ      ' '
     C*PASAR ZTRABN 'ACRED.MASI'
     C                   MOVEL     $HIL(001)     ZTRABN
     C*FUNCION QGRAALD (ZTRABN 292 10)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZTRABN        PARM      ZTRABN        F$2Z1           250
     C                   PARM      292           F$2Z2             4 0
     C                   PARM      10            F$2Z3             4 0
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*** 1er SELECT
     C*LLAMAR CLCEST50(ZNOMTR ZNUMTR ZUSUAR ZRANDO)
     C                   CALL      'CLCEST50'
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C*CASO ZT@002 <> 'F' Y ZCARIN = 0 Y ZINLLA = *BLANCO
     C                   SELECT
     C     ZT@002        WHENNE    'F'
     C     ZCARIN        ANDEQ     0
     C     ZINLLA        ANDEQ     *BLANK
     C* Seguridad y documentación
     C*EJECUTAR INICIA
     C                   EXSR      INICIA
     C* Ind. simulación planillas
     C*LIMPIAR ZSIMUL
     C                   CLEAR                   ZSIMUL
     C* Indicador de llamado
     C*SI ZT@002 = 'S'
     C     ZT@002        IFEQ      'S'
     C* Acreditación planillas
     C*PASAR ZT@002 '1'
     C                   MOVEL     '1'           ZT@002
     C* Ind. simulación planillas
     C*PASAR ZSIMUL 'S'
     C                   MOVEL     'S'           ZSIMUL
     C*FIN
     C                   END
     C*LLAMAR RPVALSIS (ZHORA ZFESIS ZFECED USUÑÑÑ)
     C                   CALL      'RPVALSIS'
     C                   PARM                    ZHORA
     C                   PARM                    ZFESIS
     C                   PARM                    ZFECED
     C                   PARM                    USUÑÑÑ
     C*ASIGNAR SEG$$$ 'N'
     C                   MOVEL     'N'           SEG$$$
     C*LLAMAR TRINIFY1 (SEG$$$ NSIÑÑÑ NCOÑÑÑ)
     C                   CALL      'TRINIFY1'
     C                   PARM                    SEG$$$
     C                   PARM                    NSIÑÑÑ
     C                   PARM                    NCOÑÑÑ
     C* Imprime encabezados
     C*EJECUTAR ENC@@1
     C                   EXSR      ENC@@1
     C* Límite inf. delta cub. compens.
     C*CALCULAR ZLINFC = 0.00000009 * -1
     C                   Z-SUB     1             V$CA1           030 9
     C     0,00000009    MULT      V$CA1         ZLINFC
     C* Límite sup. delta cub. compens.
     C*MOVER ZLSUFC 0.00000009
     C                   Z-ADD     0,00000009    ZLSUFC
     C* Lee de configuración
     C*EJECUTAR M00004
     C                   EXSR      M00004
     C*SI ZT@002 = 'R'
     C     ZT@002        IFEQ      'R'
     C* Tipo de ejecucion Pagos en exceso
     C*PASAR ZT@002 '2'
     C                   MOVEL     '2'           ZT@002
     C*FIN
     C                   END
     C* Subir a memoria y ingreso una vez
     C*CASO ZT@002 = 'R' Y ZCARIN > 0
     C     ZT@002        WHENEQ    'R'
     C     ZCARIN        ANDGT     0
     C* Tipo de ejecucion Pagos en exceso
     C*PASAR ZT@002 '2'
     C                   MOVEL     '2'           ZT@002
     C*SINO
     C                   OTHER
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C*LLAMAR RPVALSIS (ZHORA ZFESIS ZFECED USUÑÑÑ)
     C                   CALL      'RPVALSIS'
     C                   PARM                    ZHORA
     C                   PARM                    ZFESIS
     C                   PARM                    ZFECED
     C                   PARM                    USUÑÑÑ
     C*ASIGNAR SEG$$$ 'N'
     C                   MOVEL     'N'           SEG$$$
     C*LLAMAR TRINIFY1 (SEG$$$ NSIÑÑÑ NCOÑÑÑ)
     C                   CALL      'TRINIFY1'
     C                   PARM                    SEG$$$
     C                   PARM                    NSIÑÑÑ
     C                   PARM                    NCOÑÑÑ
     C* Imprime encabezados
     C*EJECUTAR ENC@@1
     C                   EXSR      ENC@@1
     C*FIN
     C                   END
     C*FINCASOS
     C                   ENDSL
     C* Recuperar parámetros de configuración
     C*EJECUTAR M00008
     C                   EXSR      M00008
     C* Subir a memoria y ingreso una vez
     C*SI ZT@002 = 'M'
     C     ZT@002        IFEQ      'M'
     C* Tipo ejecucion planilla normal
     C*PASAR ZT@002 '1'
     C                   MOVEL     '1'           ZT@002
     C* Ind llamado masiva x valor/fecha
     C*PASAR ZINLLA 'M'
     C                   MOVEL     'M'           ZINLLA
     C*SINO
     C                   ELSE
     C*LIMPIAR ZVATRE ZCUTRE ZVADRE ZVTRRE ZCUTRR
     C                   CLEAR                   ZVATRE
     C                   CLEAR                   ZCUTRE
     C                   CLEAR                   ZVADRE
     C                   CLEAR                   ZVTRRE
     C                   CLEAR                   ZCUTRR
     C*FIN
     C                   END
     C*** 2do SELECT
     C* Acreditación planillas
     C*CASO ZT@002 = '1'
     C                   SELECT
     C     ZT@002        WHENEQ    '1'
     C* Número de planilla
     C*SI ZT@001 |= *BLANCO
     C     ZT@001        IFNE      *BLANK
     C* Número de planilla INTERNO
     C*MOVER ZPLNU1 ZT@001
     C                   MOVE      ZT@001        ZPLNU1
     C* Número de planilla INTERNO
     C*MOVER PLANU1 ZPLNU1
     C                   Z-ADD     ZPLNU1        PLANU1
     C* Recupera planilla de recaudo
     C*INICIARI PLAARC04 (PLANU1)
     C     PLANU1        SETLL     PLAARC04                               74
     C     *IN74         IFEQ      '1'
     C                   MOVE      '0'           *IN74
     C                   ELSE
     C                   MOVE      '1'           *IN74
     C                   END
     C*SI NER(PLAARC04)
     C     *IN74         IFEQ      '1'
     C*PASAR ZERROR 'Planilla no encontrada'
     C                   MOVEL     $HIL(002)     ZERROR
     C* Imprimir error
     C*EJECUTAR M00023
     C                   EXSR      M00023
     C* Encontro planilla
     C*SINO
     C                   ELSE
     C* Recupera planilla de recaudo
     C*RECUPERARD (N) PLAARC04 (PLANU1)
     C     PLANU1        CHAIN     PLAARC04                           7494
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Planilla en estado COP
     C*SI PLAEST = 'COP'
     C     PLAEST        IFEQ      'COP'
     C* Proceso Principal
     C*EJECUTAR M00010
     C                   EXSR      M00010
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Planilla en estado diferente a Conciliado'
     C                   MOVEL     $HIL(003)     ZERROR
     C* Imprimir error
     C*EJECUTAR M00023
     C                   EXSR      M00023
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Núm. planilla = blancos
     C*SINO
     C                   ELSE
     C* Planillas conciliadas empledaor
     C*MOVER PLAEST 'COE'
     C                   MOVE      'COE'         PLAEST
     C* Acreditación por depositante
     C*SI ZT@007 |= *BLANCO
     C     ZT@007        IFNE      *BLANK
     C*SI ZPROCJ = 'J'
     C     ZPROCJ        IFEQ      'J'
     C* Proceso planillas validación especial
     C*EJECUTAR M82000
     C                   EXSR      M82000
     C*SINO
     C                   ELSE
     C* Número de identificación
     C*MOVER ZNUMID ZT@007
     C                   MOVE      ZT@007        ZNUMID
     C*INICIAR PLAARC15 (PLAEST ZNUMID)
     C     LL$001        KLIST
     C                   KFLD                    PLAEST
     C                   KFLD                    ZNUMID
     C     LL$001        SETLL     PLAARC15                           75
     C*LEER PLAARC15
     C                   READ      PLAARC15                               75
     C*MIENTRAS NFA(PLAARC15) Y PLAEST = 'COE' Y PLANU4 = ZNUMID
     C     *IN75         DOWEQ     '0'
     C     PLAEST        ANDEQ     'COE'
     C     PLANU4        ANDEQ     ZNUMID
     C* Tipo planilla
     C*SI PLATI1 = ZT@006
     C     PLATI1        IFEQ      ZT@006
     C* Proceso principal
     C*EJECUTAR M00010
     C                   EXSR      M00010
     C*FIN
     C                   END
     C*LEER PLAARC15
     C                   READ      PLAARC15                               75
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Acreditación por reproceso
     C*SI ZT@005 = 'REP'
     C     ZT@005        IFEQ      'REP'
     C*LIMPIAR ZT@004 ZT@005
     C                   CLEAR                   ZT@004
     C                   CLEAR                   ZT@005
     C*MOVER PLAEST 'COP'
     C                   MOVE      'COP'         PLAEST
     C*INICIAR PLAARC15 (PLAEST)
     C     PLAEST        SETLL     PLAARC15                           75
     C*LEER PLAARC15
     C                   READ      PLAARC15                               75
     C*MIENTRAS NFA(PLAARC15) Y PLAEST = 'COP'
     C     *IN75         DOWEQ     '0'
     C     PLAEST        ANDEQ     'COP'
     C* Proceso principal
     C*EJECUTAR M00010
     C                   EXSR      M00010
     C*LEER PLAARC15
     C                   READ      PLAARC15                               75
     C*FIN
     C                   END
     C* Acreditación general
     C*SINO
     C                   ELSE
     C*SI ZTLLAM = 'X'
     C     ZTLLAM        IFEQ      'X'
     C* Resta días de DIAACR
     C*F QRESDI1 (ZFESIS ZVARDI ZFEINI)
     C                   CALL      'RPRESDI1'                                   QRESDI1
     C     ZFESIS        PARM      ZFESIS        F$431             8
     C     ZVARDI        PARM      ZVARDI        F$432             5 0
     C     ZFEINI        PARM      ZFEINI        F$433             8
     C* Acreditación por fecha
     C*EJECUTAR M00017
     C                   EXSR      M00017
     C*SINO
     C                   ELSE
     C*SI ZTLLAM = 'Z'
     C     ZTLLAM        IFEQ      'Z'
     C* ACR POR RANGO DE FECHAS
     C*EJECUTAR M80000
     C                   EXSR      M80000
     C*SINO
     C                   ELSE
     C*SQL
     C/EXEC SQL
     C+  DECLARE CURPLA CURSOR FOR
     C+  SELECT PLANU1
     C+  FROM PLAARC
     C+  WHERE
     C+  PLANU1 BETWEEN :ZPLINI AND :ZPLFIN
     C+  AND PLAEST = 'CON'
     C+  ORDER BY PLATO8 DESC
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  OPEN CURPLA
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  FETCH CURPLA INTO :ZPLANU
     C/END-EXEC
     C*MIENTRAS SQLCOD = 0
     C     SQLCOD        DOWEQ     0
     C*INICIARI PLAARC04 (ZPLANU)
     C     ZPLANU        SETLL     PLAARC04                               74
     C     *IN74         IFEQ      '1'
     C                   MOVE      '0'           *IN74
     C                   ELSE
     C                   MOVE      '1'           *IN74
     C                   END
     C*LEER PLAARC04
     C                   READ      PLAARC04                               74
     C*SI PLAEST = 'CON'
     C     PLAEST        IFEQ      'CON'
     C* Proceso principal
     C*EJECUTAR M00010
     C                   EXSR      M00010
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  FETCH CURPLA INTO :ZPLANU
     C/END-EXEC
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  CLOSE CURPLA
     C/END-EXEC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Cancelación deuda con P.E.
     C*CASO ZT@002 = '2'
     C     ZT@002        WHENEQ    '2'
     C* Limpiar variables del proceso
     C*EJECUTAR M00050
     C                   EXSR      M00050
     C* Leer archivos relac. acred. p.e.
     C*EJECUTAR M00006
     C                   EXSR      M00006
     C*SI ZSALIR ]= '1'
     C     ZSALIR        IFNE      '1'
     C* Proceso acred. deuda con p.e.
     C*EJECUTAR M00060
     C                   EXSR      M00060
     C*SINO
     C                   ELSE
     C* Total de planillas erradas
     C*SUMAR 1 ZTPLAE
     C                   ADD       1             ZTPLAE
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C* Rollback
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Imprime reporte de totales
     C*EJECUTAR TOT@01
     C                   EXSR      TOT@01
     C* Acreditación de rezagos
     C*CASO ZT@002 = '3'
     C     ZT@002        WHENEQ    '3'
     C* Proceso de acreditación de rezagos
     C*EJECUTAR M00070
     C                   EXSR      M00070
     C*FINCASOS
     C                   ENDSL
     C*
     C* Si se llama desde la nueva opción
     C*SI ZINLLA = 'M' Y ZT@002 = 'F'
     C     ZINLLA        IFEQ      'M'
     C     ZT@002        ANDEQ     'F'
     C*SI PLAPER < ZPEVIG
     C     PLAPER        IFLT      ZPEVIG
     C* Terminar revers. comisión ces.
     C*EJECUTAR M14095
     C                   EXSR      M14095
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Impresión de totales proc. masivo
     C*SI ZT@002 = 'F'
     C     ZT@002        IFEQ      'F'
     C* Ind llamado masiva x valor/fecha
     C*LIMPIAR ZINLLA
     C                   CLEAR                   ZINLLA
     C*FIN
     C                   END
     C*SI ZT@002 <> 'R' Y ZT@002 <> '2'
     C     ZT@002        IFNE      'R'
     C     ZT@002        ANDNE     '2'
     C* Imprime reporte de totales
     C*EJECUTAR TOT@01
     C                   EXSR      TOT@01
     C*SI ZINLLA <> 'M'
     C     ZINLLA        IFNE      'M'
     C* Fin reporte detallado
     C*IMPRIMIR FMT@F1
     C                   EXCEPT    FMT@F1
     C* Fin reporte totales
     C*IMPRIMIR FMT@F2
     C                   EXCEPT    FMT@F2
     C* Total planillas erradas
     C*IMPRIMIR FMT@T4
     C                   EXCEPT    FMT@T4
     C* Fin reporte de errores
     C*IMPRIMIR FMT@F3
     C                   EXCEPT    FMT@F3
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZT@002 = '2' O ZINLLA = 'M'
     C     ZT@002        IFEQ      '2'
     C     ZINLLA        OREQ      'M'
     C* Incrementa var. cargue de var.
     C*PASAR ZCARIN 1
     C                   MOVEL     1             ZCARIN
     C* Programa cargado em memoria
     C*RETORNAR
     C                   MOVE      '0'           *INLR
     C                   RETURN
     C*FIN
     C                   END
     C*
     C*SI ZT@002 <> '2' Y ZINLLA <> 'M'
     C     ZT@002        IFNE      '2'
     C     ZINLLA        ANDNE     'M'
     C* Finaliza proceso
     C*LLAMAR TRCTPR51 (FUNCIO ZMODO ZNRTRA)
     C                   CALL      'TRCTPR51'
     C                   PARM                    FUNCIO
     C                   PARM                    ZMODO
     C                   PARM                    ZNRTRA
     C*PASAR ZFI 'S'
     C                   MOVEL     'S'           ZFI
     C* Actualiza HISAR4
     C*LLAMAR TRPLAN6I(ZFONDO HISFE3 ZCODTX ZCONCE ZVALHI ZCUOHI ZFI)
     C                   CALL      'TRPLAN6I'
     C                   PARM                    ZFONDO
     C                   PARM                    HISFE3
     C                   PARM                    ZCODTX
     C                   PARM                    ZCONCE
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C                   PARM                    ZFI
     C*PASAR ZDEPR1 'S'
     C                   MOVEL     'S'           ZDEPR1
     C* Tipo de planilla
     C*PASAR ZP PLATIP
     C                   MOVEL     PLATIP        ZP
     C* Fecha ley 1607
     C*PASAR ZF ZFEIN2
     C                   MOVEL     ZFEIN2        ZF
     C* Tasa interés simple
     C*MOVER ZT ZTAINS
     C                   Z-ADD     ZTAINS        ZT
     C* Amnistia
     C*PASAR ZAMP ZAMNPA
     C                   MOVEL     ZAMNPA        ZAMP
     C* ultimo digito
     C*MOVER ZUL ZULNIT
     C                   Z-ADD     ZULNIT        ZUL
     C*LLAMAR TRPAGR65 ($$PAGR ZVALHI ZCUOHI ZDEPR1)
     C                   CALL      'TRPAGR65'
     C                   PARM                    $$PAGR
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C                   PARM                    ZDEPR1
     C*LLAMAR TRDPIN50(ZIND ZLOT ZPLA ZPAG ZSEC ZFDE ZID ZPER ZTPLA ZTPA
     C                   CALL      'TRDPIN50'
     C                   PARM                    ZIND
     C                   PARM                    ZLOT
     C                   PARM                    ZPLA
     C                   PARM                    ZPAG
     C                   PARM                    ZSEC
     C                   PARM                    ZFDE
     C                   PARM                    ZID
     C                   PARM                    ZPER
     C                   PARM                    ZTPLA
     C                   PARM                    ZTPAG
     C                   PARM                    ZINDLI
     C                   PARM                    ZAMP
     C                   PARM                    ZLIQIN
     C                   PARM                    ZCOTFS
     C                   PARM                    ZCOTSF
     C                   PARM                    ZCOTOB
     C                   PARM                    ZCOTVA
     C                   PARM                    ZCOTVE
     C                   PARM                    ZCOTAR
     C                   PARM                    ZCOTFG
     C                   PARM                    ZER
     C                   PARM                    ZFI
     C*LLAMAR TRPLAN6N(ZPER ZP PLAT03 ZFECDE ZFEL ZINDLI ZCL ZFO ZUL ZAM
     C                   CALL      'TRPLAN6N'
     C                   PARM                    ZPER
     C                   PARM                    ZP
     C                   PARM                    PLAT03
     C                   PARM                    ZFECDE
     C                   PARM                    ZFEL
     C                   PARM                    ZINDLI
     C                   PARM                    ZCL
     C                   PARM                    ZFO
     C                   PARM                    ZUL
     C                   PARM                    ZAMP
     C                   PARM                    ZLIQIN
     C                   PARM                    ZSAIFS
     C                   PARM                    ZSAISF
     C                   PARM                    ZSAINT
     C                   PARM                    ZSICVA
     C                   PARM                    ZSICVE
     C                   PARM                    ZSINAR
     C                   PARM                    ZSAIFG
     C                   PARM                    ZER
     C                   PARM                    ZFI
     C                   PARM                    ZF
     C                   PARM                    ZT
     C                   PARM                    ZISL
     C                   PARM                    ZICL
     C*FIN
     C                   END
     C* Desarrollo santander
     C*SI ZD7046 = 1 O ZR9072 = 1
     C     ZD7046        IFEQ      1
     C     ZR9072        OREQ      1
     C*LIMPIAR ZLLAM1
     C                   CLEAR                   ZLLAM1
     C*LLAMAR TREMPN52 (ZCODIN PLATI1 PLANU4 PLAPER PLAPER ZINVAL ZLLAM1
     C                   CALL      'TREMPN52'
     C                   PARM                    ZCODIN
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    PLAPER
     C                   PARM                    PLAPER
     C                   PARM                    ZINVAL
     C                   PARM                    ZLLAM1
     C*FIN
     C                   END
     C* Bajar de memoria programa y finalizar
     C*SI ZT@002 = 'F'
     C     ZT@002        IFEQ      'F'
     C* Finaliza proceso
     C*LLAMAR TRCTPR51 (FUNCIO ZMODO ZNRTRA)
     C                   CALL      'TRCTPR51'
     C                   PARM                    FUNCIO
     C                   PARM                    ZMODO
     C                   PARM                    ZNRTRA
     C*TERMINAR
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C*FIN
     C                   END
     C* Proceso masivo
     C*SI ZTIPXX = 'W' O ZTLLAM = 'X' O ZREZMS='S' O ZTLLAM = 'Z'
     C     ZTIPXX        IFEQ      'W'
     C     ZTLLAM        OREQ      'X'
     C     ZREZMS        OREQ      'S'
     C     ZTLLAM        OREQ      'Z'
     C* Estado proceso terminación
     C*PASAR ZESTPR 'T'
     C                   MOVEL     'T'           ZESTPR
     C*Act. inf.trabajos acred.masiva ytotaliza transac
     C*LLAMAR TRPLAN22(ZESTPR ZNOMTR ZNUMTR ZUSUAR)
     C                   CALL      'TRPLAN22'
     C                   PARM                    ZESTPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C* Finaliza proceso
     C*LLAMAR TRCTPR51 (FUNCIO ZMODO ZNRTRA)
     C                   CALL      'TRCTPR51'
     C                   PARM                    FUNCIO
     C                   PARM                    ZMODO
     C                   PARM                    ZNRTRA
     C*TERMINAR
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C*FIN
     C                   END
     C* Desarrollo santander O PRO108
     C*SI ZD7046 = 1 O ZR9072 = 1
     C     ZD7046        IFEQ      1
     C     ZR9072        OREQ      1
     C* Se descargan los programas de memoria
     C*LIMPIAR ZLLAM1
     C                   CLEAR                   ZLLAM1
     C*PASAR ZINDUL '1'
     C                   MOVEL     '1'           ZINDUL
     C*LLAMAR TREMPN52 (ZCODIN PLATI1 PLANU4 PLAPER PLAPER ZINVAL ZLLAM1
     C                   CALL      'TREMPN52'
     C                   PARM                    ZCODIN
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    PLAPER
     C                   PARM                    PLAPER
     C                   PARM                    ZINVAL
     C                   PARM                    ZLLAM1
     C*SI ZR8565 = 1
     C     ZR8565        IFEQ      1
     C*LLAMAR TRACUE51(PLACOD ZFECDE PLANUM ZTVDEP ZINDUL)
     C                   CALL      'TRACUE51'
     C                   PARM                    PLACOD
     C                   PARM                    ZFECDE
     C                   PARM                    PLANUM
     C                   PARM                    ZTVDEP
     C                   PARM                    ZINDUL
     C*FIN
     C                   END
     C*SI ZR9072 = 1
     C     ZR9072        IFEQ      1
     C*LLAMAR TRACUE58(ZTILLA PLANUM MOVNU2 ZEMPLA ZFECDE ZTOPAG ZINDUL)
     C                   CALL      'TRACUE58'
     C                   PARM                    ZTILLA
     C                   PARM                    PLANUM
     C                   PARM                    MOVNU2
     C                   PARM                    ZEMPLA
     C                   PARM                    ZFECDE
     C                   PARM                    ZTOPAG
     C                   PARM                    ZINDUL
     C*FIN
     C                   END
     C*LLAMAR TRACUE57(DEUTIP DEUNUM ZSALDE ZINDUL ZCODIN)
     C                   CALL      'TRACUE57'
     C                   PARM                    DEUTIP
     C                   PARM                    DEUNUM
     C                   PARM                    ZSALDE
     C                   PARM                    ZINDUL
     C                   PARM                    ZCODIN
     C*LLAMAR TRDEUD7L (DEUTIP DEUNUM ZFECDE ZCLASE ZFORDE ZVALIN ZVALI1
     C                   CALL      'TRDEUD7L'
     C                   PARM                    DEUTIP
     C                   PARM                    DEUNUM
     C                   PARM                    ZFECDE
     C                   PARM                    ZCLASE
     C                   PARM                    ZFORDE
     C                   PARM                    ZVALIN
     C                   PARM                    ZVALI1
     C                   PARM                    PLANU1
     C                   PARM                    ZINACT
     C                   PARM                    ZERROR
     C                   PARM                    ZCUCOD
     C                   PARM                    ZCUIDE
     C                   PARM                    ZFEIN2
     C                   PARM                    ZTAINS
     C                   PARM                    ZINDUL
     C*FIN
     C                   END
     C* Tipo de llamado finalización
     C*PASAR ZTIPLL 'F'
     C                   MOVEL     'F'           ZTIPLL
     C* Días de dec. 2616
     C*LIMPIAR ZDIDEC
     C                   CLEAR                   ZDIDEC
     C*LLAMAR TRDIAC63 (DIANUM DIAPER ZTIPLL ZDIDEC)
     C                   CALL      'TRDIAC63'
     C                   PARM                    DIANUM
     C                   PARM                    DIAPER
     C                   PARM                    ZTIPLL
     C                   PARM                    ZDIDEC
     C* Descargar de memoria recuperar porcentaje retención
     C* Descargar programa de memoria
     C*PASAR ZFI 'S'
     C                   MOVEL     'S'           ZFI
     C*LIMPIAR MOVFEC ZRECRE ZPORET
     C                   CLEAR                   MOVFEC
     C                   CLEAR                   ZRECRE
     C                   CLEAR                   ZPORET
     C*LLAMAR RPPORC51(MOVFEC ZRECRE ZPORET ZFI)
     C                   CALL      'RPPORC51'
     C                   PARM                    MOVFEC
     C                   PARM                    ZRECRE
     C                   PARM                    ZPORET
     C                   PARM                    ZFI
     C                   ENDSR
     C*==================================================================
     C*==  Prepara variables para TRHIPO50                             ==
     C*==                                                              ==
     C*==================================================================
     C     M00VAR        BEGSR
     C* Empleador
     C*MOVER ZE PLACOD
     C                   Z-ADD     PLACOD        ZE
     C* Fecha depo
     C*PASAR ZFD PLAFEC
     C                   MOVEL     PLAFEC        ZFD
     C* Cotizacion del detalle
     C*MOVER ZCOT DETCOT
     C                   Z-ADD     DETCOT        ZCOT
     C* Tip id afiliado
     C*PASAR ZTI DETTI2
     C                   MOVEL     DETTI2        ZTI
     C* Num id afiliado
     C*MOVER ZNI DETNU2
     C                   Z-ADD     DETNU2        ZNI
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza pago en exceso de fusión - PAGA22                 ==
     C*==                                                              ==
     C*==================================================================
     C     M000FF        BEGSR
     C* Des.Esp 10592
     C*SI Z10592 = 1 Y ZIPEFP = '1'
     C     Z10592        IFEQ      1
     C     ZIPEFP        ANDEQ     '1'
     C* Completar en PGM.
     C*PASAR ZCOMPL 'N'
     C                   MOVEL     'N'           ZCOMPL
     C*CASO ZINPEE = 'N'
     C                   SELECT
     C     ZINPEE        WHENEQ    'N'
     C* Saldo empleador en cuotas (PAG020)
     C* Saldo cuotas P.E. empleador
     C*CALCULAR ZSVP22 = ZAGS16 - ZVRPAG
     C     ZAGS16        SUB       ZVRPAG        ZSVP22
     C* Saldo empleador (PAGS16)
     C* Saldo P.E. empleador
     C*CALCULAR ZS1P22 = ZSVP22 / ZVCFDI
     C     ZSVP22        DIV       ZVCFDI        ZS1P22
     C*CALCULAR (R) ZSCP22 = ZS1P22
     C                   Z-ADD(H)  ZS1P22        ZSCP22
     C*CASO ZINPEE = 'S'
     C     ZINPEE        WHENEQ    'S'
     C*Cta = Saldo P.E* Valor cta Ing
     C*CALCULAR (R) ZCUTEM = (PAGSA3/ZVCFFI)
     C     PAGSA3        DIV       ZVCFFI        V$CA1           030 9
     C                   Z-ADD(H)  V$CA1         ZCUTEM
     C*CALCULAR (R) ZVALTE = ZCUTEM * ZVCFDI
     C     ZCUTEM        MULT(H)   ZVCFDI        ZVALTE
     C*CALCULAR (R) ZVAPAU = ZVALTE
     C                   Z-ADD(H)  ZVALTE        ZVAPAU
     C*MOVER ZSVP22 ZVAPAU
     C                   Z-ADD     ZVAPAU        ZSVP22
     C*Cta = Saldo P.E* Valor cta Ing
     C*CALCULAR (R) ZCUTEM = (ZSVP22/ZVCFDI)
     C     ZSVP22        DIV       ZVCFDI        V$CA1           030 9
     C                   Z-ADD(H)  V$CA1         ZCUTEM
     C*CALCULAR ZSCP22 = ZCUTEM
     C                   Z-ADD     ZCUTEM        ZSCP22
     C*
     C*FINCASOS
     C                   ENDSL
     C* Modifica PAGA22
     C* Planilla PAGA22
     C*MOVER ZPLP22 ZAGPL5
     C                   Z-ADD     ZAGPL5        ZPLP22
     C* Valor 15,2  para parametro
     C*MOVER ZSV152 ZSVP22
     C                   Z-ADD     ZSVP22        ZSV152
     C*LLAMAR TRFEQA56 (ZPLP22 ZSV152 ZSCP22 ZCOMPL)
     C                   CALL      'TRFEQA56'
     C                   PARM                    ZPLP22
     C                   PARM                    ZSV152
     C                   PARM                    ZSCP22
     C                   PARM                    ZCOMPL
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Leer entidades relacionadas                                 ==
     C*==                                                              ==
     C*==================================================================
     C     M00000        BEGSR
     C*LIMPIAR ZCUCOD
     C                   CLEAR                   ZCUCOD
     C* Buscar planilla base de retroactiva
     C*EJECUTAR M00180
     C                   EXSR      M00180
     C* Desarrollo especial santander
     C*SI ZD7046 = 1 O ZR9072 = 1
     C     ZD7046        IFEQ      1
     C     ZR9072        OREQ      1
     C* Variable que controla proceso
     C*LIMPIAR ZINVAL
     C                   CLEAR                   ZINVAL
     C* Código interno auxiliar
     C*LIMPIAR ZCODIN
     C                   CLEAR                   ZCODIN
     C* Verificar empleador
     C*PASAR ZLLAM1 'E'
     C                   MOVEL     'E'           ZLLAM1
     C*LLAMAR TREMPN52 (ZCODIN PLATI1 PLANU4 PLAPER PLAPER ZINVAL ZLLAM1
     C                   CALL      'TREMPN52'
     C                   PARM                    ZCODIN
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    PLAPER
     C                   PARM                    PLAPER
     C                   PARM                    ZINVAL
     C                   PARM                    ZLLAM1
     C*SI ZINVAL <> *BLANCO
     C     ZINVAL        IFNE      *BLANK
     C*PASAR ZINVAL '1'
     C                   MOVEL     '1'           ZINVAL
     C*FIN
     C                   END
     C* Planilla cancelación deuda
     C*SI PLAT03 = '02'
     C     PLAT03        IFEQ      '02'
     C* Indicador planilla PLCD
     C*LIMPIAR ZPLCND
     C                   CLEAR                   ZPLCND
     C* Prefijo PLCD (PLanilla cancelación)
     C*PASAR ZCARAC ZPLCPR
     C                   CLEAR                   ZCARAC
     C                   MOVEL     ZPLCPR        ZCARAC
     C*F QNUMCAR (ZCARAC ZNUMCA)
     C                   CALL      'F037SNAP'                                   QNUMCAR
     C     ZCARAC        PARM      ZCARAC        F$3H1           255
     C     ZNUMCA        PARM      ZNUMCA        F$3H2             3 0
     C*OBTENER ZPREF1 = *EXT(PLANU3 1 ZNUMCA)
     C                   CLEAR                   H$1
     C     ZNUMCA        SUBST     PLANU3:1      H$1             256
     C                   MOVEL     H$1           ZPREF1
     C* Prefijos iguales
     C*SI ZPLCPR = ZPREF1
     C     ZPLCPR        IFEQ      ZPREF1
     C* PLCD acuerdo
     C*PASAR ZPLCND '1'
     C                   MOVEL     '1'           ZPLCND
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Período de la planilla
     C*PASAR ZPER PLAPER
     C                   MOVEL     PLAPER        ZPER
     C* Planilla de tercero
     C*SI PLATIP = '03'
     C     PLATIP        IFEQ      '03'
     C* Mes de cotización
     C*MOVER ZMESPE PLAPER
     C                   MOVE      PLAPER        ZMESPE
     C* Se cotiza para enero
     C*SI ZMESPE = '01'
     C     ZMESPE        IFEQ      '01'
     C* Variable esta inactiva
     C*SI ZACRVO <> 'S'
     C     ZACRVO        IFNE      'S'
     C* 1er día del período de cot.
     C*OBTENER (0) ZFEPER = PLAPER || '01'
     C                   CLEAR                   ZFEPER
     C     PLAPER        CAT       '01':0        ZFEPER
     C* Número meses a restar
     C*MOVER ZNUME1 1
     C                   Z-ADD     1             ZNUME1
     C*LIMPIAR ZRENTR ZERRO2
     C                   CLEAR                   ZRENTR
     C                   CLEAR                   ZERRO2
     C* DIC. DEL AÑO ANTERIOR
     C*FUNCION QRESME1 (ZFEPER 1 ZFEPER)
     C                   CALL      'RPRESME1'                                   QRESME1
     C     ZFEPER        PARM      ZFEPER        F$4D1             8
     C                   PARM      1             F$4D2             8 0
     C     ZFEPER        PARM      ZFEPER        F$4D3             8
     C* Período ant. a cotización
     C*PASAR ZPEANT ZFEPER
     C                   MOVEL     ZFEPER        ZPEANT
     C* Período para HISAR6
     C*PASAR ZHPPE1 ZPEANT
     C                   MOVEL     ZPEANT        ZHPPE1
     C* Recupera Hisar6
     C*LLAMAR TRHPAR55($$REG1)
     C                   CALL      'TRHPAR55'
     C                   PARM                    $$REG1
     C* Indicador de error
     C*SI ZHPIND = '1'
     C     ZHPIND        IFEQ      '1'
     C* Período de la planilla
     C*PASAR ZPERER ZPEANT
     C                   MOVEL     ZPEANT        ZPERER
     C* Período en formato pantalla
     C*F FPANPER (ZPERER)
     C                   CALL      'TRPANPER'                                   FPANPER
     C     ZPERER        PARM      ZPERER        F$0P1             6
     C*OBTENER (1) ZERROR = 'No existe histórico de parámetros para el p
     C                   CLEAR                   ZERROR
     C     $HIL(004)     CAT       ZPERER:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*SINO
     C                   ELSE
     C* Salario mínimo dic. año ant.
     C*MOVER ZSAMII ZHPVA2
     C                   Z-ADD     ZHPVA2        ZSAMII
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Indicador pacto cancel.deudas
     C*EJECUTAR M00020
     C                   EXSR      M00020
     C* No se valida hist. de parámetros para planillas de traspaso ó
     C* No es planilla de traspaso, y el tipo de pago es extraordinario
     C* No es planilla de traspaso, y el tipo pago es canc. deuda y el p
     C*SI PLATIP = '05' O PLATIP ]= '05' Y PLAT03 = '06' O PLATIP ]= '05
     C     PLATIP        IFEQ      '05'
     C     PLATIP        ORNE      '05'
     C     PLAT03        ANDEQ     '06'
     C     PLATIP        ORNE      '05'
     C     PLAT03        ANDEQ     '02'
     C     PLAPER        ANDEQ     *BLANK
     C*LIMPIAR ZFEIND ZPCTCO ZPCTFS ZSALMI ZSALMA ZSALFS ZDIAPE
     C                   CLEAR                   ZFEIND
     C                   CLEAR                   ZPCTCO
     C                   CLEAR                   ZPCTFS
     C                   CLEAR                   ZSALMI
     C                   CLEAR                   ZSALMA
     C                   CLEAR                   ZSALFS
     C                   CLEAR                   ZDIAPE
     C*SI PLATIP ]= '05' Y PLAT03 = '06' O PLATIP ]= '05' Y PLAT03 = '02
     C     PLATIP        IFNE      '05'
     C     PLAT03        ANDEQ     '06'
     C     PLATIP        ORNE      '05'
     C     PLAT03        ANDEQ     '02'
     C     PLAPER        ANDEQ     *BLANK
     C* Clas.empl,forma declaración
     C*EJECUTAR  M00001
     C                   EXSR      M00001
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Lee datos planillas <> '05'
     C*EJECUTAR M00005
     C                   EXSR      M00005
     C*FIN
     C                   END
     C* Verifica si planilla fué conciliada solo con P.A.
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Conciliacion PLA/DEP
     C*INICIARI CONAR202 (PLANU3 PLANUM)
     C     LL$002        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$002        SETLL     CONAR202                               41
     C     *IN41         IFEQ      '1'
     C                   MOVE      '0'           *IN41
     C                   ELSE
     C                   MOVE      '1'           *IN41
     C                   END
     C*SI ERE (CONAR202)
     C     *IN41         IFEQ      '0'
     C*LEER CONAR202
     C                   READ      CONAR202                               41
     C*MIENTRAS NFA (CONAR202) Y PLANU3=CONNU4 Y PLANUM=CONNU5
     C     *IN41         DOWEQ     '0'
     C     PLANU3        ANDEQ     CONNU4
     C     PLANUM        ANDEQ     CONNU5
     C* Conc.con Pago adelantado
     C*CASO CONTI3= '5'
     C                   SELECT
     C     CONTI3        WHENEQ    '5'
     C*PASAR ZIND05 '1'
     C                   MOVEL     '1'           ZIND05
     C* Conci. con depósitos
     C*CASO CONTI3= ' '
     C     CONTI3        WHENEQ    ' '
     C*PASAR ZIND05 '0'
     C                   MOVEL     '0'           ZIND05
     C*SALIR
     C                   GOTO      T$1
     C*FINCASOS
     C                   ENDSL
     C*LEER CONAR202
     C                   READ      CONAR202                               41
     C*FIN
     C                   END
     C     T$1           TAG
     C*FIN
     C                   END
     C* Vlr conc. o tiene conc. P.A
     C*SI PLAVAL > *CERO O ZIND05 = '1'
     C     PLAVAL        IFGT      *ZERO
     C     ZIND05        OREQ      '1'
     C* Calcula última fecha depósito
     C*EJECUTAR M00013
     C                   EXSR      M00013
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LIMPIAR ZTIPLP ZNJ ZTPVAE ZTPVDF
     C                   CLEAR                   ZTIPLP
     C                   CLEAR                   ZNJ
     C                   CLEAR                   ZTPVAE
     C                   CLEAR                   ZTPVDF
     C* Programa que retorna Naturaleza juridica ZNJ de PLAA66:
     C*LLAMAR TRPLCO50(PLANU3 PLANUM ZNJ ZTIPLP)
     C                   CALL      'TRPLCO50'
     C                   PARM                    PLANU3
     C                   PARM                    PLANUM
     C                   PARM                    ZNJ
     C                   PARM                    ZTIPLP
     C*SI ZTIPLP <> *BLANCO
     C     ZTIPLP        IFNE      *BLANK
     C*LLAMAR RPTPVE50(ZTIPLP ZTPVAE ZTPVDF)
     C                   CALL      'RPTPVE50'
     C                   PARM                    ZTIPLP
     C                   PARM                    ZTPVAE
     C                   PARM                    ZTPVDF
     C* Planilla Z tomar porcentaje comision Z
     C*SI ZTIPLP = 'Z'
     C     ZTIPLP        IFEQ      'Z'
     C*SQL
     C/EXEC SQL
     C+  SELECT HISP60 INTO :ZISP60
     C+  FROM SBHISAR6 WHERE
     C+  HISPE1 = :ZHPPE1
     C/END-EXEC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Llamado desde modulo sentencia o acr de rezagos
     C*SI ZPROCJ = 'J' Y ZTPVAE = '1' O ZTPVAE = '1' Y ZT@002 = '3'
     C     ZPROCJ        IFEQ      'J'
     C     ZTPVAE        ANDEQ     '1'
     C     ZTPVAE        OREQ      '1'
     C     ZT@002        ANDEQ     '3'
     C*SQL
     C/EXEC SQL
     C+  SELECT CONT99 INTO :ZTIPVL
     C+  FROM CONA86 WHERE
     C+  CONP13 = :PLANUM
     C+  FETCH FIRST 1 ROWS ONLY
     C/END-EXEC
     C*FIN
     C                   END
     C*SI ZTPVAE = '1' Y ZTIPVL =*BLANCO Y ZTPVDF <> *BLANCOS
     C     ZTPVAE        IFEQ      '1'
     C     ZTIPVL        ANDEQ     *BLANK
     C     ZTPVDF        ANDNE     *BLANKS
     C*PASAR ZTIPVL ZTPVDF
     C                   MOVEL     ZTPVDF        ZTIPVL
     C*FIN
     C                   END
     C*
     C*LIMPIAR ZVAESP
     C                   CLEAR                   ZVAESP
     C*LLAMAR RPLIQESP50 (PLANU3 PLANU1 PLAFEC ZVAESP)
     C                   MOVEL     'RPLIQESP'    H$L10            10
     C                   MOVE      '50'          H$L10
     C                   CALL      H$L10
     C                   PARM                    PLANU3
     C                   PARM                    PLANU1
     C                   PARM                    PLAFEC
     C                   PARM                    ZVAESP
     C*SI ZVAESP = '1'
     C     ZVAESP        IFEQ      '1'
     C*LIMPIAR ZTPVAE
     C                   CLEAR                   ZTPVAE
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualizar clasificación empleador y forma de declaración   ==
     C*==                                                              ==
     C*==================================================================
     C     M00001        BEGSR
     C* Pequeño - Independiente
     C*PASAR ZCLASE 'I'
     C                   MOVEL     'I'           ZCLASE
     C*CASO PLATIP='03' O PLAT03='08' O PLAT03='13' O PLAT03='14' O ZTPG
     C                   SELECT
     C     PLATIP        WHENEQ    '03'
     C     PLAT03        OREQ      '08'
     C     PLAT03        OREQ      '13'
     C     PLAT03        OREQ      '14'
     C     ZTPGRT        OREQ      '08'
     C     ZTPGRT        OREQ      '13'
     C     ZTPGRT        OREQ      '14'
     C* Forma declaración consolidada
     C*PASAR ZFORDE 'C'
     C                   MOVEL     'C'           ZFORDE
     C*SI PLATIP='07' Y PLAT03='09'
     C     PLATIP        IFEQ      '07'
     C     PLAT03        ANDEQ     '09'
     C*SI ZTPGRT='08' O ZTPGRT='13' O ZTPGRT='14'
     C     ZTPGRT        IFEQ      '08'
     C     ZTPGRT        OREQ      '13'
     C     ZTPGRT        OREQ      '14'
     C* Pequeño
     C*PASAR ZCLASE 'B'
     C                   MOVEL     'B'           ZCLASE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Planilla indep.
     C*CASO PLATIP = '02' O PLATIP = '07'
     C     PLATIP        WHENEQ    '02'
     C     PLATIP        OREQ      '07'
     C* Forma declaración única
     C*PASAR ZFORDE 'U'
     C                   MOVEL     'U'           ZFORDE
     C*SINO
     C                   OTHER
     C* Si se reportan estos datos en la planilla
     C*SI PLACL1 ]= *BLANCO Y PLAFOR ]= *BLANCO
     C     PLACL1        IFNE      *BLANK
     C     PLAFOR        ANDNE     *BLANK
     C* Clasificación empleador
     C*PASAR ZCLASE PLACL1
     C                   MOVEL     PLACL1        ZCLASE
     C* Forma declaración
     C*PASAR ZFORDE PLAFOR
     C                   MOVEL     PLAFOR        ZFORDE
     C*SINO
     C                   ELSE
     C* Clasificación empleador
     C*PASAR ZCLASE EMPCLA
     C                   MOVEL     EMPCLA        ZCLASE
     C* Forma declaración
     C*PASAR ZFORDE EMPFOR
     C                   MOVEL     EMPFOR        ZFORDE
     C*FIN
     C                   END
     C*FINCASOS
     C                   ENDSL
     C                   ENDSR
     C*==================================================================
     C*==  Trae porcentajes de cotización y comisiones para sector sa  ==
     C*==                                                              ==
     C*==================================================================
     C     M00002        BEGSR
     C*LIMPIAR ZERROR
     C                   CLEAR                   ZERROR
     C*LLAMAR TRHISF50 (ZPER1 PLAT03 ZCOSIT ZCOMSI ZPRISI ZFGPSI ZCOHOS
     C                   CALL      'TRHISF50'
     C                   PARM                    ZPER1
     C                   PARM                    PLAT03
     C                   PARM                    ZCOSIT
     C                   PARM                    ZCOMSI
     C                   PARM                    ZPRISI
     C                   PARM                    ZFGPSI
     C                   PARM                    ZCOHOS
     C                   PARM                    ZCOMHO
     C                   PARM                    ZPRIHO
     C                   PARM                    ZFGPHO
     C                   PARM                    ZERROR
     C* Situado normal o retroactivo
     C*SI PLAT03 = '04' O PLAT03 = '11'
     C     PLAT03        IFEQ      '04'
     C     PLAT03        OREQ      '11'
     C* Comisión situados
     C*MOVER ZPCOCO ZCOMSI
     C                   Z-ADD     ZCOMSI        ZPCOCO
     C* C.O. situados
     C*MOVER ZPCTCO ZCOSIT
     C                   Z-ADD     ZCOSIT        ZPCTCO
     C* Prima situados
     C*MOVER ZPORPS ZPRISI
     C                   Z-ADD     ZPRISI        ZPORPS
     C* F.G.P.M
     C*MOVER ZPFGPM ZFGPSI
     C                   Z-ADD     ZFGPSI        ZPFGPM
     C*SINO
     C                   ELSE
     C* Comisión hospitales
     C*MOVER ZPCOCO ZCOMHO
     C                   Z-ADD     ZCOMHO        ZPCOCO
     C* C.O. hospitales
     C*MOVER ZPCTCO ZCOHOS
     C                   Z-ADD     ZCOHOS        ZPCTCO
     C* Prima hospitales
     C*MOVER ZPORPS ZPRIHO
     C                   Z-ADD     ZPRIHO        ZPORPS
     C* F.G.P.M
     C*MOVER ZPFGPM ZFGPHO
     C                   Z-ADD     ZFGPHO        ZPFGPM
     C*FIN
     C                   END
     C*SI ZERROR |= *BLANCO
     C     ZERROR        IFNE      *BLANK
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*SINO
     C                   ELSE
     C* D.E. fusión PRO
     C*SI Z10592=1 Y PLAPER<ZPEFUS Y ZPER1<ZPEFUS
     C     Z10592        IFEQ      1
     C     PLAPER        ANDLT     ZPEFUS
     C     ZPER1         ANDLT     ZPEFUS
     C*LLAMAR TRFEPL57 (PLANUM PLATIP PLAT03 ZPER1 ZPCOCO ZPORPS ZINDER)
     C                   CALL      'TRFEPL57'
     C                   PARM                    PLANUM
     C                   PARM                    PLATIP
     C                   PARM                    PLAT03
     C                   PARM                    ZPER1
     C                   PARM                    ZPCOCO
     C                   PARM                    ZPORPS
     C                   PARM                    ZINDER
     C*SI ZINDER = '1'
     C     ZINDER        IFEQ      '1'
     C* Período de la planilla
     C*PASAR ZPERER ZPER1
     C                   MOVEL     ZPER1         ZPERER
     C* Período en formato pantalla
     C*F FPANPER (ZPERER)
     C                   CALL      'TRPANPER'                                   FPANPER
     C     ZPERER        PARM      ZPERER        F$0P1             6
     C*OBTENER (1) ZERROR = 'No existe histórico de parám. fusión PRO pe
     C                   CLEAR                   ZERROR
     C     $HIL(005)     CAT       ZPERER:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Verifica datos por fusión                                   ==
     C*==                                                              ==
     C*==================================================================
     C     M00003        BEGSR
     C*PASAR ZINDPL '0'
     C                   MOVEL     '0'           ZINDPL
     C* Programa que determina si existe planilla en fondo orígen.
     C* Fusión Colmena - Davivir
     C*SI ZFUCDA = '1'
     C     ZFUCDA        IFEQ      '1'
     C*LLAMAR TRFPLA53 (DEUNUM ZINDPL ZTIPPL ZEMPPL ZPERPL ZFDEFO)
     C                   CALL      'TRFPLA53'
     C                   PARM                    DEUNUM
     C                   PARM                    ZINDPL
     C                   PARM                    ZTIPPL
     C                   PARM                    ZEMPPL
     C                   PARM                    ZPERPL
     C                   PARM                    ZFDEFO
     C*SINO
     C                   ELSE
     C* Fusión Colpatria - Horizonte
     C*SI ZFUCHO = '1'
     C     ZFUCHO        IFEQ      '1'
     C*LLAMAR TRFPLA60 (DEUNUM ZINDPL ZTIPPL ZEMPPL ZPERPL ZTIPO ZIDPLA)
     C                   CALL      'TRFPLA60'
     C                   PARM                    DEUNUM
     C                   PARM                    ZINDPL
     C                   PARM                    ZTIPPL
     C                   PARM                    ZEMPPL
     C                   PARM                    ZPERPL
     C                   PARM                    ZTIPO
     C                   PARM                    ZIDPLA
     C*SINO
     C                   ELSE
     C* Fusión Proteccion - ING
     C*SI Z10592 = 1
     C     Z10592        IFEQ      1
     C* Indicador de llenado INFA48
     C*PASAR ZINFUS '1'
     C                   MOVEL     '1'           ZINFUS
     C*LIMPIAR $$PLAA $$INFA
     C                   CLEAR                   $$PLAA
     C                   CLEAR                   $$INFA
     C* Pgm de servicio
     C*LLAMAR TRFPLA01 (DEUNUM $$PLAA $$INFA ZINFUS)
     C                   CALL      'TRFPLA01'
     C                   PARM                    DEUNUM
     C                   PARM                    $$PLAA
     C                   PARM                    $$INFA
     C                   PARM                    ZINFUS
     C* Existe registro PLAA55
     C*SI ZLA113 <> *CERO
     C     ZLA113        IFNE      *ZERO
     C*PASAR ZINDPL '1'
     C                   MOVEL     '1'           ZINDPL
     C* Período del empleador
     C*PASAR ZPERPL ZLAP29
     C                   MOVEL     ZLAP29        ZPERPL
     C* Tipo de planilla
     C*PASAR ZTIPPL ZLA114
     C                   MOVEL     ZLA114        ZTIPPL
     C* Obtiene datos de la deuda
     C*EJECUTAR M00300
     C                   EXSR      M00300
     C* Código empleador
     C*MOVER ZEMPPL ZLA117
     C                   Z-ADD     ZLA117        ZEMPPL
     C*SINO
     C                   ELSE
     C* Indicador de llenado INFA48
     C*PASAR ZINFUS '2'
     C                   MOVEL     '2'           ZINFUS
     C*LIMPIAR $$PLAA $$INFA
     C                   CLEAR                   $$PLAA
     C                   CLEAR                   $$INFA
     C* Pgm de servicio
     C*LLAMAR TRFPLA01 (DEUNUM $$PLAA $$INFA ZINFUS)
     C                   CALL      'TRFPLA01'
     C                   PARM                    DEUNUM
     C                   PARM                    $$PLAA
     C                   PARM                    $$INFA
     C                   PARM                    ZINFUS
     C* Existe registro PLAA55
     C*SI ZNFN35 <> *CERO
     C     ZNFN35        IFNE      *ZERO
     C*PASAR ZINDPL '2'
     C                   MOVEL     '2'           ZINDPL
     C* Período del empleador
     C*PASAR ZPERPL ZNFP08
     C                   MOVEL     ZNFP08        ZPERPL
     C* Tipo de planilla
     C*PASAR ZTIPPL ZNFT28
     C                   MOVEL     ZNFT28        ZTIPPL
     C* Obtiene datos de la deuda
     C*EJECUTAR M00300
     C                   EXSR      M00300
     C* Código empleador
     C*MOVER ZEMPPL ZLA117
     C                   Z-ADD     ZLA117        ZEMPPL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Encontró planilla
     C*CASO ZINDPL = '1'
     C                   SELECT
     C     ZINDPL        WHENEQ    '1'
     C* Tipo de planilla
     C*PASAR PLATIP ZTIPPL
     C                   MOVEL     ZTIPPL        PLATIP
     C* Código empleador
     C*MOVER PLACOD ZEMPPL
     C                   Z-ADD     ZEMPPL        PLACOD
     C* Período del empleador
     C*PASAR ZPER ZPERPL
     C                   MOVEL     ZPERPL        ZPER
     C* Encontró envío (INFAR4)
     C*CASO ZINDPL = '2'
     C     ZINDPL        WHENEQ    '2'
     C*MOVER ZCIEMP ZEMPPL
     C                   Z-ADD     ZEMPPL        ZCIEMP
     C*PASAR ZPER ZPERPL
     C                   MOVEL     ZPERPL        ZPER
     C* Tipo de planilla
     C*PASAR ZTIPLN ZTIPPL
     C                   MOVEL     ZTIPPL        ZTIPLN
     C*FINCASOS
     C                   ENDSL
     C*SI ZINDPL = '0' Y ZPER = *BLANCO
     C     ZINDPL        IFEQ      '0'
     C     ZPER          ANDEQ     *BLANK
     C*OBTENER (1) ZERROR = 'No se encontró información en el fondo orig
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(006)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Lee parámetros de configuración                             ==
     C*==                                                              ==
     C*==================================================================
     C     M00004        BEGSR
     C* Lee parámetros de conf.
     C*EJECUTAR M00016
     C                   EXSR      M00016
     C* Validar variables PORDIA y DOCDIA
     C*LIMPIAR ZDOCUM ZPORBT ZPORSB ZPORRE ZERROR
     C                   CLEAR                   ZDOCUM
     C                   CLEAR                   ZPORBT
     C                   CLEAR                   ZPORSB
     C                   CLEAR                   ZPORRE
     C                   CLEAR                   ZERROR
     C* Ejecutado desde acreditador
     C*PASAR ZPROAC '1'
     C                   MOVEL     '1'           ZPROAC
     C*LLAMAR TRCONF56 (ZDOCUM ZPORBT ZPORSB ZPORRE ZPROAC ZERROR)
     C                   CALL      'TRCONF56'
     C                   PARM                    ZDOCUM
     C                   PARM                    ZPORBT
     C                   PARM                    ZPORSB
     C                   PARM                    ZPORRE
     C                   PARM                    ZPROAC
     C                   PARM                    ZERROR
     C* Hubo error
     C*SI ZERROR <> *BLANCO
     C     ZERROR        IFNE      *BLANK
     C* Genera reporte
     C*EJECUTAR M00023
     C                   EXSR      M00023
     C*FIN
     C                   END
     C* Valida desarrollo especial requerimiento 10592 - Fusión PRO - IN
     C* Nombre del sistema
     C*PASAR ZNOMSI 'FUTURA'
     C                   CLEAR                   ZNOMSI
     C                   MOVEL     'FUTURA'      ZNOMSI
     C* Número de requerimiento
     C*MOVER ZNUMRE 10592
     C                   Z-ADD     10592         ZNUMRE
     C* Indica acceso a funcionalidad
     C*MOVER Z10592 *CERO
     C                   MOVE      *ZERO         Z10592
     C* Valida si desar espe ACTIVO
     C*LLAMAR TRVALI50(ZNOMSI ZNUMRE Z10592)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZNOMSI
     C                   PARM                    ZNUMRE
     C                   PARM                    Z10592
     C* Número del requerimiento
     C*MOVER ZNUMRE 9072
     C                   Z-ADD     9072          ZNUMRE
     C* Indicador autorización
     C*MOVER ZR9072 0
     C                   Z-ADD     0             ZR9072
     C* Valida autorización
     C*LLAMAR TRVALI50 (ZSISTE ZNUMRE ZR9072)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZSISTE
     C                   PARM                    ZNUMRE
     C                   PARM                    ZR9072
     C** Evaluar desarrollos especiales
     C* Nombre del sistema
     C*PASAR ZSISTE 'FUTURA'
     C                   CLEAR                   ZSISTE
     C                   MOVEL     'FUTURA'      ZSISTE
     C* Número del requerimiento
     C*MOVER ZNUMRE 7436
     C                   Z-ADD     7436          ZNUMRE
     C* Indicador autorización
     C*MOVER ZINDAU 0
     C                   Z-ADD     0             ZINDAU
     C* Valida autorización
     C*LLAMAR TRVALI50 (ZSISTE ZNUMRE ZINDAU)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZSISTE
     C                   PARM                    ZNUMRE
     C                   PARM                    ZINDAU
     C* Desarrollo inactivo
     C*SI ZINDAU = 0
     C     ZINDAU        IFEQ      0
     C* Req. 7436 no autorizado
     C*PASAR ZR7436 '0'
     C                   MOVEL     '0'           ZR7436
     C*SINO
     C                   ELSE
     C* Req. 7436 permitido
     C*PASAR ZR7436 '1'
     C                   MOVEL     '1'           ZR7436
     C*FIN
     C                   END
     C*
     C* Indicador autorizac. req.7421
     C*PASAR ZR7421 '1'
     C                   MOVEL     '1'           ZR7421
     C* Número del requerimiento
     C*MOVER ZNUMRE 7421
     C                   Z-ADD     7421          ZNUMRE
     C* Indicador autorización
     C*MOVER ZINDAU 0
     C                   Z-ADD     0             ZINDAU
     C* Valida autorización
     C*LLAMAR TRVALI50 (ZSISTE ZNUMRE ZINDAU)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZSISTE
     C                   PARM                    ZNUMRE
     C                   PARM                    ZINDAU
     C*SI ZINDAU = 0
     C     ZINDAU        IFEQ      0
     C* Req. 7421 no autorizado
     C*PASAR ZR7421 '0'
     C                   MOVEL     '0'           ZR7421
     C*FIN
     C                   END
     C*
     C*LIMPIAR ZI9120
     C                   CLEAR                   ZI9120
     C* Número de requerimiento
     C*MOVER ZNUMRE 9120
     C                   Z-ADD     9120          ZNUMRE
     C* Valida Des. Esp. 9120
     C*LLAMAR TRVALI50(ZSISTE ZNUMRE ZI9120)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZSISTE
     C                   PARM                    ZNUMRE
     C                   PARM                    ZI9120
     C*
     C* Número del requerimiento
     C*MOVER ZNUMRE 9601
     C                   Z-ADD     9601          ZNUMRE
     C* Indicador desarrollo especial
     C*MOVER ZR9601 0
     C                   Z-ADD     0             ZR9601
     C* Valida autorización
     C*LLAMAR TRVALI50 (ZSISTE ZNUMRE ZR9601)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZSISTE
     C                   PARM                    ZNUMRE
     C                   PARM                    ZR9601
     C*
     C* Número del requerimiento
     C*MOVER ZNUMRE 9072
     C                   Z-ADD     9072          ZNUMRE
     C* Indicador autorización
     C*MOVER ZR9072 0
     C                   Z-ADD     0             ZR9072
     C* Valida autorización
     C*LLAMAR TRVALI50 (ZSISTE ZNUMRE ZR9072)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZSISTE
     C                   PARM                    ZNUMRE
     C                   PARM                    ZR9072
     C*
     C* Número del requerimiento
     C*MOVER ZNUMRE 11433
     C                   Z-ADD     11433         ZNUMRE
     C* Indicador autorización
     C*MOVER Z11433 0
     C                   Z-ADD     0             Z11433
     C* Valida autorización
     C*LLAMAR TRVALI50 (ZSISTE ZNUMRE Z11433)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZSISTE
     C                   PARM                    ZNUMRE
     C                   PARM                    Z11433
     C* HISAR3
     C*PASAR ZENTID '9'
     C                   MOVEL     '9'           ZENTID
     C* Limpia var. de trabajo
     C*LIMPIAR ZALFA8 ZALFA5 ZINERE ZFITIP
     C                   CLEAR                   ZALFA8
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C                   CLEAR                   ZFITIP
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2 ZNUM21
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C                   CLEAR                   ZNUM21
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM12 ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM12
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C* Fecha del fondo
     C*PASAR HISFE3 ZALFA8
     C                   MOVEL     ZALFA8        HISFE3
     C* Fecha del fondo
     C*PASAR ZFEFON HISFE3
     C                   MOVEL     HISFE3        ZFEFON
     C* Cuotas de operación
     C*MOVER HISC28 ZNUM21
     C                   Z-ADD     ZNUM21        HISC28
     C                   ENDSR
     C*==================================================================
     C*==  Lee archivos para planillas diferentes a traspaso           ==
     C*==                                                              ==
     C*==================================================================
     C     M00005        BEGSR
     C* Calcula fecha límite de pago
     C*EJECUTAR M00015
     C                   EXSR      M00015
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Fecha inicio de la deuda
     C*PASAR ZFEIND ZFECHA
     C                   MOVEL     ZFECHA        ZFEIND
     C*MOVER ZDIAS1 1
     C                   Z-ADD     1             ZDIAS1
     C*FUNCION QSUMDI1 (ZFEIND ZDIAS1 ZFEIND)
     C                   CALL      'RPSUMDI1'                                   QSUMDI1
     C     ZFEIND        PARM      ZFEIND        F$4L1             8
     C     ZDIAS1        PARM      ZDIAS1        F$4L2             5 0
     C     ZFEIND        PARM      ZFEIND        F$4L3             8
     C* Sector salud
     C*SI PLATIP = '04'
     C     PLATIP        IFEQ      '04'
     C* Período
     C*PASAR ZPER1 ZPER
     C                   MOVEL     ZPER          ZPER1
     C* Traer % sector salud
     C*EJECUTAR M00002
     C                   EXSR      M00002
     C*SINO
     C                   ELSE
     C* Porcentaje de C.O.
     C*MOVER ZPCTCO ZHPPOR
     C                   Z-ADD     ZHPPOR        ZPCTCO
     C* Si no es planilla extraord.
     C*SI PLAT03 ]= '06'
     C     PLAT03        IFNE      '06'
     C* F.G.P.M
     C*MOVER ZPFGPM ZHPP49
     C                   Z-ADD     ZHPP49        ZPFGPM
     C* % com. cotiz. oblig.
     C*MOVER ZPCOCO ZHPPO1
     C                   Z-ADD     ZHPPO1        ZPCOCO
     C* % prima de seguro
     C*MOVER ZPORPS ZHPPO2
     C                   Z-ADD     ZHPPO2        ZPORPS
     C* D.E. fusión PRO
     C*SI Z10592 = 1 Y PLAPER < ZPEFUS
     C     Z10592        IFEQ      1
     C     PLAPER        ANDLT     ZPEFUS
     C* Ind. Planilla perído fusión
     C*PASAR ZPLFUS 'S'
     C                   MOVEL     'S'           ZPLFUS
     C*LLAMAR TRFEPL57 (PLANUM PLATIP PLAT03 ZPER ZPCOCO ZPORPS ZINDER)
     C                   CALL      'TRFEPL57'
     C                   PARM                    PLANUM
     C                   PARM                    PLATIP
     C                   PARM                    PLAT03
     C                   PARM                    ZPER
     C                   PARM                    ZPCOCO
     C                   PARM                    ZPORPS
     C                   PARM                    ZINDER
     C*SI ZINDER = '1'
     C     ZINDER        IFEQ      '1'
     C* Período de la planilla
     C*PASAR ZPERER ZPER
     C                   MOVEL     ZPER          ZPERER
     C* Período en formato pantalla
     C*F FPANPER (ZPERER)
     C                   CALL      'TRPANPER'                                   FPANPER
     C     ZPERER        PARM      ZPERER        F$0P1             6
     C*OBTENER (1) ZERROR = 'No existe histórico de parám. fusión PRO pe
     C                   CLEAR                   ZERROR
     C     $HIL(007)     CAT       ZPERER:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* No se deben calcular % prima seguros, ni % comisión c.o.
     C*LIMPIAR ZPCOCO ZPORPS
     C                   CLEAR                   ZPCOCO
     C                   CLEAR                   ZPORPS
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* % com. cotiz. volunt.
     C*MOVER ZPORCV ZHPPO3
     C                   Z-ADD     ZHPPO3        ZPORCV
     C* Porcentaje fondo solidaridad
     C*MOVER ZPCTFS ZHPPO4
     C                   Z-ADD     ZHPPO4        ZPCTFS
     C* % a distrib. de FS a SFS
     C*MOVER ZPDSFS ZHPP50
     C                   Z-ADD     ZHPP50        ZPDSFS
     C* Salario mínimo
     C*MOVER ZSALMI ZHPVA2
     C                   Z-ADD     ZHPVA2        ZSALMI
     C* Salario máximo de cotización
     C*CALCULAR (R) ZSALMA = ZHPVA2 * ZHPN24
     C     ZHPVA2        MULT(H)   ZHPN24        ZSALMA
     C* Salario para cotizar f.s.
     C*CALCULAR (R) ZSALFS = ZHPVA2 * ZHPN05
     C     ZHPVA2        MULT(H)   ZHPN05        ZSALFS
     C* Días del período
     C*MOVER ZDIAPE ZHPN26
     C                   Z-ADD     ZHPN26        ZDIAPE
     C* Delta inferior período
     C*MOVER ZDELIN ZHPDE1
     C                   Z-ADD     ZHPDE1        ZDELIN
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Leer archivos relacionados acred. deuda con p.e.            ==
     C*==                                                              ==
     C*==================================================================
     C     M00006        BEGSR
     C* HISAR3
     C*PASAR ZENTID '9'
     C                   MOVEL     '9'           ZENTID
     C* Limpia var. de trabajo
     C*LIMPIAR ZALFA8 ZALFA5 ZINERE ZFITIP
     C                   CLEAR                   ZALFA8
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C                   CLEAR                   ZFITIP
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2 ZNUM21
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C                   CLEAR                   ZNUM21
     C* Limpiar variables
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM12 ZALF15 ZALFA1
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM12
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* Limpiar variables
     C*LIMPIAR ZINPED
     C                   CLEAR                   ZINPED
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C* Limpiar interno empleador planilla
     C*LIMPIAR ZEMPLA
     C                   CLEAR                   ZEMPLA
     C* Fecha del fondo
     C*PASAR HISFE3 ZALFA8
     C                   MOVEL     ZALFA8        HISFE3
     C* Fecha del fondo
     C*PASAR ZFEFON HISFE3
     C                   MOVEL     HISFE3        ZFEFON
     C* Cuotas de operación
     C*MOVER HISC28 ZNUM21
     C                   Z-ADD     ZNUM21        HISC28
     C* Indicador de P.E por detalle
     C*PASAR ZINPED 'N'
     C                   MOVEL     'N'           ZINPED
     C* Ind. valorización P.E.E.
     C*SI ZINPEE = 'S'
     C     ZINPEE        IFEQ      'S'
     C* Fecha de fondo
     C*PASAR ZFECDE HISFE3
     C                   MOVEL     HISFE3        ZFECDE
     C*INICIARI INFAR402(ZPLNU1)
     C     ZPLNU1        SETLL     INFAR402                               74
     C     *IN74         IFEQ      '1'
     C                   MOVE      '0'           *IN74
     C                   ELSE
     C                   MOVE      '1'           *IN74
     C                   END
     C*SI ERE(INFAR402)
     C     *IN74         IFEQ      '0'
     C*LEER INFAR402
     C                   READ      INFAR402                               74
     C* Indicador de P.E por detalle
     C*PASAR ZINPED 'S'
     C                   MOVEL     'S'           ZINPED
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Pasar de alfa a numérico
     C*MOVER ZPLNU1 ZT@001
     C                   MOVE      ZT@001        ZPLNU1
     C* Ind. P.E. migrado
     C*PASAR ZINDMI '0'
     C                   MOVEL     '0'           ZINDMI
     C* Desarrollo especial fusión
     C*SI ZFUCDA = '1'
     C     ZFUCDA        IFEQ      '1'
     C*LLAMAR TRFPLA53 (DEUNUM ZINDPL ZTIPPL ZEMPPL ZPERPL ZFDEFO)
     C                   CALL      'TRFPLA53'
     C                   PARM                    DEUNUM
     C                   PARM                    ZINDPL
     C                   PARM                    ZTIPPL
     C                   PARM                    ZEMPPL
     C                   PARM                    ZPERPL
     C                   PARM                    ZFDEFO
     C*PASAR ZINDMI ZINDPL
     C                   MOVEL     ZINDPL        ZINDMI
     C*FIN
     C                   END
     C* Fusión HORIZ - COLP
     C*SI ZFUCHO = '1'
     C     ZFUCHO        IFEQ      '1'
     C* Busca SI P.E. migrado
     C*LLAMAR TRFPAE53 (ZINDMI ZPLNU1 ZPLAFO)
     C                   CALL      'TRFPAE53'
     C                   PARM                    ZINDMI
     C                   PARM                    ZPLNU1
     C                   PARM                    ZPLAFO
     C*FIN
     C                   END
     C* SI ES P.E. MIGRADO
     C*SI ZINDMI = '1'
     C     ZINDMI        IFEQ      '1'
     C* Desarrollo especial fusión
     C*CASO ZFUCDA = '1'
     C                   SELECT
     C     ZFUCDA        WHENEQ    '1'
     C* Fecha depósito F.O.
     C*PASAR ZFECDE ZFDEFO
     C                   MOVEL     ZFDEFO        ZFECDE
     C* Si fusión HORIZ - COLP
     C*CASO ZFUCHO = '1'
     C     ZFUCHO        WHENEQ    '1'
     C* Fecha depósito F.O.
     C*LLAMAR TRHPLA54 (ZPLAFO ZFECDE)
     C                   CALL      'TRHPLA54'
     C                   PARM                    ZPLAFO
     C                   PARM                    ZFECDE
     C*FINCASOS
     C                   ENDSL
     C*SINO
     C                   ELSE
     C* Recupera la fecha del dep.
     C*LLAMAR CALFECDE (ZPLNU1 ZFECDE)
     C                   CALL      'CALFECDE'
     C                   PARM                    ZPLNU1
     C                   PARM                    ZFECDE
     C*FIN
     C                   END
     C* Fecha del depósito PEE
     C*SI ZFECDE = *BLANCO
     C     ZFECDE        IFEQ      *BLANK
     C*INICIARI INFAR402(ZPLNU1)
     C     ZPLNU1        SETLL     INFAR402                               74
     C     *IN74         IFEQ      '1'
     C                   MOVE      '0'           *IN74
     C                   ELSE
     C                   MOVE      '1'           *IN74
     C                   END
     C*SI ERE(INFAR402)
     C     *IN74         IFEQ      '0'
     C*LEER INFAR402
     C                   READ      INFAR402                               74
     C* Indicador de P.E por detalle
     C*PASAR ZINPED 'S'
     C                   MOVEL     'S'           ZINPED
     C* Fecha depósito
     C*PASAR ZFECDE INFFE3
     C                   MOVEL     INFFE3        ZFECDE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Fecha del depósito PEE
     C*SI ZFECDE = *BLANCO
     C     ZFECDE        IFEQ      *BLANK
     C* DE activo
     C*SI Z10592 = 1
     C     Z10592        IFEQ      1
     C* Recupera fecha depósito
     C*EJECUTAR M80100
     C                   EXSR      M80100
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Fecha del depósito PEE
     C*SI ZFECDE = *BLANCO
     C     ZFECDE        IFEQ      *BLANK
     C*PASAR ZERROR  'No existe fecha de depósito a calcular'
     C                   MOVEL     $HIL(008)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Ultima fecha de depósito
     C*MOVER ZULFDE ZFECDE
     C                   MOVE      ZFECDE        ZULFDE
     C* Tipo de la deuda
     C*PASAR DEUTIP ZT@009
     C                   MOVEL     ZT@009        DEUTIP
     C* Planilla de la deuda
     C*MOVER DEUNUM ZT@003
     C                   MOVE      ZT@003        DEUNUM
     C* Las deudas de los empl.
     C*RECUPERARD (N) DEUARC (DEUTIP DEUNUM)
     C     LL$003        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C     LL$003        CHAIN     DEUARC                             5094
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Planilla del p.e.
     C*MOVER PAGNUM ZT@001
     C                   MOVE      ZT@001        PAGNUM
     C* Pagos en exceso
     C*RECUPERAR (N) PAGARC (PAGNUM)
     C     PAGNUM        CHAIN     PAGARC                             70
     C* Valor saldo P.E
     C*MOVER ZVALPE PAGSA3
     C                   Z-ADD     PAGSA3        ZVALPE
     C* Cuotas saldo P.E
     C*MOVER ZCUOPE PAGSA4
     C                   Z-ADD     PAGSA4        ZCUOPE
     C* Desarrollo especial fusión 10592
     C*SI Z10592 = 1
     C     Z10592        IFEQ      1
     C* Valida Pago en exceso Fusionado
     C*PASAR ZINDAR 2
     C                   MOVEL     2             ZINDAR
     C*LLAMAR TRFEQA50(PAGNUM DETPAG DETSEC PAGTI6 PAGEST PLANU4 PLAPER
     C                   CALL      'TRFEQA50'
     C                   PARM                    PAGNUM
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    PAGTI6
     C                   PARM                    PAGEST
     C                   PARM                    PLANU4
     C                   PARM                    PLAPER
     C                   PARM                    PLAFEC
     C                   PARM                    PAGEST
     C                   PARM                    ZINPAA
     C                   PARM                    ZINDAR
     C                   PARM                    ZINDE3
     C*FIN
     C                   END
     C*LIMPIAR $$PLAA $$INFA
     C                   CLEAR                   $$PLAA
     C                   CLEAR                   $$INFA
     C* Planillas de rec. de empl.
     C*INICIARI PLAARC04 (DEUNUM)
     C     DEUNUM        SETLL     PLAARC04                               74
     C     *IN74         IFEQ      '1'
     C                   MOVE      '0'           *IN74
     C                   ELSE
     C                   MOVE      '1'           *IN74
     C                   END
     C* Planillas de rec. de empl.
     C*SI ERE (PLAARC04)
     C     *IN74         IFEQ      '0'
     C* Recupera planilla disponibilidad
     C*RECUPERARD (N) PLAARC04 (DEUNUM)
     C     DEUNUM        CHAIN     PLAARC04                           7494
     C                   MOVE      *IN94         I$RND
     C* Registro disponible
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Período de la planilla
     C*PASAR ZPER PLAPER
     C                   MOVEL     PLAPER        ZPER
     C* Código interno empleador PLAARC
     C*MOVER ZEMPLA PLACOD
     C                   Z-ADD     PLACOD        ZEMPLA
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'PLAARC04 no disponible - M00006'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(009)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI Z10592 = 1
     C     Z10592        IFEQ      1
     C* Indicador de llenado PLAA55
     C*PASAR ZINFUS '1'
     C                   MOVEL     '1'           ZINFUS
     C*LIMPIAR $$PLAA $$INFA
     C                   CLEAR                   $$PLAA
     C                   CLEAR                   $$INFA
     C* Pgm de servicio
     C*LLAMAR TRFPLA01 (DEUNUM $$PLAA $$INFA ZINFUS)
     C                   CALL      'TRFPLA01'
     C                   PARM                    DEUNUM
     C                   PARM                    $$PLAA
     C                   PARM                    $$INFA
     C                   PARM                    ZINFUS
     C* Existe registro PLAA55
     C*SI ZLA113 <> *CERO
     C     ZLA113        IFNE      *ZERO
     C* Período de la planilla
     C*PASAR ZPER ZLAP29
     C                   MOVEL     ZLAP29        ZPER
     C* Tipo de planilla PLAA55
     C*PASAR PLATIP ZLA114
     C                   MOVEL     ZLA114        PLATIP
     C* Recupera Código interno de deuda
     C*EJECUTAR M00300
     C                   EXSR      M00300
     C* Código interno empleador PLAARC
     C*MOVER ZEMPLA ZLA117
     C                   Z-ADD     ZLA117        ZEMPLA
     C* Código interno empleador PLAA55
     C*MOVER PLACOD ZLA117
     C                   Z-ADD     ZLA117        PLACOD
     C*SINO
     C                   ELSE
     C*PASAR ZINEP5 '1'
     C                   MOVEL     '1'           ZINEP5
     C*FIN SI
     C                   END
     C*SINO
     C                   ELSE
     C* Si no es Fusión enciende indicador
     C*PASAR ZINEP5 '1'
     C                   MOVEL     '1'           ZINEP5
     C*FIN SI
     C                   END
     C*SI ZINEP5 <> *BLANCOS
     C     ZINEP5        IFNE      *BLANKS
     C* Indicador de envio otra AFP
     C*PASAR ZINOAF '1'
     C                   MOVEL     '1'           ZINOAF
     C* INFAR402
     C*PASAR ZENTID '4'
     C                   MOVEL     '4'           ZENTID
     C* Campo númerico de 12
     C*MOVER ZNUM12 DEUNUM
     C                   Z-ADD     DEUNUM        ZNUM12
     C* Limpia var. de trabajo
     C*LIMPIAR ZALFA8 ZALFA5 ZINERE ZFITIP
     C                   CLEAR                   ZALFA8
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C                   CLEAR                   ZFITIP
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM21 ZPEFIN  ZALF15 ZALFA1
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM21
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C* Valida ind. de existe o no
     C*SI ZINERE = '0'
     C     ZINERE        IFEQ      '0'
     C* Per. para cal. fecha lím.
     C*PASAR ZPER ZALFA8
     C                   MOVEL     ZALFA8        ZPER
     C* Cód. interno empleador
     C*MOVER ZCIEMP ZNUM12
     C                   Z-ADD     ZNUM12        ZCIEMP
     C* Código interno empleador INFAR4
     C*MOVER ZEMPLA ZCIEMP
     C                   Z-ADD     ZCIEMP        ZEMPLA
     C* Tipo de planilla
     C*PASAR ZTIPLN ZALFA5
     C                   MOVEL     ZALFA5        ZTIPLN
     C*SINO
     C                   ELSE
     C* Ind. des esp. fusión
     C*SI ZFUCDA = '1' O ZFUCHO = '1' O Z10592 = 1
     C     ZFUCDA        IFEQ      '1'
     C     ZFUCHO        OREQ      '1'
     C     Z10592        OREQ      1
     C* Verifica datos por fusión
     C*EJECUTAR M00003
     C                   EXSR      M00003
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN SI
     C                   END
     C*FIN
     C                   END
     C* Rec. histórico de par.
     C*EJECUTAR M00007
     C                   EXSR      M00007
     C* Val. número de página
     C*SI ZT@004 ]= *BLANCO
     C     ZT@004        IFNE      *BLANK
     C* Número de página deuda
     C*MOVER DETPA2 ZT@004
     C                   MOVE      ZT@004        DETPA2
     C* Secuencia deuda
     C*MOVER DETSE4 ZT@005
     C                   MOVE      ZT@005        DETSE4
     C*RECUPERAR DETAR2 (DEUTIP DEUNUM DETPA2 DETSE4)
     C     LL$004        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C                   KFLD                    DETPA2
     C                   KFLD                    DETSE4
     C     LL$004        CHAIN     DETAR2                             47
     C     *IN47         IFEQ      '1'
     C     *NOKEY        CLEAR                   DETRE1
     C                   END
     C*FIN
     C                   END
     C* Pl. deuda <> Pl. PEE
     C*SI DEUNUM ]= PAGNUM Y ZINPEE = 'S'
     C     DEUNUM        IFNE      PAGNUM
     C     ZINPEE        ANDEQ     'S'
     C* Saldo de PEE valorizado
     C*CALCULAR (R) Z$DHOY = PAGSA4 * HISC28
     C     PAGSA4        MULT(H)   HISC28        Z$DHOY
     C*SI Z10592 = 1 Y ZINDE3 = '1'
     C     Z10592        IFEQ      1
     C     ZINDE3        ANDEQ     '1'
     C* Consulta pago en exceso de fusión - PAGA22.
     C*EJECUTAR M00040
     C                   EXSR      M00040
     C*FIN SI
     C                   END
     C*SINO
     C                   ELSE
     C* Desarrollo Especial Fusion ING-Pro y Pago en exceso Fusionado
     C*SI Z10592 = 1 Y ZINDE3 = '1'
     C     Z10592        IFEQ      1
     C     ZINDE3        ANDEQ     '1'
     C* Consulta pago en exceso de fusión - PAGA22.
     C*EJECUTAR M00040
     C                   EXSR      M00040
     C*SI ZIPEFP = '1'
     C     ZIPEFP        IFEQ      '1'
     C* Valor P.E. PAGA22
     C*MOVER Z$DHOY ZAGS16
     C                   Z-ADD     ZAGS16        Z$DHOY
     C*SINO
     C                   ELSE
     C* Saldo PEE empleador
     C*MOVER Z$DHOY PAGSA3
     C                   Z-ADD     PAGSA3        Z$DHOY
     C*FIN SI
     C                   END
     C*SINO
     C                   ELSE
     C* Saldo PEE empleador
     C*MOVER Z$DHOY PAGSA3
     C                   Z-ADD     PAGSA3        Z$DHOY
     C*FIN SI
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DEUARC no disponible - M00006'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(010)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Recupera de histórico de parámetros                         ==
     C*==                                                              ==
     C*==================================================================
     C     M00007        BEGSR
     C* Período para HISAR6
     C*PASAR ZHPPE1 ZPER
     C                   MOVEL     ZPER          ZHPPE1
     C* Recupera Hisar6
     C*LLAMAR TRHPAR55($$REG1)
     C                   CALL      'TRHPAR55'
     C                   PARM                    $$REG1
     C*PASAR ZPLAAA DEUNUM
     C                   MOVEL     DEUNUM        ZPLAAA
     C* Parametros decreto 558
     C*EJECUTAR M98415
     C                   EXSR      M98415
     C* Indicador de error
     C*SI ZHPIND = '1'
     C     ZHPIND        IFEQ      '1'
     C* Período de la planilla
     C*PASAR ZPERER ZPER
     C                   MOVEL     ZPER          ZPERER
     C* Período en formato pantalla
     C*F FPANPER (ZPERER)
     C                   CALL      'TRPANPER'                                   FPANPER
     C     ZPERER        PARM      ZPERER        F$0P1             6
     C*OBTENER (1) ZERROR = 'No existe histórico de parámetros para el p
     C                   CLEAR                   ZERROR
     C     $HIL(011)     CAT       ZPERER:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* Sector salud
     C*SI PLATIP = '04'
     C     PLATIP        IFEQ      '04'
     C* Período de planilla
     C*PASAR ZPER1 ZPER
     C                   MOVEL     ZPER          ZPER1
     C* Traer % sector salud
     C*EJECUTAR M00002
     C                   EXSR      M00002
     C*SINO
     C                   ELSE
     C* Porcentaje de C.O.
     C*MOVER ZPCTCO ZHPPOR
     C                   Z-ADD     ZHPPOR        ZPCTCO
     C*FIN
     C                   END
     C* Porcentaje fondo solidaridad
     C*MOVER ZPCTFS ZHPPO4
     C                   Z-ADD     ZHPPO4        ZPCTFS
     C* % a distrib. de FS a SFS
     C*MOVER ZPDSFS ZHPP50
     C                   Z-ADD     ZHPP50        ZPDSFS
     C* Salario mínimo
     C*MOVER ZSALMI ZHPVA2
     C                   Z-ADD     ZHPVA2        ZSALMI
     C* Salario máximo de cotización
     C*CALCULAR (R) ZSALMA = ZHPVA2 * ZHPN24
     C     ZHPVA2        MULT(H)   ZHPN24        ZSALMA
     C* Salario para cotizar f.s.
     C*CALCULAR (R) ZSALFS = ZHPVA2 * ZHPN05
     C     ZHPVA2        MULT(H)   ZHPN05        ZSALFS
     C* Días del período
     C*MOVER ZDIAPE ZHPN26
     C                   Z-ADD     ZHPN26        ZDIAPE
     C* Período fecha depósito
     C*PASAR ZPERIO ZFECDE
     C                   MOVEL     ZFECDE        ZPERIO
     C* Período para HISAR6
     C*PASAR ZHPPE1 ZPERIO
     C                   MOVEL     ZPERIO        ZHPPE1
     C* Recupera Hisar6
     C*LLAMAR TRHPAR55($$REG1)
     C                   CALL      'TRHPAR55'
     C                   PARM                    $$REG1
     C*PASAR ZPLAAA PLANU1
     C                   MOVEL     PLANU1        ZPLAAA
     C* Parametros decreto 558
     C*EJECUTAR M98415
     C                   EXSR      M98415
     C* Indicador de error
     C*SI ZHPIND = '1'
     C     ZHPIND        IFEQ      '1'
     C* Período de la fecha depósito
     C*PASAR ZPERER ZPERIO
     C                   MOVEL     ZPERIO        ZPERER
     C* Período en formato pantalla
     C*F FPANPER (ZPERER)
     C                   CALL      'TRPANPER'                                   FPANPER
     C     ZPERER        PARM      ZPERER        F$0P1             6
     C*OBTENER (1) ZERROR = 'No existe histórico de parámetros para el p
     C                   CLEAR                   ZERROR
     C     $HIL(012)     CAT       ZPERER:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* Sector salud
     C*SI PLATIP = '04'
     C     PLATIP        IFEQ      '04'
     C* Período de planilla
     C*PASAR ZPER1 ZPERIO
     C                   MOVEL     ZPERIO        ZPER1
     C* Traer % sector salud
     C*EJECUTAR M00002
     C                   EXSR      M00002
     C*SINO
     C                   ELSE
     C* % com. cotiz. oblig.
     C*MOVER ZPCOCO ZHPPO1
     C                   Z-ADD     ZHPPO1        ZPCOCO
     C* % prima de seguro
     C*MOVER ZPORPS ZHPPO2
     C                   Z-ADD     ZHPPO2        ZPORPS
     C*SI Z10592 = 1 Y PLAPER < ZPEFUS       ** D.E. fusión PRO
     C* D.E. fusión PRO
     C*SI Z10592=1 Y PLAPER<ZPEFUS Y ZPERIO<ZPEFUS
     C     Z10592        IFEQ      1
     C     PLAPER        ANDLT     ZPEFUS
     C     ZPERIO        ANDLT     ZPEFUS
     C*PASAR ZPER ZPERIO
     C                   MOVEL     ZPERIO        ZPER
     C*LLAMAR TRFEPL57 (PLANUM PLATIP PLAT03 ZPER ZPCOCO ZPORPS ZINDER)
     C                   CALL      'TRFEPL57'
     C                   PARM                    PLANUM
     C                   PARM                    PLATIP
     C                   PARM                    PLAT03
     C                   PARM                    ZPER
     C                   PARM                    ZPCOCO
     C                   PARM                    ZPORPS
     C                   PARM                    ZINDER
     C*SI ZINDER = '1'
     C     ZINDER        IFEQ      '1'
     C* Período de la planilla
     C*PASAR ZPERER ZPER
     C                   MOVEL     ZPER          ZPERER
     C* Período en formato pantalla
     C*F FPANPER (ZPERER)
     C                   CALL      'TRPANPER'                                   FPANPER
     C     ZPERER        PARM      ZPERER        F$0P1             6
     C*OBTENER (1) ZERROR = 'No existe histórico de parám. fusión PRO pe
     C                   CLEAR                   ZERROR
     C     $HIL(013)     CAT       ZPERER:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* % com. cotiz. volunt.
     C*MOVER ZPORCV ZHPPO3
     C                   Z-ADD     ZHPPO3        ZPORCV
     C                   ENDSR
     C*==================================================================
     C*==  Recuperar parametros de configuración                       ==
     C*==                                                              ==
     C*==================================================================
     C     M00008        BEGSR
     C* Hoja I configuración
     C*LIMPIAR $$CONF
     C                   CLEAR                   $$CONF
     C* Recupera variables configuración
     C*LLAMAR TRCONF61 ($$CONF)
     C                   CALL      'TRCONF61'
     C                   PARM                    $$CONF
     C* CODHNS
     C*PASAR ZFONDO ZFONDX
     C                   MOVEL     ZFONDX        ZFONDO
     C* FECIN2
     C*MOVER ZTAINS ZTAINX
     C                   MOVE      ZTAINX        ZTAINS
     C* DE2616
     C*MOVER ZSEMAN ZSEMAX
     C                   MOVE      ZSEMAX        ZSEMAN
     C* DE2616
     C*MOVER ZDISE1 ZDIS1X
     C                   MOVE      ZDIS1X        ZDISE1
     C* DE2616
     C*MOVER ZDISE2 ZDIS2X
     C                   MOVE      ZDIS2X        ZDISE2
     C* DE2616
     C*MOVER ZDISE3 ZDIS3X
     C                   MOVE      ZDIS3X        ZDISE3
     C* DE2616
     C*MOVER ZDISE4 ZDIS4X
     C                   MOVE      ZDIS4X        ZDISE4
     C* RCONEM
     C*MOVER ZREGCE ZREGCX
     C                   MOVE      ZREGCX        ZREGCE
     C* DIAACR
     C*MOVER ZVARDI ZVARDX
     C                   MOVE      ZVARDX        ZVARDI
     C* CODHNS
     C*MOVER ZENTI1 ZENTIX
     C                   MOVE      ZENTIX        ZENTI1
     C* HISC28>HISAR3
     C*MOVER ZVCFFP ZVCFFX
     C                   MOVE      ZVCFFX        ZVCFFP
     C* SOLCTA
     C*MOVER ZINDSO ZINDSX
     C                   MOVE      ZINDSX        ZINDSO
     C* NUMPER
     C*MOVER ZNUMPE ZNUMPX
     C                   MOVE      ZNUMPX        ZNUMPE
     C* MESRAC
     C*MOVER INDMRA INDMRX
     C                   MOVE      INDMRX        INDMRA
     C* INDPAA
     C*MOVER ZINPAA ZINPAX
     C                   MOVE      ZINPAX        ZINPAA
     C* DELGTX
     C*MOVER ZDELTA ZDELTX
     C                   MOVE      ZDELTX        ZDELTA
     C* CODHNS
     C*MOVER ZCODFO ZENTI1
     C                   Z-ADD     ZENTI1        ZCODFO
     C* Existe error en las variables
     C*SI ZERROX<>*BLANCO
     C     ZERROX        IFNE      *BLANK
     C* Mensaje
     C*PASAR ZERROR ZERROX
     C                   MOVEL     ZERROX        ZERROR
     C* Debe terminar ejecución TRPLAN64
     C*SI ZSALIX='1'
     C     ZSALIX        IFEQ      '1'
     C* Imprimir error y terminar
     C*EJECUTAR M00023
     C                   EXSR      M00023
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Variable GENCON
     C*PASAR CONIDE 'GENCON'
     C                   MOVEL     'GENCON'      CONIDE
     C* Recupera GENCON
     C*RECUPERAR (N) CONARC (CONIDE CONID1)
     C     LL$005        KLIST
     C                   KFLD                    CONIDE
     C                   KFLD                    CONID1
     C     LL$005        CHAIN     CONARC                             44
     C* Encontró variable GENCON
     C*SI ERE (CONARC)
     C     *IN44         IFEQ      '0'
     C* Indicador crear contratos
     C*PASAR ZGNCON CONCAR
     C                   MOVEL     CONCAR        ZGNCON
     C*FIN
     C                   END
     C*
     C* FGPM FSP licencia no remunerada
     C*PASAR CONIDE 'FGFSLI'
     C                   MOVEL     'FGFSLI'      CONIDE
     C*LIMPIAR CONID1
     C                   CLEAR                   CONID1
     C* Configuración FGFSLI
     C*RECUPERAR (N) CONARC (CONIDE CONID1)
     C     LL$006        KLIST
     C                   KFLD                    CONIDE
     C                   KFLD                    CONID1
     C     LL$006        CHAIN     CONARC                             44
     C* Encontró configuración
     C*SI ERE (CONARC)
     C     *IN44         IFEQ      '0'
     C* Fecha desde nueva liq Lic(Req 12354)
     C*PASAR Z51 CONFEC
     C                   MOVEL     CONFEC        Z51
     C*FIN
     C                   END
     C* Delta PE negativos redondeo ctas
     C*CALCULAR ZCTPEE=2/(10000*10000)
     C     10000         MULT      10000         V$CA1           030 9
     C     2             DIV       V$CA1         ZCTPEE
     C*
     C* Nuevas fechas vigencia retención
     C*EJECUTAR M00190
     C                   EXSR      M00190
     C*
     C* FGPM FSP licencia no remunerada
     C*PASAR CONIDE 'INTPLO'
     C                   MOVEL     'INTPLO'      CONIDE
     C*LIMPIAR CONID1
     C                   CLEAR                   CONID1
     C* Configuración FGFSLI
     C*RECUPERAR (N) CONARC (CONIDE CONID1)
     C     LL$007        KLIST
     C                   KFLD                    CONIDE
     C                   KFLD                    CONID1
     C     LL$007        CHAIN     CONARC                             44
     C* Encontró configuración
     C*SI ERE (CONARC)
     C     *IN44         IFEQ      '0'
     C* Asigna valor de variable
     C*MOVER ZINPLO CONVA3
     C                   Z-ADD     CONVA3        ZINPLO
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Agregar registro a MOVARC                                   ==
     C*==                                                              ==
     C*==================================================================
     C     M00009        BEGSR
     C*LIMPIAR ZCONVE ZFDREC ZPLREC ZPAREC ZSEREC ZCOREC ZCIREC ZDIPAG Z
     C                   CLEAR                   ZCONVE
     C                   CLEAR                   ZFDREC
     C                   CLEAR                   ZPLREC
     C                   CLEAR                   ZPAREC
     C                   CLEAR                   ZSEREC
     C                   CLEAR                   ZCOREC
     C                   CLEAR                   ZCIREC
     C                   CLEAR                   ZDIPAG
     C                   CLEAR                   ZDIARE
     C                   CLEAR                   ZRECAL
     C                   CLEAR                   ZULTDE
     C                   CLEAR                   ZPLAFE
     C                   CLEAR                   ZZATIP
     C                   CLEAR                   ZZAT03
     C*SI ZT@002='3'
     C     ZT@002        IFEQ      '3'
     C*SI ZINSUM <> '1'
     C     ZINSUM        IFNE      '1'
     C*CALCULAR ZVLRRZ = REZCOT+REZCO1+REZCO2+REZCO4+REZVA1+REZINT+REZIN
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZVA1        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     V$CA1         ADD       REZIN9        V$CA1
     C     V$CA1         SUB       REZDEU        V$CA1
     C     V$CA1         ADD       REZVA3        ZVLRRZ
     C*CALCULAR ZCUORZ = REZCUO + REZCU2
     C     REZCUO        ADD       REZCU2        ZCUORZ
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*CALCULAR ZVLRRZ = ZVLRRZ - (ZZAFSP+ZVZFSP+ZVIFSP+ZVISUB)
     C     ZZAFSP        ADD       ZVZFSP        V$CA1           030 9
     C     V$CA1         ADD       ZVIFSP        V$CA1
     C     V$CA1         ADD       ZVISUB        V$CA1
     C     ZVLRRZ        SUB       V$CA1         ZVLRRZ
     C*CALCULAR ZCUORZ = ZCUORZ - (ZZUFSP+ZCSFSP+ZCIFSP+ZCISUB)
     C     ZZUFSP        ADD       ZCSFSP        V$CA1           030 9
     C     V$CA1         ADD       ZCIFSP        V$CA1
     C     V$CA1         ADD       ZCISUB        V$CA1
     C     ZCUORZ        SUB       V$CA1         ZCUORZ
     C*FIN
     C                   END
     C* Si se acredita más de un rezago
     C*SI ZCAREZ > 1
     C     ZCAREZ        IFGT      1
     C* Acumulado valor rezagos
     C*SUMAR ZVLRRZ ZVLRRA
     C                   ADD       ZVLRRZ        ZVLRRA
     C* Acumulado cuotas rezagos
     C*SUMAR ZCUORZ ZCUORA
     C                   ADD       ZCUORZ        ZCUORA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*CALCULAR ZVLRMV=(MOVCOT+MOVCOM+MOVVAL+MOVC24+MOVCO5+MOVCO6+MOVINT
     C     MOVCOT        ADD       MOVCOM        V$CA1           030 9
     C     V$CA1         ADD       MOVVAL        V$CA1
     C     V$CA1         ADD       MOVC24        V$CA1
     C     V$CA1         ADD       MOVCO5        V$CA1
     C     V$CA1         ADD       MOVCO6        V$CA1
     C     V$CA1         ADD       MOVINT        V$CA1
     C     V$CA1         ADD       MOVVA4        V$CA1
     C     V$CA1         ADD       MOVCO8        V$CA1
     C     V$CA1         ADD       MOVIN2        V$CA1
     C     V$CA1         ADD       MOVV12        V$CA1
     C     V$CA1         ADD       MOVI05        V$CA1
     C     V$CA1         ADD       MOVV13        V$CA1
     C     V$CA1         ADD       MOVI06        V$CA1
     C                   Z-ADD     V$CA1         ZVLRMV
     C*CALCULAR ZCUOMV=(MOVCUO+MOVCU2+MOVCU7+MOVC25+MOVCU3+MOVCU4+MOVCU6
     C     MOVCUO        ADD       MOVCU2        V$CA1           030 9
     C     V$CA1         ADD       MOVCU7        V$CA1
     C     V$CA1         ADD       MOVC25        V$CA1
     C     V$CA1         ADD       MOVCU3        V$CA1
     C     V$CA1         ADD       MOVCU4        V$CA1
     C     V$CA1         ADD       MOVCU6        V$CA1
     C     V$CA1         ADD       MOVC19        V$CA1
     C     V$CA1         ADD       MOVCU8        V$CA1
     C     V$CA1         ADD       MOVC16        V$CA1
     C     V$CA1         ADD       MOV056        V$CA1
     C     V$CA1         ADD       MOV057        V$CA1
     C     V$CA1         ADD       MOV058        V$CA1
     C     V$CA1         ADD       MOV059        V$CA1
     C                   Z-ADD     V$CA1         ZCUOMV
     C* Si se acredita más de un rezago
     C*SI ZCAREZ > 1 O K > 2
     C     ZCAREZ        IFGT      1
     C     K             ORGT      2
     C* Valor movimiento acumulado
     C*SUMAR ZVLRMV ZVLRMA
     C                   ADD       ZVLRMV        ZVLRMA
     C* Cuotas acumuladas movimientos
     C*SUMAR ZCUOMV ZCUOMA
     C                   ADD       ZCUOMV        ZCUOMA
     C*SINO
     C                   ELSE
     C* Valor movimiento acumulado
     C*MOVER ZVLRMA ZVLRMV
     C                   Z-ADD     ZVLRMV        ZVLRMA
     C* Cuotas acumuladas movimientos
     C*MOVER ZCUOMA ZCUOMV
     C                   Z-ADD     ZCUOMV        ZCUOMA
     C*FIN
     C                   END
     C*SI PLANU8=*CERO O ZINAPA = '1'
     C     PLANU8        IFEQ      *ZERO
     C     ZINAPA        OREQ      '1'
     C*PASAR ZINSUM '1'
     C                   MOVEL     '1'           ZINSUM
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Código fondo
     C*PASAR MOV148 ZFONDO
     C                   MOVEL     ZFONDO        MOV148
     C* Afiliado con ocupación decreto 2616
     C*SI ZI2616 = 'S'
     C     ZI2616        IFEQ      'S'
     C* Días detalle planilla <= días 1 sem
     C*CASO MOVNUM <= ZDISE1
     C                   SELECT
     C     MOVNUM        WHENLE    ZDISE1
     C* Días 1 semana completa
     C*MOVER ZCONVE ZDISE1
     C                   Z-ADD     ZDISE1        ZCONVE
     C* Días detalle planilla <= días 2 sem
     C*CASO MOVNUM <= ZDISE2
     C     MOVNUM        WHENLE    ZDISE2
     C* Días 2 semanas completas
     C*MOVER ZCONVE ZDISE2
     C                   Z-ADD     ZDISE2        ZCONVE
     C* Días detalle planilla <= días 3 sem
     C*CASO MOVNUM <= ZDISE3
     C     MOVNUM        WHENLE    ZDISE3
     C* Días 3 semanas completas
     C*MOVER ZCONVE ZDISE3
     C                   Z-ADD     ZDISE3        ZCONVE
     C* Días detalle planilla <= días 4 sem
     C*SINO
     C                   OTHER
     C* Días del mes
     C*MOVER ZCONVE ZHPN26
     C                   Z-ADD     ZHPN26        ZCONVE
     C*FINCASOS
     C                   ENDSL
     C* Días convertidos a semana completa
     C*MOVER MOVNUM ZCONVE
     C                   Z-ADD     ZCONVE        MOVNUM
     C*FIN
     C                   END
     C*LIMPIAR ZES3P
     C                   CLEAR                   ZES3P
     C*LLAMAR RPHDEC558A(PLANUM MOVPAG MOVSEC ZES3P)
     C                   MOVEL     'RPHDEC55'    H$L10            10
     C                   MOVE      '8A'          H$L10
     C                   CALL      H$L10
     C                   PARM                    PLANUM
     C                   PARM                    MOVPAG
     C                   PARM                    MOVSEC
     C                   PARM                    ZES3P
     C*SI ZES3P='S'
     C     ZES3P         IFEQ      'S'
     C*LIMPIAR MOVNUM MOVDIA
     C                   CLEAR                   MOVNUM
     C                   CLEAR                   MOVDIA
     C*FIN
     C                   END
     C*
     C*SI PLANU8 = *CERO Y ZT@002 <>'2' Y PLAT03 <> '02' O ZINAPA = '1'
     C     PLANU8        IFEQ      *ZERO
     C     ZT@002        ANDNE     '2'
     C     PLAT03        ANDNE     '02'
     C     ZINAPA        OREQ      '1'
     C*CALCULAR ZULTDE = K - L
     C     K             SUB       L             ZULTDE
     C*FIN
     C                   END
     C*
     C*SI PLANU8 <> *CERO Y ZINAPA = '0' O PLAT03='02' O ZT@002='2' O L
     C     PLANU8        IFNE      *ZERO
     C     ZINAPA        ANDEQ     '0'
     C     PLAT03        OREQ      '02'
     C     ZT@002        OREQ      '2'
     C     L             OREQ      1
     C* Consecutivo para FSP
     C*MOVER ZFSCON MOVCON
     C                   Z-ADD     MOVCON        ZFSCON
     C* Decreto 1858 para FSP
     C*EJECUTAR M01858
     C                   EXSR      M01858
     C*FIN
     C                   END
     C*
     C* Agregar registro
     C*AGREGAR MOVARC
     C                   WRITE     MOVREG                               94
     C                   MOVE      *IN94         I$DUP
     C* Si hay registro duplicado
     C*MIENTRAS DUP
     C     I$DUP         DOWEQ     '1'
     C* Sumar 1 al consecutivo
     C*SUMAR 1 MOVCON
     C                   ADD       1             MOVCON
     C* Adicionar registro
     C*AGREGAR MOVARC
     C                   WRITE     MOVREG                               94
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C* Plan Z actualizar RANA01 omisos a P
     C*SI ZTIPLP = 'Z'
     C     ZTIPLP        IFEQ      'Z'
     C*LIMPIAR ZPEORI
     C                   CLEAR                   ZPEORI
     C*SQL
     C/EXEC SQL
     C+  SELECT PLAPEO INTO :ZPEORI
     C+  FROM SBPLAA66 WHERE
     C+  PLA175 = :MOVNU2
     C/END-EXEC
     C* Periodo original
     C*SI ZPEORI = *BLANCOS
     C     ZPEORI        IFEQ      *BLANKS
     C*PASAR ZPEORI MOVPER
     C                   MOVEL     MOVPER        ZPEORI
     C*FIN
     C                   END
     C* Indicador acreditación
     C*PASAR ZLLPLZ 'A'
     C                   MOVEL     'A'           ZLLPLZ
     C*LLAMAR RPRPOM51 (MOVCO4 MOVCOD ZPEORI ZLLPLZ)
     C                   CALL      'RPRPOM51'
     C                   PARM                    MOVCO4
     C                   PARM                    MOVCOD
     C                   PARM                    ZPEORI
     C                   PARM                    ZLLPLZ
     C*FIN
     C                   END
     C*SI PLANU8=*CERO Y ZULTDE=1 O PLAT03='02' O ZT@002='2' O PLANU8<>*
     C     PLANU8        IFEQ      *ZERO
     C     ZULTDE        ANDEQ     1
     C     PLAT03        OREQ      '02'
     C     ZT@002        OREQ      '2'
     C     PLANU8        ORNE      *ZERO
     C     ZINAPA        ANDEQ     '0'
     C     PLANU8        ORNE      *ZERO
     C     ZINAPA        ANDEQ     '1'
     C     ZULTDE        ANDEQ     1
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C* Indicador acreditación
     C*PASAR ZLLFSP 'A'
     C                   MOVEL     'A'           ZLLFSP
     C*LLAMAR RPFSP1858 (ZLLFSP ZI1858 MOVNU2 MOV148 MOVPAG MOVSEC ZFSCO
     C                   MOVEL     'RPFSP185'    H$L10            10
     C                   MOVE      '8 '          H$L10
     C                   CALL      H$L10
     C                   PARM                    ZLLFSP
     C                   PARM                    ZI1858
     C                   PARM                    MOVNU2
     C                   PARM                    MOV148
     C                   PARM                    MOVPAG
     C                   PARM                    MOVSEC
     C                   PARM                    ZFSCON
     C                   PARM                    MOVCO4
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Ultimo interno guardado
     C*MOVER ZMVINT MOVCO4
     C                   Z-ADD     MOVCO4        ZMVINT
     C* ultimo consec guardado
     C*MOVER ZMVCNN MOVCON
     C                   Z-ADD     MOVCON        ZMVCNN
     C* Genere mod. historia laboral
     C*SI MOVCO4 <> 0
     C     MOVCO4        IFNE      0
     C* Acción a realizar
     C*PASAR ZMDACC 'A'
     C                   MOVEL     'A'           ZMDACC
     C* Código interno
     C*MOVER ZMDCO3 MOVCO4
     C                   Z-ADD     MOVCO4        ZMDCO3
     C* Tipo de identificación
     C*PASAR ZMDTI7 AFITI1
     C                   MOVEL     AFITI1        ZMDTI7
     C* Número de identificación
     C*MOVER ZMDNU7 AFIC01
     C                   Z-ADD     AFIC01        ZMDNU7
     C*LLAMAR TRMOHL50 ($$MOHL)
     C                   CALL      'TRMOHL50'
     C                   PARM                    $$MOHL
     C*FIN
     C                   END
     C* Limpia variables
     C*LIMPIAR ZVFGP2 ZCUFG2 ZVIFG2 ZCIFG2 ZCODI2
     C                   CLEAR                   ZVFGP2
     C                   CLEAR                   ZCUFG2
     C                   CLEAR                   ZVIFG2
     C                   CLEAR                   ZCIFG2
     C                   CLEAR                   ZCODI2
     C* Código interno afiliado
     C*MOVER ZCODI2 MOVCO4
     C                   Z-ADD     MOVCO4        ZCODI2
     C* Valor FGPM
     C*MOVER ZVFGP2 MOVV12
     C                   Z-ADD     MOVV12        ZVFGP2
     C* Cuotas FGPM
     C*MOVER ZCUFG2 MOV056
     C                   Z-ADD     MOV056        ZCUFG2
     C* Valor interes FGPM
     C*MOVER ZVIFG2 MOVI05
     C                   Z-ADD     MOVI05        ZVIFG2
     C* Cuotas FGPM
     C*MOVER ZCIFG2 MOV057
     C                   Z-ADD     MOV057        ZCIFG2
     C* Tipo llamado masivo
     C*SI ZTIPXX <> 'W' Y ZTLLAM <> 'X'
     C     ZTIPXX        IFNE      'W'
     C     ZTLLAM        ANDNE     'X'
     C*LLAMAR TRFGPA52 (ZCODI2 ZVFGP2 ZCUFG2 ZVIFG2 ZCIFG2)
     C                   CALL      'TRFGPA52'
     C                   PARM                    ZCODI2
     C                   PARM                    ZVFGP2
     C                   PARM                    ZCUFG2
     C                   PARM                    ZVIFG2
     C                   PARM                    ZCIFG2
     C*SINO
     C                   ELSE
     C*LLAMAR TRPLANB2(PLANUM ZCODI2 ZVFGP2 ZCUFG2 ZVIFG2 ZCIFG2)
     C                   CALL      'TRPLANB2'
     C                   PARM                    PLANUM
     C                   PARM                    ZCODI2
     C                   PARM                    ZVFGP2
     C                   PARM                    ZCUFG2
     C                   PARM                    ZVIFG2
     C                   PARM                    ZCIFG2
     C*FIN
     C                   END
     C*
     C*SI PLAFEC = *BLANCOS
     C     PLAFEC        IFEQ      *BLANKS
     C*SQL
     C/EXEC SQL
     C+  SELECT INFFE3 INTO :ZPLAFE
     C+  FROM SBINFAR4 WHERE
     C+  INFNU2 = :MOVNU2 AND
     C+  INFPAG = :MOVPAG AND
     C+  INFSE4 = :MOVSEC
     C/END-EXEC
     C*FIN
     C                   END
     C*
     C*PASAR ZZATIP PLATIP
     C                   MOVEL     PLATIP        ZZATIP
     C*PASAR ZZAT03 PLAT03
     C                   MOVEL     PLAT03        ZZAT03
     C*SI ZZATIP = *BLANCOS Y ZZAT03 = *BLANCOS Y MOVPLA <> *CEROS
     C     ZZATIP        IFEQ      *BLANKS
     C     ZZAT03        ANDEQ     *BLANKS
     C     MOVPLA        ANDNE     *ZEROS
     C*SQL
     C/EXEC SQL
     C+  SELECT PLATIP, PLAT03
     C+  INTO :ZZATIP, :ZZAT03
     C+  FROM PLAARC WHERE
     C+  PLANU1 = :MOVPLA
     C/END-EXEC
     C*FIN
     C                   END
     C* Recalculo de días pagados, se recalcula si fecha deposito es may
     C* fecha variable DIAREC o si la fecha es menor y está en RECA53
     C*SI Z14006 = 1
     C     Z14006        IFEQ      1
     C* Valida fec pago vs DIAREC y si existe en RECA53
     C*EJECUTAR M00014
     C                   EXSR      M00014
     C*FIN
     C                   END
     C*LIMPIAR $$REDH
     C                   CLEAR                   $$REDH
     C* tipo RD
     C*PASAR ZPRF 'RD'
     C                   MOVEL     'RD'          ZPRF
     C* Consultar RECA53
     C*PASAR ZACC53 'D'
     C                   MOVEL     'D'           ZACC53
     C* Planilla
     C*MOVER ZPLA53 MOVNU2
     C                   Z-ADD     MOVNU2        ZPLA53
     C* Pagina
     C*MOVER ZPAG53 MOVPAG
     C                   Z-ADD     MOVPAG        ZPAG53
     C* Secuencia
     C*MOVER ZSEC53 MOVSEC
     C                   Z-ADD     MOVSEC        ZSEC53
     C* Pgm servicio RECA53
     C*LLAMAR RPREDH50 ($$REDH)
     C                   CALL      'RPREDH50'
     C                   PARM                    $$REDH
     C*SI PLAFEC >= ZFEREC O PLAFEC < ZFEREC Y ZEXI53 = 'S' Y ZTIG53 <>'
     C     PLAFEC        IFGE      ZFEREC
     C     PLAFEC        ORLT      ZFEREC
     C     ZEXI53        ANDEQ     'S'
     C     ZTIG53        ANDNE     'P'
     C     ZPLAFE        ORGE      ZFEREC
     C*LLAMAR RPTPPF50(ZPRF ZTIPLP ZZATIP ZZAT03 ZEXITT)
     C                   CALL      'RPTPPF50'
     C                   PARM                    ZPRF
     C                   PARM                    ZTIPLP
     C                   PARM                    ZZATIP
     C                   PARM                    ZZAT03
     C                   PARM                    ZEXITT
     C*SI ZT@002='2' O ZZAT03='02' Y ZEXITT='S'
     C     ZT@002        IFEQ      '2'
     C     ZZAT03        OREQ      '02'
     C     ZEXITT        ANDEQ     'S'
     C*LIMPIAR ZEXITT ZLA180
     C                   CLEAR                   ZEXITT
     C                   CLEAR                   ZLA180
     C*SQL
     C/EXEC SQL
     C+  SELECT PLA180 INTO :ZLA180
     C+  FROM PLAA66 WHERE PLA175 = :MOVNU2
     C/END-EXEC
     C*SI SQLCOD <> 0
     C     SQLCOD        IFNE      0
     C*PASAR ZLA180 ' '
     C                   MOVEL     ' '           ZLA180
     C*FIN
     C                   END
     C* se corrobora que el tipo de planilla al cual le cancelan deuda t
     C*LLAMAR RPTPPF50(ZPRF ZLA180 MOVTI5 MOVT10 ZEXITT)
     C                   CALL      'RPTPPF50'
     C                   PARM                    ZPRF
     C                   PARM                    ZLA180
     C                   PARM                    MOVTI5
     C                   PARM                    MOVT10
     C                   PARM                    ZEXITT
     C*LIMPIAR ZFEPGG
     C                   CLEAR                   ZFEPGG
     C*SQL
     C/EXEC SQL
     C+  SELECT PLAFEC INTO :ZFEPGG
     C+  FROM PLAARC WHERE PLANU1=:MOVNU2
     C/END-EXEC
     C*SI ZFEPGG = *BLANCOS
     C     ZFEPGG        IFEQ      *BLANKS
     C*SQL
     C/EXEC SQL
     C+  SELECT INFFE3 INTO :ZFEPGG
     C+  FROM SBINFAR4 WHERE
     C+  INFNU2 = :MOVNU2 AND
     C+  INFPAG = :MOVPAG AND
     C+  INFSE4 = :MOVSEC
     C/END-EXEC
     C*FIN
     C                   END
     C*SI ZEXITT ='S' Y ZFEPGG<ZFEREC Y ZFEPGG<>' '
     C     ZEXITT        IFEQ      'S'
     C     ZFEPGG        ANDLT     ZFEREC
     C     ZFEPGG        ANDNE     ' '
     C*SI ZTIG53 <> 'A' Y ZTIG53 <> 'G'
     C     ZTIG53        IFNE      'A'
     C     ZTIG53        ANDNE     'G'
     C*LIMPIAR ZEXITT
     C                   CLEAR                   ZEXITT
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZEXITT='S'
     C     ZEXITT        IFEQ      'S'
     C*No dec 558, 2616, 376
     C*SI ZES3P<>'S' Y ZI2616<>'S' Y ZES13P<>'S'
     C     ZES3P         IFNE      'S'
     C     ZI2616        ANDNE     'S'
     C     ZES13P        ANDNE     'S'
     C* Fondo recalculo días
     C*PASAR ZFDREC MOV148
     C                   MOVEL     MOV148        ZFDREC
     C* Planilla recalculo días
     C*MOVER ZPLREC MOVNU2
     C                   Z-ADD     MOVNU2        ZPLREC
     C* Pagina recalculo días
     C*MOVER ZPAREC MOVPAG
     C                   Z-ADD     MOVPAG        ZPAREC
     C* Secuencia recalculo días
     C*MOVER ZSEREC MOVSEC
     C                   Z-ADD     MOVSEC        ZSEREC
     C* Consec. recalculo días
     C*MOVER ZCOREC MOVCON
     C                   Z-ADD     MOVCON        ZCOREC
     C* Cod int. recalculo días
     C*MOVER ZCIREC MOVCO4
     C                   Z-ADD     MOVCO4        ZCIREC
     C* Dias pagados aporte
     C*MOVER ZDIPAG *CERO
     C                   MOVE      *ZERO         ZDIPAG
     C* Dias reportados
     C*CALCULAR ZDIARE = MOVNUM + MOVDIA
     C     MOVNUM        ADD       MOVDIA        ZDIARE
     C* Si se concilió con más de un depósito se recalcula una vez
     C* después de haber procesado todos los depósitos
     C*SI PLANU8 = *CERO Y ZT@002 <>'2' Y PLAT03 <> '02' O ZINAPA = '1'
     C     PLANU8        IFEQ      *ZERO
     C     ZT@002        ANDNE     '2'
     C     PLAT03        ANDNE     '02'
     C     ZINAPA        OREQ      '1'
     C*CALCULAR ZULTDE = K - L
     C     K             SUB       L             ZULTDE
     C*MOVER ZCOREC ZCONMI
     C                   Z-ADD     ZCONMI        ZCOREC
     C*FIN
     C                   END
     C*SI PLANU8=*CERO Y ZULTDE=1 O PLAT03='02' O ZT@002='2' O PLANU8<>*
     C     PLANU8        IFEQ      *ZERO
     C     ZULTDE        ANDEQ     1
     C     PLAT03        OREQ      '02'
     C     ZT@002        OREQ      '2'
     C     PLANU8        ORNE      *ZERO
     C     ZINAPA        ANDEQ     '0'
     C     PLANU8        ORNE      *ZERO
     C     ZINAPA        ANDEQ     '1'
     C     ZULTDE        ANDEQ     1
     C* Libera MOVARC
     C*INICIAR MOVARC
     C     *LOVAL        SETLL     MOVARC                             67
     C* Libera DETARC
     C*GRABAR DETARC
     C     *IN49         IFEQ      '0'
     C                   UPDATE    DETREG                               94
     C                   ELSE
     C                   WRITE     DETREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*LLAMAR RPREDI50 (ZFDREC ZPLREC ZPAREC ZSEREC ZCOREC ZCIREC ZDIPAG
     C                   CALL      'RPREDI50'
     C                   PARM                    ZFDREC
     C                   PARM                    ZPLREC
     C                   PARM                    ZPAREC
     C                   PARM                    ZSEREC
     C                   PARM                    ZCOREC
     C                   PARM                    ZCIREC
     C                   PARM                    ZDIPAG
     C* Hay cambio de días
     C*SI ZDIARE <> ZDIPAG
     C     ZDIARE        IFNE      ZDIPAG
     C* Ind. recalculo
     C*PASAR ZRECAL '1'
     C                   MOVEL     '1'           ZRECAL
     C*FIN
     C                   END
     C*RECUPERAR DETARC (PLANU3 PLANUM ZPAREC ZSEREC)
     C     LL$008        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    ZPAREC
     C                   KFLD                    ZSEREC
     C     LL$008        CHAIN     DETARC                             49
     C     *IN49         IFEQ      '1'
     C     *NOKEY        CLEAR                   DETREG
     C                   END
     C*SI ZRECAL = '1'
     C     ZRECAL        IFEQ      '1'
     C*SI ZT@002 = '2' O PLAT03='02'
     C     ZT@002        IFEQ      '2'
     C     PLAT03        OREQ      '02'
     C* Periodo
     C*MOVER ZPERCO MOVPER
     C                   MOVE      MOVPER        ZPERCO
     C* Actualiza DIAAR1
     C*EJECUTAR M14075
     C                   EXSR      M14075
     C*GRABAR DETARC
     C     *IN49         IFEQ      '0'
     C                   UPDATE    DETREG                               94
     C                   ELSE
     C                   WRITE     DETREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI DETTI8='01' Y DETT44='03' Y DETI28='S' Y PLAT03='02' O DETTI8=
     C     DETTI8        IFEQ      '01'
     C     DETT44        ANDEQ     '03'
     C     DETI28        ANDEQ     'S'
     C     PLAT03        ANDEQ     '02'
     C     DETTI8        OREQ      '01'
     C     DETT44        ANDEQ     '03'
     C     DETI28        ANDEQ     'S'
     C     ZT@002        ANDEQ     '2'
     C* Actualiza DIAAR1
     C*EJECUTAR M14075
     C                   EXSR      M14075
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LIMPIAR ZCONMI
     C                   CLEAR                   ZCONMI
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI DETTI8='01' Y DETT44='03' Y DETI28='S' Y PLAT03='02' O DETTI8=
     C     DETTI8        IFEQ      '01'
     C     DETT44        ANDEQ     '03'
     C     DETI28        ANDEQ     'S'
     C     PLAT03        ANDEQ     '02'
     C     DETTI8        OREQ      '01'
     C     DETT44        ANDEQ     '03'
     C     DETI28        ANDEQ     'S'
     C     ZT@002        ANDEQ     '2'
     C* Actualiza DIAAR1
     C*EJECUTAR M14075
     C                   EXSR      M14075
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI DETTI8='01' Y DETT44='03' Y DETI28='S' Y PLAT03='02' O DETTI8=
     C     DETTI8        IFEQ      '01'
     C     DETT44        ANDEQ     '03'
     C     DETI28        ANDEQ     'S'
     C     PLAT03        ANDEQ     '02'
     C     DETTI8        OREQ      '01'
     C     DETT44        ANDEQ     '03'
     C     DETI28        ANDEQ     'S'
     C     ZT@002        ANDEQ     '2'
     C* Actualiza DIAAR1
     C*EJECUTAR M14075
     C                   EXSR      M14075
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LIMPIAR ZRECAL
     C                   CLEAR                   ZRECAL
     C                   ENDSR
     C*==================================================================
     C*==  Proceso principal acreditación por planilla                 ==
     C*==                                                              ==
     C*==================================================================
     C     M00010        BEGSR
     C* Planilla del proceso
     C*MOVER ZPLAPR PLANU1
     C                   Z-ADD     PLANU1        ZPLAPR
     C* Limpiar variables
     C*EJECUTAR M00050
     C                   EXSR      M00050
     C* Indicador de error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Leer entidades relacionadas
     C*EJECUTAR M00000
     C                   EXSR      M00000
     C* Indicador de error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*SI ZTPVAE |= '1' O ZTPVAE = '1' Y ZPROCJ = 'J' O ZTPVAE = '1' Y Z
     C     ZTPVAE        IFNE      '1'
     C     ZTPVAE        OREQ      '1'
     C     ZPROCJ        ANDEQ     'J'
     C     ZTPVAE        OREQ      '1'
     C     ZPROCJ        ANDNE     'J'
     C     ZTPVDF        ANDNE     *BLANKS
     C*PASAR ZRANDO PLANUM
     C                   MOVEL     PLANUM        ZRANDO
     C* Dependientes, independientes, voluntarios, terceros, sector salu
     C*SI PLATIP='01' O PLATIP='02' O PLATIP='03' O PLATIP='04' O PLATIP
     C     PLATIP        IFEQ      '01'
     C     PLATIP        OREQ      '02'
     C     PLATIP        OREQ      '03'
     C     PLATIP        OREQ      '04'
     C     PLATIP        OREQ      '07'
     C     PLATIP        OREQ      '08'
     C*
     C* Obtiene prefijo de lote
     C*FUNCION QSUBSTR (PLANU3 1 4 ZPLOTE)
     C                   CALL      'F160SNAP'                                   QSUBSTR
     C     PLANU3        PARM      PLANU3        F$4H1           240
     C                   PARM      1             F$4H2             4 0
     C                   PARM      4             F$4H3             4 0
     C     ZPLOTE        PARM      ZPLOTE        F$4H4           240
     C*CASO PLATIP='01' Y ZPORLR<>*CERO Y ZPLOTE='PLIC'
     C                   SELECT
     C     PLATIP        WHENEQ    '01'
     C     ZPORLR        ANDNE     *ZERO
     C     ZPLOTE        ANDEQ     'PLIC'
     C* Planilla dependiente, existe % de licencia y lote de licencia
     C* IND. tipo plan. para gen. P.E
     C*PASAR ZINPLA '0'
     C                   MOVEL     '0'           ZINPLA
     C* Procesa planilla declaración
     C*EJECUTAR M40000
     C                   EXSR      M40000
     C*CASO PLAT03='01' O PLAT03='04' O PLAT03='05' O PLAT03='07' O PLAT
     C     PLAT03        WHENEQ    '01'
     C     PLAT03        OREQ      '04'
     C     PLAT03        OREQ      '05'
     C     PLAT03        OREQ      '07'
     C     PLAT03        OREQ      '08'
     C     PLAT03        OREQ      '09'
     C     PLAT03        OREQ      '11'
     C     PLAT03        OREQ      '12'
     C     PLAT03        OREQ      '13'
     C     PLAT03        OREQ      '14'
     C* Tipo de pago normal, situados, contratante o agremiación
     C*SI PLATIP='04' Y PLAT03='11'
     C     PLATIP        IFEQ      '04'
     C     PLAT03        ANDEQ     '11'
     C* Desarrollo especial no activo
     C*SI ZI9120 = *CERO
     C     ZI9120        IFEQ      *ZERO
     C* Ind. tipo plan. para gen. P.E
     C*PASAR ZINPLA '1'
     C                   MOVEL     '1'           ZINPLA
     C* Procesa planilla normal
     C*EJECUTAR M10000
     C                   EXSR      M10000
     C*SINO
     C                   ELSE
     C* No hay depósito para planilla
     C*LIMPIAR ZSIDEP
     C                   CLEAR                   ZSIDEP
     C* Si no # depósitos ir a CONAR2
     C*SI PLANU9 = *CERO
     C     PLANU9        IFEQ      *ZERO
     C* Verifica conciliac.dep.
     C*INICIARI CONAR2 (PLANU3 PLANUM)
     C     LL$009        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$009        SETLL     CONAR2                                 40
     C     *IN40         IFEQ      '1'
     C                   MOVE      '0'           *IN40
     C                   ELSE
     C                   MOVE      '1'           *IN40
     C                   END
     C* Encontró registro conciliación
     C*SI ERE (CONAR2)
     C     *IN40         IFEQ      '0'
     C* Encontró depósito conciliado
     C*MOVER ZSIDEP 1
     C                   Z-ADD     1             ZSIDEP
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Lee depósitos
     C*RECUPERARD DEPAR3 (PLANU8 PLANU9 PLACON)
     C     LL$010        KLIST
     C                   KFLD                    PLANU8
     C                   KFLD                    PLANU9
     C                   KFLD                    PLACON
     C     LL$010        CHAIN     DEPAR3                             4694
     C                   MOVE      *IN94         I$RND
     C     *IN46         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   DEPRE2
     C                   END
     C* Encontró depósito
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Encontró depósito asociado
     C*MOVER ZSIDEP 1
     C                   Z-ADD     1             ZSIDEP
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DEPAR3 no disponible - M00010'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(014)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Hay depósito,acreditar normal
     C*SI ZSIDEP = 1
     C     ZSIDEP        IFEQ      1
     C* Ind. tipo plan. para gen. P.E
     C*PASAR ZINPLA '1'
     C                   MOVEL     '1'           ZINPLA
     C* Procesa planilla normal
     C*EJECUTAR M10000
     C                   EXSR      M10000
     C* No depósito, acreditar decl-no pago
     C*SINO
     C                   ELSE
     C* Ind. tipo plan. para gen. P.E
     C*PASAR ZINPLA '0'
     C                   MOVEL     '0'           ZINPLA
     C* Procesa planilla declaración
     C*EJECUTAR M40000
     C                   EXSR      M40000
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Ind. tipo plan. para gen. P.E
     C*PASAR ZINPLA '1'
     C                   MOVEL     '1'           ZINPLA
     C* Procesa planilla normal
     C*EJECUTAR M10000
     C                   EXSR      M10000
     C*FIN
     C                   END
     C* Tipo pago cancelación deuda
     C*CASO PLAT03='02' O PLAT03='10'
     C     PLAT03        WHENEQ    '02'
     C     PLAT03        OREQ      '10'
     C* Ind. tipo plan. para gen. P.E
     C*PASAR ZINPLA '0'
     C                   MOVEL     '0'           ZINPLA
     C* Procesa planilla cancelación
     C*EJECUTAR M20000
     C                   EXSR      M20000
     C* Tipo pago declaración y no p.
     C*CASO PLAT03='03'
     C     PLAT03        WHENEQ    '03'
     C* Ind. tipo plan. para gen. P.E
     C*PASAR ZINPLA '0'
     C                   MOVEL     '0'           ZINPLA
     C* Procesa planilla declaración
     C*EJECUTAR M40000
     C                   EXSR      M40000
     C* Tipo de pago extraordinario
     C*CASO PLAT03='06'
     C     PLAT03        WHENEQ    '06'
     C* IND. tipo plan. para gen. P.E
     C*PASAR ZINPLA '0'
     C                   MOVEL     '0'           ZINPLA
     C* Procesa planilla extraordinar
     C*EJECUTAR M30000
     C                   EXSR      M30000
     C*FINCASOS
     C                   ENDSL
     C*SINO
     C                   ELSE
     C* Ind. tipo plan. para gen. P.E
     C*PASAR ZINPLA '0'
     C                   MOVEL     '0'           ZINPLA
     C* Planilla de traspaso entrada
     C*SI PLATIP='05'
     C     PLATIP        IFEQ      '05'
     C* Procesa planilla de traspaso
     C*EJECUTAR M50000
     C                   EXSR      M50000
     C* Planilla aportes cajas
     C*SINO
     C                   ELSE
     C* Procesa planilla extraordinar
     C*EJECUTAR M30000
     C                   EXSR      M30000
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Actualizar lote de planillas
     C*EJECUTAR M00030
     C                   EXSR      M00030
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Limpia archivo temporal que se utiliza para la liquidación de in
     C* en planillas de terceros.
     C*
     C*SI ZTIPXX<>'W' Y ZTLLAM<>'X'
     C     ZTIPXX        IFNE      'W'
     C     ZTLLAM        ANDNE     'X'
     C*SQL
     C/EXEC SQL
     C+  DELETE FROM DETA31 WHERE DETLOT = :PLANU3 AND DETPL8 = :PLANUM
     C/END-EXEC
     C*FIN
     C                   END
     C*
     C* Hay error
     C*SI ZSALIR = '1'
     C     ZSALIR        IFEQ      '1'
     C* Total planillas erradas
     C*SUMAR 1 ZTPLAE
     C                   ADD       1             ZTPLAE
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C* Rollback
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C* Bloqueada acreditación por no cubrir intereses o es masivo
     C*SI ZCOI='1' O ZTIPXX='W' O ZTLLAM='X'
     C     ZCOI          IFEQ      '1'
     C     ZTIPXX        OREQ      'W'
     C     ZTLLAM        OREQ      'X'
     C* Hubo error por cálculo intereses
     C*SI ZCOI='1'
     C     ZCOI          IFEQ      '1'
     C* Bloqueo por intereses
     C*PASAR ZESTA 'COI'
     C                   MOVEL     'COI'         ZESTA
     C*SINO
     C                   ELSE
     C* Bloqueo por error en acred. masiva
     C*PASAR ZESTA 'COP'
     C                   MOVEL     'COP'         ZESTA
     C*FIN
     C                   END
     C*RECUPERARD PLAARC (PLANU3 PLANUM)
     C     LL$011        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$011        CHAIN     PLAARC                             7394
     C                   MOVE      *IN94         I$RND
     C     *IN73         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   PLAREG
     C                   END
     C* Registro disponible
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Bloqueada acreditación Int/Masivo
     C*ASIGNAR PLAEST ZESTA
     C                   MOVEL     ZESTA         PLAEST
     C* Usuario última modificación
     C*ASIGNAR PLAUSU USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        PLAUSU
     C* Fecha última modificación
     C*ASIGNAR PLAFE1 ZFESIS
     C                   MOVEL     ZFESIS        PLAFE1
     C* Modifica registro
     C*GRABAR PLAARC
     C     *IN73         IFEQ      '0'
     C                   UPDATE    PLAREG                               94
     C                   ELSE
     C                   WRITE     PLAREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'PLAARC no disponible - M00010'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(015)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* Simulación de planillas
     C*SI ZSIMUL <> 'S'
     C     ZSIMUL        IFNE      'S'
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C*COMPLETAR
     C     PLANUM        COMMIT                                         94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Valida si afilido del detalle es fusionado y trae % de HI0  ==
     C*==                                                              ==
     C*==================================================================
     C     M00011        BEGSR
     C*LIMPIAR ZPCOCO ZPORPS ZDETFU
     C                   CLEAR                   ZPCOCO
     C                   CLEAR                   ZPORPS
     C                   CLEAR                   ZDETFU
     C*SI ZDET65 = 'D'
     C     ZDET65        IFEQ      'D'
     C*SQL
     C/EXEC SQL
     C+  SELECT COALESCE(DET407, ' ') INTO :ZDETFU
     C+  FROM DETA65
     C+  WHERE DET404 = :DETNU9
     C+  AND DETP18 = :DETPA2 AND DET406 = :DETSE4
     C/END-EXEC
     C*SINO
     C                   ELSE
     C*SQL
     C/EXEC SQL
     C+  SELECT COALESCE(DET407, ' ') INTO :ZDETFU
     C+  FROM DETA65
     C+  WHERE DET404 = :PLANU1
     C+  AND DETP18 = :DETPAG AND DET406 = :DETSEC
     C/END-EXEC
     C*FIN
     C                   END
     C*SI ZDETFU = 'S' Y ZPER < ZPEFUS
     C     ZDETFU        IFEQ      'S'
     C     ZPER          ANDLT     ZPEFUS
     C*SI ZDET65 = 'D'
     C     ZDET65        IFEQ      'D'
     C*LLAMAR TRFEPL57 (DETNU9 DETTI8 DETT44 DETPER ZPCOCO ZPORPS ZINDER
     C                   CALL      'TRFEPL57'
     C                   PARM                    DETNU9
     C                   PARM                    DETTI8
     C                   PARM                    DETT44
     C                   PARM                    DETPER
     C                   PARM                    ZPCOCO
     C                   PARM                    ZPORPS
     C                   PARM                    ZINDER
     C*SINO
     C                   ELSE
     C*LLAMAR TRFEPL57 (PLANUM PLATIP PLAT03 ZPER ZPCOCO ZPORPS ZINDER)
     C                   CALL      'TRFEPL57'
     C                   PARM                    PLANUM
     C                   PARM                    PLATIP
     C                   PARM                    PLAT03
     C                   PARM                    ZPER
     C                   PARM                    ZPCOCO
     C                   PARM                    ZPORPS
     C                   PARM                    ZINDER
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI PLATIP = '04'
     C     PLATIP        IFEQ      '04'
     C*SI ZDET65 = 'D'
     C     ZDET65        IFEQ      'D'
     C* Situado normal o retroactivo
     C*SI DEUT01 = '04' O DEUT01 = '11'
     C     DEUT01        IFEQ      '04'
     C     DEUT01        OREQ      '11'
     C* Comisión situados
     C*MOVER ZPCOCO ZCOMSI
     C                   Z-ADD     ZCOMSI        ZPCOCO
     C* Prima situados
     C*MOVER ZPORPS ZPRISI
     C                   Z-ADD     ZPRISI        ZPORPS
     C*SINO
     C                   ELSE
     C* Comisión hospital
     C*MOVER ZPCOCO ZCOMHO
     C                   Z-ADD     ZCOMHO        ZPCOCO
     C* Prima hospital
     C*MOVER ZPORPS ZPRIHO
     C                   Z-ADD     ZPRIHO        ZPORPS
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Situado normal o retroactivo
     C*SI PLAT03 = '04' O PLAT03 = '11'
     C     PLAT03        IFEQ      '04'
     C     PLAT03        OREQ      '11'
     C* Comisión situados
     C*MOVER ZPCOCO ZCOMSI
     C                   Z-ADD     ZCOMSI        ZPCOCO
     C* Prima situados
     C*MOVER ZPORPS ZPRISI
     C                   Z-ADD     ZPRISI        ZPORPS
     C*SINO
     C                   ELSE
     C* Comisión hospital
     C*MOVER ZPCOCO ZCOMHO
     C                   Z-ADD     ZCOMHO        ZPCOCO
     C* Prima hospital
     C*MOVER ZPORPS ZPRIHO
     C                   Z-ADD     ZPRIHO        ZPORPS
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Comisión
     C*MOVER ZPCOCO ZHPPO1
     C                   Z-ADD     ZHPPO1        ZPCOCO
     C* Prima
     C*MOVER ZPORPS ZHPPO2
     C                   Z-ADD     ZHPPO2        ZPORPS
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Si no es planilla extraord.
     C*SI PLAT03 = '06'
     C     PLAT03        IFEQ      '06'
     C* No se deben calcular % prima seguros, ni % comisión c.o.
     C*LIMPIAR ZPORPS
     C                   CLEAR                   ZPORPS
     C*SI ZTIPLP <> 'Z'
     C     ZTIPLP        IFNE      'Z'
     C*LIMPIAR ZPCOCO
     C                   CLEAR                   ZPCOCO
     C*SINO
     C                   ELSE
     C* Plan Z tomar porc comision Z
     C*MOVER ZPCOCO ZISP60
     C                   Z-ADD     ZISP60        ZPCOCO
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza P.E por detalle de n.V                            ==
     C*==                                                              ==
     C*==================================================================
     C     M00012        BEGSR
     C* Si es p.E de N.V
     C*SI ZINPED = 'S'
     C     ZINPED        IFEQ      'S'
     C* Act. PAGA28
     C*LLAMAR TRPANV50(PAGNUM ZVALPE ZCUOPE PAGSA3 PAGSA4)
     C                   CALL      'TRPANV50'
     C                   PARM                    PAGNUM
     C                   PARM                    ZVALPE
     C                   PARM                    ZCUOPE
     C                   PARM                    PAGSA3
     C                   PARM                    PAGSA4
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcula última fecha de depósito                            ==
     C*==                                                              ==
     C*==================================================================
     C     M00013        BEGSR
     C* Conciliación con un depósito
     C*SI PLANU8 |= *CERO
     C     PLANU8        IFNE      *ZERO
     C*RECUPERARD (N) DEPAR3 (PLANU8 PLANU9 PLACON)
     C     LL$012        KLIST
     C                   KFLD                    PLANU8
     C                   KFLD                    PLANU9
     C                   KFLD                    PLACON
     C     LL$012        CHAIN     DEPAR3                             4694
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SI Z10592 = 1 Y DEPVA2 != *CEROS Y DEPFE5 != *CEROS
     C     Z10592        IFEQ      1
     C     DEPVA2        ANDNE     *ZEROS
     C     DEPFE5        ANDNE     *ZEROS
     C* Período de la fecha depósito
     C*PASAR ZPERIO DEPFE5
     C                   MOVEL     DEPFE5        ZPERIO
     C* Última fecha de depósito
     C*PASAR ZULFDE DEPFE5
     C                   MOVEL     DEPFE5        ZULFDE
     C*SINO
     C                   ELSE
     C* Período de la fecha depósito
     C*PASAR ZPERIO DEPFEC
     C                   MOVEL     DEPFEC        ZPERIO
     C* Última fecha de depósito
     C*PASAR ZULFDE DEPFEC
     C                   MOVEL     DEPFEC        ZULFDE
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DEPAR3 no disponible - M00013'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(016)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Tipo de conciliación normal
     C*LIMPIAR CONTI3
     C                   CLEAR                   CONTI3
     C*INICIARUI CONAR202 (PLANU3 PLANUM CONTI3)
     C     LL$013        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    CONTI3
     C     LL$013        SETLL     CONAR202                               41
     C     *IN41         IFEQ      '1'
     C     LL$013        SETGT     CONAR202                           41
     C                   MOVE      '0'           *IN41
     C                   ELSE
     C                   MOVE      '1'           *IN41
     C                   END
     C*SI ERE (CONAR202)
     C     *IN41         IFEQ      '0'
     C*LEEANT CONAR202
     C                   READP     CONAR202                               41
     C*FIN
     C                   END
     C* Período de la fecha depósito
     C*PASAR ZPERIO CONFE7
     C                   MOVEL     CONFE7        ZPERIO
     C* Última fecha de depósito
     C*PASAR ZULFDE CONFE7
     C                   MOVEL     CONFE7        ZULFDE
     C*SI ZULFDE = *BLANCO
     C     ZULFDE        IFEQ      *BLANK
     C* TIPO DE CONCILIACIÓN NORMA
     C*PASAR CONTI3  '5'
     C                   MOVEL     '5'           CONTI3
     C*INICIARUI CONAR202 (PLANU3 PLANUM CONTI3)
     C     LL$014        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    CONTI3
     C     LL$014        SETLL     CONAR202                               41
     C     *IN41         IFEQ      '1'
     C     LL$014        SETGT     CONAR202                           41
     C                   MOVE      '0'           *IN41
     C                   ELSE
     C                   MOVE      '1'           *IN41
     C                   END
     C*SI ERE (CONAR202)
     C     *IN41         IFEQ      '0'
     C*LEEANT CONAR202
     C                   READP     CONAR202                               41
     C*FIN
     C                   END
     C* PERÍODO DE LA FECHA DEPÓSIT
     C*PASAR ZPERIO CONFE7
     C                   MOVEL     CONFE7        ZPERIO
     C* ÚLTIMA FECHA DE DEPÓSITO
     C*PASAR ZULFDE CONFE7
     C                   MOVEL     CONFE7        ZULFDE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZPER = *BLANCO
     C     ZPER          IFEQ      *BLANK
     C* Período fecha del pago
     C*PASAR ZPER PLAFEC
     C                   MOVEL     PLAFEC        ZPER
     C*FIN
     C                   END
     C* Período para HISAR6
     C*PASAR ZHPPE1 ZPER
     C                   MOVEL     ZPER          ZHPPE1
     C* Recupera Hisar6
     C*LLAMAR TRHPAR55($$REG1)
     C                   CALL      'TRHPAR55'
     C                   PARM                    $$REG1
     C* Indicador de error
     C*SI ZHPIND = '1'
     C     ZHPIND        IFEQ      '1'
     C* Período de la planilla
     C*PASAR ZPERER ZPERIO
     C                   MOVEL     ZPERIO        ZPERER
     C* Período en formato pantalla
     C*F FPANPER (ZPERER)
     C                   CALL      'TRPANPER'                                   FPANPER
     C     ZPERER        PARM      ZPERER        F$0P1             6
     C*OBTENER (1) ZERROR = 'No existe histórico de parámetros para el p
     C                   CLEAR                   ZERROR
     C     $HIL(017)     CAT       ZPERER:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*PASAR ZPLAAA PLANU1
     C                   MOVEL     PLANU1        ZPLAAA
     C* Parametros decreto 558
     C*EJECUTAR M98415
     C                   EXSR      M98415
     C* % a distrib. de FS a SFS
     C*MOVER ZPDSFS ZHPP50
     C                   Z-ADD     ZHPP50        ZPDSFS
     C                   ENDSR
     C*==================================================================
     C*==  Valida fec pago vs DIAREC y si existe en RECA53             ==
     C*==                                                              ==
     C*==================================================================
     C     M00014        BEGSR
     C*
     C* fecha pago menor a fecha DIAREC
     C*SI MOVFEC < ZFEREC
     C     MOVFEC        IFLT      ZFEREC
     C* Planilla
     C*MOVER ZPLA53 MOVNU2
     C                   Z-ADD     MOVNU2        ZPLA53
     C* Página
     C*MOVER ZPAG53 MOVPAG
     C                   Z-ADD     MOVPAG        ZPAG53
     C* Secuencia
     C*MOVER ZSEC53 MOVSEC
     C                   Z-ADD     MOVSEC        ZSEC53
     C* Código interno
     C*MOVER ZAFINU MOVCO4
     C                   Z-ADD     MOVCO4        ZAFINU
     C*SQL
     C/EXEC SQL
     C+  SELECT MOVEST INTO :ZESTPL
     C+  FROM MOVARC
     C+  WHERE MOVNU2 = :ZPLA53
     C+  AND MOVPAG = :ZPAG53
     C+  AND MOVSEC = :ZSEC53
     C+  AND MOVCO4 = :ZAFINU
     C+  AND MOVCO1 = '02'
     C+  FETCH FIRST 1 ROWS ONLY
     C/END-EXEC
     C*SI SQLCOD = 0  Y ZESTPL = 'R'
     C     SQLCOD        IFEQ      0
     C     ZESTPL        ANDEQ     'R'
     C*LIMPIAR ZPLA53 ZPAG53 ZSEC53 ZAFINU ZESTPL
     C                   CLEAR                   ZPLA53
     C                   CLEAR                   ZPAG53
     C                   CLEAR                   ZSEC53
     C                   CLEAR                   ZAFINU
     C                   CLEAR                   ZESTPL
     C*SINO
     C                   ELSE
     C* Fondo
     C*PASAR ZFON53 MOV148
     C                   MOVEL     MOV148        ZFON53
     C* Planilla
     C*MOVER ZPLA53 MOVNU2
     C                   Z-ADD     MOVNU2        ZPLA53
     C* Página
     C*MOVER ZPAG53 MOVPAG
     C                   Z-ADD     MOVPAG        ZPAG53
     C* Secuencia
     C*MOVER ZSEC53 MOVSEC
     C                   Z-ADD     MOVSEC        ZSEC53
     C* Consecutivo
     C*MOVER ZCON53 MOVCON
     C                   Z-ADD     MOVCON        ZCON53
     C* Interno
     C*MOVER ZINT53 MOVCO4
     C                   Z-ADD     MOVCO4        ZINT53
     C* Días normales actual
     C*MOVER ZDTA53 MOVNUM
     C                   Z-ADD     MOVNUM        ZDTA53
     C* Días licencia actual
     C*MOVER ZDLA53 MOVDIA
     C                   Z-ADD     MOVDIA        ZDLA53
     C* Días normales recalculo
     C*MOVER ZDTC53 0
     C                   Z-ADD     0             ZDTC53
     C* Días licencia recalculo
     C*MOVER ZDLC53 0
     C                   Z-ADD     0             ZDLC53
     C* Tipo generación
     C*PASAR ZTIG53 'A'
     C                   MOVEL     'A'           ZTIG53
     C* Usuario recontrucción
     C*PASAR ZUSU53 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        ZUSU53
     C* Fecha recontrucción
     C*MOVER ZFEC53 ZFESIS
     C                   MOVE      ZFESIS        ZFEC53
     C* Hora recontrucción
     C*MOVER ZHOR53 ZHORA
     C                   MOVE      ZHORA         ZHOR53
     C* Acción agregar
     C*PASAR ZACC53 'A'
     C                   MOVEL     'A'           ZACC53
     C*LLAMAR RPREDH50 ($$REDH)
     C                   CALL      'RPREDH50'
     C                   PARM                    $$REDH
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcula fecha límite de pago                                ==
     C*==                                                              ==
     C*==================================================================
     C     M00015        BEGSR
     C* Clas.empl,forma declaración
     C*EJECUTAR M00001
     C                   EXSR      M00001
     C*LIMPIAR ZERROR ZFECHA
     C                   CLEAR                   ZERROR
     C                   CLEAR                   ZFECHA
     C* Ultimo dígito del nit
     C*MOVER ZULNIT PLANU4
     C                   Z-ADD     PLANU4        ZULNIT
     C* Indicador deuda
     C*LIMPIAR ZINDEU
     C                   CLEAR                   ZINDEU
     C*
     C*SI PLAT03 = '09' O PLAT03 = '10' O PLAT03 = '11' O PLAT03 = '12'
     C     PLAT03        IFEQ      '09'
     C     PLAT03        OREQ      '10'
     C     PLAT03        OREQ      '11'
     C     PLAT03        OREQ      '12'
     C*PASAR ZERROR PLANU4
     C                   CLEAR                   ZERROR
     C                   MOVEL     PLANU4        ZERROR
     C*FIN
     C                   END
     C*
     C*LLAMAR CALFECPA(ZPER ZULNIT ZCLASE ZFORDE PLATIP PLAT03 ZFECHA ZI
     C                   CALL      'CALFECPA'
     C                   PARM                    ZPER
     C                   PARM                    ZULNIT
     C                   PARM                    ZCLASE
     C                   PARM                    ZFORDE
     C                   PARM                    PLATIP
     C                   PARM                    PLAT03
     C                   PARM                    ZFECHA
     C                   PARM                    ZINDEU
     C                   PARM                    ZERROR
     C                   PARM                    ZCODER
     C*
     C*SI ZERROR |= *BLANCO
     C     ZERROR        IFNE      *BLANK
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*SINO
     C                   ELSE
     C* Período para HISAR6
     C*PASAR ZHPPE1 ZPER
     C                   MOVEL     ZPER          ZHPPE1
     C* Recupera Hisar6
     C*LLAMAR TRHPAR55($$REG1)
     C                   CALL      'TRHPAR55'
     C                   PARM                    $$REG1
     C*PASAR ZPLAAA PLANU1
     C                   MOVEL     PLANU1        ZPLAAA
     C* Parametros decreto 558
     C*EJECUTAR M98415
     C                   EXSR      M98415
     C* Indicador de error
     C*SI ZHPIND = '1'
     C     ZHPIND        IFEQ      '1'
     C* Período de la planilla
     C*PASAR ZPERER ZPER
     C                   MOVEL     ZPER          ZPERER
     C* Período en formato pantalla
     C*F FPANPER (ZPERER)
     C                   CALL      'TRPANPER'                                   FPANPER
     C     ZPERER        PARM      ZPERER        F$0P1             6
     C*OBTENER (1) ZERROR = 'No existe histórico de parámetros para el p
     C                   CLEAR                   ZERROR
     C     $HIL(018)     CAT       ZPERER:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Lee parámetros de configuración                             ==
     C*==                                                              ==
     C*==================================================================
     C     M00016        BEGSR
     C* FORAR1
     C*PASAR ZENTID '8'
     C                   MOVEL     '8'           ZENTID
     C* Limpia var. de trabajo
     C*LIMPIAR ZALFA8 ZALFA5 ZINERE ZFITIP
     C                   CLEAR                   ZALFA8
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C                   CLEAR                   ZFITIP
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2 ZNUM21
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C                   CLEAR                   ZNUM21
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM12 ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM12
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C*SI ZINERE = '1'
     C     ZINERE        IFEQ      '1'
     C*PASAR ZERROR 'No existen registros en archivo forma liq. interese
     C                   MOVEL     $HIL(019)     ZERROR
     C* Imprimir error
     C*EJECUTAR M00023
     C                   EXSR      M00023
     C*FIN
     C                   END
     C* DESARROLLO ESPECIAL SANTANDER
     C* Nombre del sistema
     C*PASAR ZNOMSI 'FUTURA'
     C                   CLEAR                   ZNOMSI
     C                   MOVEL     'FUTURA'      ZNOMSI
     C* Número del requerimiento
     C*MOVER ZNUREQ 7046
     C                   Z-ADD     7046          ZNUREQ
     C* Indicador de acceso a funcionalidad
     C*MOVER ZD7046 0
     C                   Z-ADD     0             ZD7046
     C*LLAMAR TRVALI50(ZNOMSI ZNUREQ ZD7046)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZNOMSI
     C                   PARM                    ZNUREQ
     C                   PARM                    ZD7046
     C*
     C* Número del requerimiento
     C*MOVER ZNUREQ 8305
     C                   Z-ADD     8305          ZNUREQ
     C* Ind. Desa. Especial Protección
     C*MOVER ZR8305 0
     C                   Z-ADD     0             ZR8305
     C*LLAMAR TRVALI50(ZNOMSI ZNUREQ ZR8305)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZNOMSI
     C                   PARM                    ZNUREQ
     C                   PARM                    ZR8305
     C*
     C* Número del requerimiento
     C*MOVER ZNUREQ 8565
     C                   Z-ADD     8565          ZNUREQ
     C* Ind. Desa. Especial Protección
     C*MOVER ZR8565 0
     C                   Z-ADD     0             ZR8565
     C*LLAMAR TRVALI50(ZNOMSI ZNUREQ ZR8565)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZNOMSI
     C                   PARM                    ZNUREQ
     C                   PARM                    ZR8565
     C* Se verifica si se encuentra activo req 1199
     C* Número de requerimient
     C*MOVER ZNUMRE 7957
     C                   Z-ADD     7957          ZNUMRE
     C* Indicador acceso a funcionalida
     C*MOVER ZD1199 0
     C                   Z-ADD     0             ZD1199
     C*LLAMAR TRVALI50(ZNOMSI ZNUMRE ZD1199)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZNOMSI
     C                   PARM                    ZNUMRE
     C                   PARM                    ZD1199
     C*
     C* Número de requerimient
     C*MOVER ZNUMRE 12541
     C                   Z-ADD     12541         ZNUMRE
     C* Indicador acceso a funcionalida
     C*MOVER Z12541 0
     C                   Z-ADD     0             Z12541
     C*LLAMAR TRVALI50(ZNOMSI ZNUMRE Z12541)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZNOMSI
     C                   PARM                    ZNUMRE
     C                   PARM                    Z12541
     C*
     C* Número de requerimiento
     C*MOVER ZNUMRE 13136
     C                   Z-ADD     13136         ZNUMRE
     C* Indicador acceso a funcionalida
     C*MOVER Z13136 0
     C                   Z-ADD     0             Z13136
     C*LLAMAR TRVALI50(ZNOMSI ZNUMRE Z13136)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZNOMSI
     C                   PARM                    ZNUMRE
     C                   PARM                    Z13136
     C*
     C* Verifica desarrollo especial activo: REQ 13422
     C* Asignar requerimiento
     C*MOVER ZNUMRE 13422
     C                   Z-ADD     13422         ZNUMRE
     C* Desarrollo especial inactivo
     C*MOVER ZR3422 0
     C                   Z-ADD     0             ZR3422
     C*LLAMAR TRVALI50(ZNOMSI ZNUMRE ZR3422)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZNOMSI
     C                   PARM                    ZNUMRE
     C                   PARM                    ZR3422
     C*
     C* Número de requerimiento
     C*MOVER ZNUMRE 13783
     C                   Z-ADD     13783         ZNUMRE
     C* Indicador acceso a funcionalida
     C*MOVER Z13783 0
     C                   Z-ADD     0             Z13783
     C*LLAMAR TRVALI50(ZNOMSI ZNUMRE Z13783)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZNOMSI
     C                   PARM                    ZNUMRE
     C                   PARM                    Z13783
     C*
     C* Número de requerimiento
     C*MOVER ZNUMRE 14006
     C                   Z-ADD     14006         ZNUMRE
     C* Indicador acceso a funcionalida
     C*MOVER Z14006 0
     C                   Z-ADD     0             Z14006
     C*LLAMAR TRVALI50(ZNOMSI ZNUMRE Z14006)
     C                   CALL      'TRVALI50'
     C                   PARM                    ZNOMSI
     C                   PARM                    ZNUMRE
     C                   PARM                    Z14006
     C                   ENDSR
     C*==================================================================
     C*==  Llamado desde acreditación por fecha.                       ==
     C*==                                                              ==
     C*==================================================================
     C     M00017        BEGSR
     C*SQL
     C/EXEC SQL
     C+  DECLARE C1 CURSOR FOR
     C+  SELECT PLANU1
     C+  FROM DEPAR303 A, PLAARC B
     C+  WHERE B.PLAEST = 'CON'
     C+  AND A.DEPFEC BETWEEN :ZFEINI AND :ZFESIS
     C+  AND PLANU1 BETWEEN :ZPLINI AND :ZPLFIN
     C+  AND A.DEPNUM = B.PLANU8
     C+  AND A.DEPNU1 = B.PLANU9
     C+  AND B.PLACON = A.DEPCON
     C+  UNION
     C+  SELECT PLANU1
     C+  FROM DEPAR303 INNER JOIN CONAR2
     C+  ON DEPNUM=CONNU2
     C+  AND DEPNU1=CONNU3
     C+  AND DEPCON=CONCO4
     C+  INNER JOIN PLAARC
     C+  ON CONNU4=PLANU3
     C+  AND CONNU5=PLANUM
     C+  WHERE PLAEST = 'CON'
     C+  AND DEPFEC BETWEEN :ZFEINI AND :ZFESIS
     C+  AND PLANU1 BETWEEN :ZPLINI AND :ZPLFIN
     C+  ORDER BY PLANU1
     C+  FOR READ ONLY
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  OPEN C1
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  FETCH C1 INTO :ZPLANU
     C/END-EXEC
     C*MIENTRAS SQLCOD = 0
     C     SQLCOD        DOWEQ     0
     C*INICIARI PLAARC04 (ZPLANU)
     C     ZPLANU        SETLL     PLAARC04                               74
     C     *IN74         IFEQ      '1'
     C                   MOVE      '0'           *IN74
     C                   ELSE
     C                   MOVE      '1'           *IN74
     C                   END
     C*LEER PLAARC04
     C                   READ      PLAARC04                               74
     C* Solo se acreditan las planillas CON
     C*SI PLAEST='CON'
     C     PLAEST        IFEQ      'CON'
     C* Proceso principal
     C*EJECUTAR M00010
     C                   EXSR      M00010
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  FETCH C1 INTO :ZPLANU
     C/END-EXEC
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  CLOSE C1
     C/END-EXEC
     C******************************************************************
     C* ACREDITA PLANILLAS 'CON' POR FECHA DEPOSITO FUSIONADO
     C*SQL
     C/EXEC SQL
     C+  DECLARE C3 CURSOR FOR
     C+  SELECT PLANU1
     C+  FROM DEPAR3 A, PLAARC B
     C+  WHERE B.PLAEST = 'CON'
     C+  AND A.DEPFE5 BETWEEN :ZFEINI AND :ZFESIS
     C+  AND PLANU1 BETWEEN :ZPLINI AND :ZPLFIN
     C+  AND A.DEPNUM = B.PLANU8
     C+  AND A.DEPNU1 = B.PLANU9
     C+  AND B.PLACON = A.DEPCON
     C+  UNION
     C+  SELECT PLANU1
     C+  FROM DEPAR3 INNER JOIN CONAR2
     C+  ON DEPNUM=CONNU2
     C+  AND DEPNU1=CONNU3
     C+  AND DEPCON=CONCO4
     C+  INNER JOIN PLAARC
     C+  ON CONNU4=PLANU3
     C+  AND CONNU5=PLANUM
     C+  WHERE PLAEST = 'CON'
     C+  AND DEPFE5 BETWEEN :ZFEINI AND :ZFESIS
     C+  AND PLANU1 BETWEEN :ZPLINI AND :ZPLFIN
     C+  ORDER BY PLANU1
     C+  FOR READ ONLY
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  OPEN C3
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  FETCH C3 INTO :ZPLANU
     C/END-EXEC
     C*MIENTRAS SQLCOD = 0
     C     SQLCOD        DOWEQ     0
     C*INICIARI PLAARC04 (ZPLANU)
     C     ZPLANU        SETLL     PLAARC04                               74
     C     *IN74         IFEQ      '1'
     C                   MOVE      '0'           *IN74
     C                   ELSE
     C                   MOVE      '1'           *IN74
     C                   END
     C*LEER PLAARC04
     C                   READ      PLAARC04                               74
     C* Solo se acreditan las planillas CON
     C*SI PLAEST='CON'
     C     PLAEST        IFEQ      'CON'
     C* Proceso principal
     C*EJECUTAR M00010
     C                   EXSR      M00010
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  FETCH C3 INTO :ZPLANU
     C/END-EXEC
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  CLOSE C3
     C/END-EXEC
     C******************************************************************
     C* ACREDITA PLANILLAS 'CON' FUERA DEL RANGO DE FECHAS
     C*SQL
     C/EXEC SQL
     C+  DECLARE C2 CURSOR FOR
     C+  SELECT PLANU1
     C+  FROM DEPAR303 A, PLAARC B
     C+  WHERE B.PLAEST = 'CON'
     C+  AND PLANU1 BETWEEN :ZPLINI AND :ZPLFIN
     C+  AND A.DEPNUM = B.PLANU8
     C+  AND A.DEPNU1 = B.PLANU9
     C+  AND B.PLACON = A.DEPCON
     C+  UNION
     C+  SELECT PLANU1
     C+  FROM DEPAR303 INNER JOIN CONAR2
     C+  ON DEPNUM=CONNU2
     C+  AND DEPNU1=CONNU3
     C+  AND DEPCON=CONCO4
     C+  INNER JOIN PLAARC
     C+  ON CONNU4=PLANU3
     C+  AND CONNU5=PLANUM
     C+  WHERE PLAEST = 'CON'
     C+  AND PLANU1 BETWEEN :ZPLINI AND :ZPLFIN
     C+  ORDER BY PLANU1
     C+  FOR READ ONLY
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  OPEN C2
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  FETCH C2 INTO :ZPLANU
     C/END-EXEC
     C*MIENTRAS SQLCOD = 0
     C     SQLCOD        DOWEQ     0
     C*INICIARI PLAARC04 (ZPLANU)
     C     ZPLANU        SETLL     PLAARC04                               74
     C     *IN74         IFEQ      '1'
     C                   MOVE      '0'           *IN74
     C                   ELSE
     C                   MOVE      '1'           *IN74
     C                   END
     C*LEER PLAARC04
     C                   READ      PLAARC04                               74
     C* Solo se acreditan las planillas CON
     C*SI PLAEST='CON'
     C     PLAEST        IFEQ      'CON'
     C* Proceso principal
     C*EJECUTAR M00010
     C                   EXSR      M00010
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  FETCH C2 INTO :ZPLANU
     C/END-EXEC
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  CLOSE C2
     C/END-EXEC
     C                   ENDSR
     C*==================================================================
     C*==  Lectura parámetros acreditador recaudo                      ==
     C*==                                                              ==
     C*==================================================================
     C     M00018        BEGSR
     C*LLAMAR TRPLAN6A(ZNUME3 ZNUMI3 ZNUME2 ZALFA8 ZALFA5 ZNUM12 ZINERE
     C                   CALL      'TRPLAN6A'
     C                   PARM                    ZNUME3
     C                   PARM                    ZNUMI3
     C                   PARM                    ZNUME2
     C                   PARM                    ZALFA8
     C                   PARM                    ZALFA5
     C                   PARM                    ZNUM12
     C                   PARM                    ZINERE
     C                   PARM                    ZENTID
     C                   PARM                    ZNUME9
     C                   PARM                    ZNUMI9
     C                   PARM                    ZNUMR9
     C                   PARM                    ZNUM21
     C                   PARM                    ZPEFIN
     C                   PARM                    ZALF15
     C                   PARM                    ZALFA1
     C                   PARM                    ZALFE1
     C                   PARM                    ZNUME5
     C                   PARM                    ZFITIP
     C                   ENDSR
     C*==================================================================
     C*==  Imprimir formato de error                                   ==
     C*==                                                              ==
     C*==================================================================
     C     M00019        BEGSR
     C* Reporte de error
     C*IMPRIMIR FMT@D3
     C                   EXCEPT    FMT@D3
     C* Ind. de error
     C*PASAR ZSALIR '1'
     C                   MOVEL     '1'           ZSALIR
     C                   ENDSR
     C*==================================================================
     C*==  Leer indicador de pacto para cancelación de deuda           ==
     C*==                                                              ==
     C*==================================================================
     C     M00020        BEGSR
     C* Planilla de dependientes
     C*SI PLATIP='01' O PLATIP='04' O PLATIP='08'
     C     PLATIP        IFEQ      '01'
     C     PLATIP        OREQ      '04'
     C     PLATIP        OREQ      '08'
     C*INICIARI EMPAR204 (PLANU4)
     C     PLANU4        SETLL     EMPAR204                               58
     C     *IN58         IFEQ      '1'
     C                   MOVE      '0'           *IN58
     C                   ELSE
     C                   MOVE      '1'           *IN58
     C                   END
     C* Empleadores del sistema
     C*SI ERE(EMPAR204)
     C     *IN58         IFEQ      '0'
     C*LEER EMPAR204
     C                   READ      EMPAR204                               58
     C* Código sucursal principal
     C*PASAR ZSUCPR EMPCOS
     C                   MOVEL     EMPCOS        ZSUCPR
     C*FIN
     C                   END
     C* Si es planilla dependiente
     C*SI PLATIP = '01'
     C     PLATIP        IFEQ      '01'
     C* Tipo de empresa
     C*PASAR ZMPTI6 EMPTI6
     C                   MOVEL     EMPTI6        ZMPTI6
     C* Devuelve % licencia
     C*LLAMAR TRHILI50 (PLAPER ZMPTI6 ZPORLR)
     C                   CALL      'TRHILI50'
     C                   PARM                    PLAPER
     C                   PARM                    ZMPTI6
     C                   PARM                    ZPORLR
     C*LIMPIAR ZMPTI6
     C                   CLEAR                   ZMPTI6
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* AFPARC01
     C*PASAR ZENTID  '1'
     C                   MOVEL     '1'           ZENTID
     C* Número de identificación
     C*MOVER ZNUM12 PLANU4
     C                   Z-ADD     PLANU4        ZNUM12
     C* Tipo identificación
     C*PASAR ZALFA8 PLATI1
     C                   CLEAR                   ZALFA8
     C                   MOVEL     PLATI1        ZALFA8
     C* Limpia var. de trabajo
     C*LIMPIAR ZALFA5 ZINERE ZFITIP
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C                   CLEAR                   ZFITIP
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM21 ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM21
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C* Código de AFP
     C*PASAR AFPCDI ZALFA5
     C                   MOVEL     ZALFA5        AFPCDI
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualizar archivo de acuerdo de pago                       ==
     C*==                                                              ==
     C*==================================================================
     C     M00021        BEGSR
     C* Limpiar código empleador
     C*LIMPIAR ZCODIN
     C                   CLEAR                   ZCODIN
     C* Verifica relación afiliado empleador
     C*PASAR ZLLAMA 'E'
     C                   MOVEL     'E'           ZLLAMA
     C*LLAMAR TREMPN52 (ZEMPLA PLATI1 PLANU4 ZPER ZPER ZINVAL ZLLAMA)
     C                   CALL      'TREMPN52'
     C                   PARM                    ZEMPLA
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    ZPER
     C                   PARM                    ZPER
     C                   PARM                    ZINVAL
     C                   PARM                    ZLLAMA
     C* Encontro registro
     C*SI ZINVAL <> ' '
     C     ZINVAL        IFNE      ' '
     C*MENSAJE 'Se encuentra en acuerdo de pago'
     C* Indicador de acreditación
     C*PASAR ZTILLA '1'
     C                   MOVEL     '1'           ZTILLA
     C*LLAMAR TRACUE58(ZTILLA MOVPLA MOVNU2 ZEMPLA ZFECDE ZTOPAG ZINDUL)
     C                   CALL      'TRACUE58'
     C                   PARM                    ZTILLA
     C                   PARM                    MOVPLA
     C                   PARM                    MOVNU2
     C                   PARM                    ZEMPLA
     C                   PARM                    ZFECDE
     C                   PARM                    ZTOPAG
     C                   PARM                    ZINDUL
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Llamada a TRPLAN6A para validar vinculación eliminada       ==
     C*==                                                              ==
     C*==================================================================
     C     M00022        BEGSR
     C*
     C* Ind período válido
     C*LIMPIAR ZT@IPV
     C                   CLEAR                   ZT@IPV
     C* Limpia var. de trabajo
     C*LIMPIAR ZALFA8 ZALFA5 ZINERE ZFITIP
     C                   CLEAR                   ZALFA8
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C                   CLEAR                   ZFITIP
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2 ZNUM21
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C                   CLEAR                   ZNUM21
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM12
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM12
     C* Limpia var. de trabajo
     C*LIMPIAR ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C*
     C* Archivo a trabajar
     C*PASAR ZENTID 'H'
     C                   MOVEL     'H'           ZENTID
     C* Tipo identificación
     C*PASAR ZALFA5 DETTI2
     C                   CLEAR                   ZALFA5
     C                   MOVEL     DETTI2        ZALFA5
     C* Identificación afiliado
     C*MOVER ZNUM12 DETNU2
     C                   Z-ADD     DETNU2        ZNUM12
     C* Código interno afiliado
     C*MOVER ZNUME9 DETN04
     C                   Z-ADD     DETN04        ZNUME9
     C* Planilla física MOVNU2
     C*MOVER ZNUM21 PLANU1
     C                   Z-ADD     PLANU1        ZNUM21
     C* Página
     C*MOVER ZNUME3 DETPAG
     C                   Z-ADD     DETPAG        ZNUME3
     C* Secuencia
     C*MOVER ZNUMI3 DETSEC
     C                   Z-ADD     DETSEC        ZNUMI3
     C* Período cotización
     C*PASAR ZPEFIN PLAPER
     C                   MOVEL     PLAPER        ZPEFIN
     C* Ind valida movimiento
     C*PASAR ZALFA1 *BLANCO
     C                   MOVEL     *BLANK        ZALFA1
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C*
     C* Período en vig eliminada
     C*PASAR ZT@IPV ZALFE1
     C                   MOVEL     ZALFE1        ZT@IPV
     C* Período no válido
     C*SI ZT@IPV = 'N'
     C     ZT@IPV        IFEQ      'N'
     C* Per no válido y usuario auto
     C*SI ZUSAUT='S' Y Z11433=1 Y ZT@002='3'
     C     ZUSAUT        IFEQ      'S'
     C     Z11433        ANDEQ     1
     C     ZT@002        ANDEQ     '3'
     C* Periodo si es válido para usuario
     C*LIMPIAR ZT@IPV
     C                   CLEAR                   ZT@IPV
     C*SINO
     C                   ELSE
     C* Número de identificación
     C*MOVER ZNUMAL DETNU2
     C                   MOVE      DETNU2        ZNUMAL
     C*OBTENER (1) ZERROR = 'Período de vigencia eliminada para afiliado
     C                   CLEAR                   ZERROR
     C     $HIL(020)     CAT       ZNUMAL:1      ZERROR
     C* Reporte de error
     C*IMPRIMIR FMT@D3
     C                   EXCEPT    FMT@D3
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Imprimir error                                              ==
     C*==                                                              ==
     C*==================================================================
     C     M00023        BEGSR
     C* Imprime detalle
     C*IMPRIMIR FMT@D3
     C                   EXCEPT    FMT@D3
     C* Fin de reporte error
     C*IMPRIMIR FMT@F3
     C                   EXCEPT    FMT@F3
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C* Rollback
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C* Finaliza proceso concurrencia
     C*LLAMAR TRCTPR51 (FUNCIO ZMODO ZNRTRA)
     C                   CALL      'TRCTPR51'
     C                   PARM                    FUNCIO
     C                   PARM                    ZMODO
     C                   PARM                    ZNRTRA
     C*TERMINAR
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   ENDSR
     C*==================================================================
     C*==  Módulo comisión de cesantes                                 ==
     C*==                                                              ==
     C*==================================================================
     C     M00025        BEGSR
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C*COMPLETAR
     C     PLANU4        COMMIT                                         94
     C                   MOVE      *IN94         I$NFT
     C* Si ya finalizó
     C*SI ZINLLA <> 'M'
     C     ZINLLA        IFNE      'M'
     C* Modo llamado proceso cesantes
     C*PASAR ZLLAMA 'F'
     C                   MOVEL     'F'           ZLLAMA
     C*** 3er SELECT
     C*CASO ZINDLL = 'C' Y ZCOINT <> *BLANCO
     C                   SELECT
     C     ZINDLL        WHENEQ    'C'
     C     ZCOINT        ANDNE     *BLANK
     C* Cobro comisión cesantes
     C*LLAMAR TRDQCE53 (ZCOINT ZAFILA ZPERCE ZPEFIN ZOPCIO ZNUPER ZLLAMA
     C                   CALL      'TRDQCE53'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPERCE
     C                   PARM                    ZPEFIN
     C                   PARM                    ZOPCIO
     C                   PARM                    ZNUPER
     C                   PARM                    ZLLAMA
     C                   PARM                    ZFEVIG
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C*CASO ZINDLL = 'R' Y ZCOINT <> *BLANCO
     C     ZINDLL        WHENEQ    'R'
     C     ZCOINT        ANDNE     *BLANK
     C* Reversar comisión cesantes
     C*LLAMAR TRAFRC59 (ZCOINT ZAFILA ZPEINI ZPEFIN ZFEVIG ZOPCIO ZLLAMA
     C                   CALL      'TRAFRC59'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPEINI
     C                   PARM                    ZPEFIN
     C                   PARM                    ZFEVIG
     C                   PARM                    ZOPCIO
     C                   PARM                    ZLLAMA
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C*CASO ZINDLL = 'A' Y ZCOINT <> *BLANCO
     C     ZINDLL        WHENEQ    'A'
     C     ZCOINT        ANDNE     *BLANK
     C* Cobro comisión cesantes
     C*LLAMAR TRDQCE53 (ZCOINT ZAFILA ZPERCE ZPEFIN ZOPCIO ZNUPER ZLLAMA
     C                   CALL      'TRDQCE53'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPERCE
     C                   PARM                    ZPEFIN
     C                   PARM                    ZOPCIO
     C                   PARM                    ZNUPER
     C                   PARM                    ZLLAMA
     C                   PARM                    ZFEVIG
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C* Reversar comisión cesantes
     C*LLAMAR TRAFRC59 (ZCOINT ZAFILA ZPEINI ZPEFIN ZFEVIG ZOPCIO ZLLAMA
     C                   CALL      'TRAFRC59'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPEINI
     C                   PARM                    ZPEFIN
     C                   PARM                    ZFEVIG
     C                   PARM                    ZOPCIO
     C                   PARM                    ZLLAMA
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C*FINCASOS
     C                   ENDSL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SUMAR 1 ZTPLAE
     C                   ADD       1             ZTPLAE
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C* Rollback
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C* Per no válido y usuario auto
     C*SI ZT@002='3'
     C     ZT@002        IFEQ      '3'
     C*RECUPERARD REZARC (REZNRO REZNR1 REZNR2)
     C     LL$015        KLIST
     C                   KFLD                    REZNRO
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$015        CHAIN     REZARC                             7694
     C                   MOVE      *IN94         I$RND
     C     *IN76         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   REZREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SI REZEST='COP'
     C     REZEST        IFEQ      'COP'
     C* Estado temporal del rezago
     C*PASAR REZEST 'FIN'
     C                   MOVEL     'FIN'         REZEST
     C*GRABAR REZARC
     C     *IN76         IFEQ      '0'
     C                   UPDATE    REZREG                               94
     C                   ELSE
     C                   WRITE     REZREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*COMPLETAR
     C     REZNR2        COMMIT                                         94
     C                   MOVE      *IN94         I$NFT
     C*LIMPIAR ZSALIR
     C                   CLEAR                   ZSALIR
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'REZARC no disponible - M00025'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(021)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza lote de planillas                                 ==
     C*==                                                              ==
     C*==================================================================
     C     M00030        BEGSR
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*RECUPERARD PLAARC (PLANU3 PLANUM)
     C     LL$016        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$016        CHAIN     PLAARC                             7394
     C                   MOVE      *IN94         I$RND
     C     *IN73         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   PLAREG
     C                   END
     C* Registro disponible
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Estado planilla no ACR
     C*SI PLAEST |= 'ACR'
     C     PLAEST        IFNE      'ACR'
     C* Estado de la planilla
     C*ASIGNAR PLAEST 'ACR'
     C                   MOVEL     'ACR'         PLAEST
     C* Borra plan en archivo CONA59
     C*LLAMAR TRREVR52(PLANU1)
     C                   CALL      'TRREVR52'
     C                   PARM                    PLANU1
     C* Validacion de cliente
     C*SI ZCODFO =  2  Y ZDESDB = 'S'
     C     ZCODFO        IFEQ      2
     C     ZDESDB        ANDEQ     'S'
     C* Producto
     C*MOVER  ZPRODU '01'
     C                   MOVE      '01'          ZPRODU
     C* Valida planilla unificada
     C*OBTENER ZPUA01 = *EXT(PLANU3 1 3)
     C                   CLEAR                   H$1
     C     3             SUBST     PLANU3:1      H$1             256
     C                   MOVEL     H$1           ZPUA01
     C*SI ZPUA01 = 'PUA'
     C     ZPUA01        IFEQ      'PUA'
     C* Número de identificación
     C*PASAR ZNUIDE PLANU4
     C                   MOVEL     PLANU4        ZNUIDE
     C* Número de planilla
     C*PASAR ZNUPLA PLANUM
     C                   MOVEL     PLANUM        ZNUPLA
     C* Número total de empleados
     C*PASAR ZNUTOE PLAN09
     C                   MOVEL     PLAN09        ZNUTOE
     C*LLAMAR TRBUCEM4(PLATI1 PLANU4 PLADIR PLACO1 PLACO2 PLATEL PLAFOR
     C                   CALL      'TRBUCEM4'
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    PLADIR
     C                   PARM                    PLACO1
     C                   PARM                    PLACO2
     C                   PARM                    PLATEL
     C                   PARM                    PLAFOR
     C                   PARM                    ZNUTOE
     C                   PARM                    PLANU3
     C                   PARM                    ZNUPLA
     C*SINO
     C                   ELSE
     C* Número de identificación
     C*PASAR ZNUIDE PLANU4
     C                   MOVEL     PLANU4        ZNUIDE
     C*LLAMAR  TRBUCEM3(ZPRODU PLATI1 ZNUIDE PLADIR PLACO1 PLACO2 PLATEL
     C                   CALL      'TRBUCEM3'
     C                   PARM                    ZPRODU
     C                   PARM                    PLATI1
     C                   PARM                    ZNUIDE
     C                   PARM                    PLADIR
     C                   PARM                    PLACO1
     C                   PARM                    PLACO2
     C                   PARM                    PLATEL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Planilla sin fecha fondo acreditación
     C*SI PLAF09 = *BLANCO
     C     PLAF09        IFEQ      *BLANK
     C* Fecha fondo acreditación
     C*PASAR PLAF09 HISFE3
     C                   MOVEL     HISFE3        PLAF09
     C*SINO
     C                   ELSE
     C*
     C* Agregar modificaciones a planillas en MODAR3
     C* Tipo registro : Reacreditación
     C*MOVER ZTMOPL 3
     C                   Z-ADD     3             ZTMOPL
     C* Adicionar modific. a planillas
     C*EJECUTAR M00200
     C                   EXSR      M00200
     C*
     C*FIN
     C                   END
     C*GRABAR PLAARC
     C     *IN73         IFEQ      '0'
     C                   UPDATE    PLAREG                               94
     C                   ELSE
     C                   WRITE     PLAREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Actualiza lote planillas
     C*RECUPERARD LOTAR5 (PLANU3)
     C     PLANU3        CHAIN     LOTAR5                             6694
     C                   MOVE      *IN94         I$RND
     C     *IN66         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   LOTRE5
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Planillas conciliadas
     C*RESTAR 1 LOTN13
     C                   SUB       1             LOTN13
     C* Planillas acreditadas
     C*SUMAR 1 LOTN12
     C                   ADD       1             LOTN12
     C* Definidas = acreditadas
     C*SI LOT008 = LOTN12
     C     LOT008        IFEQ      LOTN12
     C* Estado del lote acreditado
     C*PASAR LOTES5 'ACR'
     C                   MOVEL     'ACR'         LOTES5
     C*FIN
     C                   END
     C*GRABAR LOTAR5
     C     *IN66         IFEQ      '0'
     C                   UPDATE    LOTRE5                               94
     C                   ELSE
     C                   WRITE     LOTRE5                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'LOTAR5 no disponible - M00030'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(022)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* Perìodo ant. instalaciòn cesan.
     C*SI PLAPER < ZPEVIG Y ZINLLA <> 'M'
     C     PLAPER        IFLT      ZPEVIG
     C     ZINLLA        ANDNE     'M'
     C* Terminar revers. comisión ces.
     C*EJECUTAR M14095
     C                   EXSR      M14095
     C*FIN
     C                   END
     C* Limpia archivo temporal que se utiliza para la liquidación de in
     C* en planillas de terceros.
     C*SI ZTIPXX <> 'W' Y ZTLLAM <> 'X'
     C     ZTIPXX        IFNE      'W'
     C     ZTLLAM        ANDNE     'X'
     C*SQL
     C/EXEC SQL
     C+  DELETE FROM DETA31 WHERE DETLOT = :PLANU3 AND DETPL8 = :PLANUM
     C/END-EXEC
     C*FIN
     C                   END
     C*
     C*SI ZSIMUL <> 'S'
     C     ZSIMUL        IFNE      'S'
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C*SI ZSALIR <>'1'
     C     ZSALIR        IFNE      '1'
     C*COMPLETAR
     C     PLANU3        COMMIT                                         94
     C                   MOVE      *IN94         I$NFT
     C*LIMPIAR ZTOPAG
     C                   CLEAR                   ZTOPAG
     C* Modo llamado proceso cesantes
     C*PASAR ZLLAMA 'F'
     C                   MOVEL     'F'           ZLLAMA
     C*** 3er SELECT
     C*CASO ZINDLL = 'C' Y ZCOINT <> *BLANCO
     C                   SELECT
     C     ZINDLL        WHENEQ    'C'
     C     ZCOINT        ANDNE     *BLANK
     C* Cobro comisión cesantes
     C*LLAMAR TRDQCE53 (ZCOINT ZAFILA ZPERCE ZPEFIN ZOPCIO ZNUPER ZLLAMA
     C                   CALL      'TRDQCE53'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPERCE
     C                   PARM                    ZPEFIN
     C                   PARM                    ZOPCIO
     C                   PARM                    ZNUPER
     C                   PARM                    ZLLAMA
     C                   PARM                    ZFEVIG
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C*CASO ZINDLL = 'R' Y ZCOINT <> *BLANCO
     C     ZINDLL        WHENEQ    'R'
     C     ZCOINT        ANDNE     *BLANK
     C* Reversar comisión cesantes
     C*LLAMAR TRAFRC59 (ZCOINT ZAFILA ZPEINI ZPEFIN ZFEVIG ZOPCIO ZLLAMA
     C                   CALL      'TRAFRC59'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPEINI
     C                   PARM                    ZPEFIN
     C                   PARM                    ZFEVIG
     C                   PARM                    ZOPCIO
     C                   PARM                    ZLLAMA
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C*CASO ZINDLL = 'A' Y ZCOINT <> *BLANCO
     C     ZINDLL        WHENEQ    'A'
     C     ZCOINT        ANDNE     *BLANK
     C* Cobro comisión cesantes
     C*LLAMAR TRDQCE53 (ZCOINT ZAFILA ZPERCE ZPEFIN ZOPCIO ZNUPER ZLLAMA
     C                   CALL      'TRDQCE53'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPERCE
     C                   PARM                    ZPEFIN
     C                   PARM                    ZOPCIO
     C                   PARM                    ZNUPER
     C                   PARM                    ZLLAMA
     C                   PARM                    ZFEVIG
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C* Reversar comisión cesantes
     C*LLAMAR TRAFRC59 (ZCOINT ZAFILA ZPEINI ZPEFIN ZFEVIG ZOPCIO ZLLAMA
     C                   CALL      'TRAFRC59'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPEINI
     C                   PARM                    ZPEFIN
     C                   PARM                    ZFEVIG
     C                   PARM                    ZOPCIO
     C                   PARM                    ZLLAMA
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C*FINCASOS
     C                   ENDSL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* La planilla está en estado ACR
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Planilla en estado ACR'
     C                   MOVEL     $HIL(023)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'PLAARC no disponible - M00030'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(024)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Activa afiliado con ind. ilocalizado                        ==
     C*==                                                              ==
     C*==================================================================
     C     M00035        BEGSR
     C*SI PLAT03!='06' Y PLATIP != '05'
     C     PLAT03        IFNE      '06'
     C     PLATIP        ANDNE     '05'
     C*FUNCION QRESME1 (HISFE3 INDMRA ZFETMP)
     C                   CALL      'RPRESME1'                                   QRESME1
     C     HISFE3        PARM      HISFE3        F$4D1             8
     C     INDMRA        PARM      INDMRA        F$4D2             8 0
     C     ZFETMP        PARM      ZFETMP        F$4D3             8
     C* Periodo fecha restada
     C*PASAR ZPERT2 ZFETMP
     C                   MOVEL     ZFETMP        ZPERT2
     C* Periodo fecha fondo
     C*PASAR ZPERT1 HISFE3
     C                   MOVEL     HISFE3        ZPERT1
     C* Esta en rango
     C*SI ZOVPER >= ZPERT2 Y ZOVPER <= ZPERT1
     C     ZOVPER        IFGE      ZPERT2
     C     ZOVPER        ANDLE     ZPERT1
     C* Llena registro
     C*LLAMAR TRAFIC51 (AFINU3 AFICO7 AFIFE9)
     C                   CALL      'TRAFIC51'
     C                   PARM                    AFINU3
     C                   PARM                    AFICO7
     C                   PARM                    AFIFE9
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Consulta pago en exceso de fusión - PAGA22                  ==
     C*==                                                              ==
     C*==================================================================
     C     M00040        BEGSR
     C* Trae datos de PAGA22
     C* Ind P.E fusionado
     C*LIMPIAR ZIPEFP
     C                   CLEAR                   ZIPEFP
     C*LIMPIAR $$PAGA
     C                   CLEAR                   $$PAGA
     C*LLAMAR TRFPEX23 (PAGNUM $$PAGA)
     C                   CALL      'TRFPEX23'
     C                   PARM                    PAGNUM
     C                   PARM                    $$PAGA
     C*SI ZAGPL5 <> *CEROS
     C     ZAGPL5        IFNE      *ZEROS
     C* Encontro PAGA22
     C*PASAR ZIPEFP '1'
     C                   MOVEL     '1'           ZIPEFP
     C*FIN SI
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Limpiar todas las variables que intervienen en el proceso   ==
     C*==                                                              ==
     C*==================================================================
     C     M00050        BEGSR
     C*LIMPIAR K L    ZACUDI ZADEPR ZAVRDI ZCAPER ZCMAR  ZCMCCA ZCMCCE Z
     C                   CLEAR                   K
     C                   CLEAR                   L
     C                   CLEAR                   ZACUDI
     C                   CLEAR                   ZADEPR
     C                   CLEAR                   ZAVRDI
     C                   CLEAR                   ZCAPER
     C                   CLEAR                   ZCMAR
     C                   CLEAR                   ZCMCCA
     C                   CLEAR                   ZCMCCE
     C                   CLEAR                   ZCMCCO
     C                   CLEAR                   ZCMCO
     C                   CLEAR                   ZCMCVA
     C*LIMPIAR ZCMCVE ZCMFS  ZCMIFS ZCMINT ZCMPS  ZCMREN ZCONCE ZCONSE Z
     C                   CLEAR                   ZCMCVE
     C                   CLEAR                   ZCMFS
     C                   CLEAR                   ZCMIFS
     C                   CLEAR                   ZCMINT
     C                   CLEAR                   ZCMPS
     C                   CLEAR                   ZCMREN
     C                   CLEAR                   ZCONCE
     C                   CLEAR                   ZCONSE
     C                   CLEAR                   ZCOTAR
     C*LIMPIAR ZCOTFS ZCOTOB ZCOTVA ZCOTVE ZCUAR  ZCUCO  ZCUCVA ZCUCVE Z
     C                   CLEAR                   ZCOTFS
     C                   CLEAR                   ZCOTOB
     C                   CLEAR                   ZCOTVA
     C                   CLEAR                   ZCOTVE
     C                   CLEAR                   ZCUAR
     C                   CLEAR                   ZCUCO
     C                   CLEAR                   ZCUCVA
     C                   CLEAR                   ZCUCVE
     C                   CLEAR                   ZCUDEP
     C*LIMPIAR ZCUFS  ZCUIFS ZCUINT ZCUOHI ZCUOTA ZCUOTE ZCUPA  ZCUPAD Z
     C                   CLEAR                   ZCUFS
     C                   CLEAR                   ZCUIFS
     C                   CLEAR                   ZCUINT
     C                   CLEAR                   ZCUOHI
     C                   CLEAR                   ZCUOTA
     C                   CLEAR                   ZCUOTE
     C                   CLEAR                   ZCUPA
     C                   CLEAR                   ZCUPAD
     C                   CLEAR                   ZCUPAG
     C*LIMPIAR ZCUPE  ZCUREN ZCUREP ZCUREZ ZCUTEM ZDELTA ZDEPO  ZDEREZ Z
     C                   CLEAR                   ZCUPE
     C                   CLEAR                   ZCUREN
     C                   CLEAR                   ZCUREP
     C                   CLEAR                   ZCUREZ
     C                   CLEAR                   ZCUTEM
     C                   CLEAR                   ZDELTA
     C                   CLEAR                   ZDEPO
     C                   CLEAR                   ZDEREZ
     C                   CLEAR                   ZDIAME
     C*LIMPIAR ZDIAPE ZDIAS  ZDIASM ZDIAS1 ZERROR ZFECDE ZFECHA ZTIPAG
     C                   CLEAR                   ZDIAPE
     C                   CLEAR                   ZDIAS
     C                   CLEAR                   ZDIASM
     C                   CLEAR                   ZDIAS1
     C                   CLEAR                   ZERROR
     C                   CLEAR                   ZFECDE
     C                   CLEAR                   ZFECHA
     C                   CLEAR                   ZTIPAG
     C*LIMPIAR ZFECPA ZFECPE ZFEIND ZIFSRE ZINDIC ZINDNI ZINDPA ZINARE
     C                   CLEAR                   ZFECPA
     C                   CLEAR                   ZFECPE
     C                   CLEAR                   ZFEIND
     C                   CLEAR                   ZIFSRE
     C                   CLEAR                   ZINDIC
     C                   CLEAR                   ZINDNI
     C                   CLEAR                   ZINDPA
     C                   CLEAR                   ZINARE
     C*LIMPIAR ZINDPE ZINTER ZINTFS ZINTRE ZLOTE  ZMES   ZMESDI ZNROID Z
     C                   CLEAR                   ZINDPE
     C                   CLEAR                   ZINTER
     C                   CLEAR                   ZINTFS
     C                   CLEAR                   ZINTRE
     C                   CLEAR                   ZLOTE
     C                   CLEAR                   ZMES
     C                   CLEAR                   ZMESDI
     C                   CLEAR                   ZNROID
     C                   CLEAR                   ZNUMAL
     C*LIMPIAR ZPAG   ZPCOCO ZPCT   ZPCTCO ZPCTFS ZPER   ZPERER ZPERFI Z
     C                   CLEAR                   ZPAG
     C                   CLEAR                   ZPCOCO
     C                   CLEAR                   ZPCT
     C                   CLEAR                   ZPCTCO
     C                   CLEAR                   ZPCTFS
     C                   CLEAR                   ZPER
     C                   CLEAR                   ZPERER
     C                   CLEAR                   ZPERFI
     C                   CLEAR                   ZPERIN
     C*LIMPIAR ZPERIO ZPERVI ZPLACA ZPLANI ZPORCV ZPORPS ZRAR   ZRCCO  Z
     C                   CLEAR                   ZPERIO
     C                   CLEAR                   ZPERVI
     C                   CLEAR                   ZPLACA
     C                   CLEAR                   ZPLANI
     C                   CLEAR                   ZPORCV
     C                   CLEAR                   ZPORPS
     C                   CLEAR                   ZRAR
     C                   CLEAR                   ZRCCO
     C                   CLEAR                   ZRCO
     C*LIMPIAR ZRCOCV ZRCVA  ZRCVE  ZRDERE ZRENDI ZREZEM ZRFS   ZRIFS  Z
     C                   CLEAR                   ZRCOCV
     C                   CLEAR                   ZRCVA
     C                   CLEAR                   ZRCVE
     C                   CLEAR                   ZRDERE
     C                   CLEAR                   ZRENDI
     C                   CLEAR                   ZREZEM
     C                   CLEAR                   ZRFS
     C                   CLEAR                   ZRIFS
     C                   CLEAR                   ZRPEEM
     C*LIMPIAR ZRPS   ZRREIN ZSAAR  ZSACO  ZSACOT ZSACVA ZSACVE ZSADET Z
     C                   CLEAR                   ZRPS
     C                   CLEAR                   ZRREIN
     C                   CLEAR                   ZSAAR
     C                   CLEAR                   ZSACO
     C                   CLEAR                   ZSACOT
     C                   CLEAR                   ZSACVA
     C                   CLEAR                   ZSACVE
     C                   CLEAR                   ZSADET
     C                   CLEAR                   ZSAFS
     C*LIMPIAR ZSAIFS ZSAINT ZSALAR ZSALCA ZSALDD ZSALDE ZSALFS ZSALIR Z
     C                   CLEAR                   ZSAIFS
     C                   CLEAR                   ZSAINT
     C                   CLEAR                   ZSALAR
     C                   CLEAR                   ZSALCA
     C                   CLEAR                   ZSALDD
     C                   CLEAR                   ZSALDE
     C                   CLEAR                   ZSALFS
     C                   CLEAR                   ZSALIR
     C                   CLEAR                   ZSALMA
     C*LIMPIAR ZSICVA ZSICVE ZSINAR ZINDAR ZSALDT
     C                   CLEAR                   ZSICVA
     C                   CLEAR                   ZSICVE
     C                   CLEAR                   ZSINAR
     C                   CLEAR                   ZINDAR
     C                   CLEAR                   ZSALDT
     C*LIMPIAR ZSALMI ZSAREN ZSEC   ZTDAR  ZTDCO  ZTDCVA ZTDCVE ZTDFS  Z
     C                   CLEAR                   ZSALMI
     C                   CLEAR                   ZSAREN
     C                   CLEAR                   ZSEC
     C                   CLEAR                   ZTDAR
     C                   CLEAR                   ZTDCO
     C                   CLEAR                   ZTDCVA
     C                   CLEAR                   ZTDCVE
     C                   CLEAR                   ZTDFS
     C                   CLEAR                   ZTDIFS
     C*LIMPIAR ZTDINT ZTDREN ZTIRE  ZTOAR  ZTOCNI ZTOCO  ZTOCOT ZTOCRE Z
     C                   CLEAR                   ZTDINT
     C                   CLEAR                   ZTDREN
     C                   CLEAR                   ZTIRE
     C                   CLEAR                   ZTOAR
     C                   CLEAR                   ZTOCNI
     C                   CLEAR                   ZTOCO
     C                   CLEAR                   ZTOCOT
     C                   CLEAR                   ZTOCRE
     C                   CLEAR                   ZTOCRP
     C*LIMPIAR ZTOCVA ZTOCVE ZTODDP ZTODET ZTOFS  ZTOTCO ZTOTDE ZTOTD1 Z
     C                   CLEAR                   ZTOCVA
     C                   CLEAR                   ZTOCVE
     C                   CLEAR                   ZTODDP
     C                   CLEAR                   ZTODET
     C                   CLEAR                   ZTOFS
     C                   CLEAR                   ZTOTCO
     C                   CLEAR                   ZTOTDE
     C                   CLEAR                   ZTOTD1
     C                   CLEAR                   ZTOTDP
     C                   CLEAR                   ZTOTNI
     C*LIMPIAR ZTOTRP ZTOVRE ZTRANS ZULFDE ZULNIT ZULTPE ZULTP1 ZVAAR
     C                   CLEAR                   ZTOTRP
     C                   CLEAR                   ZTOVRE
     C                   CLEAR                   ZTRANS
     C                   CLEAR                   ZULFDE
     C                   CLEAR                   ZULNIT
     C                   CLEAR                   ZULTPE
     C                   CLEAR                   ZULTP1
     C                   CLEAR                   ZVAAR
     C*LIMPIAR ZVACO  ZVACOT ZVACVA ZVACVE ZVAFS  ZVAIFS ZVAINT ZVALCO Z
     C                   CLEAR                   ZVACO
     C                   CLEAR                   ZVACOT
     C                   CLEAR                   ZVACVA
     C                   CLEAR                   ZVACVE
     C                   CLEAR                   ZVAFS
     C                   CLEAR                   ZVAIFS
     C                   CLEAR                   ZVAINT
     C                   CLEAR                   ZVALCO
     C                   CLEAR                   ZVALHI
     C*LIMPIAR ZVALIN ZVALOR ZVALTE ZVAREN ZVDAR  ZVDCO  ZVDCVA ZVDCVE Z
     C                   CLEAR                   ZVALIN
     C                   CLEAR                   ZVALOR
     C                   CLEAR                   ZVALTE
     C                   CLEAR                   ZVAREN
     C                   CLEAR                   ZVDAR
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZVDCVA
     C                   CLEAR                   ZVDCVE
     C                   CLEAR                   ZVDFS
     C*LIMPIAR ZVDIFS ZVDINT ZVDREN ZVMAR  ZVMCCA ZVMCCE ZVMCCO ZVMCO  Z
     C                   CLEAR                   ZVDIFS
     C                   CLEAR                   ZVDINT
     C                   CLEAR                   ZVDREN
     C                   CLEAR                   ZVMAR
     C                   CLEAR                   ZVMCCA
     C                   CLEAR                   ZVMCCE
     C                   CLEAR                   ZVMCCO
     C                   CLEAR                   ZVMCO
     C                   CLEAR                   ZVMCVA
     C*LIMPIAR ZVMCVE ZVMFS  ZVMIFS ZVMINT ZVMPS  ZVMREN ZVRAND ZVRDEP Z
     C                   CLEAR                   ZVMCVE
     C                   CLEAR                   ZVMFS
     C                   CLEAR                   ZVMIFS
     C                   CLEAR                   ZVMINT
     C                   CLEAR                   ZVMPS
     C                   CLEAR                   ZVMREN
     C                   CLEAR                   ZVRAND
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZVRHIS
     C*LIMPIAR ZVRPA  ZVRPAD ZVRPAG ZVRPE  ZVRPRO ZVRREP ZVRREZ ZVRTEM Z
     C                   CLEAR                   ZVRPA
     C                   CLEAR                   ZVRPAD
     C                   CLEAR                   ZVRPAG
     C                   CLEAR                   ZVRPE
     C                   CLEAR                   ZVRPRO
     C                   CLEAR                   ZVRREP
     C                   CLEAR                   ZVRREZ
     C                   CLEAR                   ZVRTEM
     C                   CLEAR                   ZVRPER
     C*LIMPIAR ZLIQIN ZTOVRN ZTOCRN ZVRRET ZINOAF ZTVPA  ZTCPA  ZCOI ZIN
     C                   CLEAR                   ZLIQIN
     C                   CLEAR                   ZTOVRN
     C                   CLEAR                   ZTOCRN
     C                   CLEAR                   ZVRRET
     C                   CLEAR                   ZINOAF
     C                   CLEAR                   ZTVPA
     C                   CLEAR                   ZTCPA
     C                   CLEAR                   ZCOI
     C                   CLEAR                   ZINREF
     C*
     C*LIMPIAR ZTAFIL ZVSFSP ZVFGPM ZPSFSP ZPFGPM ZCOTSF ZCOTFG ZTOSFS Z
     C                   CLEAR                   ZTAFIL
     C                   CLEAR                   ZVSFSP
     C                   CLEAR                   ZVFGPM
     C                   CLEAR                   ZPSFSP
     C                   CLEAR                   ZPFGPM
     C                   CLEAR                   ZCOTSF
     C                   CLEAR                   ZCOTFG
     C                   CLEAR                   ZTOSFS
     C                   CLEAR                   ZVSFSO
     C*LIMPIAR ZTOFGP ZINTSF ZSAISF ZINTFG ZSAIFG ZSASFS ZSAFGP ZTDSFS
     C                   CLEAR                   ZTOFGP
     C                   CLEAR                   ZINTSF
     C                   CLEAR                   ZSAISF
     C                   CLEAR                   ZINTFG
     C                   CLEAR                   ZSAIFG
     C                   CLEAR                   ZSASFS
     C                   CLEAR                   ZSAFGP
     C                   CLEAR                   ZTDSFS
     C*LIMPIAR ZTDFGP ZTDISF ZTDIFG ZVDSFS ZVDFGP ZVDISF ZVDIFG ZVAFGP
     C                   CLEAR                   ZTDFGP
     C                   CLEAR                   ZTDISF
     C                   CLEAR                   ZTDIFG
     C                   CLEAR                   ZVDSFS
     C                   CLEAR                   ZVDFGP
     C                   CLEAR                   ZVDISF
     C                   CLEAR                   ZVDIFG
     C                   CLEAR                   ZVAFGP
     C*LIMPIAR ZVDFGP ZCUFGP ZCUIFG ZVASFS ZCUSFS ZCUISF ZIFGRE ZISFRE
     C                   CLEAR                   ZVDFGP
     C                   CLEAR                   ZCUFGP
     C                   CLEAR                   ZCUIFG
     C                   CLEAR                   ZVASFS
     C                   CLEAR                   ZCUSFS
     C                   CLEAR                   ZCUISF
     C                   CLEAR                   ZIFGRE
     C                   CLEAR                   ZISFRE
     C*LIMPIAR ZVMSFS ZVMFGP ZVMISF ZVMIFG ZCMSFS ZCMISF ZCMFGP ZCMIFG
     C                   CLEAR                   ZVMSFS
     C                   CLEAR                   ZVMFGP
     C                   CLEAR                   ZVMISF
     C                   CLEAR                   ZVMIFG
     C                   CLEAR                   ZCMSFS
     C                   CLEAR                   ZCMISF
     C                   CLEAR                   ZCMFGP
     C                   CLEAR                   ZCMIFG
     C*LIMPIAR ZVIFGA ZCIFGA ZVISFA ZCISFA ZVMFSD ZCMFSD ZVMIFD ZCMIFD
     C                   CLEAR                   ZVIFGA
     C                   CLEAR                   ZCIFGA
     C                   CLEAR                   ZVISFA
     C                   CLEAR                   ZCISFA
     C                   CLEAR                   ZVMFSD
     C                   CLEAR                   ZCMFSD
     C                   CLEAR                   ZVMIFD
     C                   CLEAR                   ZCMIFD
     C*LIMPIAR ZVDFSD ZCUFSD ZVDIFD ZCUIFD ZIBCAF ZINDFO
     C                   CLEAR                   ZVDFSD
     C                   CLEAR                   ZCUFSD
     C                   CLEAR                   ZVDIFD
     C                   CLEAR                   ZCUIFD
     C                   CLEAR                   ZIBCAF
     C                   CLEAR                   ZINDFO
     C*LIMPIAR ZVDIVA ZVDIVE ZVDIAR ZENTRA
     C                   CLEAR                   ZVDIVA
     C                   CLEAR                   ZVDIVE
     C                   CLEAR                   ZVDIAR
     C                   CLEAR                   ZENTRA
     C*LIMPIAR ZCUIVA ZCUIVE ZCUIAR ZPLAG1 ZSALPE
     C                   CLEAR                   ZCUIVA
     C                   CLEAR                   ZCUIVE
     C                   CLEAR                   ZCUIAR
     C                   CLEAR                   ZPLAG1
     C                   CLEAR                   ZSALPE
     C* Inicializar arreglos
     C*LIMPIAR A$AR[] A$CO[] A$CVA[] A$CVE[] A$FS[] A$IFS[] A$INT[] A$RE
     C                   CLEAR                   $0
     C                   CLEAR                   $1
     C                   CLEAR                   $2
     C                   CLEAR                   $3
     C                   CLEAR                   $4
     C                   CLEAR                   $5
     C                   CLEAR                   $6
     C                   CLEAR                   $7
     C*LIMPIAR ACUAR[] ACUCO[] ACUCVA[] ACUCVE[] ACUFS[] ACUIFS[] ACUINT
     C                   CLEAR                   $8
     C                   CLEAR                   $9
     C                   CLEAR                   $A
     C                   CLEAR                   $B
     C                   CLEAR                   $C
     C                   CLEAR                   $D
     C                   CLEAR                   $E
     C*LIMPIAR ACUREN[] AFECDE[] CDIAR[] CDICO[] CDICVA[] CDICVE[] CDIFS
     C                   CLEAR                   $F
     C                   CLEAR                   $G
     C                   CLEAR                   $H
     C                   CLEAR                   $I
     C                   CLEAR                   $J
     C                   CLEAR                   $K
     C                   CLEAR                   $L
     C*LIMPIAR CDIIFS[] CDIINT[] CDIREN[] VDIAR[] VDICO[] VDICVA[] VDICV
     C                   CLEAR                   $M
     C                   CLEAR                   $N
     C                   CLEAR                   $O
     C                   CLEAR                   $P
     C                   CLEAR                   $Q
     C                   CLEAR                   $R
     C                   CLEAR                   $S
     C*LIMPIAR VDIFS[] VDIIFS[] VDIINT[] VDIREN[] ZAR$RE[] ZARCRE[] ZARF
     C                   CLEAR                   $T
     C                   CLEAR                   $U
     C                   CLEAR                   $V
     C                   CLEAR                   $W
     C                   CLEAR                   $X
     C                   CLEAR                   $Y
     C                   CLEAR                   $Z
     C*
     C*LIMPIAR ZVPECS ZCPECS
     C                   CLEAR                   ZVPECS
     C                   CLEAR                   ZCPECS
     C*LIMPIAR ZCOSIT ZCOMSI ZPRISI ZCOHOS ZCOMHO ZPRIHO ZINREF ZINPIN
     C                   CLEAR                   ZCOSIT
     C                   CLEAR                   ZCOMSI
     C                   CLEAR                   ZPRISI
     C                   CLEAR                   ZCOHOS
     C                   CLEAR                   ZCOMHO
     C                   CLEAR                   ZPRIHO
     C                   CLEAR                   ZINREF
     C                   CLEAR                   ZINPIN
     C* INDIC. ACRED. P.A. 0=NO
     C*PASAR ZINAPA '0'
     C                   MOVEL     '0'           ZINAPA
     C*LIMPIAR ZTVDEP ZTCDEP ZTVHIS ZTCHIS ZEVALU ZINOCU ZSAMII ZPEANT Z
     C                   CLEAR                   ZTVDEP
     C                   CLEAR                   ZTCDEP
     C                   CLEAR                   ZTVHIS
     C                   CLEAR                   ZTCHIS
     C                   CLEAR                   ZEVALU
     C                   CLEAR                   ZINOCU
     C                   CLEAR                   ZSAMII
     C                   CLEAR                   ZPEANT
     C                   CLEAR                   ZMESPE
     C*LIMPIAR ZFINDE ZFLQIN ZCUTER ZTOSUM ZINDTE ZDIFPA ZFEPER ZINDTE Z
     C                   CLEAR                   ZFINDE
     C                   CLEAR                   ZFLQIN
     C                   CLEAR                   ZCUTER
     C                   CLEAR                   ZTOSUM
     C                   CLEAR                   ZINDTE
     C                   CLEAR                   ZDIFPA
     C                   CLEAR                   ZFEPER
     C                   CLEAR                   ZINDTE
     C                   CLEAR                   ZDIFPL
     C*LIMPIAR ZVTDIS ZVCDIS ZTOINT ZTOPLA ZVRSFS ZVRFSP ZVRDCO ZVRDFG Z
     C                   CLEAR                   ZVTDIS
     C                   CLEAR                   ZVCDIS
     C                   CLEAR                   ZTOINT
     C                   CLEAR                   ZTOPLA
     C                   CLEAR                   ZVRSFS
     C                   CLEAR                   ZVRFSP
     C                   CLEAR                   ZVRDCO
     C                   CLEAR                   ZVRDFG
     C                   CLEAR                   ZVRCAR
     C*LIMPIAR ZFAFIR ZPAFIR ZPEAIR ZAFUL2 ZULPER ZTIPLA ZPERCO ZVLDET Z
     C                   CLEAR                   ZFAFIR
     C                   CLEAR                   ZPAFIR
     C                   CLEAR                   ZPEAIR
     C                   CLEAR                   ZAFUL2
     C                   CLEAR                   ZULPER
     C                   CLEAR                   ZTIPLA
     C                   CLEAR                   ZPERCO
     C                   CLEAR                   ZVLDET
     C                   CLEAR                   ZCAUSA
     C*LIMPIAR ZINDCA ZINDBO ZINACC ZTOCAL ZDIFED ZICRSF ZPLAGE ZICRSF Z
     C                   CLEAR                   ZINDCA
     C                   CLEAR                   ZINDBO
     C                   CLEAR                   ZINACC
     C                   CLEAR                   ZTOCAL
     C                   CLEAR                   ZDIFED
     C                   CLEAR                   ZICRSF
     C                   CLEAR                   ZPLAGE
     C                   CLEAR                   ZICRSF
     C                   CLEAR                   ZPLARE
     C*LIMPIAR ZPROEJ ZGRDSF ZTIFS  ZTISF ZTAINT ZTICVA ZTICVE ZTINAR ZT
     C                   CLEAR                   ZPROEJ
     C                   CLEAR                   ZGRDSF
     C                   CLEAR                   ZTIFS
     C                   CLEAR                   ZTISF
     C                   CLEAR                   ZTAINT
     C                   CLEAR                   ZTICVA
     C                   CLEAR                   ZTICVE
     C                   CLEAR                   ZTINAR
     C                   CLEAR                   ZTAIFG
     C*LIMPIAR ZFIRVO ZTOTER ZCUDIT ZVALI1 ZPLDNP
     C                   CLEAR                   ZFIRVO
     C                   CLEAR                   ZTOTER
     C                   CLEAR                   ZCUDIT
     C                   CLEAR                   ZVALI1
     C                   CLEAR                   ZPLDNP
     C*LIMPIAR ZOVCO8 ZOVIN2 ZOVV13 ZOVI06 ZOVCOM ZOVVAL ZOVCO7 ZOVC27 Z
     C                   CLEAR                   ZOVCO8
     C                   CLEAR                   ZOVIN2
     C                   CLEAR                   ZOVV13
     C                   CLEAR                   ZOVI06
     C                   CLEAR                   ZOVCOM
     C                   CLEAR                   ZOVVAL
     C                   CLEAR                   ZOVCO7
     C                   CLEAR                   ZOVC27
     C                   CLEAR                   ZOVRET
     C*LIMPIAR ZINCFS ZINCSF ZINCNT ZICCVA ZICCVE ZINCAR ZINCFG ZTOTI2 Z
     C                   CLEAR                   ZINCFS
     C                   CLEAR                   ZINCSF
     C                   CLEAR                   ZINCNT
     C                   CLEAR                   ZICCVA
     C                   CLEAR                   ZICCVE
     C                   CLEAR                   ZINCAR
     C                   CLEAR                   ZINCFG
     C                   CLEAR                   ZTOTI2
     C                   CLEAR                   ZTOTI3
     C* Variables para desarrollo especial planillas COI
     C*LIMPIAR ZSAIN1 ZSIVA1 ZSIVE1 ZSINR1 ZSAIF1 ZSAIG1 ZSAIS1
     C                   CLEAR                   ZSAIN1
     C                   CLEAR                   ZSIVA1
     C                   CLEAR                   ZSIVE1
     C                   CLEAR                   ZSINR1
     C                   CLEAR                   ZSAIF1
     C                   CLEAR                   ZSAIG1
     C                   CLEAR                   ZSAIS1
     C*LIMPIAR ZSAIN2 ZSIVA2 ZSIVE2 ZSINR2 ZSAIF2 ZSAIG2 ZSAIS2
     C                   CLEAR                   ZSAIN2
     C                   CLEAR                   ZSIVA2
     C                   CLEAR                   ZSIVE2
     C                   CLEAR                   ZSINR2
     C                   CLEAR                   ZSAIF2
     C                   CLEAR                   ZSAIG2
     C                   CLEAR                   ZSAIS2
     C*LIMPIAR ZSAIN3 ZSIVA3 ZSIVE3 ZSINR3 ZSAIF3 ZSAIG3 ZSAIS3
     C                   CLEAR                   ZSAIN3
     C                   CLEAR                   ZSIVA3
     C                   CLEAR                   ZSIVE3
     C                   CLEAR                   ZSINR3
     C                   CLEAR                   ZSAIF3
     C                   CLEAR                   ZSAIG3
     C                   CLEAR                   ZSAIS3
     C*LIMPIAR ZSAIN4 ZSIVA4 ZSIVE4 ZSINR4 ZSAIF4 ZSAIG4 ZSAIS4
     C                   CLEAR                   ZSAIN4
     C                   CLEAR                   ZSIVA4
     C                   CLEAR                   ZSIVE4
     C                   CLEAR                   ZSINR4
     C                   CLEAR                   ZSAIF4
     C                   CLEAR                   ZSAIG4
     C                   CLEAR                   ZSAIS4
     C*LIMPIAR ZSAIN5 ZSIVA5 ZSIVE5 ZSINR5 ZSAIF5 ZSAIG5 ZSAIS5
     C                   CLEAR                   ZSAIN5
     C                   CLEAR                   ZSIVA5
     C                   CLEAR                   ZSIVE5
     C                   CLEAR                   ZSINR5
     C                   CLEAR                   ZSAIF5
     C                   CLEAR                   ZSAIG5
     C                   CLEAR                   ZSAIS5
     C*LIMPIAR ZTAIF1 ZTAIS1 ZTAIN1 ZTIVA1 ZTIVE1 ZTINA1 ZTAIG1
     C                   CLEAR                   ZTAIF1
     C                   CLEAR                   ZTAIS1
     C                   CLEAR                   ZTAIN1
     C                   CLEAR                   ZTIVA1
     C                   CLEAR                   ZTIVE1
     C                   CLEAR                   ZTINA1
     C                   CLEAR                   ZTAIG1
     C*LIMPIAR ZTAIF2 ZTAIS2 ZTAIN2 ZTIVA2 ZTIVE2 ZTINA2 ZTAIG2
     C                   CLEAR                   ZTAIF2
     C                   CLEAR                   ZTAIS2
     C                   CLEAR                   ZTAIN2
     C                   CLEAR                   ZTIVA2
     C                   CLEAR                   ZTIVE2
     C                   CLEAR                   ZTINA2
     C                   CLEAR                   ZTAIG2
     C*LIMPIAR ZTCTER ZTCCVA ZTCCVE ZTCTAR ZTCTFG ZTCTFS ZTCTSF
     C                   CLEAR                   ZTCTER
     C                   CLEAR                   ZTCCVA
     C                   CLEAR                   ZTCCVE
     C                   CLEAR                   ZTCTAR
     C                   CLEAR                   ZTCTFG
     C                   CLEAR                   ZTCTFS
     C                   CLEAR                   ZTCTSF
     C*LIMPIAR ZIITER ZIICVA ZIICVE ZIITAR ZIITFG ZIITFS ZIITSF
     C                   CLEAR                   ZIITER
     C                   CLEAR                   ZIICVA
     C                   CLEAR                   ZIICVE
     C                   CLEAR                   ZIITAR
     C                   CLEAR                   ZIITFG
     C                   CLEAR                   ZIITFS
     C                   CLEAR                   ZIITSF
     C*SI ZINLLA = *BLANCO
     C     ZINLLA        IFEQ      *BLANK
     C*LIMPIAR ZTPLAE
     C                   CLEAR                   ZTPLAE
     C*FIN
     C                   END
     C*LIMPIAR ZOPCI2 ZEMPAR ZFSPRE ZVFSRE ZCFSRE ZDEURE
     C                   CLEAR                   ZOPCI2
     C                   CLEAR                   ZEMPAR
     C                   CLEAR                   ZFSPRE
     C                   CLEAR                   ZVFSRE
     C                   CLEAR                   ZCFSRE
     C                   CLEAR                   ZDEURE
     C                   ENDSR
     C*==================================================================
     C*==  Actualizar histórico de conceptos con PLAN6I                ==
     C*==                                                              ==
     C*==================================================================
     C     M00055        BEGSR
     C*LIMPIAR ZFI
     C                   CLEAR                   ZFI
     C*SI ZTIPXX = 'W' O ZTLLAM = 'X' O ZREZMS='S' O ZPEDEM = 'S'
     C     ZTIPXX        IFEQ      'W'
     C     ZTLLAM        OREQ      'X'
     C     ZREZMS        OREQ      'S'
     C     ZPEDEM        OREQ      'S'
     C*LLAMAR TRPLANB1(ZFONDO HISFE3 PLANUM ZCODTX ZCONCE ZVALHI ZCUOHI
     C                   CALL      'TRPLANB1'
     C                   PARM                    ZFONDO
     C                   PARM                    HISFE3
     C                   PARM                    PLANUM
     C                   PARM                    ZCODTX
     C                   PARM                    ZCONCE
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C                   PARM                    ZFI
     C* Devolvió error TRPLANB1
     C*SI ZFI = '1'
     C     ZFI           IFEQ      '1'
     C* Reporte
     C*LLAMAR TRPLAN6K(ZCODTX ZCONCE ZFI ZVALHI ZCUOHI)
     C                   CALL      'TRPLAN6K'
     C                   PARM                    ZCODTX
     C                   PARM                    ZCONCE
     C                   PARM                    ZFI
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C*PASAR ZERROR 'Error al actualizar el HIS782, revise spool'
     C                   MOVEL     $HIL(025)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C* Rollback
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*LLAMAR TRPLAN6I(ZFONDO HISFE3 ZCODTX ZCONCE ZVALHI ZCUOHI ZFI)
     C                   CALL      'TRPLAN6I'
     C                   PARM                    ZFONDO
     C                   PARM                    HISFE3
     C                   PARM                    ZCODTX
     C                   PARM                    ZCONCE
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C                   PARM                    ZFI
     C* Devolvió error TRPLAN6I
     C*SI ZFI != *BLANCO
     C     ZFI           IFNE      *BLANK
     C* Nombre trabajo
     C*PASAR ZNTRAB 'TRPLAN64'
     C                   CLEAR                   ZNTRAB
     C                   MOVEL     'TRPLAN64'    ZNTRAB
     C*LLAMAR TRPLANB5 (ZFONDO HISFE3 ZPLNU1 ZCODTX ZCONCE ZVALHI ZCUOHI
     C                   CALL      'TRPLANB5'
     C                   PARM                    ZFONDO
     C                   PARM                    HISFE3
     C                   PARM                    ZPLNU1
     C                   PARM                    ZCODTX
     C                   PARM                    ZCONCE
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C                   PARM                    ZNTRAB
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Proceso acred. abono deuda con p.e.                         ==
     C*==                                                              ==
     C*==================================================================
     C     M00060        BEGSR
     C* Cruce PE con deuda masivo
     C*FUNCION QLEEALD (ZPEDEM 971 1)
     C                   CALL      'F079SNAP'                                   QLEEALD
     C     ZPEDEM        PARM      ZPEDEM        F$371           250
     C                   PARM      971           F$372             4 0
     C                   PARM      1             F$373             4 0
     C*SI DEUEST |= 'AND' Y DEUEST |= 'CAN'
     C     DEUEST        IFNE      'AND'
     C     DEUEST        ANDNE     'CAN'
     C*PASAR ZRANDO DEUNUM
     C                   MOVEL     DEUNUM        ZRANDO
     C* Pág. planilla
     C*SI ZT@004 = *BLANCO
     C     ZT@004        IFEQ      *BLANK
     C*CALCULAR ZSALDE = DEUSAL + DEUSA1 + DEUS03
     C     DEUSAL        ADD       DEUSA1        V$CA1           030 9
     C     V$CA1         ADD       DEUS03        ZSALDE
     C*ENGRUPO DETAR201 (DEUTIP DEUNUM)
     C     LL$017        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C     LL$017        SETLL     DETAR201                               48
     C     *IN48         IFEQ      '1'
     C     LL$017        READE     DETAR201                               48
     C     *IN48         DOUEQ     '1'
     C*SI DETEST ]= 'AND' Y DETEST ]= 'CAN'
     C     DETEST        IFNE      'AND'
     C     DETEST        ANDNE     'CAN'
     C*LLAMAR TRACUE60 (DETTI6 DETID2 DETSUB ZINDAJ)
     C                   CALL      'TRACUE60'
     C                   PARM                    DETTI6
     C                   PARM                    DETID2
     C                   PARM                    DETSUB
     C                   PARM                    ZINDAJ
     C*SI ZINDAJ = ' '
     C     ZINDAJ        IFEQ      ' '
     C*CALCULAR ZSALDT=ZSALDT+DETSA1+DETSA4+DETSA3+DETSA7+DETSA5+DETS07+
     C     ZSALDT        ADD       DETSA1        V$CA1           030 9
     C     V$CA1         ADD       DETSA4        V$CA1
     C     V$CA1         ADD       DETSA3        V$CA1
     C     V$CA1         ADD       DETSA7        V$CA1
     C     V$CA1         ADD       DETSA5        V$CA1
     C     V$CA1         ADD       DETS07        V$CA1
     C     V$CA1         ADD       DETS01        V$CA1
     C     V$CA1         ADD       DETS95        V$CA1
     C     V$CA1         ADD       DETS96        V$CA1
     C     V$CA1         ADD       DETS97        V$CA1
     C     V$CA1         ADD       DETS98        V$CA1
     C     V$CA1         ADD       DET120        V$CA1
     C     V$CA1         ADD       DET125        V$CA1
     C     V$CA1         ADD       DET126        V$CA1
     C     V$CA1         ADD       DET127        ZSALDT
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C     LL$017        READE     DETAR201                               48
     C                   END
     C     LL$017        SETGT     DETAR201                           48
     C                   MOVE      '0'           *IN48
     C                   ELSE
     C                   MOVE      '1'           *IN48
     C                   END
     C*SI ZSALDE<>ZSALDT
     C     ZSALDE        IFNE      ZSALDT
     C*MOVER ZSALDE ZSALDT
     C                   Z-ADD     ZSALDT        ZSALDE
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*CALCULAR ZSALDE=DETSA1+DETSA4+DETSA3+DETSA7+DETSA5+DETS07+DETS01+
     C     DETSA1        ADD       DETSA4        V$CA1           030 9
     C     V$CA1         ADD       DETSA3        V$CA1
     C     V$CA1         ADD       DETSA7        V$CA1
     C     V$CA1         ADD       DETSA5        V$CA1
     C     V$CA1         ADD       DETS07        V$CA1
     C     V$CA1         ADD       DETS01        V$CA1
     C     V$CA1         ADD       DETS95        V$CA1
     C     V$CA1         ADD       DETS96        V$CA1
     C     V$CA1         ADD       DETS97        V$CA1
     C     V$CA1         ADD       DETS98        V$CA1
     C     V$CA1         ADD       DET120        V$CA1
     C     V$CA1         ADD       DET125        V$CA1
     C     V$CA1         ADD       DET126        V$CA1
     C     V$CA1         ADD       DET127        ZSALDE
     C*FIN
     C                   END
     C*SI ZSALDE < 0
     C     ZSALDE        IFLT      0
     C*MOVER ZPLADE DEUNUM
     C                   Z-ADD     DEUNUM        ZPLADE
     C*PASAR ZERROR 'El saldo de la deuda es negativo'
     C                   MOVEL     $HIL(026)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*IMPRIMIR FMT@D4
     C                   EXCEPT    FMT@D4
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Sldo deuda > Saldo p.e. valor.
     C*SI ZSALDE > Z$DHOY
     C     ZSALDE        IFGT      Z$DHOY
     C* Valor pago en exceso
     C*MOVER ZVRPAG Z$DHOY
     C                   Z-ADD     Z$DHOY        ZVRPAG
     C* Se debe valorizar a fecha fusion. Los rendimientos se van a ingr
     C* Desarrollo Especial Fusion ING-Pro y Pago en exceso Fusionado
     C*SI Z10592 = 1 Y ZIPEFP = '1'
     C     Z10592        IFEQ      1
     C     ZIPEFP        ANDEQ     '1'
     C*CASO ZINPEE = 'N'
     C                   SELECT
     C     ZINPEE        WHENEQ    'N'
     C* Calcular saldo en cuotas Fusion
     C*EJECUTAR M00090
     C                   EXSR      M00090
     C*CASO ZINPEE = 'S'
     C     ZINPEE        WHENEQ    'S'
     C* Cuotas pago en exceso
     C*MOVER ZCUPAG PAGSA4
     C                   Z-ADD     PAGSA4        ZCUPAG
     C*FINCASOS
     C                   ENDSL
     C* Calcular rendimientos Fusion
     C*EJECUTAR M00080
     C                   EXSR      M00080
     C*SINO
     C                   ELSE
     C* Cuotas pago en exceso
     C*MOVER ZCUPAG PAGSA4
     C                   Z-ADD     PAGSA4        ZCUPAG
     C*FIN SI
     C                   END
     C*SINO
     C                   ELSE
     C* Saldo de la deuda
     C*MOVER ZVRPAG ZSALDE
     C                   Z-ADD     ZSALDE        ZVRPAG
     C*SI Z10592 = 1 Y ZIPEFP = '1'
     C     Z10592        IFEQ      1
     C     ZIPEFP        ANDEQ     '1'
     C*CASO ZINPEE = 'N'
     C                   SELECT
     C     ZINPEE        WHENEQ    'N'
     C* Calcular saldo en cuotas Fusion
     C*EJECUTAR M00090
     C                   EXSR      M00090
     C*CASO ZINPEE = 'S'
     C     ZINPEE        WHENEQ    'S'
     C*CALCULAR ZCUPAG = ZVRPAG / HISC28
     C     ZVRPAG        DIV       HISC28        ZCUPAG
     C*FINCASOS
     C                   ENDSL
     C* Calcular rendimientos Fusion
     C*EJECUTAR M00080
     C                   EXSR      M00080
     C*SINO
     C                   ELSE
     C*SI ZINPEE = 'N'
     C     ZINPEE        IFEQ      'N'
     C* Cuotas a pagar
     C*CALCULAR (R) ZCUPAG=(ZVRPAG*PAGCU2)/PAGVA4
     C     ZVRPAG        MULT      PAGCU2        V$CA1           030 9
     C     V$CA1         DIV(H)    PAGVA4        ZCUPAG
     C*SINO
     C                   ELSE
     C*CALCULAR ZCUPAG = ZVRPAG / HISC28
     C     ZVRPAG        DIV       HISC28        ZCUPAG
     C*FIN SI
     C                   END
     C*FIN SI
     C                   END
     C*FIN
     C                   END
     C*LIMPIAR ZADEPR ZAVRDI ZACUDI ZVRPAD ZCUPAD ZINDAJ
     C                   CLEAR                   ZADEPR
     C                   CLEAR                   ZAVRDI
     C                   CLEAR                   ZACUDI
     C                   CLEAR                   ZVRPAD
     C                   CLEAR                   ZCUPAD
     C                   CLEAR                   ZINDAJ
     C*SI ZT@004 = *BLANCO
     C     ZT@004        IFEQ      *BLANK
     C*LIMPIAR ZVACED ZVACUD ZPLADE
     C                   CLEAR                   ZVACED
     C                   CLEAR                   ZVACUD
     C                   CLEAR                   ZPLADE
     C*INICIAR DETAR201 (DEUTIP DEUNUM)
     C     LL$018        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C     LL$018        SETLL     DETAR201                           48
     C*LEER DETAR201(DEUTIP DEUNUM)
     C     LL$019        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C     LL$019        READE     DETAR201                               48
     C*MIENTRAS NFA(DETAR201) Y DETTIP = DEUTIP Y DETNU9 = DEUNUM
     C     *IN48         DOWEQ     '0'
     C     DETTIP        ANDEQ     DEUTIP
     C     DETNU9        ANDEQ     DEUNUM
     C*SI DETEST ]= 'AND' Y DETEST ]= 'CAN'
     C     DETEST        IFNE      'AND'
     C     DETEST        ANDNE     'CAN'
     C*LLAMAR TRACUE60 (DETTI6 DETID2 DETSUB ZINDAJ)
     C                   CALL      'TRACUE60'
     C                   PARM                    DETTI6
     C                   PARM                    DETID2
     C                   PARM                    DETSUB
     C                   PARM                    ZINDAJ
     C*SI ZINDAJ = ' '
     C     ZINDAJ        IFEQ      ' '
     C* Corroborar deudas
     C*EJECUTAR M00120
     C                   EXSR      M00120
     C* Hay error
     C*SI ZSALIR = '1'
     C     ZSALIR        IFEQ      '1'
     C*SALIR
     C                   GOTO      T$2
     C*FIN
     C                   END
     C* Calcular valor distribuido
     C*EJECUTAR M21020
     C                   EXSR      M21020
     C* Cancelar detalle deuda con p.e
     C*EJECUTAR M61000
     C                   EXSR      M61000
     C* Hay error
     C*SI ZSALIR = '1'
     C     ZSALIR        IFEQ      '1'
     C*SALIR
     C                   GOTO      T$2
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LEER DETAR201(DEUTIP DEUNUM)
     C     LL$020        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C     LL$020        READE     DETAR201                               48
     C*FIN
     C                   END
     C     T$2           TAG
     C* No hay error
     C*SI ZSALIR ]= '1'
     C     ZSALIR        IFNE      '1'
     C* Vlrs. distrib dif. a saldo
     C*SI ZVACED|=ZVRPAG O ZCUPAG|=ZVACUD
     C     ZVACED        IFNE      ZVRPAG
     C     ZCUPAG        ORNE      ZVACUD
     C* Planilla de deuda
     C*MOVER ZPLADE DEUNUM
     C                   Z-ADD     DEUNUM        ZPLADE
     C*PASAR ZERROR 'Descuadre en saldo de encabezado de deuda contra de
     C                   MOVEL     $HIL(027)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*IMPRIMIR FMT@D4
     C                   EXCEPT    FMT@D4
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Valor a pagar con p.e
     C*MOVER ZVDCO ZVRPAG
     C                   Z-ADD     ZVRPAG        ZVDCO
     C* Cuotas a pagar con p.e
     C*MOVER ZCUCO ZCUPAG
     C                   Z-ADD     ZCUPAG        ZCUCO
     C* Leer afiliado y cuenta
     C*EJECUTAR M21015
     C                   EXSR      M21015
     C* Per.planilla >= Per.reforma
     C*SI DEUPER >  ZPEREF
     C     DEUPER        IFGT      ZPEREF
     C* Período para procesar F.S.
     C*PASAR ZPERFS DEUPER
     C                   MOVEL     DEUPER        ZPERFS
     C*PASAR ZINREF 'S'
     C                   MOVEL     'S'           ZINREF
     C* IBC del afiliado
     C*MOVER ZIBCAF DETSA2
     C                   Z-ADD     DETSA2        ZIBCAF
     C* Retorna FGPM Y SFSP
     C*EJECUTAR M77000
     C                   EXSR      M77000
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR ]= '1'
     C     ZSALIR        IFNE      '1'
     C* Cancelar detalle deuda con p.e
     C*EJECUTAR M61000
     C                   EXSR      M61000
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Cód. transacción
     C*PASAR ZCODTX '03'
     C                   MOVEL     '03'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '22'
     C                   MOVEL     '22'          ZCONCE
     C* Valor histórico
     C*MOVER ZVALHI ZVRPAD
     C                   Z-ADD     ZVRPAD        ZVALHI
     C*LIMPIAR ZCUOHI
     C                   CLEAR                   ZCUOHI
     C* Actualizar HISAR4
     C*EJECUTAR M00055
     C                   EXSR      M00055
     C*
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Grabar deuda cancelada
     C*EJECUTAR M14392
     C                   EXSR      M14392
     C* Actualizar pagos con recaudo con la planilla del p.e.
     C* Actualizar pagos por recaudo
     C*MOVER PLANU1 PAGNUM
     C                   Z-ADD     PAGNUM        PLANU1
     C* Evaluar deuda o P.E.
     C*PASAR ZEVALU 'N'
     C                   MOVEL     'N'           ZEVALU
     C* Genera encabezados e histórico
     C*EJECUTAR M15000
     C                   EXSR      M15000
     C* Actualizar saldo p.e.
     C*EJECUTAR M63000
     C                   EXSR      M63000
     C*SINO
     C                   ELSE
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Proceso de acred. de rezagos                                ==
     C*==                                                              ==
     C*==================================================================
     C     M00070        BEGSR
     C* Recupera usuario autorizado para finalización forzosa de rezagos
     C*LIMPIAR ZUSAUT CONID1
     C                   CLEAR                   ZUSAUT
     C                   CLEAR                   CONID1
     C* Variable USUREZ
     C*PASAR CONIDE 'USUREZ'
     C                   MOVEL     'USUREZ'      CONIDE
     C* Verifica si usuario está autorizado
     C*ENGRUPO CONARC(CONIDE)
     C     CONIDE        SETLL     CONARC                                 44
     C     *IN44         IFEQ      '1'
     C     CONIDE        READE     CONARC                                 44
     C     *IN44         DOUEQ     '1'
     C* Usuario autorizado
     C*PASAR ZUSURZ CONCAR
     C                   MOVEL     CONCAR        ZUSURZ
     C* Usuario que ejecuta el proceso
     C*SI ZUSURZ = USUÑÑÑ
     C     ZUSURZ        IFEQ      USUÑÑÑ
     C* Ind. de usuario autorizado
     C*PASAR ZUSAUT 'S'
     C                   MOVEL     'S'           ZUSAUT
     C*SALIR
     C                   GOTO      T$3
     C*FIN
     C                   END
     C*FIN
     C     CONIDE        READE     CONARC                                 44
     C                   END
     C     T$3           TAG
     C     CONIDE        SETGT     CONARC                             44
     C                   MOVE      '0'           *IN44
     C                   ELSE
     C                   MOVE      '1'           *IN44
     C                   END
     C* Número de planilla inicial
     C*MOVER ZPLAIN ZT@001
     C                   MOVE      ZT@001        ZPLAIN
     C* Número planilla final
     C*MOVER ZPLAFI ZT@003
     C                   MOVE      ZT@003        ZPLAFI
     C*SI ZPLAIN=*CERO
     C     ZPLAIN        IFEQ      *ZERO
     C*PASAR ZPLAFI '999999999999'
     C                   MOVEL     $HIL(028)     ZPLAFI
     C*FIN
     C                   END
     C*SI ZT@001<>*BLANCO Y ZT@003<>*BLANCO Y ZT@004=*BLANCO
     C     ZT@001        IFNE      *BLANK
     C     ZT@003        ANDNE     *BLANK
     C     ZT@004        ANDEQ     *BLANK
     C*PASAR ZREZMS 'S'
     C                   MOVEL     'S'           ZREZMS
     C* Obtiene nombre del proceso sometido
     C*LLAMAR CLDATDP (ZNOMTR ZNUMTR ZUSUAR)
     C                   CALL      'CLDATDP'
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C* Asigna indicador de generación
     C*PASAR ZESTPR 'G'
     C                   MOVEL     'G'           ZESTPR
     C* Llama prog.generac registro archivo trabajos
     C*LLAMAR TRPLAN22(ZESTPR ZNOMTR ZNUMTR ZUSUAR)
     C                   CALL      'TRPLAN22'
     C                   PARM                    ZESTPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C*FIN
     C                   END
     C* Fecha inicial rezagos
     C*FUNCION QLEEALD (ZFEINR 276 8)
     C                   CALL      'F079SNAP'                                   QLEEALD
     C     ZFEINR        PARM      ZFEINR        F$371           250
     C                   PARM      276           F$372             4 0
     C                   PARM      8             F$373             4 0
     C* Fecha inicial rezagos
     C*FUNCION QLEEALD (ZFEFIR 284 8)
     C                   CALL      'F079SNAP'                                   QLEEALD
     C     ZFEFIR        PARM      ZFEFIR        F$371           250
     C                   PARM      284           F$372             4 0
     C                   PARM      8             F$373             4 0
     C* Ind. generar PAGA30
     C*FUNCION QLEEALD (ZPAG30 430 1)
     C                   CALL      'F079SNAP'                                   QLEEALD
     C     ZPAG30        PARM      ZPAG30        F$371           250
     C                   PARM      430           F$372             4 0
     C                   PARM      1             F$373             4 0
     C*SI ZFEFIR=*BLANCO
     C     ZFEFIR        IFEQ      *BLANK
     C*LIMPIAR ZFEINR
     C                   CLEAR                   ZFEINR
     C*PASAR ZFEFIR '99999999'
     C                   MOVEL     '99999999'    ZFEFIR
     C*FIN
     C                   END
     C* Acred rzgos x normal (01-10)
     C*EJECUTAR M00071
     C                   EXSR      M00071
     C* Acred rzgos x extraor.(11-19 y 34)
     C*EJECUTAR M00072
     C                   EXSR      M00072
     C* Acred Rzgos x traspaso (32)
     C*EJECUTAR M00073
     C                   EXSR      M00073
     C* Acred Rzgos x rev. mvto normal(31)
     C*EJECUTAR M00074
     C                   EXSR      M00074
     C*
     C*SI ZREZMS='S'
     C     ZREZMS        IFEQ      'S'
     C*PASAR ZCNPL8 ZT@001
     C                   CLEAR                   ZCNPL8
     C                   MOVEL     ZT@001        ZCNPL8
     C* Tipo de proceso
     C*FUNCION QLEEALD (ZTIREX 275 1)
     C                   CALL      'F079SNAP'                                   QLEEALD
     C     ZTIREX        PARM      ZTIREX        F$371           250
     C                   PARM      275           F$372             4 0
     C                   PARM      1             F$373             4 0
     C*SI ZTIREX<>'4' Y ZTIREX<>'3'
     C     ZTIREX        IFNE      '4'
     C     ZTIREX        ANDNE     '3'
     C*PASAR ZTIREX '1'
     C                   MOVEL     '1'           ZTIREX
     C*FIN
     C                   END
     C*PASAR ZTIPRX 'A'
     C                   MOVEL     'A'           ZTIPRX
     C*PASAR ZINTEX 'N'
     C                   MOVEL     'N'           ZINTEX
     C*PASAR ZACCIX '3'
     C                   MOVEL     '3'           ZACCIX
     C*LLAMAR TRCORZ50 (ZCNPL8 ZCNPL9 ZTIREX ZTIPRX ZINTEX ZACCIX ZTERMX
     C                   CALL      'TRCORZ50'
     C                   PARM                    ZCNPL8
     C                   PARM                    ZCNPL9
     C                   PARM                    ZTIREX
     C                   PARM                    ZTIPRX
     C                   PARM                    ZINTEX
     C                   PARM                    ZACCIX
     C                   PARM                    ZTERMX
     C*PASAR ZACCIX '4'
     C                   MOVEL     '4'           ZACCIX
     C*LLAMAR TRCORZ50 (ZCNPL8 ZCNPL9 ZTIREX ZTIPRX ZINTEX ZACCIX ZTERMX
     C                   CALL      'TRCORZ50'
     C                   PARM                    ZCNPL8
     C                   PARM                    ZCNPL9
     C                   PARM                    ZTIREX
     C                   PARM                    ZTIPRX
     C                   PARM                    ZINTEX
     C                   PARM                    ZACCIX
     C                   PARM                    ZTERMX
     C*
     C* Todos los trabajos terminaron
     C*SI ZTERMX='1' Y ZTIREX='1'
     C     ZTERMX        IFEQ      '1'
     C     ZTIREX        ANDEQ     '1'
     C* Partes finales acreditación rezagos
     C*LLAMAR CLREZA60I (USUÑÑÑ)
     C                   MOVEL     'CLREZA60'    H$L10            10
     C                   MOVE      'I '          H$L10
     C                   CALL      H$L10
     C                   PARM                    USUÑÑÑ
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LIMPIAR ZPAG30
     C                   CLEAR                   ZPAG30
     C* Limpia área datos
     C*FUNCION QGRAALD (ZPAG30 430 1)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZPAG30        PARM      ZPAG30        F$2Z1           250
     C                   PARM      430           F$2Z2             4 0
     C                   PARM      1             F$2Z3             4 0
     C                   ENDSR
     C*==================================================================
     C*==  Acred. de rezagos por planilla normal (01-10)               ==
     C*==                                                              ==
     C*==================================================================
     C     M00071        BEGSR
     C* Ind. de actualizar o crear Temp. TEM708
     C*LIMPIAR ZINTEM
     C                   CLEAR                   ZINTEM
     C*PASAR ZESTAD 'FIN'
     C                   MOVEL     'FIN'         ZESTAD
     C*SI ZPLAIN=*CERO
     C     ZPLAIN        IFEQ      *ZERO
     C* Rz x estad, usuario
     C*INICIAR REZARC18 (ZESTAD ZT@008)
     C     LL$021        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C     LL$021        SETLL     REZARC18                           77
     C*SINO
     C                   ELSE
     C* Rz x estad, usuario, planil
     C*INICIAR REZARC18 (ZESTAD ZT@008 ZPLAIN)
     C     LL$022        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C                   KFLD                    ZPLAIN
     C     LL$022        SETLL     REZARC18                           77
     C*FIN
     C                   END
     C*LEER REZARC18
     C                   READ      REZARC18                               77
     C*MIENTRAS NFA (REZARC18) Y REZEST=ZESTAD Y REZUSU=ZT@008 Y REZNRO<
     C     *IN77         DOWEQ     '0'
     C     REZEST        ANDEQ     ZESTAD
     C     REZUSU        ANDEQ     ZT@008
     C     REZNRO        ANDLE     ZPLAFI
     C*SQL
     C/EXEC SQL
     C+  SELECT COUNT(*) INTO :ZCAREZ
     C+  FROM REZARC WHERE
     C+  REZNRO = :REZNRO AND
     C+  REZEST IN('FIN', 'COP')
     C/END-EXEC
     C*SI REZFEC>=ZFEINR Y REZFEC<=ZFEFIR
     C     REZFEC        IFGE      ZFEINR
     C     REZFEC        ANDLE     ZFEFIR
     C* Estado temporal de la planilla
     C*PASAR ZESTAD 'COP'
     C                   MOVEL     'COP'         ZESTAD
     C* Número de planilla para cesantes
     C*PASAR ZRANDO REZNRO
     C                   MOVEL     REZNRO        ZRANDO
     C* Si para la plan. hay rezago = COP
     C*INICIARI REZARC01 (ZESTAD REZNRO)
     C     LL$023        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    REZNRO
     C     LL$023        SETLL     REZARC01                               85
     C     *IN85         IFEQ      '1'
     C                   MOVE      '0'           *IN85
     C                   ELSE
     C                   MOVE      '1'           *IN85
     C                   END
     C* Rezago COP para el mismo usuario
     C*SI ERE(REZARC01) Y REZUSU = ZT@008
     C     *IN85         IFEQ      '0'
     C     REZUSU        ANDEQ     ZT@008
     C* Planillas finalizadas
     C*PASAR ZESTAD 'FIN'
     C                   MOVEL     'FIN'         ZESTAD
     C* Planilla del rezago
     C*MOVER ZPLARE REZNRO
     C                   MOVE      REZNRO        ZPLARE
     C*OBTENER (1) ZERROR = 'Otro trabajo está procesando el rezago'|| Z
     C                   CLEAR                   ZERROR
     C     $HIL(029)     CAT       ZPLARE:1      ZERROR
     C* Imprime detalle de error
     C*IMPRIMIR  FMT@D3
     C                   EXCEPT    FMT@D3
     C*INICIARU REZARC18 (ZESTAD ZT@008 REZNRO)
     C     LL$024        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C                   KFLD                    REZNRO
     C     LL$024        SETGT     REZARC18                           77
     C* No procesar el rezago
     C*LEER REZARC18
     C                   READ      REZARC18                               77
     C*SINO
     C                   ELSE
     C* Lectura rezago y planilla
     C*EJECUTAR M00140
     C                   EXSR      M00140
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Leer entid. relacionadas
     C*EJECUTAR M00000
     C                   EXSR      M00000
     C*FIN
     C                   END
     C*MOVER L 1
     C                   Z-ADD     1             L
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Cal. totales x concep - acr.rzgos
     C*EJECUTAR M70000
     C                   EXSR      M70000
     C*FIN
     C                   END
     C*SI ZSALIR ]= '1'
     C     ZSALIR        IFNE      '1'
     C*MOVER K 1
     C                   Z-ADD     1             K
     C*MOVER J 1
     C                   Z-ADD     1             J
     C*PASAR ZINDPE '0'
     C                   MOVEL     '0'           ZINDPE
     C*MIENTRAS K < L Y ZINDPE = '0'
     C     K             DOWLT     L
     C     ZINDPE        ANDEQ     '0'
     C* Valor x depósito - acre. rezagos
     C*MOVER ZVRDEP ZAR$RE[K]
     C                   Z-ADD     $X(K)         ZVRDEP
     C* Cuotas x deposito - acr. rezagos
     C*MOVER ZCUDEP ZARCRE[K]
     C                   Z-ADD     $Y(K)         ZCUDEP
     C* Fecha depósito - acr. rezagos
     C*MOVER ZFECDE ZARFRE[K]
     C                   MOVE      $Z(K)         ZFECDE
     C*PASAR DEPFEC ZFECDE
     C                   MOVEL     ZFECDE        DEPFEC
     C* Calcula valor no identificados
     C*EJECUTAR M12020
     C                   EXSR      M12020
     C* Procesar planilla
     C*EJECUTAR M12200
     C                   EXSR      M12200
     C*CALCULAR ZSALDO = ZSACO+ZSAAR+ZSACVA+ZSACVE+ZSAFS+ZSAINT+ZSAIFS+Z
     C     ZSACO         ADD       ZSAAR         V$CA1           030 9
     C     V$CA1         ADD       ZSACVA        V$CA1
     C     V$CA1         ADD       ZSACVE        V$CA1
     C     V$CA1         ADD       ZSAFS         V$CA1
     C     V$CA1         ADD       ZSAINT        V$CA1
     C     V$CA1         ADD       ZSAIFS        V$CA1
     C     V$CA1         ADD       ZSAFGP        V$CA1
     C     V$CA1         ADD       ZSAIFG        V$CA1
     C     V$CA1         ADD       ZSASFS        V$CA1
     C     V$CA1         ADD       ZSAISF        ZSALDO
     C* Saldo cotización
     C*SI ZSALDO |= *CERO
     C     ZSALDO        IFNE      *ZERO
     C*SINO
     C                   ELSE
     C* Ind. pago en exceso empleador
     C*PASAR ZINDPE '1'
     C                   MOVEL     '1'           ZINDPE
     C*FIN
     C                   END
     C*SUMAR 1 K
     C                   ADD       1             K
     C*FIN
     C                   END
     C* Guarda el índice a partir del cual se genera p.e. - acr. rezagos
     C* Indica generar P.E. - acr. rezagos
     C*MOVER J L
     C                   Z-ADD     L             J
     C* Procesar detalles de rezagos
     C*EJECUTAR M71000
     C                   EXSR      M71000
     C*FIN
     C                   END
     C*PASAR ZESTAD 'FIN'
     C                   MOVEL     'FIN'         ZESTAD
     C* Estad, usuario, plani.
     C*INICIARU REZARC18 (ZESTAD ZT@008 ZPLAN1)
     C     LL$025        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C                   KFLD                    ZPLAN1
     C     LL$025        SETGT     REZARC18                           77
     C*LEER REZARC18
     C                   READ      REZARC18                               77
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*LEER REZARC18
     C                   READ      REZARC18                               77
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Acred. de rezagos x plan. extraord. (11-19 y 34)            ==
     C*==                                                              ==
     C*==================================================================
     C     M00072        BEGSR
     C*PASAR ZESTAD 'FIN'
     C                   MOVEL     'FIN'         ZESTAD
     C*SI ZPLAIN=*CERO
     C     ZPLAIN        IFEQ      *ZERO
     C* Rz x estad, usuario
     C*INICIAR REZARC19 (ZESTAD ZT@008)
     C     LL$026        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C     LL$026        SETLL     REZARC19                           78
     C*SINO
     C                   ELSE
     C* x estado, usuario, Nro plan
     C*INICIAR REZARC19 (ZESTAD ZT@008 ZPLAIN)
     C     LL$027        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C                   KFLD                    ZPLAIN
     C     LL$027        SETLL     REZARC19                           78
     C*FIN
     C                   END
     C*LEER REZARC19
     C                   READ      REZARC19                               78
     C*MIENTRAS NFA (REZARC19) Y REZEST=ZESTAD Y REZUSU=ZT@008 Y REZNRO<
     C     *IN78         DOWEQ     '0'
     C     REZEST        ANDEQ     ZESTAD
     C     REZUSU        ANDEQ     ZT@008
     C     REZNRO        ANDLE     ZPLAFI
     C*SQL
     C/EXEC SQL
     C+  SELECT COUNT(*) INTO :ZCAREZ
     C+  FROM REZARC WHERE
     C+  REZNRO = :REZNRO AND
     C+  REZEST IN('FIN', 'COP')
     C/END-EXEC
     C*SI REZFEC>=ZFEINR Y REZFEC<=ZFEFIR
     C     REZFEC        IFGE      ZFEINR
     C     REZFEC        ANDLE     ZFEFIR
     C* Estado temporal de la planilla
     C*PASAR ZESTAD 'COP'
     C                   MOVEL     'COP'         ZESTAD
     C* Número de planilla para cesantes
     C*PASAR ZRANDO REZNRO
     C                   MOVEL     REZNRO        ZRANDO
     C* Si para la plan. hay rezago = COP
     C*INICIARI REZARC01 (ZESTAD REZNRO)
     C     LL$028        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    REZNRO
     C     LL$028        SETLL     REZARC01                               85
     C     *IN85         IFEQ      '1'
     C                   MOVE      '0'           *IN85
     C                   ELSE
     C                   MOVE      '1'           *IN85
     C                   END
     C* Rezago COP para mismo usuario
     C*SI ERE(REZARC01) Y REZUSU = ZT@008
     C     *IN85         IFEQ      '0'
     C     REZUSU        ANDEQ     ZT@008
     C*PASAR ZESTAD 'FIN'
     C                   MOVEL     'FIN'         ZESTAD
     C* Planilla del rezago
     C*MOVER ZPLARE REZNRO
     C                   MOVE      REZNRO        ZPLARE
     C*OBTENER (1) ZERROR = 'Otro trabajo está procesando el rezago'|| Z
     C                   CLEAR                   ZERROR
     C     $HIL(030)     CAT       ZPLARE:1      ZERROR
     C* Imprime detalle de error
     C*IMPRIMIR  FMT@D3
     C                   EXCEPT    FMT@D3
     C*INICIARU REZARC19 (ZESTAD ZT@008 REZNRO)
     C     LL$029        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C                   KFLD                    REZNRO
     C     LL$029        SETGT     REZARC19                           78
     C* No procesar el rezago
     C*LEER REZARC19
     C                   READ      REZARC19                               78
     C*SINO
     C                   ELSE
     C* Lectura rezago y planilla
     C*EJECUTAR M00140
     C                   EXSR      M00140
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Leer entid. relacionadas
     C*EJECUTAR M00000
     C                   EXSR      M00000
     C*FIN
     C                   END
     C*MOVER L 1
     C                   Z-ADD     1             L
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Calcular totales conc Acr. rez Extr
     C*EJECUTAR M72000
     C                   EXSR      M72000
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*MOVER K 1
     C                   Z-ADD     1             K
     C*MOVER J 1
     C                   Z-ADD     1             J
     C*PASAR ZINDPE '0'
     C                   MOVEL     '0'           ZINDPE
     C*MIENTRAS K<L Y ZINDPE = '0'
     C     K             DOWLT     L
     C     ZINDPE        ANDEQ     '0'
     C* Valor x depósito - acre. rezagos
     C*MOVER ZVRDEP ZAR$RE[K]
     C                   Z-ADD     $X(K)         ZVRDEP
     C* Cuotas x deposito - acr. rezagos
     C*MOVER ZCUDEP ZARCRE[K]
     C                   Z-ADD     $Y(K)         ZCUDEP
     C* Fecha depósito - acr. rezagos
     C*MOVER ZFECDE ZARFRE[K]
     C                   MOVE      $Z(K)         ZFECDE
     C* Liq. ints. deudas empleador
     C*EJECUTAR M12030
     C                   EXSR      M12030
     C*PASAR DEPFEC ZFECDE
     C                   MOVEL     ZFECDE        DEPFEC
     C* Calcula valor no identificado
     C*EJECUTAR M12020
     C                   EXSR      M12020
     C* Procesar planilla extraordin.
     C*EJECUTAR M30020
     C                   EXSR      M30020
     C*CALCULAR ZSALDO = ZSACO+ZSAAR+ZSACVA+ZSACVE+ZSAFS+ZSAINT+ZSAIFS+Z
     C     ZSACO         ADD       ZSAAR         V$CA1           030 9
     C     V$CA1         ADD       ZSACVA        V$CA1
     C     V$CA1         ADD       ZSACVE        V$CA1
     C     V$CA1         ADD       ZSAFS         V$CA1
     C     V$CA1         ADD       ZSAINT        V$CA1
     C     V$CA1         ADD       ZSAIFS        V$CA1
     C     V$CA1         ADD       ZSAFGP        V$CA1
     C     V$CA1         ADD       ZSAIFG        V$CA1
     C     V$CA1         ADD       ZSASFS        V$CA1
     C     V$CA1         ADD       ZSAISF        ZSALDO
     C* Saldo cotización
     C*SI ZSALDO |= *CERO
     C     ZSALDO        IFNE      *ZERO
     C*SINO
     C                   ELSE
     C* Ind. pago en exceso empleador
     C*PASAR ZINDPE '1'
     C                   MOVEL     '1'           ZINDPE
     C*FIN
     C                   END
     C*SUMAR 1 K
     C                   ADD       1             K
     C*FIN
     C                   END
     C* Guarda índice para generar p.e.
     C*MOVER J L
     C                   Z-ADD     L             J
     C* Procesar detalles rezagos - Extr
     C*EJECUTAR M72100
     C                   EXSR      M72100
     C*FIN
     C                   END
     C*PASAR ZESTAD 'FIN'
     C                   MOVEL     'FIN'         ZESTAD
     C*INICIARU REZARC19 (ZESTAD ZT@008 ZPLAN1)
     C     LL$030        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C                   KFLD                    ZPLAN1
     C     LL$030        SETGT     REZARC19                           78
     C*LEER REZARC19
     C                   READ      REZARC19                               78
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*LEER REZARC19
     C                   READ      REZARC19                               78
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Acred. de rezagos x rev. mvto planilla traspaso             ==
     C*==                                                              ==
     C*==================================================================
     C     M00073        BEGSR
     C*PASAR ZESTAD 'FIN'
     C                   MOVEL     'FIN'         ZESTAD
     C*SI ZPLAIN=*CERO
     C     ZPLAIN        IFEQ      *ZERO
     C* Rz x estad, usuario
     C*INICIAR REZARC20 (ZESTAD ZT@008)
     C     LL$031        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C     LL$031        SETLL     REZARC20                           79
     C*SINO
     C                   ELSE
     C* Rez x estad, usuar, Planill
     C*INICIAR REZARC20 (ZESTAD ZT@008 ZPLAIN)
     C     LL$032        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C                   KFLD                    ZPLAIN
     C     LL$032        SETLL     REZARC20                           79
     C*FIN
     C                   END
     C*LEER REZARC20
     C                   READ      REZARC20                               79
     C*MIENTRAS NFA (REZARC20) Y REZEST=ZESTAD Y REZUSU=ZT@008 Y REZNRO<
     C     *IN79         DOWEQ     '0'
     C     REZEST        ANDEQ     ZESTAD
     C     REZUSU        ANDEQ     ZT@008
     C     REZNRO        ANDLE     ZPLAFI
     C*SQL
     C/EXEC SQL
     C+  SELECT COUNT(*) INTO :ZCAREZ
     C+  FROM REZARC WHERE
     C+  REZNRO = :REZNRO AND
     C+  REZEST IN('FIN', 'COP')
     C/END-EXEC
     C*SI REZFEC>=ZFEINR Y REZFEC<=ZFEFIR
     C     REZFEC        IFGE      ZFEINR
     C     REZFEC        ANDLE     ZFEFIR
     C*LIMPIAR ZOVCO1 ZOVTIP ZOVPER
     C                   CLEAR                   ZOVCO1
     C                   CLEAR                   ZOVTIP
     C                   CLEAR                   ZOVPER
     C* Estado temporal de la planilla
     C*PASAR ZESTAD 'COP'
     C                   MOVEL     'COP'         ZESTAD
     C* Numero de planilla para cesantes
     C*PASAR ZRANDO REZNRO
     C                   MOVEL     REZNRO        ZRANDO
     C* Si para plan. hay rezago = COP
     C*INICIARI REZARC01 (ZESTAD REZNRO)
     C     LL$033        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    REZNRO
     C     LL$033        SETLL     REZARC01                               85
     C     *IN85         IFEQ      '1'
     C                   MOVE      '0'           *IN85
     C                   ELSE
     C                   MOVE      '1'           *IN85
     C                   END
     C* Rezago COP mismo usuario
     C*SI ERE(REZARC01) Y REZUSU = ZT@008
     C     *IN85         IFEQ      '0'
     C     REZUSU        ANDEQ     ZT@008
     C*PASAR ZESTAD 'FIN'
     C                   MOVEL     'FIN'         ZESTAD
     C* Planilla del rezago
     C*MOVER ZPLARE REZNRO
     C                   MOVE      REZNRO        ZPLARE
     C*OBTENER (1) ZERROR = 'Otro trabajo está procesando el rezago'|| Z
     C                   CLEAR                   ZERROR
     C     $HIL(031)     CAT       ZPLARE:1      ZERROR
     C* Imprime detalle de error
     C*IMPRIMIR  FMT@D3
     C                   EXCEPT    FMT@D3
     C*INICIARU REZARC20 (ZESTAD ZT@008 REZNRO)
     C     LL$034        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C                   KFLD                    REZNRO
     C     LL$034        SETGT     REZARC20                           79
     C* No procesar el rezago
     C*LEER REZARC20
     C                   READ      REZARC20                               79
     C*SINO
     C                   ELSE
     C* Lectura rezago y planilla
     C*EJECUTAR M00140
     C                   EXSR      M00140
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Leer entid. relacionadas
     C*EJECUTAR M00000
     C                   EXSR      M00000
     C*FIN
     C                   END
     C*MOVER L 1
     C                   Z-ADD     1             L
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Calcular totales rezagos plan trasp
     C*EJECUTAR M73000
     C                   EXSR      M73000
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*MOVER K 1
     C                   Z-ADD     1             K
     C*MOVER J 1
     C                   Z-ADD     1             J
     C*PASAR ZINDPE '0'
     C                   MOVEL     '0'           ZINDPE
     C*MIENTRAS K<L Y ZINDPE = '0'
     C     K             DOWLT     L
     C     ZINDPE        ANDEQ     '0'
     C* Valor x depósito - acre. rezagos
     C*MOVER ZVRDEP ZAR$RE[K]
     C                   Z-ADD     $X(K)         ZVRDEP
     C* Cuotas x deposito - acr. rezagos
     C*MOVER ZCUDEP ZARCRE[K]
     C                   Z-ADD     $Y(K)         ZCUDEP
     C* Fecha depósito - acr. rezagos
     C*MOVER ZFECDE ZARFRE[K]
     C                   MOVE      $Z(K)         ZFECDE
     C*PASAR DEPFEC ZFECDE
     C                   MOVEL     ZFECDE        DEPFEC
     C* Calcula valor no identificado
     C*EJECUTAR M12020
     C                   EXSR      M12020
     C* Fecha de depósito
     C*MOVER AFECDE[K] ZFECDE
     C                   MOVE      ZFECDE        $G(K)
     C* Pagar fondo GPM e intereses FGPM
     C*EJECUTAR M12221
     C                   EXSR      M12221
     C* Pagar voluntaria afiliado
     C*EJECUTAR M12210
     C                   EXSR      M12210
     C* Pagar rendimientos
     C*EJECUTAR M12230
     C                   EXSR      M12230
     C* Pagar obligatoria
     C*EJECUTAR M12240
     C                   EXSR      M12240
     C* Pagar voluntaria empleador
     C*EJECUTAR M12245
     C                   EXSR      M12245
     C*CALCULAR ZSALDO = ZSACO+ZSAAR+ZSACVA+ZSACVE+ZSAFS+ZSAINT+ZSAIFS+Z
     C     ZSACO         ADD       ZSAAR         V$CA1           030 9
     C     V$CA1         ADD       ZSACVA        V$CA1
     C     V$CA1         ADD       ZSACVE        V$CA1
     C     V$CA1         ADD       ZSAFS         V$CA1
     C     V$CA1         ADD       ZSAINT        V$CA1
     C     V$CA1         ADD       ZSAIFS        V$CA1
     C     V$CA1         ADD       ZSAFGP        ZSALDO
     C* Saldo cotización
     C*SI ZSALDO |= *CERO
     C     ZSALDO        IFNE      *ZERO
     C*SINO
     C                   ELSE
     C* Ind. pago en exceso empleador
     C*PASAR ZINDPE '1'
     C                   MOVEL     '1'           ZINDPE
     C*FIN
     C                   END
     C*SUMAR 1 K
     C                   ADD       1             K
     C*FIN
     C                   END
     C* Guarda índice para genera p.e.
     C*MOVER J L
     C                   Z-ADD     L             J
     C* Procesar rezagos - traspaso
     C*EJECUTAR M73100
     C                   EXSR      M73100
     C*FIN
     C                   END
     C*PASAR ZESTAD 'FIN'
     C                   MOVEL     'FIN'         ZESTAD
     C*INICIARU REZARC20 (ZESTAD ZT@008 ZPLAN1)
     C     LL$035        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C                   KFLD                    ZPLAN1
     C     LL$035        SETGT     REZARC20                           79
     C*LEER REZARC20
     C                   READ      REZARC20                               79
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*LEER REZARC20
     C                   READ      REZARC20                               79
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Acred. de rezagos por rev. mvto planilla normal. (31)       ==
     C*==                                                              ==
     C*==================================================================
     C     M00074        BEGSR
     C*PASAR ZESTAD 'FIN'
     C                   MOVEL     'FIN'         ZESTAD
     C* Rez x estad, usuar, Planilla
     C*INICIAR REZARC21 (ZESTAD ZT@008)
     C     LL$036        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C     LL$036        SETLL     REZARC21                           56
     C*LEER REZARC21
     C                   READ      REZARC21                               56
     C*MIENTRAS NFA (REZARC21) Y REZEST=ZESTAD Y REZUSU=ZT@008
     C     *IN56         DOWEQ     '0'
     C     REZEST        ANDEQ     ZESTAD
     C     REZUSU        ANDEQ     ZT@008
     C*SI REZNRO <> ZEZNRO
     C     REZNRO        IFNE      ZEZNRO
     C*SQL
     C/EXEC SQL
     C+  SELECT COUNT(*) INTO :ZCAREZ
     C+  FROM REZARC WHERE
     C+  REZNRO = :REZNRO AND
     C+  REZEST IN('FIN', 'COP')
     C/END-EXEC
     C*LIMPIAR ZVLRRA ZCUORA ZVLRMA ZCUOMA ZREZPR ZVLPAC ZCTPAC
     C                   CLEAR                   ZVLRRA
     C                   CLEAR                   ZCUORA
     C                   CLEAR                   ZVLRMA
     C                   CLEAR                   ZCUOMA
     C                   CLEAR                   ZREZPR
     C                   CLEAR                   ZVLPAC
     C                   CLEAR                   ZCTPAC
     C*FIN
     C                   END
     C*SUMAR 1 ZREZPR
     C                   ADD       1             ZREZPR
     C*SI REZFEC>=ZFEINR Y REZFEC<=ZFEFIR
     C     REZFEC        IFGE      ZFEINR
     C     REZFEC        ANDLE     ZFEFIR
     C*SI REZNRO>=ZPLAIN Y REZNRO<=ZPLAFI
     C     REZNRO        IFGE      ZPLAIN
     C     REZNRO        ANDLE     ZPLAFI
     C*PASAR ZREZ3X ' '
     C                   MOVEL     ' '           ZREZ3X
     C*F QGRAALD (ZREZ3X 746 1)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZREZ3X        PARM      ZREZ3X        F$2Z1           250
     C                   PARM      746           F$2Z2             4 0
     C                   PARM      1             F$2Z3             4 0
     C*LIMPIAR ZOVCO1 ZOVPER ZOVTIP ZES13P
     C                   CLEAR                   ZOVCO1
     C                   CLEAR                   ZOVPER
     C                   CLEAR                   ZOVTIP
     C                   CLEAR                   ZES13P
     C* numero de planilla para cesantes
     C*PASAR ZRANDO REZNRO
     C                   MOVEL     REZNRO        ZRANDO
     C* Lectura rezago y planilla
     C*EJECUTAR M00140
     C                   EXSR      M00140
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Leer entid. relacionadas
     C*EJECUTAR M00000
     C                   EXSR      M00000
     C*FIN
     C                   END
     C*MOVER L 1
     C                   Z-ADD     1             L
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Calcular totales - rev. mvto plan n
     C*EJECUTAR M74000
     C                   EXSR      M74000
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*MOVER K 1
     C                   Z-ADD     1             K
     C*MOVER J 1
     C                   Z-ADD     1             J
     C*PASAR ZINDPE '0'
     C                   MOVEL     '0'           ZINDPE
     C*MIENTRAS K<L Y ZINDPE = '0'
     C     K             DOWLT     L
     C     ZINDPE        ANDEQ     '0'
     C* Valor x depósito - acre. rezagos
     C*MOVER ZVRDEP ZAR$RE[K]
     C                   Z-ADD     $X(K)         ZVRDEP
     C* Cuotas x deposito - acr. rezagos
     C*MOVER ZCUDEP ZARCRE[K]
     C                   Z-ADD     $Y(K)         ZCUDEP
     C* Fecha depósito - acr. rezagos
     C*MOVER ZFECDE ZARFRE[K]
     C                   MOVE      $Z(K)         ZFECDE
     C*PASAR DEPFEC ZFECDE
     C                   MOVEL     ZFECDE        DEPFEC
     C* Calcula valor no identificados
     C*EJECUTAR M12020
     C                   EXSR      M12020
     C* Procesar planilla
     C*EJECUTAR M12200
     C                   EXSR      M12200
     C*CALCULAR ZSALDO = ZSACO+ZSAAR+ZSACVA+ZSACVE+ZSAFS+ZSAINT+ZSAIFS+Z
     C     ZSACO         ADD       ZSAAR         V$CA1           030 9
     C     V$CA1         ADD       ZSACVA        V$CA1
     C     V$CA1         ADD       ZSACVE        V$CA1
     C     V$CA1         ADD       ZSAFS         V$CA1
     C     V$CA1         ADD       ZSAINT        V$CA1
     C     V$CA1         ADD       ZSAIFS        V$CA1
     C     V$CA1         ADD       ZSASFS        V$CA1
     C     V$CA1         ADD       ZSAISF        V$CA1
     C     V$CA1         ADD       ZSAFGP        V$CA1
     C     V$CA1         ADD       ZSAIFG        ZSALDO
     C* Saldo cotización
     C*SI ZSALDO |= *CERO
     C     ZSALDO        IFNE      *ZERO
     C*SINO
     C                   ELSE
     C* Ind. pago en exceso empleador
     C*PASAR ZINDPE '1'
     C                   MOVEL     '1'           ZINDPE
     C*FIN
     C                   END
     C*SUMAR 1 K
     C                   ADD       1             K
     C*FIN
     C                   END
     C* Guarda índice para generar p.e
     C*MOVER J L
     C                   Z-ADD     L             J
     C* Procesa detalles rezagos x rev. mvt
     C*EJECUTAR M74100
     C                   EXSR      M74100
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*MOVER ZEZNRO REZNRO
     C                   Z-ADD     REZNRO        ZEZNRO
     C*LEER REZARC21
     C                   READ      REZARC21                               56
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Valida si el rezago es de ajustes fase 3                    ==
     C*==                                                              ==
     C*==================================================================
     C     M00075        BEGSR
     C* No se encontro fecha depósito
     C*SI ZFECDE = *BLANCO Y Z10592 = 1
     C     ZFECDE        IFEQ      *BLANK
     C     Z10592        ANDEQ     1
     C* Indicador Rez. de ajustes
     C*LIMPIAR ZIND48
     C                   CLEAR                   ZIND48
     C* Busca FEQA48
     C*PASAR ZINARC 'F'
     C                   MOVEL     'F'           ZINARC
     C*LLAMAR TRFEQA50 (REZNRO REZNR1 REZNR2 REZTI5 REZEST REZID1 REZPER
     C                   CALL      'TRFEQA50'
     C                   PARM                    REZNRO
     C                   PARM                    REZNR1
     C                   PARM                    REZNR2
     C                   PARM                    REZTI5
     C                   PARM                    REZEST
     C                   PARM                    REZID1
     C                   PARM                    REZPER
     C                   PARM                    REZFEC
     C                   PARM                    REZEST
     C                   PARM                    ZTIPOD
     C                   PARM                    ZINARC
     C                   PARM                    ZIND48
     C* Rezago de ajuste
     C*SI ZIND48 = '1'
     C     ZIND48        IFEQ      '1'
     C* Fecha fondo acreditación
     C*PASAR ZFECDE PLAFEC
     C                   MOVEL     PLAFEC        ZFECDE
     C* Fecha fondo acreditación
     C*PASAR ZFECD1 PLAFEC
     C                   MOVEL     PLAFEC        ZFECD1
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular rend. Pendientes x Utilizar Pago en exceso Fusion  ==
     C*==                                                              ==
     C*==================================================================
     C     M00080        BEGSR
     C*LIMPIAR ZACVLI ZACCUI ZCRING
     C                   CLEAR                   ZACVLI
     C                   CLEAR                   ZACCUI
     C                   CLEAR                   ZCRING
     C*LIMPIAR ZCP229 ZCVPAG ZVEING ZREING ZCR229 ZCRING
     C                   CLEAR                   ZCP229
     C                   CLEAR                   ZCVPAG
     C                   CLEAR                   ZVEING
     C                   CLEAR                   ZREING
     C                   CLEAR                   ZCR229
     C                   CLEAR                   ZCRING
     C* Valor de la unidad de ING Fecha Fusion
     C*LLAMAR TRFEQA55 (ZFONDO ZFECFU ZVCFFI ZINFH3)
     C                   CALL      'TRFEQA55'
     C                   PARM                    ZFONDO
     C                   PARM                    ZFECFU
     C                   PARM                    ZVCFFI
     C                   PARM                    ZINFH3
     C* Si encontro
     C*SI ZINFH3 <> *BLANCOS
     C     ZINFH3        IFNE      *BLANKS
     C*LIMPIAR ZINFH3
     C                   CLEAR                   ZINFH3
     C* Fecha del deposito ING
     C*PASAR ZFDING ZAGF97
     C                   MOVEL     ZAGF97        ZFDING
     C* Valor de la unidad de ING Fecha Deposito
     C*LLAMAR TRFEQA55 (ZFONDO ZFDING ZVCFDI ZINFH3)
     C                   CALL      'TRFEQA55'
     C                   PARM                    ZFONDO
     C                   PARM                    ZFDING
     C                   PARM                    ZVCFDI
     C                   PARM                    ZINFH3
     C* Si encontro
     C*SI ZINFH3 <> *BLANCOS
     C     ZINFH3        IFNE      *BLANKS
     C* Valor en cuotas Rendimientos (Se redondea)
     C*CALCULAR ZCP229 = (ZVRPAG * ZAG020) / ZAGS16
     C     ZVRPAG        MULT      ZAG020        V$CA1           030 9
     C     V$CA1         DIV       ZAGS16        ZCP229
     C* Cuotas parte de PAGA22
     C*CALCULAR (R) ZCVPAG = ZCP229
     C                   Z-ADD(H)  ZCP229        ZCVPAG
     C*CALCULAR ZVEING = (ZCVPAG * ZVCFFI) - ZVRPAG
     C     ZCVPAG        MULT      ZVCFFI        V$CA1           030 9
     C     V$CA1         SUB       ZVRPAG        ZVEING
     C*CALCULAR (R) ZREING = ZVEING
     C                   Z-ADD(H)  ZVEING        ZREING
     C* Si no valoriza Pago en exceso
     C*SI ZINPEE = 'N' Y ZREING <> 0
     C     ZINPEE        IFEQ      'N'
     C     ZREING        ANDNE     0
     C* Rendimientos se van a Ingresos Diversos (HISAR4 transaccion 04 4
     C*PASAR ZCODTX '04'
     C                   MOVEL     '04'          ZCODTX
     C*PASAR ZCONCE '99'
     C                   MOVEL     '99'          ZCONCE
     C* Valor en cuotas fecha fusion
     C*CALCULAR ZCR229 = ZVEING / ZVCFFP
     C     ZVEING        DIV       ZVCFFP        ZCR229
     C*CALCULAR (R) ZCRING = ZCR229
     C                   Z-ADD(H)  ZCR229        ZCRING
     C* Valor cuotas HISAR4
     C*MOVER ZCUOHI ZCRING
     C                   Z-ADD     ZCRING        ZCUOHI
     C*
     C* Valor fecha fondo actual
     C*CALCULAR (R) ZVRINA = ZCRING * HISC28
     C     ZCRING        MULT(H)   HISC28        ZVRINA
     C*MOVER ZVALHI ZVRINA
     C                   Z-ADD     ZVRINA        ZVALHI
     C*EJECUTAR M00055
     C                   EXSR      M00055
     C*FIN SI
     C                   END
     C*FIN SI
     C                   END
     C*FIN SI
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular saldo en cuotas Fusion                             ==
     C*==                                                              ==
     C*==================================================================
     C     M00090        BEGSR
     C* Se redondea
     C*CALCULAR (R) ZSE229 = ZVRPAG / ZVCFFP
     C     ZVRPAG        DIV(H)    ZVCFFP        ZSE229
     C*CALCULAR (R) ZCUPAG = ZSE229
     C                   Z-ADD(H)  ZSE229        ZCUPAG
     C                   ENDSR
     C*==================================================================
     C*==  Valida actualización días cotizados                         ==
     C*==                                                              ==
     C*==================================================================
     C     M00100        BEGSR
     C* Período días cotizados
     C*LIMPIAR ZPERCO
     C                   CLEAR                   ZPERCO
     C*
     C* Si tipo planilla normal y tipo de pago es declaración y no pago
     C* y deuda está confirmada.
     C*
     C*SI DETTI8 = '01' Y DETT44 = '03' Y DETI28 = 'S'
     C     DETTI8        IFEQ      '01'
     C     DETT44        ANDEQ     '03'
     C     DETI28        ANDEQ     'S'
     C*
     C* Recupera días de cotización del detalle planilla de declaración
     C* generó la deuda real.
     C*
     C* Valida si ya mov con dias
     C*EJECUTAR M21005
     C                   EXSR      M21005
     C* DETARC05
     C*PASAR ZENTID '2'
     C                   MOVEL     '2'           ZENTID
     C* Campo númerico de 12
     C*MOVER ZNUM12 DETNU9
     C                   Z-ADD     DETNU9        ZNUM12
     C* Campo númerico de 12
     C*MOVER ZNUME3 DETPA2
     C                   Z-ADD     DETPA2        ZNUME3
     C* Campo númerico de 12
     C*MOVER ZNUMI3 DETSE4
     C                   Z-ADD     DETSE4        ZNUMI3
     C* Limpia variables
     C*LIMPIAR ZALFA8 ZALFA5 ZINERE ZNUME2 ZALFE1 ZNUME5 ZFITIP
     C                   CLEAR                   ZALFA8
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C                   CLEAR                   ZNUME2
     C                   CLEAR                   ZALFE1
     C                   CLEAR                   ZNUME5
     C                   CLEAR                   ZFITIP
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM21 ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM21
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C* Período de la deuda (Planilla)
     C*PASAR ZPERCO DEUPER
     C                   MOVEL     DEUPER        ZPERCO
     C* Ident. del afiliado
     C*MOVER DETNU2 ZNUM12
     C                   Z-ADD     ZNUM12        DETNU2
     C* Días acreditados afiliado
     C*MOVER DETDIA ZNUME2
     C                   Z-ADD     ZNUME2        DETDIA
     C* Días de incapacidad
     C*MOVER DETDI1 ZNUM21
     C                   Z-ADD     ZNUM21        DETDI1
     C* Salario base de cotización
     C*MOVER DETSAL ZNUME9
     C                   Z-ADD     ZNUME9        DETSAL
     C* Salario básico
     C*MOVER DETS12 ZNUMI9
     C                   Z-ADD     ZNUMI9        DETS12
     C* Salario calculado
     C*MOVER DETVA7 ZNUMR9
     C                   Z-ADD     ZNUMR9        DETVA7
     C* Novedad
     C*PASAR DETNOV ZALFA1
     C                   MOVEL     ZALFA1        DETNOV
     C* Indicador de novedad no aplica
     C*PASAR DETIN1 ZALFE1
     C                   MOVEL     ZALFE1        DETIN1
     C* vecntor de Novedades
     C*PASAR ZVECNO ZALF15
     C                   MOVEL     ZALF15        ZVECNO
     C* Tarifa alto riesgo
     C*MOVER DETTAR ZNUME5
     C                   Z-ADD     ZNUME5        DETTAR
     C* Tipo de planilla
     C*PASAR ZTIPLA '01'
     C                   MOVEL     '01'          ZTIPLA
     C* Se utiliza esta validación para controlar que cuando la planilla
     C* cancelación haya sido conciliada con varios depósitos, actualice
     C* relación A-E, solo una vez por detalle de deuda. Igual para DIAA
     C* El saldo y valor del det. son iguales
     C*SI ZSADET = ZVLDET Y ZINDIA=0
     C     ZSADET        IFEQ      ZVLDET
     C     ZINDIA        ANDEQ     0
     C* Actualizar relación afiliado-empleador
     C*EJECUTAR M14040
     C                   EXSR      M14040
     C*EJECUTAR M14075                   ** Actualización de días cotiza
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Verificación y creación de contratos                        ==
     C*==                                                              ==
     C*==================================================================
     C     M00110        BEGSR
     C*LIMPIAR ZCREAC
     C                   CLEAR                   ZCREAC
     C*SI ZTIPLA='07' Y PLAT03='07' O ZTIPLA='02' Y PLAT03='01'
     C     ZTIPLA        IFEQ      '07'
     C     PLAT03        ANDEQ     '07'
     C     ZTIPLA        OREQ      '02'
     C     PLAT03        ANDEQ     '01'
     C*SI ZT@002='3'
     C     ZT@002        IFEQ      '3'
     C* Recupera planilla del rezago
     C*RECUPERAR (N) PLAARC04 (ZPLAN1)
     C     ZPLAN1        CHAIN     PLAARC04                           74
     C*FIN
     C                   END
     C*SI ZNORET='X'
     C     ZNORET        IFEQ      'X'
     C*MOVER ZCREAC 9
     C                   Z-ADD     9             ZCREAC
     C*FIN
     C                   END
     C*LLAMAR TRCNAF53 (AFINUM PLATI1 PLANU4 PLAPER DETSAL ZCREAC)
     C                   CALL      'TRCNAF53'
     C                   PARM                    AFINUM
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    PLAPER
     C                   PARM                    DETSAL
     C                   PARM                    ZCREAC
     C* Crea contrato
     C*SI ZCREAC=1
     C     ZCREAC        IFEQ      1
     C*LIMPIAR $$CNAF
     C                   CLEAR                   $$CNAF
     C* Código interno del afiliado
     C*MOVER ZCNN22 AFINUM
     C                   Z-ADD     AFINUM        ZCNN22
     C* Tipo de identificación
     C*PASAR ZCNT37 PLATI1
     C                   MOVEL     PLATI1        ZCNT37
     C* Número identificación del t
     C*MOVER ZCNN23 PLANU4
     C                   Z-ADD     PLANU4        ZCNN23
     C* Consecutivo contrato
     C*MOVER ZCNC48 *CERO
     C                   MOVE      *ZERO         ZCNC48
     C* Tipo de contrato
     C*PASAR ZCNT38 '1'
     C                   MOVEL     '1'           ZCNT38
     C* Fecha inicio del contrato
     C*OBTENER ZCNF84 = PLAPER || '01'
     C     PLAPER        CAT       '01'          ZCNF84
     C* Fecha fin contrato
     C*LLAMAR TRULTDIA (ZCNF84 ZCNF85)
     C                   CALL      'TRULTDIA'
     C                   PARM                    ZCNF84
     C                   PARM                    ZCNF85
     C* Valor del contrato
     C*MOVER ZCNV18 DETSAL
     C                   Z-ADD     DETSAL        ZCNV18
     C* Ingreso base cotización
     C*MOVER ZCNIBC DETSAL
     C                   Z-ADD     DETSAL        ZCNIBC
     C* Novedad de retiro
     C*PASAR ZCNNOV *BLANCO
     C                   MOVEL     *BLANK        ZCNNOV
     C* Fecha creación
     C*PASAR ZCNF86 ZFESIS
     C                   MOVEL     ZFESIS        ZCNF86
     C* Usuario creación
     C*PASAR ZCNU25 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        ZCNU25
     C* Indicador de vigencia de SI
     C*PASAR ZCNI15 '1'
     C                   MOVEL     '1'           ZCNI15
     C* Hora de creación
     C*F QHORA (ZCNH16)
     C                   CALL      'F012SNAP'                                   QHORA
     C     ZCNH16        PARM      ZCNH16        F$301             6
     C* Campo FILLER/extra para reconstrucc
     C*PASAR ZCNFIL *BLANCO
     C                   MOVEL     *BLANK        ZCNFIL
     C* Acción insertar registro contrato
     C*PASAR ZCNACC 'I'
     C                   MOVEL     'I'           ZCNACC
     C* Ind. de error (0:No Error, 1:Error)
     C*PASAR ZCNERR *BLANCO
     C                   MOVEL     *BLANK        ZCNERR
     C* Error que retorna SQL
     C*MOVER ZCNSQL *CERO
     C                   MOVE      *ZERO         ZCNSQL
     C* Genera contrato
     C*LLAMAR TRCNAF52 ($$CNAF)
     C                   CALL      'TRCNAF52'
     C                   PARM                    $$CNAF
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Depuración relaciones Afiliado-empleador                    ==
     C*==                                                              ==
     C*==================================================================
     C     M00119        BEGSR
     C* Indicador de respuesta de TRREAE50
     C*PASAR ZEXREG '0'
     C                   MOVEL     '0'           ZEXREG
     C*SI AFIEST = 'INA' Y AFICO7 = 0 Y AFIT17 = '4'
     C     AFIEST        IFEQ      'INA'
     C     AFICO7        ANDEQ     0
     C     AFIT17        ANDEQ     '4'
     C*LLAMAR TRREAE50(AFINU3 ZFESIS ZEXREG)
     C                   CALL      'TRREAE50'
     C                   PARM                    AFINU3
     C                   PARM                    ZFESIS
     C                   PARM                    ZEXREG
     C*FIN
     C                   END
     C*
     C* Después de actualizar relación, invoca el proceso de depuración
     C* relaciones para independientes.
     C*SI AFICO7 = 0 Y AFIT17 = '2'
     C     AFICO7        IFEQ      0
     C     AFIT17        ANDEQ     '2'
     C* Código interno afiliado
     C*MOVER ZCODAF AFINU3
     C                   Z-ADD     AFINU3        ZCODAF
     C* Cantidad de registros encontrados
     C*LIMPIAR ZCANRE
     C                   CLEAR                   ZCANRE
     C*SQL
     C/EXEC SQL
     C+  SELECT COUNT(*) INTO :ZCANRE FROM AFIAR1
     C+  WHERE AFINU3 = :ZCODAF AND AFICO7 = 0
     C+  AND AFIT17= '2'
     C/END-EXEC
     C* Más de una relación existente
     C*SI ZCANRE > 1
     C     ZCANRE        IFGT      1
     C* Invoca proceso de depuración de relaciones
     C* Generación
     C*PASAR ZINPRO 'G'
     C                   MOVEL     'G'           ZINPRO
     C*LLAMAR RPAFEM50 (ZCODAF AFICO7 AFIT17 ZINPRO)
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Corroborar deudas                                           ==
     C*==                                                              ==
     C*==================================================================
     C     M00120        BEGSR
     C* Busca DETA65 con deuda
     C*PASAR ZDET65 'D'
     C                   MOVEL     'D'           ZDET65
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C*LIMPIAR ZDET65
     C                   CLEAR                   ZDET65
     C* Leer afiliado y cuenta
     C*EJECUTAR M21015
     C                   EXSR      M21015
     C* Per.planilla >= Per.reforma
     C*SI DEUPER > ZPEREF
     C     DEUPER        IFGT      ZPEREF
     C* Período para procesar F.S.
     C*PASAR ZPERFS DEUPER
     C                   MOVEL     DEUPER        ZPERFS
     C*PASAR ZINREF 'S'
     C                   MOVEL     'S'           ZINREF
     C* IBC del afiliado
     C*MOVER ZIBCAF DETSA2
     C                   Z-ADD     DETSA2        ZIBCAF
     C* Retorna FGPM Y SFSP
     C*EJECUTAR M77000
     C                   EXSR      M77000
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualizar interno afiliado forzosamente                    ==
     C*==                                                              ==
     C*==================================================================
     C     M00130        BEGSR
     C* Interno cero y 11433 activ
     C*SI DETN04=*CERO Y Z11433=1 Y REZNU1<>*CERO
     C     DETN04        IFEQ      *ZERO
     C     Z11433        ANDEQ     1
     C     REZNU1        ANDNE     *ZERO
     C* Se actualiza interno REZARC>DETARC
     C*MOVER DETN04 REZNU1
     C                   Z-ADD     REZNU1        DETN04
     C* Actualiza registro de DETARC
     C*GRABAR DETARC
     C     *IN49         IFEQ      '0'
     C                   UPDATE    DETREG                               94
     C                   ELSE
     C                   WRITE     DETREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*RECUPERARD (N) DETARC (PLANU3 PLANUM REZNR1 REZNR2)
     C     LL$037        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$037        CHAIN     DETARC                             4994
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DETARC no disponible - M00130'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(032)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Tipo de planilla Terceros
     C*SI REZTI5='07'
     C     REZTI5        IFEQ      '07'
     C*SI REZTI7='08' O REZTI7='14' O ZTPGRT='08' O ZTPGRT='14'
     C     REZTI7        IFEQ      '08'
     C     REZTI7        OREQ      '14'
     C     ZTPGRT        OREQ      '08'
     C     ZTPGRT        OREQ      '14'
     C*SI DETIN3='2'
     C     DETIN3        IFEQ      '2'
     C*LIMPIAR DETDI5
     C                   CLEAR                   DETDI5
     C*FIN
     C                   END
     C*SI DETIND='2'
     C     DETIND        IFEQ      '2'
     C*LIMPIAR DETDI2
     C                   CLEAR                   DETDI2
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Lectura rezago y planilla                                   ==
     C*==                                                              ==
     C*==================================================================
     C     M00140        BEGSR
     C* Limpiar todas las variables
     C*EJECUTAR M00050
     C                   EXSR      M00050
     C* Planilla
     C*MOVER ZPLAN1 REZNRO
     C                   Z-ADD     REZNRO        ZPLAN1
     C*INICIARI PLAARC04 (ZPLAN1)
     C     ZPLAN1        SETLL     PLAARC04                               74
     C     *IN74         IFEQ      '1'
     C                   MOVE      '0'           *IN74
     C                   ELSE
     C                   MOVE      '1'           *IN74
     C                   END
     C*SI ERE (PLAARC04)
     C     *IN74         IFEQ      '0'
     C* Recupera planilla del rezago
     C*RECUPERAR (N) PLAARC04 (ZPLAN1)
     C     ZPLAN1        CHAIN     PLAARC04                           74
     C* Período del rezago
     C*PASAR PLAPER REZPER
     C                   MOVEL     REZPER        PLAPER
     C* Cód.int. empleador del rzgo
     C*MOVER PLACOD REZCO3
     C                   Z-ADD     REZCO3        PLACOD
     C* Tipo ident.empl. del rzgo
     C*PASAR PLATI1 REZTIP
     C                   MOVEL     REZTIP        PLATI1
     C* Nro.ident. empl. del rzgo
     C*MOVER PLANU4 REZID1
     C                   Z-ADD     REZID1        PLANU4
     C* Razón soc. de empleador del rzgo
     C*PASAR PLANOM REZRAZ
     C                   MOVEL     REZRAZ        PLANOM
     C* Fecha del depósito
     C*LLAMAR CALFECDE (ZPLAN1 ZFECDE)
     C                   CALL      'CALFECDE'
     C                   PARM                    ZPLAN1
     C                   PARM                    ZFECDE
     C* Buscar planilla base de retroactiva
     C*EJECUTAR M00180
     C                   EXSR      M00180
     C* Fecha del depósito
     C*PASAR ZFECD1 ZFECDE
     C                   MOVEL     ZFECDE        ZFECD1
     C* Valida rezago de ajuste por detalle
     C*EJECUTAR M00075
     C                   EXSR      M00075
     C* Fecha del depósito en blanco
     C*SI ZFECDE = *BLANCO
     C     ZFECDE        IFEQ      *BLANK
     C*PASAR ZERROR 'No se pudo calcular fecha depósito'
     C                   MOVEL     $HIL(033)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*MOVER PLANU1 ZPLAN1
     C                   Z-ADD     ZPLAN1        PLANU1
     C*PASAR ZERROR 'No se encontró planilla del rezago'
     C                   MOVEL     $HIL(034)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Limpiar variables de HISAR4                                 ==
     C*==                                                              ==
     C*==================================================================
     C     M00150        BEGSR
     C*LIMPIAR ZVMCVA ZCMCVA ZVMFS  ZCMFS  ZVMIFS ZCMIFS
     C                   CLEAR                   ZVMCVA
     C                   CLEAR                   ZCMCVA
     C                   CLEAR                   ZVMFS
     C                   CLEAR                   ZCMFS
     C                   CLEAR                   ZVMIFS
     C                   CLEAR                   ZCMIFS
     C*LIMPIAR ZVMINT ZCMINT ZVMREN ZCMREN ZVMAR  ZCMAR
     C                   CLEAR                   ZVMINT
     C                   CLEAR                   ZCMINT
     C                   CLEAR                   ZVMREN
     C                   CLEAR                   ZCMREN
     C                   CLEAR                   ZVMAR
     C                   CLEAR                   ZCMAR
     C*LIMPIAR ZVMCO  ZCMCO  ZVMPS  ZCMPS  ZVMCVE ZCMCVE
     C                   CLEAR                   ZVMCO
     C                   CLEAR                   ZCMCO
     C                   CLEAR                   ZVMPS
     C                   CLEAR                   ZCMPS
     C                   CLEAR                   ZVMCVE
     C                   CLEAR                   ZCMCVE
     C*LIMPIAR ZVMCCA ZCMCCA ZVMCCE ZCMCCE ZVMCCO ZCMCCO
     C                   CLEAR                   ZVMCCA
     C                   CLEAR                   ZCMCCA
     C                   CLEAR                   ZVMCCE
     C                   CLEAR                   ZCMCCE
     C                   CLEAR                   ZVMCCO
     C                   CLEAR                   ZCMCCO
     C*LIMPIAR ZVMFGP ZCMFGP ZVMIFG ZCMIFG ZVMSFS ZCMSFS
     C                   CLEAR                   ZVMFGP
     C                   CLEAR                   ZCMFGP
     C                   CLEAR                   ZVMIFG
     C                   CLEAR                   ZCMIFG
     C                   CLEAR                   ZVMSFS
     C                   CLEAR                   ZCMSFS
     C*LIMPIAR ZVMISF ZCMISF ZTOVRE ZTOCRE ZTOVRN ZTOCRN
     C                   CLEAR                   ZVMISF
     C                   CLEAR                   ZCMISF
     C                   CLEAR                   ZTOVRE
     C                   CLEAR                   ZTOCRE
     C                   CLEAR                   ZTOVRN
     C                   CLEAR                   ZTOCRN
     C*LIMPIAR ZVRRET ZVPXRZ ZCPXRZ ZINDRS ZVRPE ZCUPE
     C                   CLEAR                   ZVRRET
     C                   CLEAR                   ZVPXRZ
     C                   CLEAR                   ZCPXRZ
     C                   CLEAR                   ZINDRS
     C                   CLEAR                   ZVRPE
     C                   CLEAR                   ZCUPE
     C*LIMPIAR ZVRDEU ZTOTDE ZTOTIN ZTOTI2 ZTOTD1 ZTOTI1 ZTOTI3
     C                   CLEAR                   ZVRDEU
     C                   CLEAR                   ZTOTDE
     C                   CLEAR                   ZTOTIN
     C                   CLEAR                   ZTOTI2
     C                   CLEAR                   ZTOTD1
     C                   CLEAR                   ZTOTI1
     C                   CLEAR                   ZTOTI3
     C                   ENDSR
     C*==================================================================
     C*==  Fechas iniciales relación depend/situad                     ==
     C*==                                                              ==
     C*==================================================================
     C     M00160        BEGSR
     C* Planilla depend, situado
     C*SI ZTIPLA='01' O ZTIPLA='04'
     C     ZTIPLA        IFEQ      '01'
     C     ZTIPLA        OREQ      '04'
     C* Restar 1 mes a in
     C*FUNCION QRESME1 (AFIFE9 1 ZFEINY)
     C                   CALL      'RPRESME1'                                   QRESME1
     C     AFIFE9        PARM      AFIFE9        F$4D1             8
     C                   PARM      1             F$4D2             8 0
     C     ZFEINY        PARM      ZFEINY        F$4D3             8
     C* Periodo inicio calculado
     C*PASAR ZPEINY ZFEINY
     C                   MOVEL     ZFEINY        ZPEINY
     C* Periodo planilla = Inicio rel-1 m
     C*SI ZPEINY=ZPERCO
     C     ZPEINY        IFEQ      ZPERCO
     C* Fecha inicial relación
     C*PASAR ZFEINX AFIFE9
     C                   MOVEL     AFIFE9        ZFEINX
     C*FIN
     C                   END
     C*PASAR ZPERMN '1'
     C                   MOVEL     '1'           ZPERMN
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Ejecuciones TRDPIN50                                        ==
     C*==                                                              ==
     C*==================================================================
     C     M00170        BEGSR
     C* Lote
     C*PASAR ZLOT PLANU3
     C                   MOVEL     PLANU3        ZLOT
     C* Planilla
     C*MOVER ZPLA PLANUM
     C                   Z-ADD     PLANUM        ZPLA
     C* Página
     C*MOVER ZPAG DETPAG
     C                   Z-ADD     DETPAG        ZPAG
     C* Secuencia
     C*MOVER ZSEC DETSEC
     C                   Z-ADD     DETSEC        ZSEC
     C* Tipo planilla
     C*MOVER ZTPLA PLATIP
     C                   MOVE      PLATIP        ZTPLA
     C* Tipo pago
     C*MOVER ZTPAG PLAT03
     C                   MOVE      PLAT03        ZTPAG
     C* Indicador de amnistia de pago
     C*PASAR ZAMP ZAMNPA
     C                   MOVEL     ZAMNPA        ZAMP
     C* Fecha del depósito
     C*PASAR ZFDE ZFECDE
     C                   MOVEL     ZFECDE        ZFDE
     C* Grabar cotizaciones detalle
     C*CASO ZIND = '0'
     C                   SELECT
     C     ZIND          WHENEQ    '0'
     C*LLAMAR TRDPIN50 (ZIND ZLOT ZPLA ZPAG ZSEC ZFDE ZID ZPER ZTPLA ZTP
     C                   CALL      'TRDPIN50'
     C                   PARM                    ZIND
     C                   PARM                    ZLOT
     C                   PARM                    ZPLA
     C                   PARM                    ZPAG
     C                   PARM                    ZSEC
     C                   PARM                    ZFDE
     C                   PARM                    ZID
     C                   PARM                    ZPER
     C                   PARM                    ZTPLA
     C                   PARM                    ZTPAG
     C                   PARM                    ZINDLI
     C                   PARM                    ZAMP
     C                   PARM                    ZLIQIN
     C                   PARM                    ZCOTFS
     C                   PARM                    ZCOTSF
     C                   PARM                    ZCOTOB
     C                   PARM                    ZCOTVA
     C                   PARM                    ZCOTVE
     C                   PARM                    ZCOTAR
     C                   PARM                    ZCOTFG
     C                   PARM                    ZER
     C                   PARM                    ZFI
     C* Calcular intereses a la planilla
     C*CASO ZIND = '1'
     C     ZIND          WHENEQ    '1'
     C*LLAMAR TRDPIN50 (ZIND ZLOT ZPLA ZPAG ZSEC ZFDE ZID ZPER ZTPLA ZTP
     C                   CALL      'TRDPIN50'
     C                   PARM                    ZIND
     C                   PARM                    ZLOT
     C                   PARM                    ZPLA
     C                   PARM                    ZPAG
     C                   PARM                    ZSEC
     C                   PARM                    ZFDE
     C                   PARM                    ZID
     C                   PARM                    ZPER
     C                   PARM                    ZTPLA
     C                   PARM                    ZTPAG
     C                   PARM                    ZINDLI
     C                   PARM                    ZAMP
     C                   PARM                    ZLIQIN
     C                   PARM                    ZSAIFS
     C                   PARM                    ZSAISF
     C                   PARM                    ZSAINT
     C                   PARM                    ZSICVA
     C                   PARM                    ZSICVE
     C                   PARM                    ZSINAR
     C                   PARM                    ZSAIFG
     C                   PARM                    ZER
     C                   PARM                    ZFI
     C* Calcular intereses x detalle
     C*CASO ZIND = '2'
     C     ZIND          WHENEQ    '2'
     C*LLAMAR TRDPIN50 (ZIND ZLOT ZPLA ZPAG ZSEC ZFDE ZID ZPER ZTPLA ZTP
     C                   CALL      'TRDPIN50'
     C                   PARM                    ZIND
     C                   PARM                    ZLOT
     C                   PARM                    ZPLA
     C                   PARM                    ZPAG
     C                   PARM                    ZSEC
     C                   PARM                    ZFDE
     C                   PARM                    ZID
     C                   PARM                    ZPER
     C                   PARM                    ZTPLA
     C                   PARM                    ZTPAG
     C                   PARM                    ZINDLI
     C                   PARM                    ZAMP
     C                   PARM                    ZLIQIN
     C                   PARM                    ZINIFS
     C                   PARM                    ZINISF
     C                   PARM                    ZININT
     C                   PARM                    ZINCVA
     C                   PARM                    ZINCVE
     C                   PARM                    ZINNAR
     C                   PARM                    ZINIFG
     C                   PARM                    ZER
     C                   PARM                    ZFI
     C* Calcular intereses x detalle
     C*CASO ZIND = '3'
     C     ZIND          WHENEQ    '3'
     C* Se recibe la fecha límite de pago
     C*LIMPIAR ZFDE
     C                   CLEAR                   ZFDE
     C*LLAMAR TRDPIN50 (ZIND ZLOT ZPLA ZPAG ZSEC ZFDE ZID ZPER ZTPLA ZTP
     C                   CALL      'TRDPIN50'
     C                   PARM                    ZIND
     C                   PARM                    ZLOT
     C                   PARM                    ZPLA
     C                   PARM                    ZPAG
     C                   PARM                    ZSEC
     C                   PARM                    ZFDE
     C                   PARM                    ZID
     C                   PARM                    ZPER
     C                   PARM                    ZTPLA
     C                   PARM                    ZTPAG
     C                   PARM                    ZINDLI
     C                   PARM                    ZAMP
     C                   PARM                    ZLIQIN
     C                   PARM                    ZINIFS
     C                   PARM                    ZINISF
     C                   PARM                    ZININT
     C                   PARM                    ZINCVA
     C                   PARM                    ZINCVE
     C                   PARM                    ZINNAR
     C                   PARM                    ZINIFG
     C                   PARM                    ZER
     C                   PARM                    ZFI
     C* Fecha última liq. intereses
     C*MOVER ZFECHA ZFDE
     C                   MOVE      ZFDE          ZFECHA
     C*FINCASOS
     C                   ENDSL
     C                   ENDSR
     C*==================================================================
     C*==  Buscar planilla base de retroactiva                         ==
     C*==                                                              ==
     C*==================================================================
     C     M00180        BEGSR
     C*LIMPIAR ZPLART ZTPGRT
     C                   CLEAR                   ZPLART
     C                   CLEAR                   ZTPGRT
     C* Solo aplica a planillas 09 Retroac
     C*SI PLAT03='09'
     C     PLAT03        IFEQ      '09'
     C* Busca planilla origen de la retroac
     C*INICIARI PLAAR601 (PLAN05)
     C     PLAN05        SETLL     PLAAR601                               61
     C     *IN61         IFEQ      '1'
     C                   MOVE      '0'           *IN61
     C                   ELSE
     C                   MOVE      '1'           *IN61
     C                   END
     C* Encontró planilla retroactiva
     C*SI ERE (PLAAR601)
     C     *IN61         IFEQ      '0'
     C* Lee planilla origen de retroactiva
     C*LEER PLAAR601
     C                   READ      PLAAR601                               61
     C*SINO
     C                   ELSE
     C* Busca planilla origen de la retroac
     C*INICIARI PLAAR603 (PLAN05)
     C     PLAN05        SETLL     PLAAR603                               62
     C     *IN62         IFEQ      '1'
     C                   MOVE      '0'           *IN62
     C                   ELSE
     C                   MOVE      '1'           *IN62
     C                   END
     C* Encontró planilla retroactiva
     C*SI ERE (PLAAR603)
     C     *IN62         IFEQ      '0'
     C* Lee planilla origen de retroactiva
     C*LEER PLAAR603
     C                   READ      PLAAR603                               62
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ERE (PLAAR601) O ERE (PLAAR603)
     C     *IN61         IFEQ      '0'
     C     *IN62         OREQ      '0'
     C* Asigna tipo planilla origen
     C*PASAR ZPLART PLATI5
     C                   MOVEL     PLATI5        ZPLART
     C* Asigna tipo pago planilla origen
     C*PASAR ZTPGRT PLATI8
     C                   MOVEL     PLATI8        ZTPGRT
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Nuevas fechas vigencia retención                            ==
     C*==                                                              ==
     C*==================================================================
     C     M00190        BEGSR
     C*SI ZT@002<>'F'
     C     ZT@002        IFNE      'F'
     C* Tipo proceso voluntarias FVIADI
     C*PASAR ZFVTPR 'R'
     C                   MOVEL     'R'           ZFVTPR
     C*LLAMAR TRCONF62 (ZFVTPR ZFVIN1 ZFVFI1 ZFVIN2 ZFVFI2 ZFVRET ZTEXTO
     C                   CALL      'TRCONF62'
     C                   PARM                    ZFVTPR
     C                   PARM                    ZFVIN1
     C                   PARM                    ZFVFI1
     C                   PARM                    ZFVIN2
     C                   PARM                    ZFVFI2
     C                   PARM                    ZFVRET
     C                   PARM                    ZTEXTO
     C* Variable FVIADI no configurada
     C*SI ZTEXTO<>*BLANCO
     C     ZTEXTO        IFNE      *BLANK
     C* Mensaje
     C*PASAR ZERROR ZTEXTO
     C                   CLEAR                   ZERROR
     C                   MOVEL     ZTEXTO        ZERROR
     C* Imprimir error y terminar
     C*EJECUTAR M00023
     C                   EXSR      M00023
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Agregar modificación a planilla                             ==
     C*==                                                              ==
     C*==================================================================
     C     M00200        BEGSR
     C*
     C* Agregar registro a 'Modificaciones a planillas'
     C* Origen - Planilla normal
     C*MOVER ZTORIG 1
     C                   Z-ADD     1             ZTORIG
     C* Proceso - Acreditación
     C*MOVER ZTPROC 1
     C                   Z-ADD     1             ZTPROC
     C* Tipo de registro Rezago
     C*SI ZTMOPL = 1
     C     ZTMOPL        IFEQ      1
     C*LLAMAR TRMOPL50(HISFE3 REZNRO REZNR1 REZNR2 ZTMOPL ZTORIG ZTPROC)
     C                   CALL      'TRMOPL50'
     C                   PARM                    HISFE3
     C                   PARM                    REZNRO
     C                   PARM                    REZNR1
     C                   PARM                    REZNR2
     C                   PARM                    ZTMOPL
     C                   PARM                    ZTORIG
     C                   PARM                    ZTPROC
     C*SINO
     C                   ELSE
     C* Tipo de registro Pago en exceso
     C*SI ZTMOPL = 2
     C     ZTMOPL        IFEQ      2
     C* Auxiliar Nr. pag/sec
     C*MOVER ZPGSEC 0
     C                   Z-ADD     0             ZPGSEC
     C*LLAMAR TRMOPL50(HISFE3 PAGNUM ZPGSEC ZPGSEC ZTMOPL ZTORIG ZTPROC)
     C                   CALL      'TRMOPL50'
     C                   PARM                    HISFE3
     C                   PARM                    PAGNUM
     C                   PARM                    ZPGSEC
     C                   PARM                    ZPGSEC
     C                   PARM                    ZTMOPL
     C                   PARM                    ZTORIG
     C                   PARM                    ZTPROC
     C*SINO
     C                   ELSE
     C* Tipo de registro Reacreditación
     C*SI ZTMOPL=3
     C     ZTMOPL        IFEQ      3
     C* Auxiliar Nr. pag/sec
     C*MOVER ZPGSEC 0
     C                   Z-ADD     0             ZPGSEC
     C*LLAMAR TRMOPL50(HISFE3 PLANU1 ZPGSEC ZPGSEC ZTMOPL ZTORIG ZTPROC)
     C                   CALL      'TRMOPL50'
     C                   PARM                    HISFE3
     C                   PARM                    PLANU1
     C                   PARM                    ZPGSEC
     C                   PARM                    ZPGSEC
     C                   PARM                    ZTMOPL
     C                   PARM                    ZTORIG
     C                   PARM                    ZTPROC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C                   ENDSR
     C*==================================================================
     C*==  Acreditación aporte voluntario                              ==
     C*==                                                              ==
     C*==================================================================
     C     M00210        BEGSR
     C*LLAMAR TRDAPV58 (MOVNU2 MOVPAG MOVSEC MOVCON MOVCO4 ZRETCO ZINACR
     C                   CALL      'TRDAPV58'
     C                   PARM                    MOVNU2
     C                   PARM                    MOVPAG
     C                   PARM                    MOVSEC
     C                   PARM                    MOVCON
     C                   PARM                    MOVCO4
     C                   PARM                    ZRETCO
     C                   PARM                    ZINACR
     C                   PARM                    ZVRECO
     C                   PARM                    ZVTVVA
     C                   PARM                    ZVTVVE
     C                   PARM                    ZCTCVA
     C                   PARM                    ZCTCVE
     C                   PARM                    ZINDER
     C                   PARM                    ZERRET
     C                   PARM                    $$D
     C* Retoma el movimiento después de acreditar aporte voluntario (ret
     C*RECUPERAR MOVARC06 (MOV148 MOVNU2 MOVPAG MOVSEC MOVCON MOVCO4)
     C     LL$038        KLIST
     C                   KFLD                    MOV148
     C                   KFLD                    MOVNU2
     C                   KFLD                    MOVPAG
     C                   KFLD                    MOVSEC
     C                   KFLD                    MOVCON
     C                   KFLD                    MOVCO4
     C     LL$038        CHAIN     MOVARC06                           68
     C     *IN68         IFEQ      '1'
     C                   CLEAR                   MOVC18
     C                   CLEAR                   MOVCDI
     C                   CLEAR                   MOVTIP
     C                   CLEAR                   MOVCOD
     C                   CLEAR                   MOVCO7
     C                   CLEAR                   MOVC27
     C                   CLEAR                   MOVCOM
     C                   CLEAR                   MOVCO8
     C                   CLEAR                   MOVCOT
     C                   CLEAR                   MOVCO5
     C                   CLEAR                   MOVCO6
     C                   CLEAR                   MOVC24
     C                   CLEAR                   MOVCU5
     C                   CLEAR                   MOVC28
     C                   CLEAR                   MOVCU2
     C                   CLEAR                   MOVC25
     C                   CLEAR                   MOV059
     C                   CLEAR                   MOV057
     C                   CLEAR                   MOVCU6
     C                   CLEAR                   MOVC16
     C                   CLEAR                   MOVCU7
     C                   CLEAR                   MOVC19
     C                   CLEAR                   MOV058
     C                   CLEAR                   MOVCUO
     C                   CLEAR                   MOVCU3
     C                   CLEAR                   MOVCU4
     C                   CLEAR                   MOVCU8
     C                   CLEAR                   MOV056
     C                   CLEAR                   MOVDIA
     C                   CLEAR                   MOVEST
     C                   CLEAR                   MOVFEC
     C                   CLEAR                   MOVFE1
     C                   CLEAR                   MOVFE7
     C                   CLEAR                   MOVFE5
     C                   CLEAR                   MOVFE6
     C                   CLEAR                   MOVHOR
     C                   CLEAR                   MOVHO8
     C                   CLEAR                   MOVI26
     C                   CLEAR                   MOVI11
     C                   CLEAR                   MOVINT
     C                   CLEAR                   MOVIN2
     C                   CLEAR                   MOVI06
     C                   CLEAR                   MOVI05
     C                   CLEAR                   MOVNUM
     C                   CLEAR                   MOVPER
     C                   CLEAR                   MOVPLA
     C                   CLEAR                   MOVR15
     C                   CLEAR                   MOVRET
     C                   CLEAR                   MOVSA2
     C                   CLEAR                   MOVSAL
     C                   CLEAR                   MOVSU1
     C                   CLEAR                   MOVTA1
     C                   CLEAR                   MOVT10
     C                   CLEAR                   MOVTI5
     C                   CLEAR                   MOVT11
     C                   CLEAR                   MOVVA4
     C                   CLEAR                   MOVVAL
     C                   CLEAR                   MOVV13
     C                   CLEAR                   MOVV12
     C                   CLEAR                   MOVV14
     C                   CLEAR                   MOVCO1
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Elimina detalles de intereses de planillas de terceros      ==
     C*==                                                              ==
     C*==================================================================
     C     M00250        BEGSR
     C* Limpia archivo temporal que se utiliza para la liquidación de in
     C* en planillas de terceros.
     C*SI ZTIPXX <> 'W' Y ZTLLAM <> 'X'
     C     ZTIPXX        IFNE      'W'
     C     ZTLLAM        ANDNE     'X'
     C*SQL
     C/EXEC SQL
     C+  DELETE FROM DETA31 WHERE DETLOT = :PLANU3 AND DETPL8 = :PLANUM
     C/END-EXEC
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Obtiene datos de la deuda                                   ==
     C*==                                                              ==
     C*==================================================================
     C     M00300        BEGSR
     C*INICIARI EMPAR204 (DEUNRO)
     C     DEUNRO        SETLL     EMPAR204                               58
     C     *IN58         IFEQ      '1'
     C                   MOVE      '0'           *IN58
     C                   ELSE
     C                   MOVE      '1'           *IN58
     C                   END
     C* Empleadores del sistema
     C*SI ERE(EMPAR204)
     C     *IN58         IFEQ      '0'
     C*LEER EMPAR204
     C                   READ      EMPAR204                               58
     C* Código empleador
     C*MOVER ZLA117 EMPCO6
     C                   Z-ADD     EMPCO6        ZLA117
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Valida PE de planillas de Fusión                            ==
     C*==                                                              ==
     C*==================================================================
     C     M00400        BEGSR
     C*LIMPIAR ZPECRU ZPLORF
     C                   CLEAR                   ZPECRU
     C                   CLEAR                   ZPLORF
     C*SQL
     C/EXEC SQL
     C+  SELECT FEQPL6 INTO :ZPLORF
     C+  FROM FEQA48
     C+  WHERE FEQPL5 = :DETNU9
     C+  FETCH FIRST 1 ROWS ONLY
     C/END-EXEC
     C*SI SQLCOD = 0 Y ZPLORF <> 0
     C     SQLCOD        IFEQ      0
     C     ZPLORF        ANDNE     0
     C* Planilla a validar PE para cruce
     C*MOVER ZPECRU ZPLORF
     C                   Z-ADD     ZPLORF        ZPECRU
     C* Agrega PE para cruce
     C*EJECUTAR M00401
     C                   EXSR      M00401
     C*SQL
     C/EXEC SQL
     C+  DECLARE PLFUS CURSOR FOR
     C+  SELECT FEQPL5 FROM FEQA48
     C+  WHERE FEQPL6 = :ZPLORF
     C+  AND FEQPL5 <> :DETNU9
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  OPEN PLFUS
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  FETCH PLFUS INTO :ZPECRU
     C/END-EXEC
     C*MIENTRAS SQLCOD = 0
     C     SQLCOD        DOWEQ     0
     C*SI ZPECRU <> 0
     C     ZPECRU        IFNE      0
     C* Agrega PE para cruce
     C*EJECUTAR M00401
     C                   EXSR      M00401
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  FETCH PLFUS INTO :ZPECRU
     C/END-EXEC
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  CLOSE PLFUS
     C/END-EXEC
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Agrega Planilla de PE para cruce                            ==
     C*==                                                              ==
     C*==================================================================
     C     M00401        BEGSR
     C*LIMPIAR ZNUPEX
     C                   CLEAR                   ZNUPEX
     C*SQL
     C/EXEC SQL
     C+  SELECT PAGNUM INTO :ZNUPEX
     C+  FROM PAGARC
     C+  WHERE PAGNUM = :ZPECRU
     C+  AND PAGSA3 > 0
     C/END-EXEC
     C*SI SQLCOD = 0  Y ZNUPEX <> 0
     C     SQLCOD        IFEQ      0
     C     ZNUPEX        ANDNE     0
     C* Agregar a PAGA30
     C*PASAR ZACC50 'A'
     C                   MOVEL     'A'           ZACC50
     C*LLAMAR RPPEXR50 (ZNUPEX ZACC50)
     C                   CALL      'RPPEXR50'
     C                   PARM                    ZNUPEX
     C                   PARM                    ZACC50
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Proceso decreto 1858 FSP                                    ==
     C*==                                                              ==
     C*==================================================================
     C     M01858        BEGSR
     C*LIMPIAR ZVAFSP ZCUFSP ZI1858 ZLLFSP $$FSP
     C                   CLEAR                   ZVAFSP
     C                   CLEAR                   ZCUFSP
     C                   CLEAR                   ZI1858
     C                   CLEAR                   ZLLFSP
     C                   CLEAR                   $$FSP
     C*SI ZFSPAR = '1'
     C     ZFSPAR        IFEQ      '1'
     C* Fondo
     C*MOVER ZFOFSP MOV148
     C                   MOVE      MOV148        ZFOFSP
     C* Planilla
     C*MOVER ZPLFSP MOVNU2
     C                   Z-ADD     MOVNU2        ZPLFSP
     C* Pagina
     C*MOVER ZPAFSP MOVPAG
     C                   Z-ADD     MOVPAG        ZPAFSP
     C* Secuencia
     C*MOVER ZSEFSP MOVSEC
     C                   Z-ADD     MOVSEC        ZSEFSP
     C* Acción: Consultar detalle
     C*PASAR ZACFSP 'D'
     C                   MOVEL     'D'           ZACFSP
     C*LLAMAR RPFSPR50 ($$FSP)
     C                   CALL      'RPFSPR50'
     C                   PARM                    $$FSP
     C* Existe en FSPARC
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C* FSP
     C*SUMAR ZZAFSP MOVCO8
     C                   ADD       ZZAFSP        MOVCO8
     C* Cuotas FSP
     C*SUMAR ZZUFSP MOVCU8
     C                   ADD       ZZUFSP        MOVCU8
     C* Valor subsistencia
     C*SUMAR ZVZFSP MOVV13
     C                   ADD       ZVZFSP        MOVV13
     C* Cuotas subsistencia
     C*SUMAR ZCSFSP MOV058
     C                   ADD       ZCSFSP        MOV058
     C* Intereses FSP
     C*SUMAR ZVIFSP MOVIN2
     C                   ADD       ZVIFSP        MOVIN2
     C* Cuotas intereses FSP
     C*SUMAR ZCIFSP MOVC16
     C                   ADD       ZCIFSP        MOVC16
     C* Intereses subsistencia
     C*SUMAR ZVISUB MOVI06
     C                   ADD       ZVISUB        MOVI06
     C* Cuotas intereses subsistencia
     C*SUMAR ZCISUB MOV059
     C                   ADD       ZCISUB        MOV059
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Crear registro de aporte voluntario                         ==
     C*==                                                              ==
     C*==================================================================
     C     M09000        BEGSR
     C*SI ZT@001<>*BLANCO Y ZT@003<>*BLANCO Y ZT@004=*BLANCO Y ZT@002='3
     C     ZT@001        IFNE      *BLANK
     C     ZT@003        ANDNE     *BLANK
     C     ZT@004        ANDEQ     *BLANK
     C     ZT@002        ANDEQ     '3'
     C* No ha leido cuenta por rezago
     C*SI ZCUERZ=*CERO
     C     ZCUERZ        IFEQ      *ZERO
     C* Código interno afil
     C*MOVER CUENUM AFINUM
     C                   Z-ADD     AFINUM        CUENUM
     C* Código fondo moderado
     C*PASAR CUEC17 ZFONDO
     C                   MOVEL     ZFONDO        CUEC17
     C*RECUPERARD CUEARC (CUENUM CUEC17)
     C     LL$039        KLIST
     C                   KFLD                    CUENUM
     C                   KFLD                    CUEC17
     C     LL$039        CHAIN     CUEARC                             4594
     C                   MOVE      *IN94         I$RND
     C     *IN45         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   CUEREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SINO
     C                   ELSE
     C*MOVER ZPLAER PLANUM
     C                   MOVE      PLANUM        ZPLAER
     C*MOVER ZAFIIN CUENUM
     C                   CLEAR                   ZAFIIN
     C                   MOVE      CUENUM        ZAFIIN
     C*OBTENER (1) ZERROR = 'CUEARC no disponible - M09000' || ZPLAER ||
     C                   CLEAR                   H$1
     C     $HIL(035)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Si el valor de C.V.A o C.V.E es mayor a 0
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Acreditación aportes voluntarios no actuali
     C                   CLEAR                   ZERROR
     C     $HIL(036)     CAT       ZIDENA:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*GRABAR DETARC
     C     *IN49         IFEQ      '0'
     C                   UPDATE    DETREG                               94
     C                   ELSE
     C                   WRITE     DETREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Crear registro de aporte voluntario
     C* Acreditación aporte voluntario
     C*EJECUTAR M00210
     C                   EXSR      M00210
     C*RECUPERARD CUEARC (MOVCO4 ZFONDO)
     C     LL$040        KLIST
     C                   KFLD                    MOVCO4
     C                   KFLD                    ZFONDO
     C     LL$040        CHAIN     CUEARC                             4594
     C                   MOVE      *IN94         I$RND
     C     *IN45         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   CUEREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*INICIARI DETARC(DETNUM DETNU3 DETPAG DETSEC)
     C     LL$041        KLIST
     C                   KFLD                    DETNUM
     C                   KFLD                    DETNU3
     C                   KFLD                    DETPAG
     C                   KFLD                    DETSEC
     C     LL$041        SETLL     DETARC                                 49
     C     *IN49         IFEQ      '1'
     C                   MOVE      '0'           *IN49
     C                   ELSE
     C                   MOVE      '1'           *IN49
     C                   END
     C*SI ERE(DETARC)
     C     *IN49         IFEQ      '0'
     C*LEER DETARC
     C                   READ      DETARC                                 49
     C*FIN
     C                   END
     C* Indicador de error
     C*SI ZINDER = '1'
     C     ZINDER        IFEQ      '1'
     C* Mensaje de error
     C*PASAR ZERROR ZERRET
     C                   CLEAR                   ZERROR
     C                   MOVEL     ZERRET        ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*MOVER ZPLAER PLANUM
     C                   MOVE      PLANUM        ZPLAER
     C*MOVER ZAFIIN MOVCO4
     C                   CLEAR                   ZAFIIN
     C                   MOVE      MOVCO4        ZAFIIN
     C*OBTENER (1) ZERROR = 'CUEARC no disponible - M09000' || ZPLAER ||
     C                   CLEAR                   H$1
     C     $HIL(037)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesar planilla normal                                    ==
     C*==                                                              ==
     C*==================================================================
     C     M10000        BEGSR
     C* Ind. actualizar o crear Temp.TEM708
     C*LIMPIAR ZINTEM
     C                   CLEAR                   ZINTEM
     C* Calcular total por concepto
     C*EJECUTAR M11000
     C                   EXSR      M11000
     C*SI ZSALIR <> '1'
     C     ZSALIR        IFNE      '1'
     C* Saldo a cargo
     C*MOVER ZSALCA PLASA3
     C                   Z-ADD     PLASA3        ZSALCA
     C* Número depósitos leidos
     C*MOVER K 1
     C                   Z-ADD     1             K
     C* Concilió con mas de un depós.
     C*SI PLANU8 = *CERO
     C     PLANU8        IFEQ      *ZERO
     C*PASAR ZINDP 'C'
     C                   MOVEL     'C'           ZINDP
     C*LLAMAR RPDEPF50 (PLANU3 PLANUM ZLD ZND ZCD ZCUO ZVAL ZINDP)
     C                   CALL      'RPDEPF50'
     C                   PARM                    PLANU3
     C                   PARM                    PLANUM
     C                   PARM                    ZLD
     C                   PARM                    ZND
     C                   PARM                    ZCD
     C                   PARM                    ZCUO
     C                   PARM                    ZVAL
     C                   PARM                    ZINDP
     C*INICIAR CONAR205 (PLANU3 PLANUM)
     C     LL$042        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$042        SETLL     CONAR205                           43
     C*LEER CONAR205
     C                   READ      CONAR205                               43
     C* Indicador pago en exceso
     C*MOVER ZINDPE '0'
     C                   MOVE      '0'           ZINDPE
     C*MIENTRAS NFA(CONAR205) Y PLANUM=CONNU5 Y ZINDPE='0' Y ZSALIR |= '
     C     *IN43         DOWEQ     '0'
     C     PLANUM        ANDEQ     CONNU5
     C     ZINDPE        ANDEQ     '0'
     C     ZSALIR        ANDNE     '1'
     C*SI CONTI3 = ' '
     C     CONTI3        IFEQ      ' '
     C* Lote de depósitos
     C*MOVER ZLOTE  CONNU2
     C                   Z-ADD     CONNU2        ZLOTE
     C* Número de depósito
     C*MOVER ZDEPO  CONNU3
     C                   Z-ADD     CONNU3        ZDEPO
     C* Consecutivo depósito
     C*MOVER ZCONSE CONCO4
     C                   Z-ADD     CONCO4        ZCONSE
     C* Es conciliación con P.A.
     C*SINO
     C                   ELSE
     C* Val. histórico pagos adel.
     C*SUMAR CONVLR ZTVPA
     C                   ADD       CONVLR        ZTVPA
     C* Cuotas pagos adelan.
     C*SUMAR CONCUO ZTCPA
     C                   ADD       CONCUO        ZTCPA
     C* Marca reg. conc. tipo 5 como ACR para el cuadre
     C* Marca reg. como ACR
     C*MOVER CONCO4 1
     C                   Z-ADD     1             CONCO4
     C* Gen. reg. P.E. por fecha fondo
     C*EJECUTAR M10005
     C                   EXSR      M10005
     C*FIN
     C                   END
     C* Leer depósito
     C*EJECUTAR M12000
     C                   EXSR      M12000
     C*SUMAR 1 K
     C                   ADD       1             K
     C*GRABAR CONAR205
     C     *IN43         IFEQ      '0'
     C                   UPDATE    CONRE205                             94
     C                   ELSE
     C                   WRITE     CONRE205                             94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*LEER CONAR205
     C                   READ      CONAR205                               43
     C*FIN
     C                   END
     C*SI ZTVPA |= *CERO O ZTCPA |= *CERO
     C     ZTVPA         IFNE      *ZERO
     C     ZTCPA         ORNE      *ZERO
     C* Cód. transacción
     C*PASAR ZCODTX '04'
     C                   MOVEL     '04'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '43'
     C                   MOVEL     '43'          ZCONCE
     C* Valor histórico
     C*MOVER ZVALHI ZTVPA
     C                   Z-ADD     ZTVPA         ZVALHI
     C* Cuotas histórico
     C*MOVER ZCUOHI ZTCPA
     C                   Z-ADD     ZTCPA         ZCUOHI
     C* Actualizar HISAR4
     C*EJECUTAR M00055
     C                   EXSR      M00055
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pago adelantado
     C*MOVER ZVRPEX ZVALHI
     C                   Z-ADD     ZVALHI        ZVRPEX
     C* Cuotas del pago adelantado
     C*MOVER ZCUPEX ZCUOHI
     C                   Z-ADD     ZCUOHI        ZCUPEX
     C* Actuliza GESAR8 Tx 04-43
     C*EJECUTAR M79000
     C                   EXSR      M79000
     C*LIMPIAR ZTVPA ZTCPA
     C                   CLEAR                   ZTVPA
     C                   CLEAR                   ZTCPA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Lote de depósitos
     C*MOVER ZLOTE  PLANU8
     C                   Z-ADD     PLANU8        ZLOTE
     C* Número de depósito
     C*MOVER ZDEPO  PLANU9
     C                   Z-ADD     PLANU9        ZDEPO
     C* Consecutivo depósito
     C*MOVER ZCONSE PLACON
     C                   Z-ADD     PLACON        ZCONSE
     C* Leer depósito
     C*EJECUTAR M12000
     C                   EXSR      M12000
     C*SUMAR 1 K
     C                   ADD       1             K
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*CALCULAR ZSALDO = ZSACO+ZSAAR+ZSACVA+ZSACVE+ZSAFS+ZSAINT+ZSAIFS+Z
     C     ZSACO         ADD       ZSAAR         V$CA1           030 9
     C     V$CA1         ADD       ZSACVA        V$CA1
     C     V$CA1         ADD       ZSACVE        V$CA1
     C     V$CA1         ADD       ZSAFS         V$CA1
     C     V$CA1         ADD       ZSAINT        V$CA1
     C     V$CA1         ADD       ZSAIFS        V$CA1
     C     V$CA1         ADD       ZSAFGP        V$CA1
     C     V$CA1         ADD       ZSAIFG        V$CA1
     C     V$CA1         ADD       ZSASFS        V$CA1
     C     V$CA1         ADD       ZSAISF        V$CA1
     C     V$CA1         ADD       ZSICVA        V$CA1
     C     V$CA1         ADD       ZSICVE        V$CA1
     C     V$CA1         ADD       ZSINAR        ZSALDO
     C*SI ZSALDO |= *CERO O ZSALCA |= *CERO
     C     ZSALDO        IFNE      *ZERO
     C     ZSALCA        ORNE      *ZERO
     C* Indicador de error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Procesar pagos adelantados
     C*EJECUTAR M13000
     C                   EXSR      M13000
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Indicador de error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*SI ZSAINT=0 Y ZSICVA=0 Y ZSICVE=0 Y ZSINAR=0 Y ZSAIFS=0 Y ZSAIFG=
     C     ZSAINT        IFEQ      0
     C     ZSICVA        ANDEQ     0
     C     ZSICVE        ANDEQ     0
     C     ZSINAR        ANDEQ     0
     C     ZSAIFS        ANDEQ     0
     C     ZSAIFG        ANDEQ     0
     C     ZSAISF        ANDEQ     0
     C     ZR7436        OREQ      '1'
     C* Procesar detalles
     C*EJECUTAR M14000
     C                   EXSR      M14000
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Genera encabezados e históri.
     C*EJECUTAR M15000
     C                   EXSR      M15000
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Anulación deudas por delta
     C*EJECUTAR M15500
     C                   EXSR      M15500
     C* Indicador de act. empleador
     C*SI ZACTEM = 'S' Y PLAPER >= ZPERVI
     C     ZACTEM        IFEQ      'S'
     C     PLAPER        ANDGE     ZPERVI
     C*SI PLAPER > EMPPE1 Y EMPPE1 ]= *BLANCO O EMPPE1 = *BLANCO
     C     PLAPER        IFGT      EMPPE1
     C     EMPPE1        ANDNE     *BLANK
     C     EMPPE1        OREQ      *BLANK
     C* Nro. empleados
     C*SI PLAN09 ]= *CERO
     C     PLAN09        IFNE      *ZERO
     C*SI ZSALIR |= '1' Y PLATIP = '01' Y ERE (EMPAR204) O ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C     PLATIP        ANDEQ     '01'
     C     *IN58         ANDEQ     '0'
     C     ZSALIR        ORNE      '1'
     C     PLATIP        ANDEQ     '04'
     C     *IN58         ANDEQ     '0'
     C*SI ZTIPXX <> 'W' Y ZTLLAM <> 'X'
     C     ZTIPXX        IFNE      'W'
     C     ZTLLAM        ANDNE     'X'
     C*SQL
     C/EXEC SQL
     C+  UPDATE EMPAR204 SET EMPEMP=:PLAN09
     C+  WHERE EMPNU2 = :PLANU4
     C/END-EXEC
     C*SINO
     C                   ELSE
     C*SQL
     C/EXEC SQL
     C+  INSERT INTO TEM708 VALUES (:PLANU1, :PLANU4, :PLAN09,
     C+  '', '', '', '')
     C/END-EXEC
     C* Ind. que ya creo registro
     C*PASAR ZINTEM 'S'
     C                   MOVEL     'S'           ZINTEM
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*            MOVER EMPEMP PLAN09
     C*FIN
     C                   END
     C*SI ZCLASE = 'B' Y EMPCLA = 'A' Y EMPPE1 ]= *BLANCO
     C     ZCLASE        IFEQ      'B'
     C     EMPCLA        ANDEQ     'A'
     C     EMPPE1        ANDNE     *BLANK
     C*SINO
     C                   ELSE
     C*SI ZSALIR |= '1' Y PLATIP = '01' Y ERE (EMPAR204) O ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C     PLATIP        ANDEQ     '01'
     C     *IN58         ANDEQ     '0'
     C     ZSALIR        ORNE      '1'
     C     PLATIP        ANDEQ     '04'
     C     *IN58         ANDEQ     '0'
     C*SI ZTIPXX <> 'W' Y ZTLLAM <> 'X'
     C     ZTIPXX        IFNE      'W'
     C     ZTLLAM        ANDNE     'X'
     C*SQL
     C/EXEC SQL
     C+  UPDATE EMPAR204 SET EMPCLA=:ZCLASE,
     C+  EMPFOR=:ZFORDE, EMPPE1=:PLAPER
     C+  WHERE EMPNU2 = :PLANU4
     C/END-EXEC
     C*SINO
     C                   ELSE
     C*SI ZINTEM = *BLANCO
     C     ZINTEM        IFEQ      *BLANK
     C*SQL
     C/EXEC SQL
     C+  INSERT INTO TEM708 VALUES (:PLANU1, :PLANU4, 0,
     C+  :ZCLASE, :ZFORDE, :PLAPER, '')
     C/END-EXEC
     C*SINO
     C                   ELSE
     C*SQL
     C/EXEC SQL
     C+  UPDATE TEM708 SET TEMCLA=:ZCLASE, TEMFO2=:ZFORDE,
     C+  TEMP57=:PLAPER  WHERE TEM710=:PLANU1 AND
     C+  TEMI83=:PLANU4
     C/END-EXEC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'El valor conciliado no alcanza para cubrir los inte
     C                   MOVEL     $HIL(038)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*PASAR ZCOI '1'
     C                   MOVEL     '1'           ZCOI
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Genera registro P.E. por fecha fondo                        ==
     C*==                                                              ==
     C*==================================================================
     C     M10005        BEGSR
     C* Limpia pagina y secuencia para PAGA04
     C*LIMPIAR ZT@011 ZT@012
     C                   CLEAR                   ZT@011
     C                   CLEAR                   ZT@012
     C* Carga N. planilla para PAGA04
     C*MOVER ZT@010 PLANUM
     C                   Z-ADD     PLANUM        ZT@010
     C* Carga transacción para PAGA04
     C*ASIGNAR ZT@013 '04'
     C                   MOVEL     '04'          ZT@013
     C* Carga concepto para PAGA04
     C*ASIGNAR ZT@014 '43'
     C                   MOVEL     '43'          ZT@014
     C* Carga fecha fondo para PAGA04
     C*ASIGNAR ZT@015 HISFE3
     C                   MOVEL     HISFE3        ZT@015
     C* Carga valor para PAGA04
     C*MOVER ZT@016 CONVLR
     C                   Z-ADD     CONVLR        ZT@016
     C* Carga cuotas para PAGA04
     C*MOVER ZT@017 CONCUO
     C                   Z-ADD     CONCUO        ZT@017
     C* Carga planilla P.A. para PAGA04
     C*MOVER ZT@018 CONPLA
     C                   Z-ADD     CONPLA        ZT@018
     C*LLAMAR TRPLAN90 (ZFONDO ZT@010 ZT@011 ZT@012 ZT@013 ZT@014 ZT@015
     C                   CALL      'TRPLAN90'
     C                   PARM                    ZFONDO
     C                   PARM                    ZT@010
     C                   PARM                    ZT@011
     C                   PARM                    ZT@012
     C                   PARM                    ZT@013
     C                   PARM                    ZT@014
     C                   PARM                    ZT@015
     C                   PARM                    ZT@016
     C                   PARM                    ZT@017
     C                   PARM                    ZT@018
     C                   ENDSR
     C*==================================================================
     C*==  Calcular total por concepto                                 ==
     C*==                                                              ==
     C*==================================================================
     C     M11000        BEGSR
     C* Se deben procesar todos los detalles de planilla
     C* Ind. recálculo salario
     C*LIMPIAR ZINDRS
     C                   CLEAR                   ZINDRS
     C*LIMPIAR ZTOCO ZTOCVA ZTOCVE ZTOFS ZTOAR ZINDPA ZTOSFS ZTOFGP ZTOS
     C                   CLEAR                   ZTOCO
     C                   CLEAR                   ZTOCVA
     C                   CLEAR                   ZTOCVE
     C                   CLEAR                   ZTOFS
     C                   CLEAR                   ZTOAR
     C                   CLEAR                   ZINDPA
     C                   CLEAR                   ZTOSFS
     C                   CLEAR                   ZTOFGP
     C                   CLEAR                   ZTOSUM
     C                   CLEAR                   ZINDTE
     C* Recorrer los detalles de la planilla
     C* Detalles de planilla
     C*INICIAR DETARC (PLANU3 PLANUM)
     C     LL$043        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$043        SETLL     DETARC                             49
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$044        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$044        READE     DETARC                                 49
     C*MIENTRAS NFA(DETARC) Y PLANU3 = DETNUM Y PLANUM = DETNU3 Y ZSALIR
     C     *IN49         DOWEQ     '0'
     C     PLANU3        ANDEQ     DETNUM
     C     PLANUM        ANDEQ     DETNU3
     C     ZSALIR        ANDNE     '1'
     C*LIMPIAR ZDILIC ZDITRA
     C                   CLEAR                   ZDILIC
     C                   CLEAR                   ZDITRA
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC WHERE DETNU3 = :DETNU3 AND
     C+  DETPAG = :DETPAG AND DETSEC = :DETSEC
     C/END-EXEC
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C*SUMAR DETCOT ZTCOTI
     C                   ADD       DETCOT        ZTCOTI
     C* Detalle con rezago
     C*SI DETIN4 = '07' O DETIN4 = '08'
     C     DETIN4        IFEQ      '07'
     C     DETIN4        OREQ      '08'
     C*LIMPIAR ZFEC01 ZTIREZ ZINDIF ZESRAE
     C                   CLEAR                   ZFEC01
     C                   CLEAR                   ZTIREZ
     C                   CLEAR                   ZINDIF
     C                   CLEAR                   ZESRAE
     C* Indica que se llama desde acreditac
     C*PASAR ZESRAE 'A'
     C                   MOVEL     'A'           ZESRAE
     C* Validar relación afiliado-empleador
     C*  Plan. inde
     C*SI PLATIP = '02' O PLATIP = '03' O PLATIP = '07'
     C     PLATIP        IFEQ      '02'
     C     PLATIP        OREQ      '03'
     C     PLATIP        OREQ      '07'
     C* Código empleador
     C*MOVER ZCOEMP *CERO
     C                   MOVE      *ZERO         ZCOEMP
     C*SINO
     C                   ELSE
     C* Código empleador
     C*MOVER ZCOEMP PLACOD
     C                   Z-ADD     PLACOD        ZCOEMP
     C*FIN
     C                   END
     C* Tipo de planilla
     C*PASAR ZTIPOP PLATIP
     C                   MOVEL     PLATIP        ZTIPOP
     C* Terceros
     C*SI PLATIP='07'
     C     PLATIP        IFEQ      '07'
     C*SI PLAT03='08' O PLAT03='13' O PLAT03='14' O ZTPGRT='08' O ZTPGRT
     C     PLAT03        IFEQ      '08'
     C     PLAT03        OREQ      '13'
     C     PLAT03        OREQ      '14'
     C     ZTPGRT        OREQ      '08'
     C     ZTPGRT        OREQ      '13'
     C     ZTPGRT        OREQ      '14'
     C* Tipo de planilla vol.
     C*PASAR ZTIPOP '03'
     C                   MOVEL     '03'          ZTIPOP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LLAMAR TRREZA5C (DETN04 ZCOEMP ZFEC01 PLAPER DETNOV ZTIREZ ZINDIF
     C                   CALL      'TRREZA5C'
     C                   PARM                    DETN04
     C                   PARM                    ZCOEMP
     C                   PARM                    ZFEC01
     C                   PARM                    PLAPER
     C                   PARM                    DETNOV
     C                   PARM                    ZTIREZ
     C                   PARM                    ZINDIF
     C                   PARM                    ZESRAE
     C                   PARM                    ZTIPOP
     C* No hay rezago y Contratista
     C*SI ZTIREZ = *BLANK Y PLATIP='07' Y PLAT03='07'
     C     ZTIREZ        IFEQ      *BLANK
     C     PLATIP        ANDEQ     '07'
     C     PLAT03        ANDEQ     '07'
     C* Busca contrato
     C*LLAMAR TRCNAF50 (DETN04 PLAPER ZINEER)
     C                   CALL      'TRCNAF50'
     C                   PARM                    DETN04
     C                   PARM                    PLAPER
     C                   PARM                    ZINEER
     C* No hay contratos vigentes
     C*SI ZINEER = '0'
     C     ZINEER        IFEQ      '0'
     C* Continua en rezago
     C*SINO
     C                   ELSE
     C* Código de rezago blanco
     C*PASAR DETIN4 ZTIREZ
     C                   MOVEL     ZTIREZ        DETIN4
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Código de rezago
     C*PASAR DETIN4 ZTIREZ
     C                   MOVEL     ZTIREZ        DETIN4
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C*LIMPIAR ZES13P ZCODEE ZTARD ZTARPG ZIGUAR ZTARAC ZAFSP
     C                   CLEAR                   ZES13P
     C                   CLEAR                   ZCODEE
     C                   CLEAR                   ZTARD
     C                   CLEAR                   ZTARPG
     C                   CLEAR                   ZIGUAR
     C                   CLEAR                   ZTARAC
     C                   CLEAR                   ZAFSP
     C*SI DETTA1<>3 Y PLAT03='09' O DETTA1<>3 Y PLAT03='10'
     C     DETTA1        IFNE      3
     C     PLAT03        ANDEQ     '09'
     C     DETTA1        ORNE      3
     C     PLAT03        ANDEQ     '10'
     C*PASAR ZIGUAR ' '
     C                   MOVEL     ' '           ZIGUAR
     C*LLAMAR RPHDEC558X(DETNU3 DETPAG DETSEC PLAPER DETSAL DETCOT ZES13
     C                   MOVEL     'RPHDEC55'    H$L10            10
     C                   MOVE      '8X'          H$L10
     C                   CALL      H$L10
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    PLAPER
     C                   PARM                    DETSAL
     C                   PARM                    DETCOT
     C                   PARM                    ZES13P
     C                   PARM                    ZCODEE
     C                   PARM                    ZNJ
     C                   PARM                    ZTARD
     C                   PARM                    ZTARPG
     C                   PARM                    ZIGUAR
     C                   PARM                    ZTARAC
     C                   PARM                    ZAFSP
     C*SI ZCODEE='321'
     C     ZCODEE        IFEQ      '321'
     C*OBTENER (1) ZERROR = 'Detalle decreto 376 sin tarifa especial'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(039)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*PASAR ZDETAL '1'
     C                   MOVEL     '1'           ZDETAL
     C* Calcular valor cotización
     C*EJECUTAR M11100
     C                   EXSR      M11100
     C*LIMPIAR ZDETAL
     C                   CLEAR                   ZDETAL
     C* Pago adelantado afil.indepen.
     C*SI ZINDPA = '1'
     C     ZINDPA        IFEQ      '1'
     C*LIMPIAR ZTOCO ZTOCVA ZTOCVE ZTOFS ZTOAR ZTOSFS ZTOFGP
     C                   CLEAR                   ZTOCO
     C                   CLEAR                   ZTOCVA
     C                   CLEAR                   ZTOCVE
     C                   CLEAR                   ZTOFS
     C                   CLEAR                   ZTOAR
     C                   CLEAR                   ZTOSFS
     C                   CLEAR                   ZTOFGP
     C*SALIR
     C                   GOTO      T$4
     C*SINO
     C                   ELSE
     C* Total C.O.
     C*SUMAR ZCOTOB ZTOCO
     C                   ADD       ZCOTOB        ZTOCO
     C* Total alto riesgo
     C*SUMAR ZCOTAR ZTOAR
     C                   ADD       ZCOTAR        ZTOAR
     C* Total C.V.A.
     C*SUMAR ZCOTVA ZTOCVA
     C                   ADD       ZCOTVA        ZTOCVA
     C* Total C.V.E.
     C*SUMAR ZCOTVE ZTOCVE
     C                   ADD       ZCOTVE        ZTOCVE
     C* Total F.S.
     C*SUMAR ZCOTFS ZTOFS
     C                   ADD       ZCOTFS        ZTOFS
     C* Total Subsistencia
     C*SUMAR ZCOTSF ZTOSFS
     C                   ADD       ZCOTSF        ZTOSFS
     C* Total Garantía pensión min.
     C*SUMAR ZCOTFG ZTOFGP
     C                   ADD       ZCOTFG        ZTOFGP
     C*
     C* Planilla de tercero
     C*SI PLATIP='07'
     C     PLATIP        IFEQ      '07'
     C* Grabar cotizaciones detalle
     C*PASAR ZIND '0'
     C                   MOVEL     '0'           ZIND
     C* Identificación del afiliado
     C*MOVER ZID DETNU2
     C                   Z-ADD     DETNU2        ZID
     C* Intereses por concepto
     C*EJECUTAR M12207
     C                   EXSR      M12207
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$045        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$045        READE     DETARC                                 49
     C*FIN
     C                   END
     C     T$4           TAG
     C* Saldo cotización obligatoria
     C*MOVER ZSACO  ZTOCO
     C                   Z-ADD     ZTOCO         ZSACO
     C* Saldo alto riesgo
     C*MOVER ZSAAR  ZTOAR
     C                   Z-ADD     ZTOAR         ZSAAR
     C* Saldo voluntaria afiliado
     C*MOVER ZSACVA ZTOCVA
     C                   Z-ADD     ZTOCVA        ZSACVA
     C* Saldo voluntaria empleador
     C*MOVER ZSACVE ZTOCVE
     C                   Z-ADD     ZTOCVE        ZSACVE
     C* Saldo fondo de solidaridad
     C*MOVER ZSAFS  ZTOFS
     C                   Z-ADD     ZTOFS         ZSAFS
     C* Saldo f.de solidaridad x subsistenc
     C*MOVER ZSASFS ZTOSFS
     C                   Z-ADD     ZTOSFS        ZSASFS
     C* Saldo f. grantia de pensión minima
     C*MOVER ZSAFGP ZTOFGP
     C                   Z-ADD     ZTOFGP        ZSAFGP
     C*CALCULAR ZSACOT = ZTOCO + ZTOAR + ZTOCVA + ZTOCVE
     C     ZTOCO         ADD       ZTOAR         V$CA1           030 9
     C     V$CA1         ADD       ZTOCVA        V$CA1
     C     V$CA1         ADD       ZTOCVE        ZSACOT
     C* Total cotizaciones
     C*MOVER ZTOTCO ZSACOT
     C                   Z-ADD     ZSACOT        ZTOTCO
     C* Total calculado de los detalles
     C*CALCULAR ZTOCAL = ZTOTCO + ZTOFS + ZTOSFS + ZTOFGP
     C     ZTOTCO        ADD       ZTOFS         V$CA1           030 9
     C     V$CA1         ADD       ZTOSFS        V$CA1
     C     V$CA1         ADD       ZTOFGP        ZTOCAL
     C                   ENDSR
     C*==================================================================
     C*==  Calcular valor cotización                                   ==
     C*==                                                              ==
     C*==================================================================
     C     M11100        BEGSR
     C* Ver ocupación especial
     C*EJECUTAR M11101
     C                   EXSR      M11101
     C* No hay error
     C*SI ZSALIR <> '1'
     C     ZSALIR        IFNE      '1'
     C* Valores subsistencia
     C*LIMPIAR ZVSFSP ZVFGPM ZPSFSP
     C                   CLEAR                   ZVSFSP
     C                   CLEAR                   ZVFGPM
     C                   CLEAR                   ZPSFSP
     C* Per.planilla >= Per.reforma
     C*SI PLAPER > ZPEREF
     C     PLAPER        IFGT      ZPEREF
     C*PASAR ZINREF 'S'
     C                   MOVEL     'S'           ZINREF
     C* Salario máximo
     C*CALCULAR (R) ZSAMAX = ZSALMA
     C                   Z-ADD(H)  ZSALMA        ZSAMAX
     C* Sal. calc. > Sal. máx.
     C*SI DETVA7 > ZSAMAX
     C     DETVA7        IFGT      ZSAMAX
     C* Sal. calculado
     C*MOVER DETVA7 ZSAMAX
     C                   Z-ADD     ZSAMAX        DETVA7
     C*FIN
     C                   END
     C* Período procesar F.S.
     C*PASAR ZPERFS PLAPER
     C                   MOVEL     PLAPER        ZPERFS
     C* IBC del afiliado
     C*MOVER ZIBCAF DETVA7
     C                   Z-ADD     DETVA7        ZIBCAF
     C* Retorna FGPM Y SFSP
     C*EJECUTAR M77000
     C                   EXSR      M77000
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR <> '1'
     C     ZSALIR        IFNE      '1'
     C*LIMPIAR ZCOTAR ZCOTFS ZCOTSF ZCOTFG ZSALVA
     C                   CLEAR                   ZCOTAR
     C                   CLEAR                   ZCOTFS
     C                   CLEAR                   ZCOTSF
     C                   CLEAR                   ZCOTFG
     C                   CLEAR                   ZSALVA
     C*
     C* Se calcula el valor de la cotización :Si el detalle no es rezago
     C* o Si el detalle es rezago y el proceso es de acred. de rezagos
     C*
     C*SI DETIN4 = *BLANCO Y ZT@002 |= '3' O DETIN4 |= *BLANCO Y ZT@002
     C     DETIN4        IFEQ      *BLANK
     C     ZT@002        ANDNE     '3'
     C     DETIN4        ORNE      *BLANK
     C     ZT@002        ANDEQ     '3'
     C* Pla. volun. / Ind. recalc. salario
     C*SI PLATIP='03' Y PLAT03<>'09' Y ZINDRS=*BLANK O PLATIP='02' Y ZIN
     C     PLATIP        IFEQ      '03'
     C     PLAT03        ANDNE     '09'
     C     ZINDRS        ANDEQ     *BLANK
     C     PLATIP        OREQ      '02'
     C     ZINDRS        ANDEQ     *BLANK
     C     PLAPER        ANDLT     ZPEREF
     C* Calcula salario afil. vol.
     C*EJECUTAR M11105
     C                   EXSR      M11105
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR <> '1'
     C     ZSALIR        IFNE      '1'
     C* Toma lo reportado
     C*MOVER ZCOTOB DETCOT
     C                   Z-ADD     DETCOT        ZCOTOB
     C* Si existe deuda
     C*SI DETIND = '2'
     C     DETIND        IFEQ      '2'
     C* Suma el valor de deuda
     C*CALCULAR ZCOTOB = ZCOTOB+DETDI2
     C     ZCOTOB        ADD       DETDI2        ZCOTOB
     C*SINO
     C                   ELSE
     C* Si existe p.e.
     C*SI DETIND = '3'
     C     DETIND        IFEQ      '3'
     C* Resta el vr. en exceso
     C*CALCULAR ZCOTOB = ZCOTOB-DETDI2
     C     ZCOTOB        SUB       DETDI2        ZCOTOB
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* hay licencia
     C*SI ZNOSLN='X'
     C     ZNOSLN        IFEQ      'X'
     C* calcula tarifa AR
     C*LLAMAR TRLIAR50(ZPERFS DETNU3 DETPAG DETSEC ZCOTAR)
     C                   CALL      'TRLIAR50'
     C                   PARM                    ZPERFS
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    ZCOTAR
     C*SINO
     C                   ELSE
     C* Tarifa alto riesgo
     C*SI DETTAR |= *CERO Y PLAT03 <> '05' Y PLAT03 <> '12'
     C     DETTAR        IFNE      *ZERO
     C     PLAT03        ANDNE     '05'
     C     PLAT03        ANDNE     '12'
     C*SQL
     C/EXEC SQL
     C+  SELECT SUM(DETIBV) INTO :ZSALVA
     C+  FROM DETA6806 WHERE
     C+  DET460 = :DETTI2 AND DETIDA = :DETNU2 AND
     C+  DET459 = :PLANUM AND DETTAV <> 0 AND
     C+  DETTAV <> :DETTA1
     C/END-EXEC
     C* Retroactivo
     C*SI PLAT03 = '09' O PLAT03 = '11' O PLAT03 = '10' O PLAT03 = '12'
     C     PLAT03        IFEQ      '09'
     C     PLAT03        OREQ      '11'
     C     PLAT03        OREQ      '10'
     C     PLAT03        OREQ      '12'
     C* Cotización alto riesgo
     C*CALCULAR (R) ZCOTAR=(DETSAL-ZSALVA)*DETTAR/100
     C     DETSAL        SUB       ZSALVA        V$CA1           030 9
     C     V$CA1         MULT      DETTAR        V$CA1
     C     V$CA1         DIV(H)    100           ZCOTAR
     C*SINO
     C                   ELSE
     C* Cotización alto riesgo
     C*CALCULAR (R) ZCOTAR=(DETVA7-ZSALVA)*DETTAR/100
     C     DETVA7        SUB       ZSALVA        V$CA1           030 9
     C     V$CA1         MULT      DETTAR        V$CA1
     C     V$CA1         DIV(H)    100           ZCOTAR
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI DETTAR |= *CERO Y DETTA1 = DETTAR Y PLAT03 = '09'
     C     DETTAR        IFNE      *ZERO
     C     DETTA1        ANDEQ     DETTAR
     C     PLAT03        ANDEQ     '09'
     C*MOVER ZCOTAR DETCOT
     C                   Z-ADD     DETCOT        ZCOTAR
     C*LIMPIAR ZVFGPM
     C                   CLEAR                   ZVFGPM
     C*FIN
     C                   END
     C*SI ZCOTOB > 0 Y ZCOTOB>ZVFGPM Y ZCOTOB>ZCOTAR
     C     ZCOTOB        IFGT      0
     C     ZCOTOB        ANDGT     ZVFGPM
     C     ZCOTOB        ANDGT     ZCOTAR
     C* C.O. - A.R. - G.P.M.
     C*CALCULAR ZCOTOB = ZCOTOB-ZCOTAR-ZVFGPM
     C     ZCOTOB        SUB       ZCOTAR        V$CA1           030 9
     C     V$CA1         SUB       ZVFGPM        ZCOTOB
     C*SINO
     C                   ELSE
     C*SI ZVFGPM > ZCOTOB Y ZTPVAE = '1' Y ZTIPVL = '3'
     C     ZVFGPM        IFGT      ZCOTOB
     C     ZTPVAE        ANDEQ     '1'
     C     ZTIPVL        ANDEQ     '3'
     C*MOVER ZVFGPM ZCOTOB
     C                   Z-ADD     ZCOTOB        ZVFGPM
     C*FIN
     C                   END
     C*LIMPIAR ZCOTOB
     C                   CLEAR                   ZCOTOB
     C*FIN
     C                   END
     C* Valor FGPM
     C*MOVER ZCOTFG ZVFGPM
     C                   Z-ADD     ZVFGPM        ZCOTFG
     C*SI DETVA7 >= ZSALFS O ZTPVAE = '1' Y ZTIPVL = '3'
     C     DETVA7        IFGE      ZSALFS
     C     ZTPVAE        OREQ      '1'
     C     ZTIPVL        ANDEQ     '3'
     C* Valor SFSP
     C*MOVER ZCOTSF ZVSFSP
     C                   Z-ADD     ZVSFSP        ZCOTSF
     C*SI ZTPVAE = '1' Y ZTIPVL = '3'
     C     ZTPVAE        IFEQ      '1'
     C     ZTIPVL        ANDEQ     '3'
     C*MOVER ZCOTFS DETCTA
     C                   Z-ADD     DETCTA        ZCOTFS
     C*LIMPIAR ZCOTSF
     C                   CLEAR                   ZCOTSF
     C*SINO
     C                   ELSE
     C*CALCULAR ZCOTFS = DETCTA - ZCOTSF
     C     DETCTA        SUB       ZCOTSF        ZCOTFS
     C*FIN
     C                   END
     C* Si existe deuda
     C*SI DETIN3 = '2'
     C     DETIN3        IFEQ      '2'
     C*CALCULAR ZCOTFS = ZCOTFS + DETDI5
     C     ZCOTFS        ADD       DETDI5        ZCOTFS
     C*SINO
     C                   ELSE
     C* Si existe p.e.
     C*SI DETIN3 = '3'
     C     DETIN3        IFEQ      '3'
     C* Restamos el vr. en exceso
     C*CALCULAR ZCOTFS=(ZCOTFS-DETDI5)
     C     ZCOTFS        SUB       DETDI5        V$CA1           030 9
     C                   Z-ADD     V$CA1         ZCOTFS
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI DETCOT >= ZVFGPM
     C     DETCOT        IFGE      ZVFGPM
     C* Cotización obligatoria
     C*CALCULAR ZCOTOB = DETCOT - ZVFGPM
     C     DETCOT        SUB       ZVFGPM        ZCOTOB
     C*SINO
     C                   ELSE
     C*MOVER ZVFGPM DETCOT
     C                   Z-ADD     DETCOT        ZVFGPM
     C*LIMPIAR ZCOTOB
     C                   CLEAR                   ZCOTOB
     C*FIN
     C                   END
     C*SI DETCTA > ZVSFSP
     C     DETCTA        IFGT      ZVSFSP
     C* Cot. fondo solidaridad
     C*CALCULAR ZCOTFS = DETCTA - ZVSFSP
     C     DETCTA        SUB       ZVSFSP        ZCOTFS
     C*SINO
     C                   ELSE
     C*MOVER ZVSFSP DETCTA
     C                   Z-ADD     DETCTA        ZVSFSP
     C*LIMPIAR ZCOTFS
     C                   CLEAR                   ZCOTFS
     C*FIN
     C                   END
     C* Valor SFSP
     C*MOVER ZCOTSF ZVSFSP
     C                   Z-ADD     ZVSFSP        ZCOTSF
     C* Valor FGPM
     C*MOVER ZCOTFG ZVFGPM
     C                   Z-ADD     ZVFGPM        ZCOTFG
     C*FIN
     C                   END
     C* Cot. voluntaria afiliado
     C*MOVER ZCOTVA DETCO1
     C                   Z-ADD     DETCO1        ZCOTVA
     C* Cot. voluntaria empleador
     C*MOVER ZCOTVE DETCO2
     C                   Z-ADD     DETCO2        ZCOTVE
     C*FIN
     C                   END
     C*SI ZDETAL = '1'
     C     ZDETAL        IFEQ      '1'
     C*LIMPIAR $$FSP
     C                   CLEAR                   $$FSP
     C* Fondo
     C*PASAR ZFOFSP ZFONDO
     C                   MOVEL     ZFONDO        ZFOFSP
     C* Planilla
     C*MOVER ZPLFSP PLANU1
     C                   Z-ADD     PLANU1        ZPLFSP
     C* Página
     C*MOVER ZPAFSP DETPAG
     C                   Z-ADD     DETPAG        ZPAFSP
     C* Secuencia
     C*MOVER ZSEFSP DETSEC
     C                   Z-ADD     DETSEC        ZSEFSP
     C* Acción: Consultar detalle
     C*PASAR ZACFSP 'D'
     C                   MOVEL     'D'           ZACFSP
     C*LLAMAR RPFSPR50 ($$FSP)
     C                   CALL      'RPFSPR50'
     C                   PARM                    $$FSP
     C* Existe en FSPARC
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*CALCULAR ZFS  = ZZAFSP+ZVZFSP
     C     ZZAFSP        ADD       ZVZFSP        ZFS
     C*CALCULAR ZFSP = ZCOTSF+ZCOTFS
     C     ZCOTSF        ADD       ZCOTFS        ZFSP
     C*CALCULAR ZDIF = ZFSP - ZFS
     C     ZFSP          SUB       ZFS           ZDIF
     C*SI ZFS < ZFSP
     C     ZFS           IFLT      ZFSP
     C*SI ZCOTSF > *CEROS
     C     ZCOTSF        IFGT      *ZEROS
     C*CALCULAR (R) ZSUB   = ((ZCOTFS*ZPDSFS)/100) + ZCOTSF
     C     ZCOTFS        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV       100           V$CA1
     C     V$CA1         ADD(H)    ZCOTSF        ZSUB
     C*CALCULAR (R) ZCOTSF = ZSUB - ZVZFSP
     C     ZSUB          SUB(H)    ZVZFSP        ZCOTSF
     C*CALCULAR (R) ZFSP   = ((ZCOTFS*ZPDSFS)/100) + ZZAFSP
     C     ZCOTFS        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV       100           V$CA1
     C     V$CA1         ADD(H)    ZZAFSP        ZFSP
     C*CALCULAR (R) ZCOTFS = ZCOTFS - ZFSP
     C     ZCOTFS        SUB(H)    ZFSP          ZCOTFS
     C*CALCULAR (R) ZCOTSF = ZCOTSF - ZCOTFS
     C     ZCOTSF        SUB(H)    ZCOTFS        ZCOTSF
     C*SI ZCOTSF > ZDIF
     C     ZCOTSF        IFGT      ZDIF
     C*CALCULAR ZDIF = ZCOTSF - ZDIF
     C     ZCOTSF        SUB       ZDIF          ZDIF
     C*CALCULAR ZCOTSF = ZCOTSF - ZDIF
     C     ZCOTSF        SUB       ZDIF          ZCOTSF
     C*FIN
     C                   END
     C*CALCULAR (R) ZCOTFS = (ZCOTFS/ZPDSFS) * 100
     C     ZCOTFS        DIV       ZPDSFS        V$CA1           030 9
     C     V$CA1         MULT(H)   100           ZCOTFS
     C*SINO
     C                   ELSE
     C*CALCULAR ZCOTFS = ZCOTFS - (ZZAFSP+ZVZFSP)
     C     ZZAFSP        ADD       ZVZFSP        V$CA1           030 9
     C     ZCOTFS        SUB       V$CA1         ZCOTFS
     C*FIN
     C                   END
     C*SI ZCOTSF < *CEROS
     C     ZCOTSF        IFLT      *ZEROS
     C*MOVER ZCOTSF *CEROS
     C                   MOVE      *ZEROS        ZCOTSF
     C*FIN
     C                   END
     C*SI ZCOTFS < *CEROS
     C     ZCOTFS        IFLT      *ZEROS
     C*MOVER ZCOTFS *CEROS
     C                   MOVE      *ZEROS        ZCOTFS
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*MOVER ZCOTSF *CEROS
     C                   MOVE      *ZEROS        ZCOTSF
     C*MOVER ZCOTFS *CEROS
     C                   MOVE      *ZEROS        ZCOTFS
     C*FIN
     C                   END
     C*PASAR ZFSPAR '1'
     C                   MOVEL     '1'           ZFSPAR
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Este total de planilla se utiliza para identificar la forma de
     C* prorrateo de las cotizaciones en una planilla de tercero
     C*CALCULAR (R) ZTOPLA = ZTOPLA + DETTOT + DETV14
     C     ZTOPLA        ADD       DETTOT        V$CA1           030 9
     C     V$CA1         ADD(H)    DETV14        ZTOPLA
     C                   ENDSR
     C*==================================================================
     C*==  Verifica si afilaido tiene ocupación especial               ==
     C*==                                                              ==
     C*==================================================================
     C     M11101        BEGSR
     C* indicador de ocup especial
     C*LIMPIAR ZINOCU
     C                   CLEAR                   ZINOCU
     C*INICIARI AFIARC(DETN04)
     C     DETN04        SETLL     AFIARC                                 35
     C     *IN35         IFEQ      '1'
     C                   MOVE      '0'           *IN35
     C                   ELSE
     C                   MOVE      '1'           *IN35
     C                   END
     C*SI NER (AFIARC)
     C     *IN35         IFEQ      '1'
     C* No es rezago
     C*SI DETIN4 = *BLANCO
     C     DETIN4        IFEQ      *BLANK
     C* Número de identificación
     C*MOVER ZNUMAL DETNU2
     C                   MOVE      DETNU2        ZNUMAL
     C*OBTENER (1) ZERROR = 'No existe afiliado' || ZNUMAL
     C                   CLEAR                   ZERROR
     C     $HIL(040)     CAT       ZNUMAL:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* Afiliado existe
     C*SINO
     C                   ELSE
     C*RECUPERARD (N) AFIARC (DETN04)
     C     DETN04        CHAIN     AFIARC                             3594
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Periodo de planilla > reforma
     C*SI PLAPER > ZPEREF
     C     PLAPER        IFGT      ZPEREF
     C* Buscar la ocupación del afiliado
     C*LLAMAR TROCUP50(AFIC07 ZINOCU ZDESOC ZINEER)
     C                   CALL      'TROCUP50'
     C                   PARM                    AFIC07
     C                   PARM                    ZINOCU
     C                   PARM                    ZDESOC
     C                   PARM                    ZINEER
     C* Es ocupación especial
     C*SI ZINOCU = 'S'
     C     ZINOCU        IFEQ      'S'
     C* Sal.máximo cotización
     C*CALCULAR (R) ZSALMA = ZHPVA2 * ZHPMAX
     C     ZHPVA2        MULT(H)   ZHPMAX        ZSALMA
     C*SINO
     C                   ELSE
     C* Salario máximo de cotización
     C*CALCULAR (R) ZSALMA = ZHPVA2 * ZHPN24
     C     ZHPVA2        MULT(H)   ZHPN24        ZSALMA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Número de identificación
     C*MOVER ZNUMAL DETNU2
     C                   MOVE      DETNU2        ZNUMAL
     C*OBTENER (1) ZERROR = 'Registro AFIARC no disponible M11101' || ZN
     C                   CLEAR                   ZERROR
     C     $HIL(041)     CAT       ZNUMAL:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular salario afiliado independiente                     ==
     C*==                                                              ==
     C*==================================================================
     C     M11105        BEGSR
     C* Valor conciliado
     C*CALCULAR ZVALCO = PLAVAL - DETCO1 - DETCO2
     C     PLAVAL        SUB       DETCO1        V$CA1           030 9
     C     V$CA1         SUB       DETCO2        ZVALCO
     C* Vlr. cot. F. solidaridad
     C*SI DETCTA > *CERO
     C     DETCTA        IFGT      *ZERO
     C* Porcentaje cotización
     C*CALCULAR ZPCT = ZPCTCO + ZPCTFS + DETTAR + ZPSFSP
     C     ZPCTCO        ADD       ZPCTFS        V$CA1           030 9
     C     V$CA1         ADD       DETTAR        V$CA1
     C     V$CA1         ADD       ZPSFSP        ZPCT
     C*SINO
     C                   ELSE
     C* Porcentaje cotización
     C*CALCULAR ZPCT = ZPCTCO + DETTAR
     C     ZPCTCO        ADD       DETTAR        ZPCT
     C*FIN
     C                   END
     C* Vlr. conciliado negativo
     C*SI ZVALCO < *CERO
     C     ZVALCO        IFLT      *ZERO
     C*MOVER ZVALCO *CERO
     C                   MOVE      *ZERO         ZVALCO
     C*FIN
     C                   END
     C* Salario calculado
     C*CALCULAR (R) DETVA7 = ZVALCO * 100/ZPCT
     C     ZVALCO        MULT      100           V$CA1           030 9
     C     V$CA1         DIV(H)    ZPCT          DETVA7
     C* Existe P.A
     C*SI DETVA7 < ZSALFS Y ZINDPA = '1'
     C     DETVA7        IFLT      ZSALFS
     C     ZINDPA        ANDEQ     '1'
     C* Calcula P.A.
     C*EJECUTAR M11110
     C                   EXSR      M11110
     C* No hay error
     C*SI ZSALIR <> '1'
     C     ZSALIR        IFNE      '1'
     C* Vlr. conc. + saldo P.A.
     C*CALCULAR (R) ZVALCO = ZVALCO + ZPASAL
     C     ZVALCO        ADD(H)    ZPASAL        ZVALCO
     C* Salario calculado
     C*CALCULAR (R) DETVA7 = ZVALCO * 100/ZPCT
     C     ZVALCO        MULT      100           V$CA1           030 9
     C     V$CA1         DIV(H)    ZPCT          DETVA7
     C* Sal. calc. > Sa. F.S.P.
     C*SI DETVA7 > ZSALFS
     C     DETVA7        IFGT      ZSALFS
     C* Salario calculado
     C*MOVER DETVA7 ZSALFS
     C                   Z-ADD     ZSALFS        DETVA7
     C* Sal. F.S.P. menos 1
     C*RESTAR 1 DETVA7
     C                   SUB       1             DETVA7
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR <> '1'
     C     ZSALIR        IFNE      '1'
     C* Días cotizados
     C*MOVER ZDIACO DETDIA
     C                   Z-ADD     DETDIA        ZDIACO
     C* Salario máximo
     C*CALCULAR (R) ZSAMAX = ZSALMA
     C                   Z-ADD(H)  ZSALMA        ZSAMAX
     C* Salario mínimo
     C*CALCULAR (R) ZSAMIN = ((ZSALMI*(ZDIACO+DETDI1))/30)
     C     ZDIACO        ADD       DETDI1        V$CA1           030 9
     C     ZSALMI        MULT      V$CA1         V$CA1
     C     V$CA1         DIV       30            V$CA1
     C                   Z-ADD(H)  V$CA1         ZSAMIN
     C* Sal. calc. > Sal. máx.
     C*SI DETVA7 > ZSAMAX
     C     DETVA7        IFGT      ZSAMAX
     C* Sal. calculado
     C*MOVER DETVA7 ZSAMAX
     C                   Z-ADD     ZSAMAX        DETVA7
     C*SINO
     C                   ELSE
     C* Sal. calc. < Sal. mín.
     C*SI DETVA7 < ZSAMIN
     C     DETVA7        IFLT      ZSAMIN
     C* Determina si es < a mín.
     C*EJECUTAR M11106
     C                   EXSR      M11106
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Per.plan. >= Per.reforma
     C*SI PLAPER > ZPEREF Y ZIBCAF <> DETVA7
     C     PLAPER        IFGT      ZPEREF
     C     ZIBCAF        ANDNE     DETVA7
     C* Período procesar F.S.
     C*PASAR ZPERFS PLAPER
     C                   MOVEL     PLAPER        ZPERFS
     C* Recalcula salario afil.
     C*EJECUTAR M11109
     C                   EXSR      M11109
     C*FIN
     C                   END
     C* Si no es pago adelantado
     C*SI ZINDPA |= '1'
     C     ZINDPA        IFNE      '1'
     C* Ind. diferencia
     C*LIMPIAR DETIN2 DETIN3
     C                   CLEAR                   DETIN2
     C                   CLEAR                   DETIN3
     C*CALCULAR (R) ZVALDE = (DETVA7 * (ZPCTCO + DETTAR))/ 100
     C     ZPCTCO        ADD       DETTAR        V$CA1           030 9
     C     DETVA7        MULT      V$CA1         V$CA1
     C     V$CA1         DIV(H)    100           ZVALDE
     C* Cot. Obligatoria
     C*MOVER DETCOT ZVALDE
     C                   Z-ADD     ZVALDE        DETCOT
     C* Ind. recálculo salario
     C*PASAR ZINDRS '1'
     C                   MOVEL     '1'           ZINDRS
     C*LIMPIAR ZVALDE
     C                   CLEAR                   ZVALDE
     C* Fondo de solidaridad
     C*SI DETVA7 >= ZSALFS
     C     DETVA7        IFGE      ZSALFS
     C*CALCULAR (R) ZVALDE = (DETVA7 * (ZPCTFS + ZPSFSP) )/ 100
     C     ZPCTFS        ADD       ZPSFSP        V$CA1           030 9
     C     DETVA7        MULT      V$CA1         V$CA1
     C     V$CA1         DIV(H)    100           ZVALDE
     C* Valor del detalle
     C*MOVER DETCTA ZVALDE
     C                   Z-ADD     ZVALDE        DETCTA
     C*SINO
     C                   ELSE
     C*LIMPIAR DETCTA
     C                   CLEAR                   DETCTA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*GRABAR DETARC
     C     *IN49         IFEQ      '0'
     C                   UPDATE    DETREG                               94
     C                   ELSE
     C                   WRITE     DETREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Determina si salario de independiente es menor a mín.       ==
     C*==                                                              ==
     C*==================================================================
     C     M11106        BEGSR
     C* Cot. obl. calc. volunta.
     C*CALCULAR (R) ZCOBLI = ((DETVA7*ZPCTCO)/100)
     C     DETVA7        MULT      ZPCTCO        V$CA1           030 9
     C     V$CA1         DIV       100           V$CA1
     C                   Z-ADD(H)  V$CA1         ZCOBLI
     C* Cot. obl. para comparar
     C*CALCULAR (R) ZCOBL1 = ((ZSAMIN*ZPCTCO)/100)
     C     ZSAMIN        MULT      ZPCTCO        V$CA1           030 9
     C     V$CA1         DIV       100           V$CA1
     C                   Z-ADD(H)  V$CA1         ZCOBL1
     C*RESTAR ZCOBL1 ZDELIN ZCOBL2
     C     ZCOBL1        SUB       ZDELIN        ZCOBL2
     C* Cotización no es enero
     C*SI ZCOBLI<ZCOBL2 Y ZMESPE<>'01'
     C     ZCOBLI        IFLT      ZCOBL2
     C     ZMESPE        ANDNE     '01'
     C* Planilla voluntaria retroactiva
     C*SI PLATIP='03' Y PLAT03='09'
     C     PLATIP        IFEQ      '03'
     C     PLAT03        ANDEQ     '09'
     C*SINO
     C                   ELSE
     C* Ind. Pago adelantado
     C*PASAR ZINDPA '1'
     C                   MOVEL     '1'           ZINDPA
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Cotización para enero
     C*SI ZMESPE='01'
     C     ZMESPE        IFEQ      '01'
     C* Variable activa
     C*SI ZACRVO='S'
     C     ZACRVO        IFEQ      'S'
     C* Cotización inferi. mínimo
     C*SI ZCOBLI<ZCOBL2
     C     ZCOBLI        IFLT      ZCOBL2
     C* Planilla voluntaria retroactiva
     C*SI PLATIP='03' Y PLAT03='09'
     C     PLATIP        IFEQ      '03'
     C     PLAT03        ANDEQ     '09'
     C*SINO
     C                   ELSE
     C* Ind. pago adelantado
     C*PASAR ZINDPA '1'
     C                   MOVEL     '1'           ZINDPA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Verificar si cotizó con el salario de dic. del año anterior
     C* Cot. obl. para comp
     C*CALCULAR (R) ZCOBL1 = ((ZSAMII*ZPCTCO)/100)
     C     ZSAMII        MULT      ZPCTCO        V$CA1           030 9
     C     V$CA1         DIV       100           V$CA1
     C                   Z-ADD(H)  V$CA1         ZCOBL1
     C* Diferencia en cotizaciones
     C*RESTAR ZCOBL1 ZDELIN ZCOBL2
     C     ZCOBL1        SUB       ZDELIN        ZCOBL2
     C* Cotización inferi. mínino
     C*SI ZCOBLI<ZCOBL2
     C     ZCOBLI        IFLT      ZCOBL2
     C* Planilla voluntaria retroactiva
     C*SI PLATIP='03' Y PLAT03='09'
     C     PLATIP        IFEQ      '03'
     C     PLAT03        ANDEQ     '09'
     C*SINO
     C                   ELSE
     C* Ind. Pago adelantado
     C*PASAR ZINDPA '1'
     C                   MOVEL     '1'           ZINDPA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Valida recalculo salario afiliado independiente             ==
     C*==                                                              ==
     C*==================================================================
     C     M11109        BEGSR
     C* Anterior IBC
     C*MOVER ZANIBC ZIBCAF
     C                   Z-ADD     ZIBCAF        ZANIBC
     C* Ant.valor Fondo sol.
     C*MOVER ZANFSP ZVSFSP
     C                   Z-ADD     ZVSFSP        ZANFSP
     C* Ant.valor Garantìa
     C*MOVER ZANGPM ZVFGPM
     C                   Z-ADD     ZVFGPM        ZANGPM
     C* Anterior pct. subsitencia
     C*MOVER ZAPFSP ZPSFSP
     C                   Z-ADD     ZPSFSP        ZAPFSP
     C* IBC del afiliado
     C*MOVER ZIBCAF DETVA7
     C                   Z-ADD     DETVA7        ZIBCAF
     C* Retorna FGPM Y SFSP
     C*EJECUTAR M77000
     C                   EXSR      M77000
     C* Hay cambio de tarifa
     C*SI ZAPFSP <> ZPSFSP
     C     ZAPFSP        IFNE      ZPSFSP
     C* Anterior IBC
     C*MOVER DETVA7 ZANIBC
     C                   Z-ADD     ZANIBC        DETVA7
     C* Ant.valor Fondo sol.
     C*MOVER ZVSFSP ZANFSP
     C                   Z-ADD     ZANFSP        ZVSFSP
     C* Ant.valor Garantìa
     C*MOVER ZVFGPM ZANGPM
     C                   Z-ADD     ZANGPM        ZVFGPM
     C* Anterior pct. subsitencia
     C*MOVER ZPSFSP ZAPFSP
     C                   Z-ADD     ZAPFSP        ZPSFSP
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular pagos adelantados                                  ==
     C*==                                                              ==
     C*==================================================================
     C     M11110        BEGSR
     C* Recupera fecha dep.
     C*LLAMAR CALFECDE (PLANU1 ZFDEPA)
     C                   CALL      'CALFECDE'
     C                   PARM                    PLANU1
     C                   PARM                    ZFDEPA
     C* No se encontro fecha depósito
     C*SI ZFDEPA = *BLANCO Y Z10592 = 1
     C     ZFDEPA        IFEQ      *BLANK
     C     Z10592        ANDEQ     1
     C* Indicador Rez. de ajustes
     C*LIMPIAR ZIND48
     C                   CLEAR                   ZIND48
     C* Busca FEQA48
     C*PASAR ZINARC 'F'
     C                   MOVEL     'F'           ZINARC
     C*LLAMAR TRFEQA50 (PLANU1 REZNR1 REZNR2 REZTI5 REZEST REZID1 REZPER
     C                   CALL      'TRFEQA50'
     C                   PARM                    PLANU1
     C                   PARM                    REZNR1
     C                   PARM                    REZNR2
     C                   PARM                    REZTI5
     C                   PARM                    REZEST
     C                   PARM                    REZID1
     C                   PARM                    REZPER
     C                   PARM                    REZFEC
     C                   PARM                    REZEST
     C                   PARM                    ZTIPOD
     C                   PARM                    ZINARC
     C                   PARM                    ZIND48
     C* Rezago de ajuste
     C*SI ZIND48 = '1'
     C     ZIND48        IFEQ      '1'
     C* Fecha fondo acreditación
     C*PASAR ZFDEPA REZFE3
     C                   MOVEL     REZFE3        ZFDEPA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Fecha del depósito en blanco
     C*SI ZFDEPA = *BLANCO
     C     ZFDEPA        IFEQ      *BLANK
     C* Fecha fondo acreditación
     C*PASAR ZFDEPA PLAFEC
     C                   MOVEL     PLAFEC        ZFDEPA
     C*FIN
     C                   END
     C* Fecha del depósito
     C*SI ZFDEPA = *BLANCO
     C     ZFDEPA        IFEQ      *BLANK
     C*PASAR ZERROR  'No existe fecha de depósito a calcular'
     C                   MOVEL     $HIL(042)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*RECUPERAR (N) HISAR1(ZFONDO ZFDEPA)
     C     LL$046        KLIST
     C                   KFLD                    ZFONDO
     C                   KFLD                    ZFDEPA
     C     LL$046        CHAIN     HISAR1                             89
     C* Saldo pago adelantado
     C*LIMPIAR ZPASAL ZPASA1
     C                   CLEAR                   ZPASAL
     C                   CLEAR                   ZPASA1
     C* Busca P.A. del empleador
     C*INICIARI PAGARC06 (PLANU4)
     C     PLANU4        SETLL     PAGARC06                               71
     C     *IN71         IFEQ      '1'
     C                   MOVE      '0'           *IN71
     C                   ELSE
     C                   MOVE      '1'           *IN71
     C                   END
     C*SI ERE(PAGARC06)
     C     *IN71         IFEQ      '0'
     C*RECUPERARD PAGARC06 (PLANU4)
     C     PLANU4        CHAIN     PAGARC06                           7194
     C                   MOVE      *IN94         I$RND
     C     *IN71         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   PAGREG06
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*MIENTRAS NFA(PAGARC06) Y PAGNU4 = PLANU4
     C     *IN71         DOWEQ     '0'
     C     PAGNU4        ANDEQ     PLANU4
     C* Valor P.A. a hoy
     C*CALCULAR (R) ZPASA1 = PAGCU3 * HISCU2
     C     PAGCU3        MULT(H)   HISCU2        ZPASA1
     C* Saldo pago adelantado
     C*CALCULAR (R) ZPASAL = ZPASAL + ZPASA1
     C     ZPASAL        ADD(H)    ZPASA1        ZPASAL
     C*LEER PAGARC06
     C                   READ      PAGARC06                               71
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Registro PAGARC06 no disponible M11110'
     C                   MOVEL     $HIL(043)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Leer depósitos                                              ==
     C*==                                                              ==
     C*==================================================================
     C     M12000        BEGSR
     C* Recuperar depósito
     C*EJECUTAR M12010
     C                   EXSR      M12010
     C* Indicador de error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Saldo a cargo
     C*SI ZSALCA |= *CERO
     C     ZSALCA        IFNE      *ZERO
     C* Tipo de deuda liq. errónea
     C*PASAR DEUTIP '01'
     C                   MOVEL     '01'          DEUTIP
     C* Procesar saldo a cargo
     C*EJECUTAR M12100
     C                   EXSR      M12100
     C* Tipo de deuda liq. errónea
     C*PASAR DEUTIP '07'
     C                   MOVEL     '07'          DEUTIP
     C* Procesar saldo a cargo
     C*EJECUTAR M12100
     C                   EXSR      M12100
     C*SINO
     C                   ELSE
     C* Procesar planilla
     C*EJECUTAR M12200
     C                   EXSR      M12200
     C*FIN
     C                   END
     C*CALCULAR ZSALDO = ZSACO+ZSAAR+ZSACVA+ZSACVE+ZSAFS+ZSAINT+ZSAIFS+Z
     C     ZSACO         ADD       ZSAAR         V$CA1           030 9
     C     V$CA1         ADD       ZSACVA        V$CA1
     C     V$CA1         ADD       ZSACVE        V$CA1
     C     V$CA1         ADD       ZSAFS         V$CA1
     C     V$CA1         ADD       ZSAINT        V$CA1
     C     V$CA1         ADD       ZSAIFS        V$CA1
     C     V$CA1         ADD       ZSAFGP        V$CA1
     C     V$CA1         ADD       ZSAIFG        V$CA1
     C     V$CA1         ADD       ZSASFS        V$CA1
     C     V$CA1         ADD       ZSAISF        V$CA1
     C     V$CA1         ADD       ZSICVA        V$CA1
     C     V$CA1         ADD       ZSICVE        V$CA1
     C     V$CA1         ADD       ZSINAR        ZSALDO
     C* Saldo cotización
     C*SI ZSALDO |= *CERO
     C     ZSALDO        IFNE      *ZERO
     C*SINO
     C                   ELSE
     C* Ind. pago en exceso empleador
     C*PASAR ZINDPE '1'
     C                   MOVEL     '1'           ZINDPE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Recuperar depósito                                          ==
     C*==                                                              ==
     C*==================================================================
     C     M12010        BEGSR
     C*SI PLANU8=*CERO Y CONTI3 = ' ' O PLANU8 != *CERO
     C     PLANU8        IFEQ      *ZERO
     C     CONTI3        ANDEQ     ' '
     C     PLANU8        ORNE      *ZERO
     C* Se suprime el dscto del valor y cuotas ya pagadas
     C*SI DEPNUM |= ZLOTE O DEPNU1 |= ZDEPO O DEPCON |= ZCONSE
     C     DEPNUM        IFNE      ZLOTE
     C     DEPNU1        ORNE      ZDEPO
     C     DEPCON        ORNE      ZCONSE
     C*
     C* Recupera depósitos
     C*
     C*INICIARI DEPAR3 (ZLOTE ZDEPO ZCONSE)
     C     LL$047        KLIST
     C                   KFLD                    ZLOTE
     C                   KFLD                    ZDEPO
     C                   KFLD                    ZCONSE
     C     LL$047        SETLL     DEPAR3                                 46
     C     *IN46         IFEQ      '1'
     C                   MOVE      '0'           *IN46
     C                   ELSE
     C                   MOVE      '1'           *IN46
     C                   END
     C*FIN
     C                   END
     C* Depósitos
     C*SI NER(DEPAR3)
     C     *IN46         IFEQ      '1'
     C* Error no econtró
     C*PASAR ZERROR 'No existe depósito'
     C                   MOVEL     $HIL(044)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*SINO
     C                   ELSE
     C*RECUPERARD DEPAR3 (ZLOTE ZDEPO ZCONSE)
     C     LL$048        KLIST
     C                   KFLD                    ZLOTE
     C                   KFLD                    ZDEPO
     C                   KFLD                    ZCONSE
     C     LL$048        CHAIN     DEPAR3                             4694
     C                   MOVE      *IN94         I$RND
     C     *IN46         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   DEPRE2
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Si se acredita o no la plan.
     C*PASAR ZALFA1 'S'
     C                   MOVEL     'S'           ZALFA1
     C* Generó P.E o deuda
     C*SI PLAIN6='2' Y ZDELTA<PLADEU O PLAIN6='3' Y ZDELTA<PLADEU
     C     PLAIN6        IFEQ      '2'
     C     ZDELTA        ANDLT     PLADEU
     C     PLAIN6        OREQ      '3'
     C     ZDELTA        ANDLT     PLADEU
     C*
     C* Circular 042
     C*
     C* Notar4
     C*PASAR ZENTID 'C'
     C                   MOVEL     'C'           ZENTID
     C* No planilla
     C*MOVER ZNUM12 PLANUM
     C                   Z-ADD     PLANUM        ZNUM12
     C* Lote de planilla
     C*PASAR ZALF15 PLANU3
     C                   MOVEL     PLANU3        ZALF15
     C* Comparar contra fecha sistema
     C*SI ZFECOM = '1'
     C     ZFECOM        IFEQ      '1'
     C* Fecha sistema
     C*PASAR ZALFA8 ZFESIS
     C                   MOVEL     ZFESIS        ZALFA8
     C* Comparar contra fecha fondo
     C*SINO
     C                   ELSE
     C* Fecha fondo
     C*PASAR ZALFA8 HISFE3
     C                   MOVEL     HISFE3        ZALFA8
     C*FIN
     C                   END
     C* Limpia var. de trabajo
     C*LIMPIAR ZALFA1 ZALFA5 ZINERE ZFITIP
     C                   CLEAR                   ZALFA1
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C                   CLEAR                   ZFITIP
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM21 ZPEFIN
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM21
     C                   CLEAR                   ZPEFIN
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C*
     C*FIN
     C                   END
     C* Se puede acreditar planilla
     C*SI ZALFA1 = 'S'
     C     ZALFA1        IFEQ      'S'
     C* Fusionado
     C*SI Z10592 = 1 Y DEPVA2 != *CEROS Y DEPFE5 != *CEROS
     C     Z10592        IFEQ      1
     C     DEPVA2        ANDNE     *ZEROS
     C     DEPFE5        ANDNE     *ZEROS
     C* Valor del depósito
     C*CALCULAR ZVRDEP = DEPVA2
     C                   Z-ADD     DEPVA2        ZVRDEP
     C* Fecha depósito
     C*PASAR ZFECDE DEPFE5
     C                   MOVEL     DEPFE5        ZFECDE
     C*SINO
     C                   ELSE
     C* Valor del depósito
     C*CALCULAR ZVRDEP = DEPVA8
     C                   Z-ADD     DEPVA8        ZVRDEP
     C* Fecha depósito
     C*PASAR ZFECDE DEPFEC
     C                   MOVEL     DEPFEC        ZFECDE
     C*FIN
     C                   END
     C* Cuotas del depósito
     C*CALCULAR ZCUDEP = DEPNU3
     C                   Z-ADD     DEPNU3        ZCUDEP
     C* Calcula valor no identifica.
     C*EJECUTAR M12020
     C                   EXSR      M12020
     C* Conciliado
     C*SI DEPEST = 'CON'
     C     DEPEST        IFEQ      'CON'
     C* Estado del deposito
     C*ASIGNAR DEPEST 'ACR'
     C                   MOVEL     'ACR'         DEPEST
     C* Usuario modificación
     C*PASAR DEPUS4 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        DEPUS4
     C* Fecha del sistema
     C*PASAR DEPF08 ZFESIS
     C                   MOVEL     ZFESIS        DEPF08
     C* Donde se encuentra el dep.
     C*PASAR ZDONES DEPC19
     C                   MOVEL     DEPC19        ZDONES
     C* Donde quedó el depósito
     C*PASAR DEPC19 '5'
     C                   MOVEL     '5'           DEPC19
     C* Acción acreditación
     C*PASAR ZACCIO 'AC'
     C                   MOVEL     'AC'          ZACCIO
     C* Lote (alfa)
     C*ASIGNAR ZLOTED DEPNUM
     C                   MOVEL     DEPNUM        ZLOTED
     C* No depósito (alfa)
     C*ASIGNAR ZNUMDE DEPNU1
     C                   MOVEL     DEPNU1        ZNUMDE
     C* Consecutivo (alfa)
     C*ASIGNAR ZCONDE DEPCON
     C                   MOVEL     DEPCON        ZCONDE
     C* Actualiza el archivo de gestión sobre depósitos
     C*LLAMAR TRACGE50 (HISFE3 ZLOTED ZNUMDE ZCONDE ZACCIO DEPC19 ZDONES
     C                   CALL      'TRACGE50'
     C                   PARM                    HISFE3
     C                   PARM                    ZLOTED
     C                   PARM                    ZNUMDE
     C                   PARM                    ZCONDE
     C                   PARM                    ZACCIO
     C                   PARM                    DEPC19
     C                   PARM                    ZDONES
     C                   PARM                    ZVRDEP
     C                   PARM                    DEPNU3
     C* Depósitos
     C*GRABAR DEPAR3
     C     *IN46         IFEQ      '0'
     C                   UPDATE    DEPRE2                               94
     C                   ELSE
     C                   WRITE     DEPRE2                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Total valor depòsitos
     C*SUMAR ZVRDEP ZTVDEP
     C                   ADD       ZVRDEP        ZTVDEP
     C* Total cuotas depòsitos
     C*SUMAR DEPNU3 ZTCDEP
     C                   ADD       DEPNU3        ZTCDEP
     C*SINO
     C                   ELSE
     C*SI ZCUO = *CEROS
     C     ZCUO          IFEQ      *ZEROS
     C*PASAR ZERROR 'Depósito en estado diferente a conciliado'
     C                   MOVEL     $HIL(045)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'Planilla sin respuesta del empleador (circu
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(046)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Valor conciliado valorizado
     C*MOVER ZVRDEP CONVLR
     C                   Z-ADD     CONVLR        ZVRDEP
     C* Cuotas conciliadas
     C*MOVER ZCUDEP CONCUO
     C                   Z-ADD     CONCUO        ZCUDEP
     C* Fecha de valorización
     C*PASAR ZFECDE CONFE7
     C                   MOVEL     CONFE7        ZFECDE
     C* Calcula valor no identificado
     C*EJECUTAR M12020
     C                   EXSR      M12020
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcula si el depósito esta en recaudos en proceso o en no  ==
     C*==  os                                                          ==
     C*==================================================================
     C     M12020        BEGSR
     C* Se suprime el dscto de los valores y cuotas ya pagadas
     C* CON. CON DEPOSITOS
     C*SI PLANU8=*CERO Y CONTI3 = ' ' O PLANU8 != *CERO
     C     PLANU8        IFEQ      *ZERO
     C     CONTI3        ANDEQ     ' '
     C     PLANU8        ORNE      *ZERO
     C*SI Z10592 = 1 Y DEPVA2 != *CEROS Y DEPFE5 != *CEROS
     C     Z10592        IFEQ      1
     C     DEPVA2        ANDNE     *ZEROS
     C     DEPFE5        ANDNE     *ZEROS
     C* Valor rec.proceso
     C*CALCULAR ZTOTRP = ZTOTRP + DEPVA2
     C     ZTOTRP        ADD       DEPVA2        ZTOTRP
     C*SINO
     C                   ELSE
     C* Valor rec.proceso
     C*CALCULAR ZTOTRP = ZTOTRP + DEPVA8
     C     ZTOTRP        ADD       DEPVA8        ZTOTRP
     C*FIN
     C                   END
     C* Cuotas rec.proceso
     C*CALCULAR ZTOCRP = ZTOCRP + DEPNU3
     C     ZTOCRP        ADD       DEPNU3        ZTOCRP
     C* CONC. CON P.A.
     C*SINO
     C                   ELSE
     C* VALOR REC.PROCESO
     C*CALCULAR ZTOTRP = ZTOTRP + CONVLR
     C     ZTOTRP        ADD       CONVLR        ZTOTRP
     C* CUOTAS REC.PROCESO
     C*CALCULAR ZTOCRP = ZTOCRP + CONCUO
     C     ZTOCRP        ADD       CONCUO        ZTOCRP
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Liquida Intereses deudas empleador                          ==
     C*==                                                              ==
     C*==================================================================
     C     M12030        BEGSR
     C* Libera registro detalles de deuda
     C*INICIAR DETAR2
     C     *LOVAL        SETLL     DETAR2                             47
     C* Libera registro detalles de deuda
     C*INICIAR DETAR201
     C     *LOVAL        SETLL     DETAR201                           48
     C* Planilla o empleador en proceso jurídico
     C*SI ZINVAL = '1' Y PLAT03 = '02'
     C     ZINVAL        IFEQ      '1'
     C     PLAT03        ANDEQ     '02'
     C* DES ESPEC protección inactivo
     C*SI ZR9072 = 0
     C     ZR9072        IFEQ      0
     C*CASO PLAPER <> *BLANCO Y PLAN05 <> *CERO
     C                   SELECT
     C     PLAPER        WHENNE    *BLANK
     C     PLAN05        ANDNE     *ZERO
     C*LIMPIAR PLAPER PLAN05
     C                   CLEAR                   PLAPER
     C                   CLEAR                   PLAN05
     C*CASO PLAPER <> *BLANCO
     C     PLAPER        WHENNE    *BLANK
     C*LIMPIAR PLAPER
     C                   CLEAR                   PLAPER
     C*CASO PLAN05 <> *CERO
     C     PLAN05        WHENNE    *ZERO
     C* Tipo de la deuda
     C*PASAR DEUTIP ZTIPDE
     C                   MOVEL     ZTIPDE        DEUTIP
     C* Planilla a corregir
     C*MOVER DEUNUM PLAN05
     C                   Z-ADD     PLAN05        DEUNUM
     C*RECUPERARD DEUARC (DEUTIP DEUNUM)
     C     LL$049        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C     LL$049        CHAIN     DEUARC                             5094
     C                   MOVE      *IN94         I$RND
     C     *IN50         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   DEUREG
     C                   END
     C*SI RED Y ZVRDEP > *CERO Y ZSALIR ]= '1'
     C     I$RND         IFEQ      '0'
     C     ZVRDEP        ANDGT     *ZERO
     C     ZSALIR        ANDNE     '1'
     C*LIMPIAR ZCODIN
     C                   CLEAR                   ZCODIN
     C*LLAMAR TREMPN52 (ZCODIN DEUTI1 DEUNRO DEUPER DEUPER ZINVA1 ZLLAM1
     C                   CALL      'TREMPN52'
     C                   PARM                    ZCODIN
     C                   PARM                    DEUTI1
     C                   PARM                    DEUNRO
     C                   PARM                    DEUPER
     C                   PARM                    DEUPER
     C                   PARM                    ZINVA1
     C                   PARM                    ZLLAM1
     C*SI ZINVA1 = '1' O ZINVA1 = '2'
     C     ZINVA1        IFEQ      '1'
     C     ZINVA1        OREQ      '2'
     C* Limpia número de planilla a corregir
     C*LIMPIAR PLAN05
     C                   CLEAR                   PLAN05
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DEUARC no disponible - M12030'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(047)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FINCASOS
     C                   ENDSL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Tipo pago cancelación deuda
     C*SI PLAT03 = '02' O PLAT03 = '10'
     C     PLAT03        IFEQ      '02'
     C     PLAT03        OREQ      '10'
     C* Numero plan. a corregir <> Cero
     C*SI PLAN05 != *CERO
     C     PLAN05        IFNE      *ZERO
     C* Liquidación errónea o pago parcial
     C*PASAR DEUTIP '01'
     C                   MOVEL     '01'          DEUTIP
     C* Liq. ints. deudas x planilla
     C*EJECUTAR M12037
     C                   EXSR      M12037
     C* liq. errónea afil. anteriores
     C*PASAR DEUTIP '05'
     C                   MOVEL     '05'          DEUTIP
     C* Liq. ints. deudas x planilla
     C*EJECUTAR M12037
     C                   EXSR      M12037
     C* liq. errónea afil. independiente
     C*PASAR DEUTIP '07'
     C                   MOVEL     '07'          DEUTIP
     C* Liq. ints. deudas x planilla
     C*EJECUTAR M12037
     C                   EXSR      M12037
     C* Numero plan. a corregir = 0
     C*SINO
     C                   ELSE
     C* Todos los del empleador
     C*SI PLAPER = *BLANCO
     C     PLAPER        IFEQ      *BLANK
     C* Liquidación errónea o pago parcial
     C*PASAR DEUTIP '01'
     C                   MOVEL     '01'          DEUTIP
     C* Liq. ints. deudas empleador
     C*EJECUTAR M12038
     C                   EXSR      M12038
     C* Liq. erronea afil. anterioers
     C*PASAR DEUTIP '05'
     C                   MOVEL     '05'          DEUTIP
     C* Liq. ints. deudas empleador
     C*EJECUTAR M12038
     C                   EXSR      M12038
     C* No aplica para deudas 07 porque siempre debe tener planilla a co
     C* Por periodo
     C*SINO
     C                   ELSE
     C* Deuda liq.errónea afil.anter.
     C*PASAR DEUTIP '05'
     C                   MOVEL     '05'          DEUTIP
     C* Liq intereses x periodo
     C*EJECUTAR M12039
     C                   EXSR      M12039
     C* Deuda liq. errónea
     C*PASAR DEUTIP '01'
     C                   MOVEL     '01'          DEUTIP
     C* Liq intereses x periodo
     C*EJECUTAR M12039
     C                   EXSR      M12039
     C* No aplica para deudas 07 porque siempre debe tener planilla a co
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Tipo pago |= cancelación deuda
     C*SINO
     C                   ELSE
     C* Planilla extraordinaria
     C*SI PLAT03 = '06'
     C     PLAT03        IFEQ      '06'
     C* Solo si reporta período y tiene reportado FSP. y planilla no es
     C*SI  PLAPER |= *BLANCO Y ZTOFS > 0 Y PLATIP <> '06'
     C     PLAPER        IFNE      *BLANK
     C     ZTOFS         ANDGT     0
     C     PLATIP        ANDNE     '06'
     C* Liq. errónea
     C*PASAR ZTIPDE '01'
     C                   MOVEL     '01'          ZTIPDE
     C* Liq ints.deudas plan ext. x emple.
     C*EJECUTAR M12040
     C                   EXSR      M12040
     C* Liq. errónea reafiliado
     C*PASAR ZTIPDE '05'
     C                   MOVEL     '05'          ZTIPDE
     C* Liq ints.deudas plan ext. x emple.
     C*EJECUTAR M12040
     C                   EXSR      M12040
     C* No aplica para deudas 07 porque los ind. no tiene pacto cance.
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Liquidación errónea o pago parcial
     C*PASAR DEUTIP '01'
     C                   MOVEL     '01'          DEUTIP
     C* Liq. ints. deudas empleador
     C*EJECUTAR M12038
     C                   EXSR      M12038
     C* Liq. erronea afil. anteriores
     C*PASAR DEUTIP '05'
     C                   MOVEL     '05'          DEUTIP
     C* Liq. ints. deudas empleador
     C*EJECUTAR M12038
     C                   EXSR      M12038
     C* No aplica para deudas 07 porque los ind. no tiene pacto cance.
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Liq. ints. deudas x liq. errónea                            ==
     C*==                                                              ==
     C*==================================================================
     C     M12035        BEGSR
     C* Indicador de error
     C*LIMPIAR ZINDE2 ZCUTIP ZCUCOD
     C                   CLEAR                   ZINDE2
     C                   CLEAR                   ZCUTIP
     C                   CLEAR                   ZCUCOD
     C* Des. Esp. 7046 activo
     C*SI ZINVAL = '1' O ZR9072 = 1
     C     ZINVAL        IFEQ      '1'
     C     ZR9072        OREQ      1
     C*SQL
     C/EXEC SQL
     C+  SELECT COALESCE(ACUTIP, ' '),
     C+  COALESCE(ACUCOD, 0),
     C+  COALESCE(ACUIDE, 0)
     C+  INTO :ZCUTIP, :ZCUCOD, :ZCUIDE
     C+  FROM ACUARC
     C+  WHERE ACUTI1 = :PLATI1 AND
     C+  ACUNU1 = :PLANU4 AND
     C+  ACUEST = 'ACT'
     C/END-EXEC
     C* Pla PLCD y acuerdo de pago o acuerdo de liquidación
     C*SI ZPLCND = '1' O SQLCOD = 0 Y ZCUTIP <> '1'
     C     ZPLCND        IFEQ      '1'
     C     SQLCOD        OREQ      0
     C     ZCUTIP        ANDNE     '1'
     C* No liquidar interés
     C*PASAR ZINDE2 '1'
     C                   MOVEL     '1'           ZINDE2
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Liquidar interés
     C*SI ZINDE2 = *BLANCO
     C     ZINDE2        IFEQ      *BLANK
     C* Fecha ult. liq. de intereses
     C*SI DEUFE4 = *BLANCO
     C     DEUFE4        IFEQ      *BLANK
     C* Fecha inicio deuda
     C*PASAR ZFECH1 DEUFE6
     C                   MOVEL     DEUFE6        ZFECH1
     C*SINO
     C                   ELSE
     C*PASAR ZFECH1 DEUFE4
     C                   MOVEL     DEUFE4        ZFECH1
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Libera registro Histórico liquidación intereses
     C*INICIAR HISA01
     C     *LOVAL        SETLL     HISA01                             60
     C* Fecha liq.ints.<fecha depós.
     C*SI ZFECH1 <= ZFECDE Y ZINDE2 = ' '
     C     ZFECH1        IFLE      ZFECDE
     C     ZINDE2        ANDEQ     ' '
     C* Actualización
     C*PASAR ZINACT 'A'
     C                   MOVEL     'A'           ZINACT
     C* Existe acuerdo para el perido
     C*SI ZCUCOD <> 0
     C     ZCUCOD        IFNE      0
     C*LIMPIAR ZERR1
     C                   CLEAR                   ZERR1
     C*LLAMAR TRDEUD7L (DEUTIP DEUNUM ZFECDE ZCLASE ZFORDE ZVALIN ZVALI1
     C                   CALL      'TRDEUD7L'
     C                   PARM                    DEUTIP
     C                   PARM                    DEUNUM
     C                   PARM                    ZFECDE
     C                   PARM                    ZCLASE
     C                   PARM                    ZFORDE
     C                   PARM                    ZVALIN
     C                   PARM                    ZVALI1
     C                   PARM                    PLANU1
     C                   PARM                    ZINACT
     C                   PARM                    ZERR1
     C                   PARM                    ZCUCOD
     C                   PARM                    ZCUIDE
     C                   PARM                    ZFEIN2
     C                   PARM                    ZTAINS
     C                   PARM                    ZINDUL
     C*SINO
     C                   ELSE
     C*LIMPIAR ZERR1
     C                   CLEAR                   ZERR1
     C*LLAMAR TRDEUD58 (DEUTIP DEUNUM ZFECDE ZCLASE ZFORDE ZVALIN ZVALI1
     C                   CALL      'TRDEUD58'
     C                   PARM                    DEUTIP
     C                   PARM                    DEUNUM
     C                   PARM                    ZFECDE
     C                   PARM                    ZCLASE
     C                   PARM                    ZFORDE
     C                   PARM                    ZVALIN
     C                   PARM                    ZVALI1
     C                   PARM                    PLANU1
     C                   PARM                    ZINACT
     C                   PARM                    ZFEIN2
     C                   PARM                    ZTAINS
     C                   PARM                    ZERR1
     C*FIN
     C                   END
     C* Error en liq. de intereses
     C*SI ZERR1 <> *BLANCO
     C     ZERR1         IFNE      *BLANK
     C*PASAR ZERROR ZERR1
     C                   MOVEL     ZERR1         ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*INICIARI HISA01(DEUTIP DEUNUM PLANU1 DEUFE4)
     C     LL$050        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C                   KFLD                    PLANU1
     C                   KFLD                    DEUFE4
     C     LL$050        SETLL     HISA01                                 60
     C     *IN60         IFEQ      '1'
     C                   MOVE      '0'           *IN60
     C                   ELSE
     C                   MOVE      '1'           *IN60
     C                   END
     C*SI NER (HISA01)
     C     *IN60         IFEQ      '1'
     C* Tipo de deuda (01 o 05 o 07)
     C*PASAR HISTI2 DEUTIP
     C                   MOVEL     DEUTIP        HISTI2
     C* No. planilla origen de la deuda
     C*MOVER HISN43 DEUNUM
     C                   Z-ADD     DEUNUM        HISN43
     C* No. planilla cancelación de deuda
     C*MOVER HISN44 PLANU1
     C                   Z-ADD     PLANU1        HISN44
     C* Fecha última liq.intereses
     C*PASAR HISF33 DEUFE4
     C                   MOVEL     DEUFE4        HISF33
     C* Valor causado de intereses
     C*MOVER HISV10 *CERO
     C                   MOVE      *ZERO         HISV10
     C* Valor causado de intereses T.E
     C*MOVER HISV85 *CERO
     C                   MOVE      *ZERO         HISV85
     C* Usuario que crea el registro
     C*PASAR HISUS7 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        HISUS7
     C* Fecha de creación (sistema)
     C*PASAR HISF37 ZFESIS
     C                   MOVEL     ZFESIS        HISF37
     C* Fecha de creación (fondo)
     C*PASAR HISF38 HISFE3
     C                   MOVEL     HISFE3        HISF38
     C*AGREGAR HISA01
     C                   WRITE     HISR04                               94
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  liq intereses para cancelación de deuda todas las deudas e  ==
     C*==                                                              ==
     C*==================================================================
     C     M12037        BEGSR
     C* Planilla a corregir
     C*MOVER DEUNUM PLAN05
     C                   Z-ADD     PLAN05        DEUNUM
     C* Tipo de deuda
     C*PASAR ZTIPDE DEUTIP
     C                   MOVEL     DEUTIP        ZTIPDE
     C* Número planilla de la deuda
     C*MOVER ZNPLDE DEUNUM
     C                   Z-ADD     DEUNUM        ZNPLDE
     C* Se posiciona en el archivo
     C*INICIAR DEUARC51 (ZTIPDE ZNPLDE)
     C     LL$051        KLIST
     C                   KFLD                    ZTIPDE
     C                   KFLD                    ZNPLDE
     C     LL$051        SETLL     DEUARC51                           54
     C* Lee el registro
     C*LEER DEUARC51
     C                   READ      DEUARC51                               54
     C*MIENTRAS NFA (DEUARC51) Y DEUTIP = ZTIPDE Y DEUNUM = ZNPLDE
     C     *IN54         DOWEQ     '0'
     C     DEUTIP        ANDEQ     ZTIPDE
     C     DEUNUM        ANDEQ     ZNPLDE
     C* Liq.ints.deudas x liq.errónea
     C*EJECUTAR M12035
     C                   EXSR      M12035
     C* Lee el registro
     C*LEER DEUARC51
     C                   READ      DEUARC51                               54
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Liquidación de intereses para cancelación deuda por planil  ==
     C*==                                                              ==
     C*==================================================================
     C     M12038        BEGSR
     C* Tipo de deuda
     C*PASAR ZTIPDE DEUTIP
     C                   MOVEL     DEUTIP        ZTIPDE
     C* Se posiciona en el archivo
     C*INICIAR DEUARC03 (PLANU4 ZTIPDE)
     C     LL$052        KLIST
     C                   KFLD                    PLANU4
     C                   KFLD                    ZTIPDE
     C     LL$052        SETLL     DEUARC03                           51
     C* Lee el registro
     C*LEER DEUARC03
     C                   READ      DEUARC03                               51
     C*MIENTRAS NFA (DEUARC03) Y DEUNRO = PLANU4 Y DEUTIP = ZTIPDE
     C     *IN51         DOWEQ     '0'
     C     DEUNRO        ANDEQ     PLANU4
     C     DEUTIP        ANDEQ     ZTIPDE
     C* Liq.ints.deudas x liq.errónea
     C*EJECUTAR M12035
     C                   EXSR      M12035
     C* Lee el registro
     C*LEER DEUARC03
     C                   READ      DEUARC03                               51
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Liquidacion intereses para can. deuda del periodo           ==
     C*==                                                              ==
     C*==================================================================
     C     M12039        BEGSR
     C* Tipo de deuda
     C*PASAR ZTIPDE DEUTIP
     C                   MOVEL     DEUTIP        ZTIPDE
     C* Se posiciona en el archivo
     C*INICIAR DEUARC04 (ZTIPDE PLAPER PLATI1 PLANU4)
     C     LL$053        KLIST
     C                   KFLD                    ZTIPDE
     C                   KFLD                    PLAPER
     C                   KFLD                    PLATI1
     C                   KFLD                    PLANU4
     C     LL$053        SETLL     DEUARC04                           52
     C* Lee el registro
     C*LEER DEUARC04
     C                   READ      DEUARC04                               52
     C*MIENTRAS NFA(DEUARC04) Y DEUTIP=ZTIPDE Y DEUPER=PLAPER Y DEUTI1=P
     C     *IN52         DOWEQ     '0'
     C     DEUTIP        ANDEQ     ZTIPDE
     C     DEUPER        ANDEQ     PLAPER
     C     DEUTI1        ANDEQ     PLATI1
     C     DEUNRO        ANDEQ     PLANU4
     C*EJECUTAR M12035
     C                   EXSR      M12035
     C* Lee el registro
     C*LEER DEUARC04
     C                   READ      DEUARC04                               52
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Liq. intereses deudas planilla ext. por empleador           ==
     C*==                                                              ==
     C*==================================================================
     C     M12040        BEGSR
     C* Busca deuda por tipo y planilla
     C*INICIAR DEUARC03 (PLANU4 ZTIPDE)
     C     LL$054        KLIST
     C                   KFLD                    PLANU4
     C                   KFLD                    ZTIPDE
     C     LL$054        SETLL     DEUARC03                           51
     C*LEER DEUARC03
     C                   READ      DEUARC03                               51
     C*MIENTRAS NFA(DEUARC03) Y DEUTIP=ZTIPDE Y DEUNRO=PLANU4 Y DEUPER<=
     C     *IN51         DOWEQ     '0'
     C     DEUTIP        ANDEQ     ZTIPDE
     C     DEUNRO        ANDEQ     PLANU4
     C     DEUPER        ANDLE     PLAPER
     C* Limpia variables de trabajo
     C*LIMPIAR ZALFA8 ZINERE
     C                   CLEAR                   ZALFA8
     C                   CLEAR                   ZINERE
     C* Tipo de deuda
     C*PASAR ZALFA5 DEUTIP
     C                   CLEAR                   ZALFA5
     C                   MOVEL     DEUTIP        ZALFA5
     C* Número de planilla
     C*MOVER ZNUM12 DEUNUM
     C                   Z-ADD     DEUNUM        ZNUM12
     C* Entidad a leer DETAR222
     C*PASAR ZENTID '5'
     C                   MOVEL     '5'           ZENTID
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2 ZFITIP
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C                   CLEAR                   ZFITIP
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM21 ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM21
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C* Si no hubo error
     C*SI ZINERE ='0'
     C     ZINERE        IFEQ      '0'
     C* Liq. ints. deudas x liq. errónea
     C*EJECUTAR M12035
     C                   EXSR      M12035
     C*FIN
     C                   END
     C*LEER DEUARC03
     C                   READ      DEUARC03                               51
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesar saldo a cargo                                      ==
     C*==                                                              ==
     C*==================================================================
     C     M12100        BEGSR
     C* Variable de trabajo
     C*PASAR ZDEUDA DEUTIP
     C                   MOVEL     DEUTIP        ZDEUDA
     C* Saldo a cargo < Vlr.depósito
     C*SI ZSALCA < ZVRDEP
     C     ZSALCA        IFLT      ZVRDEP
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUOTA = (ZSALCA * ZCUDEP)/ZVRDEP
     C     ZSALCA        MULT      ZCUDEP        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Saldo depósito
     C*CALCULAR ZVRTEM = ZVRDEP - ZSALCA
     C     ZVRDEP        SUB       ZSALCA        ZVRTEM
     C* Saldo cuotas depósito
     C*CALCULAR ZCUTEM = ZCUDEP - ZCUOTA
     C     ZCUDEP        SUB       ZCUOTA        ZCUTEM
     C* Valor pago deudas
     C*MOVER ZVRDEP ZSALCA
     C                   Z-ADD     ZSALCA        ZVRDEP
     C* Cuotas pago deudas
     C*MOVER ZCUDEP ZCUOTA
     C                   Z-ADD     ZCUOTA        ZCUDEP
     C* Busca deudas del empleador
     C*INICIAR DEUARC08 (DEUTIP PLANU4)
     C     LL$055        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C     LL$055        SETLL     DEUARC08                           53
     C*LEER DEUARC08(DEUTIP PLANU4)
     C     LL$056        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C     LL$056        READE     DEUARC08                               53
     C*MIENTRAS NFA(DEUARC08) Y DEUTIP = ZDEUDA Y PLANU4=DEUNRO Y DEUPER
     C     *IN53         DOWEQ     '0'
     C     DEUTIP        ANDEQ     ZDEUDA
     C     PLANU4        ANDEQ     DEUNRO
     C     DEUPER        ANDLT     PLAPER
     C     ZVRDEP        ANDGT     *ZERO
     C     ZSALIR        ANDNE     '1'
     C* Procesar deuda
     C*EJECUTAR M21500
     C                   EXSR      M21500
     C*LEER DEUARC08(DEUTIP PLANU4)
     C     LL$057        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C     LL$057        READE     DEUARC08                               53
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor depósito
     C*CALCULAR ZVRDEP = ZVRTEM + ZVRDEP
     C     ZVRTEM        ADD       ZVRDEP        ZVRDEP
     C* Cuotas depósito
     C*CALCULAR ZCUDEP = ZCUTEM + ZCUDEP
     C     ZCUTEM        ADD       ZCUDEP        ZCUDEP
     C* Saldo a cargo
     C*LIMPIAR ZSALCA
     C                   CLEAR                   ZSALCA
     C* Procesar planilla
     C*EJECUTAR M12200
     C                   EXSR      M12200
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Saldo a cargo
     C*CALCULAR ZSALCA = ZSALCA - ZVRDEP
     C     ZSALCA        SUB       ZVRDEP        ZSALCA
     C* Busca deudas del empleador
     C*INICIAR DEUARC08 (DEUTIP PLANU4)
     C     LL$058        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C     LL$058        SETLL     DEUARC08                           53
     C*LEER DEUARC08(DEUTIP PLANU4)
     C     LL$059        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C     LL$059        READE     DEUARC08                               53
     C*MIENTRAS NFA(DEUARC08) Y DEUTIP = ZDEUDA Y PLANU4=DEUNRO Y DEUPER
     C     *IN53         DOWEQ     '0'
     C     DEUTIP        ANDEQ     ZDEUDA
     C     PLANU4        ANDEQ     DEUNRO
     C     DEUPER        ANDLT     PLAPER
     C     ZVRDEP        ANDGT     *ZERO
     C     ZSALIR        ANDNE     '1'
     C* Procesar deuda
     C*EJECUTAR M21500
     C                   EXSR      M21500
     C*LEER DEUARC08(DEUTIP PLANU4)
     C     LL$060        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C     LL$060        READE     DEUARC08                               53
     C*FIN
     C                   END
     C* Valor depósito y no hay error
     C*SI ZVRDEP > *CERO Y ZSALIR |= '1'
     C     ZVRDEP        IFGT      *ZERO
     C     ZSALIR        ANDNE     '1'
     C* Saldo a cargo
     C*LIMPIAR ZSALCA
     C                   CLEAR                   ZSALCA
     C* Procesar planilla
     C*EJECUTAR M12200
     C                   EXSR      M12200
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesar planilla                                           ==
     C*==                                                              ==
     C*==================================================================
     C     M12200        BEGSR
     C* Fecha de depósito
     C*MOVER AFECDE[K] ZFECDE
     C                   MOVE      ZFECDE        $G(K)
     C* No pago extraord ni plan tercero
     C*SI PLAT03|='06' Y PLATIP|='07'
     C     PLAT03        IFNE      '06'
     C     PLATIP        ANDNE     '07'
     C* Calcular intereses
     C*EJECUTAR M12205
     C                   EXSR      M12205
     C*SINO
     C                   ELSE
     C*SI ZPLART='07' Y ZTPGRT<>'08' Y ZTPGRT<>'13' O PLATIP='07' Y PLAT
     C     ZPLART        IFEQ      '07'
     C     ZTPGRT        ANDNE     '08'
     C     ZTPGRT        ANDNE     '13'
     C     PLATIP        OREQ      '07'
     C     PLAT03        ANDNE     '08'
     C     PLAT03        ANDNE     '13'
     C* Calcular intereses a la planilla
     C*PASAR ZIND '1'
     C                   MOVEL     '1'           ZIND
     C* Intereses por concepto
     C*EJECUTAR M12207
     C                   EXSR      M12207
     C*CALCULAR (R) ZTOSUM = ZTOPLA + ZSAIFS + ZSAISF + ZSAINT + ZSICVA
     C     ZTOPLA        ADD       ZSAIFS        V$CA1           030 9
     C     V$CA1         ADD       ZSAISF        V$CA1
     C     V$CA1         ADD       ZSAINT        V$CA1
     C     V$CA1         ADD       ZSICVA        V$CA1
     C     V$CA1         ADD       ZSICVE        V$CA1
     C     V$CA1         ADD       ZSINAR        V$CA1
     C     V$CA1         ADD(H)    ZSAIFG        ZTOSUM
     C*SINO
     C                   ELSE
     C* Total planilla sin intereses
     C*MOVER ZTOSUM ZTOPLA
     C                   Z-ADD     ZTOPLA        ZTOSUM
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Este bloque de instrucciones se hace para que la deuda que se ge
     C* por intereses se distribuya al afiliado que corresponde y no sea
     C* prorrateada entre todos los detalles de la planilla
     C* Depósito < total sumado planilla
     C*SI ZVRDEP < ZTOSUM Y PLATIP = '07'
     C     ZVRDEP        IFLT      ZTOSUM
     C     PLATIP        ANDEQ     '07'
     C* Ind. de proceso por tercero
     C*LIMPIAR ZINDTE
     C                   CLEAR                   ZINDTE
     C*CALCULAR (R) ZTOINT = ZSAIFS + ZSAISF + ZSAINT + ZSICVA + ZSICVE
     C     ZSAIFS        ADD       ZSAISF        V$CA1           030 9
     C     V$CA1         ADD       ZSAINT        V$CA1
     C     V$CA1         ADD       ZSICVA        V$CA1
     C     V$CA1         ADD       ZSICVE        V$CA1
     C     V$CA1         ADD       ZSINAR        V$CA1
     C     V$CA1         ADD(H)    ZSAIFG        ZTOINT
     C* Total planilla - Depósito
     C*CALCULAR (R) ZDIFPL = ZTOSUM - ZVRDEP
     C     ZTOSUM        SUB(H)    ZVRDEP        ZDIFPL
     C* Dif. corresponde a los intereses
     C*SI ZDIFPL = ZTOINT
     C     ZDIFPL        IFEQ      ZTOINT
     C* Proceso por tercero
     C*PASAR ZINDTE 'S'
     C                   MOVEL     'S'           ZINDTE
     C* Debe generar deuda por intereses
     C*PASAR ZINPIN 'N'
     C                   MOVEL     'N'           ZINPIN
     C* Restar el valor de los intereses
     C*RESTAR ZTOINT ZTOSUM
     C                   SUB       ZTOINT        ZTOSUM
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C*SI ZVRDEP < ZTOSUM Y ZINDTE <> 'S' Y PLATIP = '07' O PLATIP <> '0
     C     ZVRDEP        IFLT      ZTOSUM
     C     ZINDTE        ANDNE     'S'
     C     PLATIP        ANDEQ     '07'
     C     PLATIP        ORNE      '07'
     C     PLATIP        OREQ      '07'
     C     PLAT03        ANDEQ     '14'
     C     ZPLART        OREQ      '07'
     C     ZTPGRT        ANDEQ     '14'
     C* Pagar voluntaria afiliado
     C*EJECUTAR M12210
     C                   EXSR      M12210
     C* Pagar F.S.P y Subsistencia
     C*EJECUTAR M12215
     C                   EXSR      M12215
     C* Pagar Fondo GPM e intereses FGPM
     C*EJECUTAR M12221
     C                   EXSR      M12221
     C* Pagar int F.S.P y Subsistencia
     C*EJECUTAR M12220
     C                   EXSR      M12220
     C* Pagar intereses C.O, C.V.A C.V.E
     C*EJECUTAR M12225
     C                   EXSR      M12225
     C* Pagar rendimientos
     C*EJECUTAR M12230
     C                   EXSR      M12230
     C* Pagar alto riesgo
     C*EJECUTAR M12235
     C                   EXSR      M12235
     C* Pagar obligatoria
     C*EJECUTAR M12240
     C                   EXSR      M12240
     C* Pagar voluntaria empleador
     C*EJECUTAR M12245
     C                   EXSR      M12245
     C*SINO
     C                   ELSE
     C*LIMPIAR ZSACO ZSAAR ZSACVA ZSACVE ZSAFS ZSAINT ZSAIFS ZSAFGP ZSAI
     C                   CLEAR                   ZSACO
     C                   CLEAR                   ZSAAR
     C                   CLEAR                   ZSACVA
     C                   CLEAR                   ZSACVE
     C                   CLEAR                   ZSAFS
     C                   CLEAR                   ZSAINT
     C                   CLEAR                   ZSAIFS
     C                   CLEAR                   ZSAFGP
     C                   CLEAR                   ZSAIFG
     C*LIMPIAR ZSASFS ZSAISF ZSICVA ZSICVE ZSINAR
     C                   CLEAR                   ZSASFS
     C                   CLEAR                   ZSAISF
     C                   CLEAR                   ZSICVA
     C                   CLEAR                   ZSICVE
     C                   CLEAR                   ZSINAR
     C* Cuotas tercero
     C*CALCULAR (R) ZCUTER = (ZCUDEP * ZTOSUM) / ZVRDEP
     C     ZCUDEP        MULT      ZTOSUM        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUTER
     C* Valor depósito
     C*RESTAR ZTOSUM ZVRDEP
     C                   SUB       ZTOSUM        ZVRDEP
     C* Cuotas depósito
     C*RESTAR ZCUTER ZCUDEP
     C                   SUB       ZCUTER        ZCUDEP
     C* Vlr disp. distrib.
     C*MOVER ZVTDIS ZTOSUM
     C                   Z-ADD     ZTOSUM        ZVTDIS
     C* Cuotas disp. distr.
     C*MOVER ZCTDIS ZCUTER
     C                   Z-ADD     ZCUTER        ZCTDIS
     C* Proceso por tercero
     C*PASAR ZINDTE 'S'
     C                   MOVEL     'S'           ZINDTE
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular intereses                                          ==
     C*==                                                              ==
     C*==================================================================
     C     M12205        BEGSR
     C* Si voluntarios y pago normal
     C*SI PLATIP = '03' Y PLAT03 = '01' O PLATIP = '02' Y PLAT03 = '01'
     C     PLATIP        IFEQ      '03'
     C     PLAT03        ANDEQ     '01'
     C     PLATIP        OREQ      '02'
     C     PLAT03        ANDEQ     '01'
     C     PLAPER        ANDLT     ZPEREF
     C*SINO
     C                   ELSE
     C* Acreditación de planillas
     C*SI ZT@002 |= '3'
     C     ZT@002        IFNE      '3'
     C* Si conc.con dep.
     C*SI PLANU8=*CERO Y CONTI3=' ' O PLANU8!=*CERO
     C     PLANU8        IFEQ      *ZERO
     C     CONTI3        ANDEQ     ' '
     C     PLANU8        ORNE      *ZERO
     C* Planilla de traspasos
     C*SI PLATIP |= '05'
     C     PLATIP        IFNE      '05'
     C* Cálculo intereses planillas
     C*EJECUTAR M12207
     C                   EXSR      M12207
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Acreditación de rezagos
     C*SINO
     C                   ELSE
     C* Planilla es conc. con p.a
     C*SI ZIND05 = '1'
     C     ZIND05        IFEQ      '1'
     C*Planilla es conc. con sólo pagos adelant. no hace nada
     C*SINO
     C                   ELSE
     C* Planilla de traspasos
     C*SI PLATIP |= '05'
     C     PLATIP        IFNE      '05'
     C* Cálculo interéses planillas
     C*EJECUTAR M12207
     C                   EXSR      M12207
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Cálculo de intereses                                        ==
     C*==                                                              ==
     C*==================================================================
     C     M12207        BEGSR
     C* Indicador de cálculo intereses 07
     C*LIMPIAR ZPLA08
     C                   CLEAR                   ZPLA08
     C* Es planilla 07
     C*SI PLATIP='07'
     C     PLATIP        IFEQ      '07'
     C*SI PLAT03='08' O PLAT03='13' O PLAT03='14' O ZTPGRT='08' O ZTPGRT
     C     PLAT03        IFEQ      '08'
     C     PLAT03        OREQ      '13'
     C     PLAT03        OREQ      '14'
     C     ZTPGRT        OREQ      '08'
     C     ZTPGRT        OREQ      '13'
     C     ZTPGRT        OREQ      '14'
     C* Es planilla 07-08, 07-13, 07-14
     C*MOVER ZPLA08 1
     C                   Z-ADD     1             ZPLA08
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Diferente de Terceros Agremiados-Pensión T.-Vol T.
     C* No es planilla 07-08, 07-13, 07-14
     C*SI ZPLA08<>1
     C     ZPLA08        IFNE      1
     C*LIMPIAR ZER ZFI
     C                   CLEAR                   ZER
     C                   CLEAR                   ZFI
     C* Trae indicador forma liq.
     C*LLAMAR TRFORL50(ZFECDE ZINDLI)
     C                   CALL      'TRFORL50'
     C                   PARM                    ZFECDE
     C                   PARM                    ZINDLI
     C*SI PLATIP='07' Y PLAT03='07' O ZPLART='07' Y ZTPGRT='07'
     C     PLATIP        IFEQ      '07'
     C     PLAT03        ANDEQ     '07'
     C     ZPLART        OREQ      '07'
     C     ZTPGRT        ANDEQ     '07'
     C* Tipo de planilla auxiliar
     C*LIMPIAR ZPLAUX
     C                   CLEAR                   ZPLAUX
     C* Planilla 07-09 con base 07-07
     C*SI ZTPGRT='07' Y PLAT03='09'
     C     ZTPGRT        IFEQ      '07'
     C     PLAT03        ANDEQ     '09'
     C* Planilla tipo 09
     C*PASAR ZPLAUX PLAT03
     C                   MOVEL     PLAT03        ZPLAUX
     C* Tipo de pago 07 (base 07-07)
     C*PASAR PLAT03 ZTPGRT
     C                   MOVEL     ZTPGRT        PLAT03
     C*FIN
     C                   END
     C* Graba detalles a liquidar intereses
     C*EJECUTAR M00170
     C                   EXSR      M00170
     C* Es planilla 07-09 con base 07-07
     C*SI ZPLAUX<>*BLANCO
     C     ZPLAUX        IFNE      *BLANK
     C* Se vuelve a asignar tipo pago 09
     C*PASAR PLAT03 ZPLAUX
     C                   MOVEL     ZPLAUX        PLAT03
     C*LIMPIAR ZPLAUX
     C                   CLEAR                   ZPLAUX
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*
     C* Se mueve el valor de las cotizaciones a las variables de interes
     C* porque no se pueden enviar más parámetros. Cuando regresa del ll
     C* mado en estas variable está el valor de los intereses liquidados
     C*
     C* Saldo intereses f.s.
     C*MOVER ZTIFS  ZSAFS
     C                   Z-ADD     ZSAFS         ZTIFS
     C* Saldo intereses subsistencia
     C*MOVER ZTISF  ZSASFS
     C                   Z-ADD     ZSASFS        ZTISF
     C* Saldo intereses
     C*MOVER ZTAINT ZSACO
     C                   Z-ADD     ZSACO         ZTAINT
     C* Saldo intereses C.V.A.
     C*MOVER ZTICVA ZSACVA
     C                   Z-ADD     ZSACVA        ZTICVA
     C* Saldo intereses C.V.E.
     C*MOVER ZTICVE ZSACVE
     C                   Z-ADD     ZSACVE        ZTICVE
     C* Saldo intereses A.R.
     C*MOVER ZTINAR ZSAAR
     C                   Z-ADD     ZSAAR         ZTINAR
     C* Saldo intereses FGPM
     C*MOVER ZTAIFG ZSAFGP
     C                   Z-ADD     ZSAFGP        ZTAIFG
     C* Fecha última liq. intereses
     C*MOVER ZFEL ZFECHA
     C                   MOVE      ZFECHA        ZFEL
     C* Tipo de planilla
     C*PASAR ZP PLATIP
     C                   MOVEL     PLATIP        ZP
     C* Fecha ley 1607
     C*PASAR ZF ZFEIN2
     C                   MOVEL     ZFEIN2        ZF
     C* Tasa interés simple
     C*MOVER ZT ZTAINS
     C                   Z-ADD     ZTAINS        ZT
     C*PASAR ZCL ZCLASE
     C                   MOVEL     ZCLASE        ZCL
     C*PASAR ZFO ZFORDE
     C                   MOVEL     ZFORDE        ZFO
     C*PASAR ZAMP ZAMNPA
     C                   MOVEL     ZAMNPA        ZAMP
     C*MOVER ZUL ZULNIT
     C                   Z-ADD     ZULNIT        ZUL
     C*LLAMAR TRPLAN6N(ZPER ZP PLAT03 ZFECDE ZFEL ZINDLI ZCL ZFO ZUL ZAM
     C                   CALL      'TRPLAN6N'
     C                   PARM                    ZPER
     C                   PARM                    ZP
     C                   PARM                    PLAT03
     C                   PARM                    ZFECDE
     C                   PARM                    ZFEL
     C                   PARM                    ZINDLI
     C                   PARM                    ZCL
     C                   PARM                    ZFO
     C                   PARM                    ZUL
     C                   PARM                    ZAMP
     C                   PARM                    ZLIQIN
     C                   PARM                    ZTIFS
     C                   PARM                    ZTISF
     C                   PARM                    ZTAINT
     C                   PARM                    ZTICVA
     C                   PARM                    ZTICVE
     C                   PARM                    ZTINAR
     C                   PARM                    ZTAIFG
     C                   PARM                    ZER
     C                   PARM                    ZFI
     C                   PARM                    ZF
     C                   PARM                    ZT
     C                   PARM                    ZISL
     C                   PARM                    ZICL
     C* Desarrollo especial activo
     C*SI ZR7436 = '1'
     C     ZR7436        IFEQ      '1'
     C*PASAR ZINS ZISL
     C                   MOVEL     ZISL          ZINS
     C*PASAR ZINC ZICL
     C                   MOVEL     ZICL          ZINC
     C*FIN
     C                   END
     C*SI ZTPVAE = '1'
     C     ZTPVAE        IFEQ      '1'
     C*LIMPIAR ZINTDE ZINFDE ZCOTTO ZFSTOT
     C                   CLEAR                   ZINTDE
     C                   CLEAR                   ZINFDE
     C                   CLEAR                   ZCOTTO
     C                   CLEAR                   ZFSTOT
     C*SQL
     C/EXEC SQL
     C+  SELECT SUM(DETCOT), SUM(DETCTA)
     C+  INTO :ZCOTTO, :ZFSTOT
     C+  FROM DETARC WHERE
     C+  DETNUM = :PLANU3 AND
     C+  DETNU3 = :PLANUM
     C/END-EXEC
     C*SI ZDETAL = '1'
     C     ZDETAL        IFEQ      '1'
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C*MOVER ZINTDE ZINRZO
     C                   Z-ADD     ZINRZO        ZINTDE
     C*MOVER ZINFDE ZIFRZO
     C                   Z-ADD     ZIFRZO        ZINFDE
     C*SINO
     C                   ELSE
     C*SI ZCOTTO <> *CERO
     C     ZCOTTO        IFNE      *ZERO
     C* Int. del detalle
     C*CALCULAR (R) ZINTDE=PLAREC*(DETCOT/ZCOTTO)
     C     DETCOT        DIV       ZCOTTO        V$CA1           030 9
     C     PLAREC        MULT(H)   V$CA1         ZINTDE
     C*FIN
     C                   END
     C*SI ZFSTOT <> *CERO
     C     ZFSTOT        IFNE      *ZERO
     C* Int. del detalle
     C*CALCULAR (R) ZINFDE=PLAIN7*(DETCTA/ZFSTOT)
     C     DETCTA        DIV       ZFSTOT        V$CA1           030 9
     C     PLAIN7        MULT(H)   V$CA1         ZINFDE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C*MOVER ZINTDE ZINRZO
     C                   Z-ADD     ZINRZO        ZINTDE
     C*MOVER ZINFDE ZIFRZO
     C                   Z-ADD     ZIFRZO        ZINFDE
     C*SINO
     C                   ELSE
     C*MOVER ZINTDE PLAREC
     C                   Z-ADD     PLAREC        ZINTDE
     C*MOVER ZINFDE PLAIN7
     C                   Z-ADD     PLAIN7        ZINFDE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Calculados pasan a cero
     C*CASO ZTIPVL = '2'
     C                   SELECT
     C     ZTIPVL        WHENEQ    '2'
     C*LIMPIAR ZTAINT ZIITER ZTAIFG ZIITFG ZSAIFS ZIITFS ZTIFS ZTISF ZTI
     C                   CLEAR                   ZTAINT
     C                   CLEAR                   ZIITER
     C                   CLEAR                   ZTAIFG
     C                   CLEAR                   ZIITFG
     C                   CLEAR                   ZSAIFS
     C                   CLEAR                   ZIITFS
     C                   CLEAR                   ZTIFS
     C                   CLEAR                   ZTISF
     C                   CLEAR                   ZTICVA
     C                   CLEAR                   ZTICVE
     C                   CLEAR                   ZTINAR
     C* Se toman los reportados
     C*CASO ZTIPVL = '3'
     C     ZTIPVL        WHENEQ    '3'
     C*LIMPIAR ZTAINT ZIITER ZTAIFG ZIITFG ZTIFS ZIITFS ZTISF ZTICVA ZTI
     C                   CLEAR                   ZTAINT
     C                   CLEAR                   ZIITER
     C                   CLEAR                   ZTAIFG
     C                   CLEAR                   ZIITFG
     C                   CLEAR                   ZTIFS
     C                   CLEAR                   ZIITFS
     C                   CLEAR                   ZTISF
     C                   CLEAR                   ZTICVA
     C                   CLEAR                   ZTICVE
     C                   CLEAR                   ZTINAR
     C*SI K = 1 O K > 1 Y ZINSU1 <> '1'
     C     K             IFEQ      1
     C     K             ORGT      1
     C     ZINSU1        ANDNE     '1'
     C*MOVER ZTIFS ZINFDE
     C                   Z-ADD     ZINFDE        ZTIFS
     C*MOVER ZIITFS ZINFDE
     C                   Z-ADD     ZINFDE        ZIITFS
     C*SI ZSACO <> *CERO O ZSAFGP <> *CERO O ZSAAR <> *CERO
     C     ZSACO         IFNE      *ZERO
     C     ZSAFGP        ORNE      *ZERO
     C     ZSAAR         ORNE      *ZERO
     C*CALCULAR (R) ZPORCE = ZSAFGP / (ZSACO+ZSAFGP+ZSAAR)
     C     ZSACO         ADD       ZSAFGP        V$CA1           030 9
     C     V$CA1         ADD       ZSAAR         V$CA1
     C     ZSAFGP        DIV(H)    V$CA1         ZPORCE
     C*SINO
     C                   ELSE
     C*MOVER ZPORCE 1
     C                   Z-ADD     1             ZPORCE
     C*FIN
     C                   END
     C*CALCULAR ZTAIFG = ZINTDE * ZPORCE
     C     ZINTDE        MULT      ZPORCE        ZTAIFG
     C*MOVER ZIITFG ZTAIFG
     C                   Z-ADD     ZTAIFG        ZIITFG
     C*CALCULAR ZTAINT = ZINTDE - ZTAIFG
     C     ZINTDE        SUB       ZTAIFG        ZTAINT
     C*SI ZSACO = *CERO
     C     ZSACO         IFEQ      *ZERO
     C*MOVER ZTINAR ZTAINT
     C                   Z-ADD     ZTAINT        ZTINAR
     C*LIMPIAR ZTAINT
     C                   CLEAR                   ZTAINT
     C*FIN
     C                   END
     C*MOVER ZIITER ZTAINT
     C                   Z-ADD     ZTAINT        ZIITER
     C*PASAR ZINSU1 '1'
     C                   MOVEL     '1'           ZINSU1
     C*FIN
     C                   END
     C* Se toman los reportados
     C*CASO ZTIPVL = '4'
     C     ZTIPVL        WHENEQ    '4'
     C*SI ZINTDE > *CERO
     C     ZINTDE        IFGT      *ZERO
     C*LIMPIAR ZTAINT ZIITER ZTAIFG ZIITFG ZTICVA ZTICVE
     C                   CLEAR                   ZTAINT
     C                   CLEAR                   ZIITER
     C                   CLEAR                   ZTAIFG
     C                   CLEAR                   ZIITFG
     C                   CLEAR                   ZTICVA
     C                   CLEAR                   ZTICVE
     C*SI ZSACO > *CERO
     C     ZSACO         IFGT      *ZERO
     C*CALCULAR (R) ZPORCE = ZSAFGP / (ZSACO+ZSAFGP)
     C     ZSACO         ADD       ZSAFGP        V$CA1           030 9
     C     ZSAFGP        DIV(H)    V$CA1         ZPORCE
     C*SINO
     C                   ELSE
     C*MOVER ZPORCE 1
     C                   Z-ADD     1             ZPORCE
     C*FIN
     C                   END
     C*CALCULAR ZTAIFG = ZINTDE * ZPORCE
     C     ZINTDE        MULT      ZPORCE        ZTAIFG
     C*MOVER ZIITFG ZTAIFG
     C                   Z-ADD     ZTAIFG        ZIITFG
     C*CALCULAR ZTAINT = ZINTDE - ZTAIFG
     C     ZINTDE        SUB       ZTAIFG        ZTAINT
     C*MOVER ZIITER ZTAINT
     C                   Z-ADD     ZTAINT        ZIITER
     C*FIN
     C                   END
     C*SI ZINFDE > *CERO
     C     ZINFDE        IFGT      *ZERO
     C*LIMPIAR ZTIFS ZIITFS ZTISF
     C                   CLEAR                   ZTIFS
     C                   CLEAR                   ZIITFS
     C                   CLEAR                   ZTISF
     C*MOVER ZTIFS ZINFDE
     C                   Z-ADD     ZINFDE        ZTIFS
     C*MOVER ZIITFS ZINFDE
     C                   Z-ADD     ZINFDE        ZIITFS
     C*FIN
     C                   END
     C*FINCASOS
     C                   ENDSL
     C*FIN
     C                   END
     C* Val especial tipo O
     C*EJECUTAR M83000
     C                   EXSR      M83000
     C* Fecha última liq. intereses
     C*MOVER ZFECHA ZFEL
     C                   MOVE      ZFEL          ZFECHA
     C* Acumular saldo de los intereses
     C* Saldo intereses f.s.
     C*SUMAR ZTIFS  ZSAIFS
     C                   ADD       ZTIFS         ZSAIFS
     C* Saldo intereses f.s.
     C*SUMAR ZTISF  ZSAISF
     C                   ADD       ZTISF         ZSAISF
     C* Saldo intereses
     C*SUMAR ZTAINT ZSAINT
     C                   ADD       ZTAINT        ZSAINT
     C* Saldo intereses C.V.A.
     C*SUMAR ZTICVA ZSICVA
     C                   ADD       ZTICVA        ZSICVA
     C* Saldo intereses C.V.E.
     C*SUMAR ZTICVE ZSICVE
     C                   ADD       ZTICVE        ZSICVE
     C* Saldo intereses A.R.
     C*SUMAR ZTINAR ZSINAR
     C                   ADD       ZTINAR        ZSINAR
     C* Saldo intereses FGPM
     C*SUMAR ZTAIFG ZSAIFG
     C                   ADD       ZTAIFG        ZSAIFG
     C* Desarrollo especial activo
     C*SI ZR7436 = '1'
     C     ZR7436        IFEQ      '1'
     C* CO TE
     C*MOVER ZTAIN1 ZTCTER
     C                   Z-ADD     ZTCTER        ZTAIN1
     C* CVA TE
     C*MOVER ZTIVA1 ZTCCVA
     C                   Z-ADD     ZTCCVA        ZTIVA1
     C* CVE TE
     C*MOVER ZTIVE1 ZTCCVE
     C                   Z-ADD     ZTCCVE        ZTIVE1
     C* AR TE
     C*MOVER ZTINA1 ZTCTAR
     C                   Z-ADD     ZTCTAR        ZTINA1
     C* FGPM
     C*MOVER ZTAIG1 ZTCTFG
     C                   Z-ADD     ZTCTFG        ZTAIG1
     C* FSP TE
     C*MOVER ZTAIF1 ZTCTFS
     C                   Z-ADD     ZTCTFS        ZTAIF1
     C* SUBS TE
     C*MOVER ZTAIS1 ZTCTSF
     C                   Z-ADD     ZTCTSF        ZTAIS1
     C* CO
     C*MOVER ZTAIN2 ZIITER
     C                   Z-ADD     ZIITER        ZTAIN2
     C* CVA
     C*MOVER ZTIVA2 ZIICVA
     C                   Z-ADD     ZIICVA        ZTIVA2
     C* CVE
     C*MOVER ZTIVE2 ZIICVE
     C                   Z-ADD     ZIICVE        ZTIVE2
     C* AR
     C*MOVER ZTINA2 ZIITAR
     C                   Z-ADD     ZIITAR        ZTINA2
     C* FGPM
     C*MOVER ZTAIG2 ZIITFG
     C                   Z-ADD     ZIITFG        ZTAIG2
     C* FSP
     C*MOVER ZTAIF2 ZIITFS
     C                   Z-ADD     ZIITFS        ZTAIF2
     C* SUBS
     C*MOVER ZTAIS2 ZIITSF
     C                   Z-ADD     ZIITSF        ZTAIS2
     C* Valor intereses compuestos liquidados
     C* Saldo intereses F.S.
     C*MOVER ZSAIF1 ZTAIF1
     C                   Z-ADD     ZTAIF1        ZSAIF1
     C* Saldo intereses S.F.
     C*MOVER ZSAIS1 ZTAIS1
     C                   Z-ADD     ZTAIS1        ZSAIS1
     C* Saldo intereses C.O
     C*MOVER ZSAIN1 ZTAIN1
     C                   Z-ADD     ZTAIN1        ZSAIN1
     C* Saldo intereses C.V.A.
     C*MOVER ZSIVA1 ZTIVA1
     C                   Z-ADD     ZTIVA1        ZSIVA1
     C* Saldo intereses C.V.E.
     C*MOVER ZSIVE1 ZTIVE1
     C                   Z-ADD     ZTIVE1        ZSIVE1
     C* Saldo intereses A.R.
     C*MOVER ZSINR1 ZTINA1
     C                   Z-ADD     ZTINA1        ZSINR1
     C* Saldo intereses FGPM
     C*MOVER ZSAIG1 ZTAIG1
     C                   Z-ADD     ZTAIG1        ZSAIG1
     C* Valor intereses simples liquidados
     C* Saldo intereses F.S.
     C*MOVER ZSAIF2 ZTAIF2
     C                   Z-ADD     ZTAIF2        ZSAIF2
     C* Saldo intereses S.F.
     C*MOVER ZSAIS2 ZTAIS2
     C                   Z-ADD     ZTAIS2        ZSAIS2
     C* Saldo intereses C.O
     C*MOVER ZSAIN2 ZTAIN2
     C                   Z-ADD     ZTAIN2        ZSAIN2
     C* Saldo intereses C.V.A.
     C*MOVER ZSIVA2 ZTIVA2
     C                   Z-ADD     ZTIVA2        ZSIVA2
     C* Saldo intereses C.V.E.
     C*MOVER ZSIVE2 ZTIVE2
     C                   Z-ADD     ZTIVE2        ZSIVE2
     C* Saldo intereses A.R.
     C*MOVER ZSINR2 ZTINA2
     C                   Z-ADD     ZTINA2        ZSINR2
     C* Saldo intereses FGPM
     C*MOVER ZSAIG2 ZTAIG2
     C                   Z-ADD     ZTAIG2        ZSAIG2
     C* Total intereses liquidados
     C* Total intereses F.S.
     C*SUMAR ZTIFS  ZSAIF4
     C                   ADD       ZTIFS         ZSAIF4
     C* Total intereses S.F.
     C*SUMAR ZTISF  ZSAIS4
     C                   ADD       ZTISF         ZSAIS4
     C* Total intereses C.O
     C*SUMAR ZTAINT ZSAIN4
     C                   ADD       ZTAINT        ZSAIN4
     C* Total intereses C.V.A.
     C*SUMAR ZTICVA ZSIVA4
     C                   ADD       ZTICVA        ZSIVA4
     C* Total intereses C.V.E.
     C*SUMAR ZTICVE ZSIVE4
     C                   ADD       ZTICVE        ZSIVE4
     C* Total intereses A.R.
     C*SUMAR ZTINAR ZSINR4
     C                   ADD       ZTINAR        ZSINR4
     C* Total intereses FGPM
     C*SUMAR ZTAIFG ZSAIG4
     C                   ADD       ZTAIFG        ZSAIG4
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Error en la liq. de intereses
     C*PASAR ZERROR ZER
     C                   MOVEL     ZER           ZERROR
     C*SI ZERROR |= *BLANCO
     C     ZERROR        IFNE      *BLANK
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Plan.07-14
     C*SI PLATIP='07' Y PLAT03='14' O ZPLART='07' Y ZTPGRT='14'
     C     PLATIP        IFEQ      '07'
     C     PLAT03        ANDEQ     '14'
     C     ZPLART        OREQ      '07'
     C     ZTPGRT        ANDEQ     '14'
     C*CASO ZIND='0'
     C                   SELECT
     C     ZIND          WHENEQ    '0'
     C* Llamado por rezagos
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C*MOVER ZINTTF REZIN9
     C                   Z-ADD     REZIN9        ZINTTF
     C*MOVER ZINTTC REZINT
     C                   Z-ADD     REZINT        ZINTTC
     C*FIN
     C                   END
     C*CASO ZIND='1'
     C     ZIND          WHENEQ    '1'
     C*LIMPIAR ZTAFIR ZTAFIS
     C                   CLEAR                   ZTAFIR
     C                   CLEAR                   ZTAFIS
     C* Llamado por rezagos
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C*MOVER ZSAINT ZINTTC
     C                   Z-ADD     ZINTTC        ZSAINT
     C*MOVER ZSAIFS ZINTTF
     C                   Z-ADD     ZINTTF        ZSAIFS
     C*CALCULAR ZSAIFG=(ZINTTC*ZHPP49)/ZHPPOR
     C     ZINTTC        MULT      ZHPP49        V$CA1           030 9
     C     V$CA1         DIV       ZHPPOR        ZSAIFG
     C*CALCULAR ZSAINT=ZSAINT-ZSAIFG
     C     ZSAINT        SUB       ZSAIFG        ZSAINT
     C*SINO
     C                   ELSE
     C*MOVER ZSAINT PLAREC
     C                   Z-ADD     PLAREC        ZSAINT
     C*MOVER ZSAIFS PLAIN7
     C                   Z-ADD     PLAIN7        ZSAIFS
     C*CALCULAR ZSAIFG=(ZSAINT*ZHPP49)/ZHPPOR
     C     ZSAINT        MULT      ZHPP49        V$CA1           030 9
     C     V$CA1         DIV       ZHPPOR        ZSAIFG
     C*CALCULAR ZSAINT=ZSAINT-ZSAIFG
     C     ZSAINT        SUB       ZSAIFG        ZSAINT
     C*MOVER ZAUMCC ZSAINT
     C                   Z-ADD     ZSAINT        ZAUMCC
     C*MOVER ZAUNFS ZSAIFS
     C                   Z-ADD     ZSAIFS        ZAUNFS
     C*MOVER ZAUNFG ZSAIFG
     C                   Z-ADD     ZSAIFG        ZAUNFG
     C*SQL
     C/EXEC SQL
     C+  SELECT COUNT(*) INTO :ZAFRES
     C+  FROM DETARC WHERE DETNUM=:DETNUM AND
     C+  DETNU3=:DETNU3 AND DETCTA>0
     C/END-EXEC
     C*FIN
     C                   END
     C*PASAR ZLIQIN '1'
     C                   MOVEL     '1'           ZLIQIN
     C*CASO ZIND='2'
     C     ZIND          WHENEQ    '2'
     C* Llamado por rezagos
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C* Intereses
     C*MOVER ZININT REZINT
     C                   Z-ADD     REZINT        ZININT
     C* Intereses FSP
     C*MOVER ZINIFS REZIN9
     C                   Z-ADD     REZIN9        ZINIFS
     C* Int. FGPM
     C*CALCULAR ZINIFG = (ZININT*ZHPP49)/ZHPPOR
     C     ZININT        MULT      ZHPP49        V$CA1           030 9
     C     V$CA1         DIV       ZHPPOR        ZINIFG
     C* Int. FGPM
     C*CALCULAR ZININT = ZININT - ZINIFG
     C     ZININT        SUB       ZINIFG        ZININT
     C*SINO
     C                   ELSE
     C*SI ZTCOTI>0
     C     ZTCOTI        IFGT      0
     C*SUMAR 1 ZTAFIR
     C                   ADD       1             ZTAFIR
     C*CALCULAR (R) ZININT=PLAREC*(DETCOT/ZTCOTI)
     C     DETCOT        DIV       ZTCOTI        V$CA1           030 9
     C     PLAREC        MULT(H)   V$CA1         ZININT
     C*LIMPIAR ZINIFS
     C                   CLEAR                   ZINIFS
     C*SI DETCTA>0
     C     DETCTA        IFGT      0
     C*SUMAR 1 ZTAFIS
     C                   ADD       1             ZTAFIS
     C*CALCULAR (R) ZINIFS=PLAIN7*(DETCOT/ZTCOTI)
     C     DETCOT        DIV       ZTCOTI        V$CA1           030 9
     C     PLAIN7        MULT(H)   V$CA1         ZINIFS
     C*FIN
     C                   END
     C* Int. FGPM
     C*CALCULAR ZINIFG = (ZININT*ZHPP49)/ZHPPOR
     C     ZININT        MULT      ZHPP49        V$CA1           030 9
     C     V$CA1         DIV       ZHPPOR        ZINIFG
     C* Int. FGPM
     C*CALCULAR ZININT = ZININT - ZINIFG
     C     ZININT        SUB       ZINIFG        ZININT
     C*SI PLAT04>0 Y ZTAFIR=PLAT04
     C     PLAT04        IFGT      0
     C     ZTAFIR        ANDEQ     PLAT04
     C*MOVER ZININT ZAUMCC
     C                   Z-ADD     ZAUMCC        ZININT
     C*MOVER ZINIFG ZAUNFG
     C                   Z-ADD     ZAUNFG        ZINIFG
     C*FIN
     C                   END
     C*SI ZAFRES>0 Y ZTAFIS=ZAFRES
     C     ZAFRES        IFGT      0
     C     ZTAFIS        ANDEQ     ZAFRES
     C*MOVER ZINIFS ZAUNFS
     C                   Z-ADD     ZAUNFS        ZINIFS
     C*FIN
     C                   END
     C*RESTAR ZININT ZAUMCC
     C                   SUB       ZININT        ZAUMCC
     C*RESTAR ZINIFS ZAUNFS
     C                   SUB       ZINIFS        ZAUNFS
     C*RESTAR ZINIFG ZAUNFG
     C                   SUB       ZINIFG        ZAUNFG
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*PASAR ZLIQIN '1'
     C                   MOVEL     '1'           ZLIQIN
     C*FINCASOS
     C                   ENDSL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Pagar voluntaria afiliado                                   ==
     C*==                                                              ==
     C*==================================================================
     C     M12210        BEGSR
     C* Valor depósito y Saldo c.v.a.
     C*SI ZVRDEP > *CERO Y ZSACVA > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSACVA        ANDGT     *ZERO
     C* Vlr. depósito > Saldo c.v.a.
     C*SI ZVRDEP > ZSACVA
     C     ZVRDEP        IFGT      ZSACVA
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSACVA) / ZVRDEP
     C     ZCUDEP        MULT      ZSACVA        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Valor pagado c.v.a
     C*MOVER A$CVA[K] ZSACVA
     C                   Z-ADD     ZSACVA        $2(K)
     C* Cuotas pagadas c.v.a
     C*MOVER ACUCVA[K] ZCUOTA
     C                   Z-ADD     ZCUOTA        $A(K)
     C* Actualiza valor depósito
     C*RESTAR ZSACVA ZVRDEP
     C                   SUB       ZSACVA        ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo c.v.a
     C*LIMPIAR ZSACVA
     C                   CLEAR                   ZSACVA
     C* Vlr. depósito =< Saldo c.v.a.
     C*SINO
     C                   ELSE
     C* Valor pagado c.v.a
     C*MOVER A$CVA[K] ZVRDEP
     C                   Z-ADD     ZVRDEP        $2(K)
     C* Cuotas pagadas c.v.a
     C*MOVER ACUCVA[K] ZCUDEP
     C                   Z-ADD     ZCUDEP        $A(K)
     C* Actuliza saldo c.v.a.
     C*RESTAR ZVRDEP ZSACVA
     C                   SUB       ZVRDEP        ZSACVA
     C* Limpia valor y cuotas depósi.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Pagar fondo de garantía de pensión mínima                   ==
     C*==                                                              ==
     C*==================================================================
     C     M12211        BEGSR
     C* Valor depósito y saldo FGPM
     C*SI ZVRDEP > *CERO Y ZSAFGP > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSAFGP        ANDGT     *ZERO
     C* Vlr. depósito > saldo FGPM
     C*SI ZVRDEP > ZSAFGP
     C     ZVRDEP        IFGT      ZSAFGP
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSAFGP) / ZVRDEP
     C     ZCUDEP        MULT      ZSAFGP        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Valor pagado FGPM
     C*MOVER A$CO[2,K] ZSAFGP
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZSAFGP        $1(V$3)
     C* Cuotas pagadas C.O.
     C*MOVER ACUCO[2,K] ZCUOTA
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUOTA        $9(V$3)
     C* Actualiza valor depósito
     C*RESTAR ZSAFGP ZVRDEP
     C                   SUB       ZSAFGP        ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo FGPM
     C*LIMPIAR ZSAFGP
     C                   CLEAR                   ZSAFGP
     C*SINO
     C                   ELSE
     C* Valor pagado FGPM
     C*MOVER A$CO[2,K] ZVRDEP
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZVRDEP        $1(V$3)
     C* Cuotas pagadas FGPM
     C*MOVER ACUCO[2,K] ZCUDEP
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUDEP        $9(V$3)
     C* Actualiza saldo C.O.
     C*RESTAR ZVRDEP ZSAFGP
     C                   SUB       ZVRDEP        ZSAFGP
     C* Limpia valor y cuotas depósito
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Pagar fondo de solidaridad                                  ==
     C*==                                                              ==
     C*==================================================================
     C     M12215        BEGSR
     C* Fondo de solidaridad
     C* Vlr depósito y saldo F.S.P
     C*SI ZVRDEP > *CERO Y ZSAFS > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSAFS         ANDGT     *ZERO
     C* Vlr depósito > saldo F.S.P
     C*SI ZVRDEP > ZSAFS
     C     ZVRDEP        IFGT      ZSAFS
     C* Cuotas F.S.P
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSAFS) / ZVRDEP
     C     ZCUDEP        MULT      ZSAFS         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Vlr pagado F.S.P
     C*MOVER A$FS[1,K] ZSAFS
     C                   Z-ADD     ZSAFS         $4(K)
     C* CUotas pagadas F.S.P
     C*MOVER ACUFS[1,K] ZCUOTA
     C                   Z-ADD     ZCUOTA        $C(K)
     C* Actualiza Vlr del depósito
     C*RESTAR ZSAFS ZVRDEP
     C                   SUB       ZSAFS         ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo F.S.P
     C*LIMPIAR ZSAFS
     C                   CLEAR                   ZSAFS
     C*SINO
     C                   ELSE
     C* Valor pagado F.S.P
     C*MOVER A$FS[1,K] ZVRDEP
     C                   Z-ADD     ZVRDEP        $4(K)
     C* Cuotas pagadas F.S.P
     C*MOVER ACUFS[1,K] ZCUDEP
     C                   Z-ADD     ZCUDEP        $C(K)
     C* Actualiza saldo F.S.P
     C*RESTAR ZVRDEP ZSAFS
     C                   SUB       ZVRDEP        ZSAFS
     C* Limpia Vlr y cuotas depósito.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Fondo de subsistencia
     C* Vlr depósito y saldo Subsistencia
     C*SI ZVRDEP > *CERO Y ZSASFS > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSASFS        ANDGT     *ZERO
     C* VLR. DEPÓSITO > SALDO C.F.S.
     C*SI ZVRDEP > ZSASFS
     C     ZVRDEP        IFGT      ZSASFS
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSASFS) / ZVRDEP
     C     ZCUDEP        MULT      ZSASFS        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Vlr pagado Subsistencia
     C*MOVER A$FS[2,K] ZSASFS
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZSASFS        $4(V$3)
     C* Cuotas pagadas subsistencia
     C*MOVER ACUFS[2,K] ZCUOTA
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUOTA        $C(V$3)
     C* Actualiza vlr depósito
     C*RESTAR ZSASFS ZVRDEP
     C                   SUB       ZSASFS        ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo subsistencia
     C*LIMPIAR ZSASFS
     C                   CLEAR                   ZSASFS
     C*SINO
     C                   ELSE
     C* Valor pagado subsistencia
     C*MOVER A$FS[2,K] ZVRDEP
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZVRDEP        $4(V$3)
     C* Cuotas pagadas subsistencia
     C*MOVER ACUFS[2,K] ZCUDEP
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUDEP        $C(V$3)
     C* Actualiza subsistencia
     C*RESTAR ZVRDEP ZSASFS
     C                   SUB       ZVRDEP        ZSASFS
     C* Limpia vlr y cuotas depósito.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Paga intereses fondo de solidaridad                         ==
     C*==                                                              ==
     C*==================================================================
     C     M12220        BEGSR
     C* Int. fondo de solidaridad
     C* Valor depósito y Saldo int.fs
     C*SI ZVRDEP > *CERO Y ZSAIFS > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSAIFS        ANDGT     *ZERO
     C* Vlr. depósito > Saldo int.f.s
     C*SI ZVRDEP > ZSAIFS
     C     ZVRDEP        IFGT      ZSAIFS
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSAIFS) / ZVRDEP
     C     ZCUDEP        MULT      ZSAIFS        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Valor pagado int. f.s.
     C*MOVER A$IFS[1,K] ZSAIFS
     C                   Z-ADD     ZSAIFS        $5(K)
     C* Cuotas pagadas int. f.s.
     C*MOVER ACUIFS[1,K] ZCUOTA
     C                   Z-ADD     ZCUOTA        $D(K)
     C* Actualiza valor depósito
     C*RESTAR ZSAIFS ZVRDEP
     C                   SUB       ZSAIFS        ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo int. f.s.
     C*LIMPIAR ZSAIFS
     C                   CLEAR                   ZSAIFS
     C*SINO
     C                   ELSE
     C* Valor pagado int. f.s.
     C*MOVER A$IFS[1,K] ZVRDEP
     C                   Z-ADD     ZVRDEP        $5(K)
     C* Cuotas pagadas int. f.s.
     C*MOVER ACUIFS[1,K] ZCUDEP
     C                   Z-ADD     ZCUDEP        $D(K)
     C* Actuliza saldo int. f.s.
     C*RESTAR ZVRDEP ZSAIFS
     C                   SUB       ZVRDEP        ZSAIFS
     C* Limpia valor y cuotas depósi.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Int. fondo de susbsistencia
     C* Vlr depósito y Sal int.subsis
     C*SI ZVRDEP > *CERO Y ZSAISF > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSAISF        ANDGT     *ZERO
     C* Vlr. depósito > Saldo int.sub
     C*SI ZVRDEP > ZSAISF
     C     ZVRDEP        IFGT      ZSAISF
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSAISF) / ZVRDEP
     C     ZCUDEP        MULT      ZSAISF        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Vlr pagado int. subsistencia
     C*MOVER A$IFS[2,K] ZSAISF
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZSAISF        $5(V$3)
     C* Cuotas pagadas int. subsis
     C*MOVER ACUIFS[2,K] ZCUOTA
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUOTA        $D(V$3)
     C* Actualiza valor depósito
     C*RESTAR ZSAISF ZVRDEP
     C                   SUB       ZSAISF        ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo int. subsisten
     C*LIMPIAR ZSAISF
     C                   CLEAR                   ZSAISF
     C*SINO
     C                   ELSE
     C* Vlr pagado int. subsistencia
     C*MOVER A$IFS[2,K] ZVRDEP
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZVRDEP        $5(V$3)
     C* Cuotas pagadas int. subsist
     C*MOVER ACUIFS[2,K] ZCUDEP
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUDEP        $D(V$3)
     C* Actuliza saldo int. subsisten
     C*RESTAR ZVRDEP ZSAISF
     C                   SUB       ZVRDEP        ZSAISF
     C* Limpia valor y cuotas depósi.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Pagar Fondo de garantia de pensión minima                   ==
     C*==                                                              ==
     C*==================================================================
     C     M12221        BEGSR
     C* Fondo de garantía
     C* Valor depósito y Saldo GPM
     C*SI ZVRDEP > *CERO Y ZSAFGP > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSAFGP        ANDGT     *ZERO
     C* Vlr. depósito > Saldo GPM
     C*SI ZVRDEP > ZSAFGP
     C     ZVRDEP        IFGT      ZSAFGP
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSAFGP) / ZVRDEP
     C     ZCUDEP        MULT      ZSAFGP        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Valor pagado F.G.P
     C*MOVER A$CO[2,K] ZSAFGP
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZSAFGP        $1(V$3)
     C* Cuotas pagadas F.G.P
     C*MOVER ACUCO[2,K] ZCUOTA
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUOTA        $9(V$3)
     C* Actualiza valor depósito
     C*RESTAR ZSAFGP ZVRDEP
     C                   SUB       ZSAFGP        ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo F.G.P
     C*LIMPIAR ZSAFGP
     C                   CLEAR                   ZSAFGP
     C*SINO
     C                   ELSE
     C* Valor pagado F.G.P
     C*MOVER A$CO[2,K] ZVRDEP
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZVRDEP        $1(V$3)
     C* Cuotas pagadas F.G.P
     C*MOVER ACUCO[2,K] ZCUDEP
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUDEP        $9(V$3)
     C* Actuliza saldo F.G.P
     C*RESTAR ZVRDEP ZSAFGP
     C                   SUB       ZVRDEP        ZSAFGP
     C* Limpia valor y cuotas depósi.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Int fondo de garantía
     C* Valor depósito y Saldo GPM
     C*SI ZVRDEP > *CERO Y ZSAIFG > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSAIFG        ANDGT     *ZERO
     C* Vlr. depósito > Saldo GPM
     C*SI ZVRDEP > ZSAIFG
     C     ZVRDEP        IFGT      ZSAIFG
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSAIFG) / ZVRDEP
     C     ZCUDEP        MULT      ZSAIFG        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Valor pagado int. F.G.P
     C*MOVER A$INT[5,K] ZSAIFG
     C     400           ADD       K             V$3               4 0
     C                   Z-ADD     ZSAIFG        $6(V$3)
     C* Cuotas pagadas int. F.G.P
     C*MOVER ACUINT[5,K] ZCUOTA
     C     400           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUOTA        $E(V$3)
     C* Actualiza valor depósito
     C*RESTAR ZSAIFG ZVRDEP
     C                   SUB       ZSAIFG        ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo int. F.G.P
     C*LIMPIAR ZSAIFG
     C                   CLEAR                   ZSAIFG
     C*SINO
     C                   ELSE
     C* Valor pagado int. F.G.P
     C*MOVER A$INT[5,K] ZVRDEP
     C     400           ADD       K             V$3               4 0
     C                   Z-ADD     ZVRDEP        $6(V$3)
     C* Cuotas pagadas int.F.G.P
     C*MOVER ACUINT[5,K] ZCUDEP
     C     400           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUDEP        $E(V$3)
     C* Actuliza saldo int. F.G.P
     C*RESTAR ZVRDEP ZSAIFG
     C                   SUB       ZVRDEP        ZSAIFG
     C* Limpia valor y cuotas depósi.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Pagar intereses cotizaciones                                ==
     C*==                                                              ==
     C*==================================================================
     C     M12225        BEGSR
     C* Valor depósito y Saldo int.
     C*SI ZVRDEP > *CERO Y ZSAINT > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSAINT        ANDGT     *ZERO
     C* Vlr. depósito > Saldo int.
     C*SI ZVRDEP > ZSAINT
     C     ZVRDEP        IFGT      ZSAINT
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSAINT) / ZVRDEP
     C     ZCUDEP        MULT      ZSAINT        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Valor pagado intereses
     C*MOVER A$INT[1,K] ZSAINT
     C                   Z-ADD     ZSAINT        $6(K)
     C* Cuotas pagadas intereses
     C*MOVER ACUINT[1,K] ZCUOTA
     C                   Z-ADD     ZCUOTA        $E(K)
     C* Actualiza valor depósito
     C*RESTAR ZSAINT ZVRDEP
     C                   SUB       ZSAINT        ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo intereses
     C*LIMPIAR ZSAINT
     C                   CLEAR                   ZSAINT
     C*SINO
     C                   ELSE
     C* Valor pagado intereses
     C*MOVER A$INT[1,K] ZVRDEP
     C                   Z-ADD     ZVRDEP        $6(K)
     C* Cuotas pagadas intereses
     C*MOVER ACUINT[1,K] ZCUDEP
     C                   Z-ADD     ZCUDEP        $E(K)
     C* Actuliza saldo intereses
     C*RESTAR ZVRDEP ZSAINT
     C                   SUB       ZVRDEP        ZSAINT
     C* Limpia valor y cuotas depósi.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Vlr depósito y Saldo int.CVA
     C*SI ZVRDEP > *CERO Y ZSICVA > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSICVA        ANDGT     *ZERO
     C* Vlr. depósito > Saldo int.
     C*SI ZVRDEP > ZSICVA
     C     ZVRDEP        IFGT      ZSICVA
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSICVA) / ZVRDEP
     C     ZCUDEP        MULT      ZSICVA        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Valor pagado intereses C.V.A
     C*MOVER A$INT[2,K] ZSICVA
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZSICVA        $6(V$3)
     C* Cuotas pagadas intereses
     C*MOVER ACUINT[2,K] ZCUOTA
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUOTA        $E(V$3)
     C* Actualiza valor depósito
     C*RESTAR ZSICVA ZVRDEP
     C                   SUB       ZSICVA        ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo intereses C.V.A
     C*LIMPIAR ZSICVA
     C                   CLEAR                   ZSICVA
     C*SINO
     C                   ELSE
     C* Valor pagado intereses CVA
     C*MOVER A$INT[2,K] ZVRDEP
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZVRDEP        $6(V$3)
     C* Cuotas pagadas intereses CVA
     C*MOVER ACUINT[2,K] ZCUDEP
     C     100           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUDEP        $E(V$3)
     C* Actuliza saldo intereses CVA
     C*RESTAR ZVRDEP ZSICVA
     C                   SUB       ZVRDEP        ZSICVA
     C* Limpia valor y cuotas depósi.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Vlr depósito y Saldo int.CVE
     C*SI ZVRDEP > *CERO Y ZSICVE > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSICVE        ANDGT     *ZERO
     C* Vlr. depósito > Saldo int.
     C*SI ZVRDEP > ZSICVE
     C     ZVRDEP        IFGT      ZSICVE
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSICVE) / ZVRDEP
     C     ZCUDEP        MULT      ZSICVE        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Valor pagado intereses C.V.E
     C*MOVER A$INT[3,K] ZSICVE
     C     200           ADD       K             V$3               4 0
     C                   Z-ADD     ZSICVE        $6(V$3)
     C* Cuotas pagadas intereses
     C*MOVER ACUINT[3,K] ZCUOTA
     C     200           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUOTA        $E(V$3)
     C* Actualiza valor depósito
     C*RESTAR ZSICVE ZVRDEP
     C                   SUB       ZSICVE        ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo intereses C.V.E
     C*LIMPIAR ZSICVE
     C                   CLEAR                   ZSICVE
     C*SINO
     C                   ELSE
     C* Valor pagado intereses CVE
     C*MOVER A$INT[3,K] ZVRDEP
     C     200           ADD       K             V$3               4 0
     C                   Z-ADD     ZVRDEP        $6(V$3)
     C* Cuotas pagadas intereses CVE
     C*MOVER ACUINT[3,K] ZCUDEP
     C     200           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUDEP        $E(V$3)
     C* Actuliza saldo intereses CVE
     C*RESTAR ZVRDEP ZSICVE
     C                   SUB       ZVRDEP        ZSICVE
     C* Limpia valor y cuotas depósi.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Vlr depósito y Saldo int.A.R.
     C*SI ZVRDEP > *CERO Y ZSINAR > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSINAR        ANDGT     *ZERO
     C* Vlr. depósito > Saldo int.
     C*SI ZVRDEP > ZSINAR
     C     ZVRDEP        IFGT      ZSINAR
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSINAR) / ZVRDEP
     C     ZCUDEP        MULT      ZSINAR        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Valor pagado intereses A.R.
     C*MOVER A$INT[4,K] ZSINAR
     C     300           ADD       K             V$3               4 0
     C                   Z-ADD     ZSINAR        $6(V$3)
     C* Cuotas pagadas intereses
     C*MOVER ACUINT[4,K] ZCUOTA
     C     300           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUOTA        $E(V$3)
     C* Actualiza valor depósito
     C*RESTAR ZSINAR ZVRDEP
     C                   SUB       ZSINAR        ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo intereses A.R.
     C*LIMPIAR ZSINAR
     C                   CLEAR                   ZSINAR
     C*SINO
     C                   ELSE
     C* Valor pagado intereses A.R.
     C*MOVER A$INT[4,K] ZVRDEP
     C     300           ADD       K             V$3               4 0
     C                   Z-ADD     ZVRDEP        $6(V$3)
     C* Cuotas pagadas intereses A.R.
     C*MOVER ACUINT[4,K] ZCUDEP
     C     300           ADD       K             V$3               4 0
     C                   Z-ADD     ZCUDEP        $E(V$3)
     C* Actuliza saldo intereses A.R.
     C*RESTAR ZVRDEP ZSINAR
     C                   SUB       ZVRDEP        ZSINAR
     C* Limpia valor y cuotas depósi.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Pagar rendimientos                                          ==
     C*==                                                              ==
     C*==================================================================
     C     M12230        BEGSR
     C* Valor depósito y Saldo rendi.
     C*SI ZVRDEP > *CERO Y ZSAREN > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSAREN        ANDGT     *ZERO
     C* Vlr. depósito > Saldo rendi.
     C*SI ZVRDEP > ZSAREN
     C     ZVRDEP        IFGT      ZSAREN
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSAREN) / ZVRDEP
     C     ZCUDEP        MULT      ZSAREN        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Valor pagado rendimientos
     C*MOVER A$REN[K] ZSAREN
     C                   Z-ADD     ZSAREN        $7(K)
     C* Cuotas pagadas rendimientos
     C*MOVER ACUREN[K] ZCUOTA
     C                   Z-ADD     ZCUOTA        $F(K)
     C* Actualiza valor depósito
     C*RESTAR ZSAREN ZVRDEP
     C                   SUB       ZSAREN        ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo rendimientos
     C*LIMPIAR ZSAREN
     C                   CLEAR                   ZSAREN
     C*SINO
     C                   ELSE
     C* Valor pagado rendimientos
     C*MOVER A$REN[K] ZVRDEP
     C                   Z-ADD     ZVRDEP        $7(K)
     C* Cuotas pagadas rendimientos
     C*MOVER ACUREN[K] ZCUDEP
     C                   Z-ADD     ZCUDEP        $F(K)
     C* Actuliza saldo rendimientos
     C*RESTAR ZVRDEP ZSAREN
     C                   SUB       ZVRDEP        ZSAREN
     C* Limpia valor y cuotas depósi.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Pagar alto riesgo                                           ==
     C*==                                                              ==
     C*==================================================================
     C     M12235        BEGSR
     C* Valor depósito y Saldo a.r.
     C*SI ZVRDEP > *CERO Y ZSAAR > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSAAR         ANDGT     *ZERO
     C* Vlr. depósito > Saldo a.r.
     C*SI ZVRDEP > ZSAAR
     C     ZVRDEP        IFGT      ZSAAR
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSAAR) / ZVRDEP
     C     ZCUDEP        MULT      ZSAAR         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Valor pagado a.r.
     C*MOVER A$AR[K] ZSAAR
     C                   Z-ADD     ZSAAR         $0(K)
     C* Cuotas pagadas a.r.
     C*MOVER ACUAR[K] ZCUOTA
     C                   Z-ADD     ZCUOTA        $8(K)
     C* Actualiza valor depósito
     C*RESTAR ZSAAR ZVRDEP
     C                   SUB       ZSAAR         ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo a.r.
     C*LIMPIAR ZSAAR
     C                   CLEAR                   ZSAAR
     C*SINO
     C                   ELSE
     C* Valor pagado a.r.
     C*MOVER A$AR[K] ZVRDEP
     C                   Z-ADD     ZVRDEP        $0(K)
     C* Cuotas pagadas a.r.
     C*MOVER ACUAR[K] ZCUDEP
     C                   Z-ADD     ZCUDEP        $8(K)
     C* Actuliza saldo a.r.
     C*RESTAR ZVRDEP ZSAAR
     C                   SUB       ZVRDEP        ZSAAR
     C* Limpia valor y cuotas depósi.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Pagar obligatoria                                           ==
     C*==                                                              ==
     C*==================================================================
     C     M12240        BEGSR
     C* Valor depósito y Saldo c.o.
     C*SI ZVRDEP > *CERO Y ZSACO > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSACO         ANDGT     *ZERO
     C* Vlr. depósito > Saldo c.o.
     C*SI ZVRDEP > ZSACO
     C     ZVRDEP        IFGT      ZSACO
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSACO) / ZVRDEP
     C     ZCUDEP        MULT      ZSACO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Valor pagado c.o.
     C*MOVER A$CO[1,K] ZSACO
     C                   Z-ADD     ZSACO         $1(K)
     C* Cuotas pagadas c.o.
     C*MOVER ACUCO[1,K] ZCUOTA
     C                   Z-ADD     ZCUOTA        $9(K)
     C* Actualiza valor depósito
     C*RESTAR ZSACO ZVRDEP
     C                   SUB       ZSACO         ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo c.o.
     C*LIMPIAR ZSACO
     C                   CLEAR                   ZSACO
     C*SINO
     C                   ELSE
     C* Valor pagado c.o.
     C*MOVER A$CO[1,K] ZVRDEP
     C                   Z-ADD     ZVRDEP        $1(K)
     C* Cuotas pagadas c.o.
     C*MOVER ACUCO[1,K] ZCUDEP
     C                   Z-ADD     ZCUDEP        $9(K)
     C* Actuliza saldo c.o.
     C*RESTAR ZVRDEP ZSACO
     C                   SUB       ZVRDEP        ZSACO
     C* Limpia valor y cuotas depósi.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Pagar cotización voluntaria empleador                       ==
     C*==                                                              ==
     C*==================================================================
     C     M12245        BEGSR
     C* Valor depósito y Saldo c.v.e.
     C*SI ZVRDEP > *CERO Y ZSACVE > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C     ZSACVE        ANDGT     *ZERO
     C* Vlr. depósito > Saldo c.v.e.
     C*SI ZVRDEP > ZSACVE
     C     ZVRDEP        IFGT      ZSACVE
     C*CALCULAR (R) ZCUOTA = (ZCUDEP * ZSACVE) / ZVRDEP
     C     ZCUDEP        MULT      ZSACVE        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUOTA
     C* Valor pagado c.v.e
     C*MOVER A$CVE[K] ZSACVE
     C                   Z-ADD     ZSACVE        $3(K)
     C* Cuotas pagadas c.v.e.
     C*MOVER ACUCVE[K] ZCUOTA
     C                   Z-ADD     ZCUOTA        $B(K)
     C* Actualiza valor depósito
     C*RESTAR ZSACVE ZVRDEP
     C                   SUB       ZSACVE        ZVRDEP
     C* Actualiza cuotas depósito
     C*RESTAR ZCUOTA ZCUDEP
     C                   SUB       ZCUOTA        ZCUDEP
     C* Limpia saldo c.v.e.
     C*LIMPIAR ZSACVE
     C                   CLEAR                   ZSACVE
     C*SINO
     C                   ELSE
     C* Valor pagado c.v.e.
     C*MOVER A$CVE[K] ZVRDEP
     C                   Z-ADD     ZVRDEP        $3(K)
     C* Cuotas pagadas c.v.e.
     C*MOVER ACUCVE[K] ZCUDEP
     C                   Z-ADD     ZCUDEP        $B(K)
     C* Actuliza saldo c.v.e.
     C*RESTAR ZVRDEP ZSACVE
     C                   SUB       ZVRDEP        ZSACVE
     C* Limpia valor y cuotas depósi.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesar pagos adelantados                                  ==
     C*==                                                              ==
     C*==================================================================
     C     M13000        BEGSR
     C*PASAR HISFEC ZULFDE
     C                   MOVEL     ZULFDE        HISFEC
     C* Indic. acred. P.A. 0=No
     C*PASAR ZINAPA '0'
     C                   MOVEL     '0'           ZINAPA
     C*RECUPERAR (N) HISAR1(ZFONDO HISFEC)
     C     LL$061        KLIST
     C                   KFLD                    ZFONDO
     C                   KFLD                    HISFEC
     C     LL$061        CHAIN     HISAR1                             89
     C* Busca P.E. del empleador
     C*INICIARI PAGARC06 (PLANU4)
     C     PLANU4        SETLL     PAGARC06                               71
     C     *IN71         IFEQ      '1'
     C                   MOVE      '0'           *IN71
     C                   ELSE
     C                   MOVE      '1'           *IN71
     C                   END
     C*SI ERE(PAGARC06)
     C     *IN71         IFEQ      '0'
     C* Limpiar valor y cuotas dep.
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C* Fecha dep. = Fecha del fondo
     C*PASAR ZFECDE HISFE3
     C                   MOVEL     HISFE3        ZFECDE
     C*
     C*CALCULAR ZSACOT = ZSACO + ZSAAR + ZSACVA + ZSACVE + ZSAFS + ZSAIN
     C     ZSACO         ADD       ZSAAR         V$CA1           030 9
     C     V$CA1         ADD       ZSACVA        V$CA1
     C     V$CA1         ADD       ZSACVE        V$CA1
     C     V$CA1         ADD       ZSAFS         V$CA1
     C     V$CA1         ADD       ZSAINT        V$CA1
     C     V$CA1         ADD       ZSAIFS        V$CA1
     C     V$CA1         ADD       ZSAFGP        V$CA1
     C     V$CA1         ADD       ZSAIFG        V$CA1
     C     V$CA1         ADD       ZSASFS        V$CA1
     C     V$CA1         ADD       ZSAISF        V$CA1
     C     V$CA1         ADD       ZSICVA        V$CA1
     C     V$CA1         ADD       ZSICVE        V$CA1
     C     V$CA1         ADD       ZSINAR        ZSACOT
     C*
     C*LEER PAGARC06(PLANU4)
     C     PLANU4        READE     PAGARC06                               71
     C*MIENTRAS NFA(PAGARC06) Y PAGNU4 = PLANU4 Y ZSACOT > *CERO
     C     *IN71         DOWEQ     '0'
     C     PAGNU4        ANDEQ     PLANU4
     C     ZSACOT        ANDGT     *ZERO
     C* Ind. de pago adelantado válido
     C*PASAR ZINPAV  '0'
     C                   MOVEL     '0'           ZINPAV
     C* Filtro CONTI3 = '9'
     C*INICIARI CONAR203 (PAGNUM)
     C     PAGNUM        SETLL     CONAR203                               42
     C     *IN42         IFEQ      '1'
     C                   MOVE      '0'           *IN42
     C                   ELSE
     C                   MOVE      '1'           *IN42
     C                   END
     C*SI ERE (CONAR203)
     C     *IN42         IFEQ      '0'
     C*LEER CONAR203
     C                   READ      CONAR203                               42
     C* P.A. aplica para el período de la planilla
     C* Período de la planilla
     C*SI CONPE3 = PLAPER
     C     CONPE3        IFEQ      PLAPER
     C* Ind. de pago disponible
     C*PASAR ZINPAV '1'
     C                   MOVEL     '1'           ZINPAV
     C* Borra registro temporal y se crea tipo conc.
     C* Eliminar conc.
     C*BORRAR CONAR203
     C                   DELETE    CONAR203
     C*SINO
     C                   ELSE
     C*LIMPIAR CONPE3
     C                   CLEAR                   CONPE3
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*PASAR ZINPAV '1'
     C                   MOVEL     '1'           ZINPAV
     C*FIN
     C                   END
     C* P.A válido para conciliar
     C*SI ZINPAV = '1'
     C     ZINPAV        IFEQ      '1'
     C* Vlr. a hoy pago adelantado
     C*CALCULAR (R) ZVRPA = PAGCU3 * HISCU2
     C     PAGCU3        MULT(H)   HISCU2        ZVRPA
     C*SI ZSACOT < ZVRPA
     C     ZSACOT        IFLT      ZVRPA
     C* Cuotas pago adelantado
     C*CALCULAR (R) ZCUPA = ZSACOT / HISCU2
     C     ZSACOT        DIV(H)    HISCU2        ZCUPA
     C*CALCULAR (R) ZVRHIS = (ZCUPA * PAGSAL) / PAGCU3
     C     ZCUPA         MULT      PAGSAL        V$CA1           030 9
     C     V$CA1         DIV(H)    PAGCU3        ZVRHIS
     C* Actualiza saldo pago adelant.
     C*RESTAR ZVRHIS PAGSAL
     C                   SUB       ZVRHIS        PAGSAL
     C* Saldo cuotas pago adelantado
     C*RESTAR ZCUPA  PAGCU3
     C                   SUB       ZCUPA         PAGCU3
     C* Valor del depósito
     C*SUMAR  ZSACOT ZVRDEP
     C                   ADD       ZSACOT        ZVRDEP
     C* Cuotas depósito
     C*SUMAR  ZCUPA  ZCUDEP
     C                   ADD       ZCUPA         ZCUDEP
     C* Valor pagado
     C*MOVER  ZVRPA  ZSACOT
     C                   Z-ADD     ZSACOT        ZVRPA
     C* Saldo cotizaciones
     C*LIMPIAR ZSACOT
     C                   CLEAR                   ZSACOT
     C*SINO
     C                   ELSE
     C* Cuotas apliacada pago adelan.
     C*MOVER ZCUPA PAGCU3
     C                   Z-ADD     PAGCU3        ZCUPA
     C* Valor depósito
     C*SUMAR ZVRPA ZVRDEP
     C                   ADD       ZVRPA         ZVRDEP
     C* Cuotas depósito
     C*SUMAR ZCUPA ZCUDEP
     C                   ADD       ZCUPA         ZCUDEP
     C* Saldo cotizaciones
     C*RESTAR ZVRPA ZSACOT
     C                   SUB       ZVRPA         ZSACOT
     C* Valor histórico pago adelant.
     C*MOVER ZVRHIS PAGSAL
     C                   Z-ADD     PAGSAL        ZVRHIS
     C* Saldo pago adelantado
     C*LIMPIAR PAGSAL PAGCU3
     C                   CLEAR                   PAGSAL
     C                   CLEAR                   PAGCU3
     C*FIN
     C                   END
     C* Genera registro conciliación
     C*EJECUTAR M13100
     C                   EXSR      M13100
     C*GRABAR PAGARC06
     C     *IN71         IFEQ      '0'
     C                   UPDATE    PAGREG06                             94
     C                   ELSE
     C                   WRITE     PAGREG06                             94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Indic. acred. P.A. 1=Si
     C*PASAR ZINAPA '1'
     C                   MOVEL     '1'           ZINAPA
     C*FIN
     C                   END
     C*LEER PAGARC06(PLANU4)
     C     PLANU4        READE     PAGARC06                               71
     C*FIN
     C                   END
     C* Valor depósito
     C*SI ZVRDEP |= *CERO
     C     ZVRDEP        IFNE      *ZERO
     C* No es acreditación de rezagos
     C*SI ZT@002 <> '3'
     C     ZT@002        IFNE      '3'
     C*MOVER ZVALHI ZVRDEP
     C                   Z-ADD     ZVRDEP        ZVALHI
     C*MOVER ZCUOHI ZCUDEP
     C                   Z-ADD     ZCUDEP        ZCUOHI
     C* Recaudos en proceso
     C*SUMAR ZVALHI ZTOTRP
     C                   ADD       ZVALHI        ZTOTRP
     C*SUMAR ZCUOHI ZTOCRP
     C                   ADD       ZCUOHI        ZTOCRP
     C* Cód. transacción
     C*PASAR ZCODTX '04'
     C                   MOVEL     '04'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '43'
     C                   MOVEL     '43'          ZCONCE
     C* Actualizar HISAR4
     C*EJECUTAR M00055
     C                   EXSR      M00055
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pago adelantado
     C*MOVER ZVRPEX ZVALHI
     C                   Z-ADD     ZVALHI        ZVRPEX
     C* Cuotas del pago adelantado
     C*MOVER ZCUPEX ZCUOHI
     C                   Z-ADD     ZCUOHI        ZCUPEX
     C* Actuliza GESAR8 Tx 04-43
     C*EJECUTAR M79000
     C                   EXSR      M79000
     C* Indicador no identificados
     C*PASAR ZINDNI '1'
     C                   MOVEL     '1'           ZINDNI
     C*FIN
     C                   END
     C* Pago adelantado para rezagos
     C*SINO
     C                   ELSE
     C* Valor conciliado p.a
     C*MOVER ZVALHI ZVRDEP
     C                   Z-ADD     ZVRDEP        ZVALHI
     C* Cuotas conciliadas p.a
     C*MOVER ZCUOHI ZCUDEP
     C                   Z-ADD     ZCUDEP        ZCUOHI
     C* Cód. transacción
     C*PASAR ZCODTX '05'
     C                   MOVEL     '05'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '32'
     C                   MOVEL     '32'          ZCONCE
     C* Actualizar HISAR4
     C*EJECUTAR M00055
     C                   EXSR      M00055
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pago adelantado
     C*MOVER ZVRPEX ZVALHI
     C                   Z-ADD     ZVALHI        ZVRPEX
     C* Cuotas del pago adelantado
     C*MOVER ZCUPEX ZCUOHI
     C                   Z-ADD     ZCUOHI        ZCUPEX
     C* Total valor depòsitos
     C*SUMAR ZVRPEX ZTVDEP
     C                   ADD       ZVRPEX        ZTVDEP
     C* Total cuotas depòsitos
     C*SUMAR ZCUPEX ZTCDEP
     C                   ADD       ZCUPEX        ZTCDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Saldo a cargo
     C*SI ZSALCA |= *CERO
     C     ZSALCA        IFNE      *ZERO
     C* Procesar saldo a cargo
     C*EJECUTAR M12100
     C                   EXSR      M12100
     C*SINO
     C                   ELSE
     C* Procesar planilla con p.a.
     C*EJECUTAR M13002
     C                   EXSR      M13002
     C*FIN
     C                   END
     C*SUMAR 1 K
     C                   ADD       1             K
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesar planilla con pago adelantado                       ==
     C*==                                                              ==
     C*==================================================================
     C     M13002        BEGSR
     C* Fecha de depósito
     C*MOVER AFECDE[K] ZFECDE
     C                   MOVE      ZFECDE        $G(K)
     C* Pagar voluntaria afiliado
     C*EJECUTAR M12210
     C                   EXSR      M12210
     C* Pagar FGPM
     C*EJECUTAR M12211
     C                   EXSR      M12211
     C* Pagar fondo de solidaridad
     C*EJECUTAR M12215
     C                   EXSR      M12215
     C* Pagar int. fondo de solidaridad
     C*EJECUTAR M12220
     C                   EXSR      M12220
     C* Pagar intereses
     C*EJECUTAR M12225
     C                   EXSR      M12225
     C* Pagar rendimientos
     C*EJECUTAR M12230
     C                   EXSR      M12230
     C* Pagar alto riesgo
     C*EJECUTAR M12235
     C                   EXSR      M12235
     C* Pagar obligatoria
     C*EJECUTAR M12240
     C                   EXSR      M12240
     C* Pagar voluntaria empleador
     C*EJECUTAR M12245
     C                   EXSR      M12245
     C                   ENDSR
     C*==================================================================
     C*==  Generar registro conciliación pago adelantado               ==
     C*==                                                              ==
     C*==================================================================
     C     M13100        BEGSR
     C* Lote planilla
     C*MOVER CONNU4 PLANU3
     C                   MOVE      PLANU3        CONNU4
     C* Número de planilla interno
     C*MOVER CONNU5 PLANUM
     C                   Z-ADD     PLANUM        CONNU5
     C* Número lote depósito
     C*MOVER CONNU2 *CERO
     C                   MOVE      *ZERO         CONNU2
     C* Número de depósito
     C*MOVER CONNU3 *CERO
     C                   MOVE      *ZERO         CONNU3
     C* Consecutivo de depósito
     C*MOVER CONCO4 *CERO
     C                   MOVE      *ZERO         CONCO4
     C* Nro. planilla pago en exceso
     C*MOVER CONPLA PAGNUM
     C                   Z-ADD     PAGNUM        CONPLA
     C*R CONAR2 (CONNU4 CONNU5 CONNU2 CONNU3 CONCO4 CONPLA)
     C     LL$062        KLIST
     C                   KFLD                    CONNU4
     C                   KFLD                    CONNU5
     C                   KFLD                    CONNU2
     C                   KFLD                    CONNU3
     C                   KFLD                    CONCO4
     C                   KFLD                    CONPLA
     C     LL$062        CHAIN     CONAR2                             40
     C     *IN40         IFEQ      '1'
     C     *NOKEY        CLEAR                   CONRE2
     C                   END
     C*SI NER(CONAR2)
     C     *IN40         IFEQ      '1'
     C* Tipo de conciliación
     C*PASAR CONTI3 '4'
     C                   MOVEL     '4'           CONTI3
     C* Fecha de conciliación
     C*PASAR CONFE2 HISFEC
     C                   MOVEL     HISFEC        CONFE2
     C* Fecha de depósito
     C*PASAR CONFE7 HISFEC
     C                   MOVEL     HISFEC        CONFE7
     C* Cuotas conciliadas
     C*MOVER CONCUO ZCUPA
     C                   Z-ADD     ZCUPA         CONCUO
     C* Valor conciliado
     C*MOVER CONVA1 ZVRHIS
     C                   Z-ADD     ZVRHIS        CONVA1
     C* Valor a fecha conciliación
     C*MOVER CONVLR ZVRPA
     C                   Z-ADD     ZVRPA         CONVLR
     C*AGREGAR CONAR2
     C                   WRITE     CONRE2                               94
     C                   MOVE      *IN94         I$DUP
     C*SINO
     C                   ELSE
     C* Cuotas conciliadas
     C*SUMAR ZCUPA  CONCUO
     C                   ADD       ZCUPA         CONCUO
     C* Valor conciliado
     C*SUMAR ZVRHIS CONVA1
     C                   ADD       ZVRHIS        CONVA1
     C* Valor a fecha conciliación
     C*SUMAR ZVRPA  CONVLR
     C                   ADD       ZVRPA         CONVLR
     C*GRABAR CONAR2
     C     *IN40         IFEQ      '0'
     C                   UPDATE    CONRE2                               94
     C                   ELSE
     C                   WRITE     CONRE2                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C* Genera registro P.A. por fecha fondo
     C*EJECUTAR M13105
     C                   EXSR      M13105
     C                   ENDSR
     C*==================================================================
     C*==  Genera registro P.A. por fecha fondo                        ==
     C*==                                                              ==
     C*==================================================================
     C     M13105        BEGSR
     C* Limpia pagina y secuencia para PAGA04
     C*LIMPIAR ZT@011 ZT@012
     C                   CLEAR                   ZT@011
     C                   CLEAR                   ZT@012
     C* Carga N. planilla para PAGA04
     C*MOVER ZT@010 CONNU5
     C                   Z-ADD     CONNU5        ZT@010
     C* No es acreditación de rezagos
     C*SI ZT@002 <> '3'
     C     ZT@002        IFNE      '3'
     C* Carga transacción para PAGA04
     C*ASIGNAR ZT@013 '04'
     C                   MOVEL     '04'          ZT@013
     C* Carga concepto para PAGA04
     C*ASIGNAR ZT@014 '43'
     C                   MOVEL     '43'          ZT@014
     C* Pago adelantado para rezagos
     C*SINO
     C                   ELSE
     C* Carga transacción para PAGA04
     C*ASIGNAR ZT@013 '05'
     C                   MOVEL     '05'          ZT@013
     C* Carga concepto para PAGA04
     C*ASIGNAR ZT@014 '32'
     C                   MOVEL     '32'          ZT@014
     C*FIN
     C                   END
     C* Carga fecha fondo para PAGA04
     C*ASIGNAR ZT@015 HISFE3
     C                   MOVEL     HISFE3        ZT@015
     C* Carga valor para PAGA04
     C*MOVER ZT@016 ZVRPA
     C                   Z-ADD     ZVRPA         ZT@016
     C* Carga cuotas para PAGA04
     C*MOVER ZT@017 ZCUPA
     C                   Z-ADD     ZCUPA         ZT@017
     C* Carga planilla P.A. para PAGA04
     C*MOVER ZT@018 CONPLA
     C                   Z-ADD     CONPLA        ZT@018
     C*LLAMAR TRPLAN90 (ZFONDO ZT@010 ZT@011 ZT@012 ZT@013 ZT@014 ZT@015
     C                   CALL      'TRPLAN90'
     C                   PARM                    ZFONDO
     C                   PARM                    ZT@010
     C                   PARM                    ZT@011
     C                   PARM                    ZT@012
     C                   PARM                    ZT@013
     C                   PARM                    ZT@014
     C                   PARM                    ZT@015
     C                   PARM                    ZT@016
     C                   PARM                    ZT@017
     C                   PARM                    ZT@018
     C                   ENDSR
     C*==================================================================
     C*==  Procesar detalles                                           ==
     C*==                                                              ==
     C*==================================================================
     C     M14000        BEGSR
     C* Se procesan todos los detalles de planilla
     C* Limpiar variables
     C*EJECUTAR M14010
     C                   EXSR      M14010
     C*
     C* Detalle de planillas
     C*INICIAR DETARC (PLANU3 PLANUM)
     C     LL$063        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$063        SETLL     DETARC                             49
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$064        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$064        READE     DETARC                                 49
     C* Ejecuta mientras no cambie de lote, planilla ni halle error
     C*MIENTRAS NFA(DETARC) Y DETNUM = PLANU3 Y DETNU3 = PLANUM Y ZSALIR
     C     *IN49         DOWEQ     '0'
     C     DETNUM        ANDEQ     PLANU3
     C     DETNU3        ANDEQ     PLANUM
     C     ZSALIR        ANDNE     '1'
     C*LIMPIAR ZOVCO1 ZOVTIP ZOVPER ZINDCE ZDILIC ZDITRA
     C                   CLEAR                   ZOVCO1
     C                   CLEAR                   ZOVTIP
     C                   CLEAR                   ZOVPER
     C                   CLEAR                   ZINDCE
     C                   CLEAR                   ZDILIC
     C                   CLEAR                   ZDITRA
     C*LIMPIAR ZES13P ZCODEE ZTARD ZTARPG ZIGUAR ZTARAC ZAFSP
     C                   CLEAR                   ZES13P
     C                   CLEAR                   ZCODEE
     C                   CLEAR                   ZTARD
     C                   CLEAR                   ZTARPG
     C                   CLEAR                   ZIGUAR
     C                   CLEAR                   ZTARAC
     C                   CLEAR                   ZAFSP
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC WHERE DETNU3 = :DETNU3 AND
     C+  DETPAG = :DETPAG AND DETSEC = :DETSEC
     C/END-EXEC
     C*PASAR ZREZ3X ' '
     C                   MOVEL     ' '           ZREZ3X
     C*F QGRAALD (ZREZ3X 746 1)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZREZ3X        PARM      ZREZ3X        F$2Z1           250
     C                   PARM      746           F$2Z2             4 0
     C                   PARM      1             F$2Z3             4 0
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C* proceso para afil decreto 2616
     C*LLAMAR TRDETA64(PLANUM DETTI2 DETNU2 ZI2616)
     C                   CALL      'TRDETA64'
     C                   PARM                    PLANUM
     C                   PARM                    DETTI2
     C                   PARM                    DETNU2
     C                   PARM                    ZI2616
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C* Detalle con rezago
     C*SI DETIN4 = '07' O DETIN4 = '08'
     C     DETIN4        IFEQ      '07'
     C     DETIN4        OREQ      '08'
     C*LIMPIAR ZFEC01 ZTIREZ ZINDIF ZESRAE
     C                   CLEAR                   ZFEC01
     C                   CLEAR                   ZTIREZ
     C                   CLEAR                   ZINDIF
     C                   CLEAR                   ZESRAE
     C* Llamada desde acreditación
     C*PASAR ZESRAE 'A'
     C                   MOVEL     'A'           ZESRAE
     C* Validar estado afiliado-empleador
     C*  Plan. inde
     C*SI PLATIP = '02' O PLATIP = '03' O PLATIP = '07'
     C     PLATIP        IFEQ      '02'
     C     PLATIP        OREQ      '03'
     C     PLATIP        OREQ      '07'
     C* Còdigo empleador
     C*MOVER ZCOEMP *CERO
     C                   MOVE      *ZERO         ZCOEMP
     C*SINO
     C                   ELSE
     C* Còdigo empleador
     C*MOVER ZCOEMP PLACOD
     C                   Z-ADD     PLACOD        ZCOEMP
     C*FIN
     C                   END
     C* Tipo de planilla
     C*PASAR ZTIPOP PLATIP
     C                   MOVEL     PLATIP        ZTIPOP
     C* Terceros
     C*SI PLATIP='07'
     C     PLATIP        IFEQ      '07'
     C* Voluntarios
     C*SI PLAT03='08' O PLAT03='13' O PLAT03='14'
     C     PLAT03        IFEQ      '08'
     C     PLAT03        OREQ      '13'
     C     PLAT03        OREQ      '14'
     C* Tipo de planilla vol.
     C*PASAR ZTIPOP '03'
     C                   MOVEL     '03'          ZTIPOP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LLAMAR TRREZA5C (DETN04 ZCOEMP ZFEC01 PLAPER DETNOV ZTIREZ ZINDIF
     C                   CALL      'TRREZA5C'
     C                   PARM                    DETN04
     C                   PARM                    ZCOEMP
     C                   PARM                    ZFEC01
     C                   PARM                    PLAPER
     C                   PARM                    DETNOV
     C                   PARM                    ZTIREZ
     C                   PARM                    ZINDIF
     C                   PARM                    ZESRAE
     C                   PARM                    ZTIPOP
     C* No hay rezago y Contratista
     C*SI ZTIREZ = *BLANK Y PLATIP='07' Y PLAT03='07'
     C     ZTIREZ        IFEQ      *BLANK
     C     PLATIP        ANDEQ     '07'
     C     PLAT03        ANDEQ     '07'
     C* Busca contrato
     C*LLAMAR TRCNAF50 (DETN04 PLAPER ZINEER)
     C                   CALL      'TRCNAF50'
     C                   PARM                    DETN04
     C                   PARM                    PLAPER
     C                   PARM                    ZINEER
     C* No hay contratos vigentes
     C*SI ZINEER = '0'
     C     ZINEER        IFEQ      '0'
     C* Continua en rezago
     C*SINO
     C                   ELSE
     C* Código de rezago blanco
     C*PASAR DETIN4 ZTIREZ
     C                   MOVEL     ZTIREZ        DETIN4
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Código de rezago
     C*PASAR DETIN4 ZTIREZ
     C                   MOVEL     ZTIREZ        DETIN4
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Leer afiliado y cuenta
     C*EJECUTAR M14020
     C                   EXSR      M14020
     C*SI DETTA1<>3 Y PLAT03='09' O DETTA1<>3 Y PLAT03='10'
     C     DETTA1        IFNE      3
     C     PLAT03        ANDEQ     '09'
     C     DETTA1        ORNE      3
     C     PLAT03        ANDEQ     '10'
     C*PASAR ZIGUAR 'S'
     C                   MOVEL     'S'           ZIGUAR
     C*LLAMAR RPHDEC558X(DETNU3 DETPAG DETSEC PLAPER DETSAL DETCOT ZES13
     C                   MOVEL     'RPHDEC55'    H$L10            10
     C                   MOVE      '8X'          H$L10
     C                   CALL      H$L10
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    PLAPER
     C                   PARM                    DETSAL
     C                   PARM                    DETCOT
     C                   PARM                    ZES13P
     C                   PARM                    ZCODEE
     C                   PARM                    ZNJ
     C                   PARM                    ZTARD
     C                   PARM                    ZTARPG
     C                   PARM                    ZIGUAR
     C                   PARM                    ZTARAC
     C                   PARM                    ZAFSP
     C*FIN
     C                   END
     C*PASAR ZDETAL '1'
     C                   MOVEL     '1'           ZDETAL
     C* Calcular valor cotización
     C*EJECUTAR M11100
     C                   EXSR      M11100
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Si pago adel. y plan. volun.
     C*SI ZINDPA = '1' Y PLATIP = '03' O ZINDPA = '1' Y PLATIP = '02' Y
     C     ZINDPA        IFEQ      '1'
     C     PLATIP        ANDEQ     '03'
     C     ZINDPA        OREQ      '1'
     C     PLATIP        ANDEQ     '02'
     C     PLAPER        ANDLT     ZPEREF
     C*SINO
     C                   ELSE
     C* Calcular fecha límite pago
     C*EJECUTAR M14015
     C                   EXSR      M14015
     C* Rendimientos
     C*MOVER ZRENDI DETV14
     C                   Z-ADD     DETV14        ZRENDI
     C*CALCULAR ZTOCOT = ZCOTAR + ZCOTOB + ZCOTVA + ZCOTVE
     C     ZCOTAR        ADD       ZCOTOB        V$CA1           030 9
     C     V$CA1         ADD       ZCOTVA        V$CA1
     C     V$CA1         ADD       ZCOTVE        ZTOCOT
     C*SI ZTOCOT = 0 Y ZRENDI = 0 Y ZNOSLN = 'X' Y DETIN4 = *BLANCO
     C     ZTOCOT        IFEQ      0
     C     ZRENDI        ANDEQ     0
     C     ZNOSLN        ANDEQ     'X'
     C     DETIN4        ANDEQ     *BLANK
     C* Valores subsistencia
     C*LIMPIAR ZVSFSP ZVFGPM
     C                   CLEAR                   ZVSFSP
     C                   CLEAR                   ZVFGPM
     C* Genera movimiento
     C*EJECUTAR M14030
     C                   EXSR      M14030
     C* Acumular valores por concepto
     C*EJECUTAR M14380
     C                   EXSR      M14380
     C* Período de la planilla
     C*PASAR ZPERCO PLAPER
     C                   MOVEL     PLAPER        ZPERCO
     C* Tipo de planilla
     C*PASAR ZTIPLA PLATIP
     C                   MOVEL     PLATIP        ZTIPLA
     C* Actualiza relación afil-empl.
     C*EJECUTAR M14040
     C                   EXSR      M14040
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Anula deudas presuntas
     C*EJECUTAR M14050
     C                   EXSR      M14050
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Procesa depósitos por detalle
     C*EJECUTAR M14100
     C                   EXSR      M14100
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Genera rezago o proc.Movto
     C*EJECUTAR M14005
     C                   EXSR      M14005
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$065        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$065        READE     DETARC                                 49
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Verifica indicador rezago                                   ==
     C*==                                                              ==
     C*==================================================================
     C     M14005        BEGSR
     C* Indicador de rezago
     C*SI DETIN4 |= *BLANCO
     C     DETIN4        IFNE      *BLANK
     C* Genera rezago
     C*EJECUTAR M14060
     C                   EXSR      M14060
     C*SINO
     C                   ELSE
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Movimiento de acreditación no actualizó la
     C                   CLEAR                   ZERROR
     C     $HIL(048)     CAT       ZIDENA:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* Período de la planilla
     C*PASAR ZPERCO PLAPER
     C                   MOVEL     PLAPER        ZPERCO
     C* Tipo de planilla
     C*PASAR ZTIPLA PLATIP
     C                   MOVEL     PLATIP        ZTIPLA
     C* Actualiza relación afil-empl.
     C*EJECUTAR M14040
     C                   EXSR      M14040
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Anula deudas presuntas
     C*EJECUTAR M14050
     C                   EXSR      M14050
     C* Para situados actualiza días acreditados únicamente
     C* para la planilla del 75%
     C*SI PLATIP = '04' Y PLAT03 = '04' O PLAT03 = '11' O PLATIP |= '04'
     C     PLATIP        IFEQ      '04'
     C     PLAT03        ANDEQ     '04'
     C     PLAT03        OREQ      '11'
     C     PLATIP        ORNE      '04'
     C* Período de la planilla
     C*PASAR ZPERCO PLAPER
     C                   MOVEL     PLAPER        ZPERCO
     C* Actualiza días cotizados
     C*EJECUTAR M14075
     C                   EXSR      M14075
     C*FIN
     C                   END
     C* Verifica si hay deuda
     C*EJECUTAR M14080
     C                   EXSR      M14080
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Acumula valores cotizaciones
     C*EJECUTAR M14085
     C                   EXSR      M14085
     C* Perìodo ant.instalaciòn cesan
     C*SI PLAPER < ZPEVIG
     C     PLAPER        IFLT      ZPEVIG
     C* Reversa comisión cesantes
     C*EJECUTAR M14090
     C                   EXSR      M14090
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Manejo de vector de novedades                               ==
     C*==                                                              ==
     C*==================================================================
     C     M14009        BEGSR
     C* Información del detalle
     C*LIMPIAR ZVECNO ZDTVA8
     C                   CLEAR                   ZVECNO
     C                   CLEAR                   ZDTVA8
     C*MOVER ZVECNO DETVEC
     C                   MOVE      DETVEC        ZVECNO
     C* Indicador de novedad
     C*PASAR ZETNOV 'X'
     C                   MOVEL     'X'           ZETNOV
     C* Valida novedad simulada
     C*EJECUTAR M14900
     C                   EXSR      M14900
     C*SI ZNOING=' ' Y ZNORET=' ' Y ZNOSLN=' ' Y ZNOVTE=' '
     C     ZNOING        IFEQ      ' '
     C     ZNORET        ANDEQ     ' '
     C     ZNOSLN        ANDEQ     ' '
     C     ZNOVTE        ANDEQ     ' '
     C* Indicador de novedad
     C*PASAR ZETNOV ' '
     C                   MOVEL     ' '           ZETNOV
     C*FIN
     C                   END
     C* Valor de la retención DETARC
     C*PASAR ZDTVA8 DETVA8
     C                   MOVEL     DETVA8        ZDTVA8
     C* ult planilla leida
     C*MOVER ZMVPLA DETNU3
     C                   Z-ADD     DETNU3        ZMVPLA
     C* Ult pag leida
     C*MOVER ZMVPAG DETPAG
     C                   Z-ADD     DETPAG        ZMVPAG
     C* Ult sec leida
     C*MOVER ZMVSEC DETSEC
     C                   Z-ADD     DETSEC        ZMVSEC
     C                   ENDSR
     C*==================================================================
     C*==  Limpiar variables                                           ==
     C*==                                                              ==
     C*==================================================================
     C     M14010        BEGSR
     C*LIMPIAR ZVAFS ZVAIFS ZVAINT ZVACVA ZVAREN ZVAAR ZVACO ZVACVE ZTOC
     C                   CLEAR                   ZVAFS
     C                   CLEAR                   ZVAIFS
     C                   CLEAR                   ZVAINT
     C                   CLEAR                   ZVACVA
     C                   CLEAR                   ZVAREN
     C                   CLEAR                   ZVAAR
     C                   CLEAR                   ZVACO
     C                   CLEAR                   ZVACVE
     C                   CLEAR                   ZTOCOT
     C                   CLEAR                   ZPERCO
     C*LIMPIAR ZVASFS ZVAFGP ZFINOK ZSALDI ZVSICO ZVSIVA ZVSIVE ZVSIAR Z
     C                   CLEAR                   ZVASFS
     C                   CLEAR                   ZVAFGP
     C                   CLEAR                   ZFINOK
     C                   CLEAR                   ZSALDI
     C                   CLEAR                   ZVSICO
     C                   CLEAR                   ZVSIVA
     C                   CLEAR                   ZVSIVE
     C                   CLEAR                   ZVSIAR
     C                   CLEAR                   ZVSIFS
     C*LIMPIAR ZVSIFG ZVSISF ZTOTIN ZTOTI1 ZTOTI2 ZTOTI3
     C                   CLEAR                   ZVSIFG
     C                   CLEAR                   ZVSISF
     C                   CLEAR                   ZTOTIN
     C                   CLEAR                   ZTOTI1
     C                   CLEAR                   ZTOTI2
     C                   CLEAR                   ZTOTI3
     C*LIMPIAR ZVSIC1 ZVSIA1 ZVSIE1 ZVSIR1 ZVSIF1 ZVSIG1 ZVSIS1
     C                   CLEAR                   ZVSIC1
     C                   CLEAR                   ZVSIA1
     C                   CLEAR                   ZVSIE1
     C                   CLEAR                   ZVSIR1
     C                   CLEAR                   ZVSIF1
     C                   CLEAR                   ZVSIG1
     C                   CLEAR                   ZVSIS1
     C* Arreglo vlr.distrib. f.s.
     C*LIMPIAR VDIFS[]
     C                   CLEAR                   $T
     C* Arreglo vlr.distrib. i.f.s.
     C*LIMPIAR VDIIFS[]
     C                   CLEAR                   $U
     C* Arreglo vlr.distrib. inter.
     C*LIMPIAR VDIINT[]
     C                   CLEAR                   $V
     C* Arreglo vlr.distrib. c.v.a.
     C*LIMPIAR VDICVA[]
     C                   CLEAR                   $R
     C* Arreglo vlr.distrib. rendim.
     C*LIMPIAR VDIREN[]
     C                   CLEAR                   $W
     C* Arreglo vlr.distrib. a.r.
     C*LIMPIAR VDIAR[]
     C                   CLEAR                   $P
     C* Arreglo vlr.distrib. c.o.
     C*LIMPIAR VDICO[]
     C                   CLEAR                   $Q
     C* Arreglo vlr.distrib. c.v.e
     C*LIMPIAR VDICVE[]
     C                   CLEAR                   $S
     C* Arreglo cuotas distrib. f.s.
     C*LIMPIAR CDIFS[]
     C                   CLEAR                   $L
     C* Arreglo cuotas distrib.i.f.s.
     C*LIMPIAR CDIIFS[]
     C                   CLEAR                   $M
     C* Arreglo cuotas distrib.inter.
     C*LIMPIAR CDIINT[]
     C                   CLEAR                   $N
     C* Arreglo cuotas distrib.c.v.a.
     C*LIMPIAR CDICVA[]
     C                   CLEAR                   $J
     C* Arreglo cuotas distrib.rendim
     C*LIMPIAR CDIREN[]
     C                   CLEAR                   $O
     C* Arreglo cuotas distrib. a.r.
     C*LIMPIAR CDIAR[]
     C                   CLEAR                   $H
     C* Arreglo cuotas distrib. c.o.
     C*LIMPIAR CDICO[]
     C                   CLEAR                   $I
     C* Arreglo cuotas distrib. c.v.e
     C*LIMPIAR CDICVE[]
     C                   CLEAR                   $K
     C*
     C                   ENDSR
     C*==================================================================
     C*==  Calcular fecha límite de pago por detalle planillas 07      ==
     C*==                                                              ==
     C*==================================================================
     C     M14015        BEGSR
     C* Es planilla de tercero
     C*SI PLATIP = '07'
     C     PLATIP        IFEQ      '07'
     C* Calcular fecha inicio deuda
     C* Último dígito del nit
     C*MOVER ZULNIT DETNU2
     C                   Z-ADD     DETNU2        ZULNIT
     C*LIMPIAR ZERROR ZFECHA
     C                   CLEAR                   ZERROR
     C                   CLEAR                   ZFECHA
     C*LLAMAR CALFECPA(ZPER ZULNIT ZCLASE ZFORDE PLATIP PLAT03 ZFECHA ZI
     C                   CALL      'CALFECPA'
     C                   PARM                    ZPER
     C                   PARM                    ZULNIT
     C                   PARM                    ZCLASE
     C                   PARM                    ZFORDE
     C                   PARM                    PLATIP
     C                   PARM                    PLAT03
     C                   PARM                    ZFECHA
     C                   PARM                    ZINDEU
     C                   PARM                    ZERROR
     C                   PARM                    ZCODER
     C* Fecha inicio deuda = fecha límite + 1 dia
     C* Fecha inicio de la deuda
     C*PASAR ZFEIND ZFECHA
     C                   MOVEL     ZFECHA        ZFEIND
     C*MOVER ZDIAS1 1
     C                   Z-ADD     1             ZDIAS1
     C* FECHA INICIO DEUDA
     C*FUNCION QSUMDI1 (ZFEIND ZDIAS1 ZFEIND)
     C                   CALL      'RPSUMDI1'                                   QSUMDI1
     C     ZFEIND        PARM      ZFEIND        F$4L1             8
     C     ZDIAS1        PARM      ZDIAS1        F$4L2             5 0
     C     ZFEIND        PARM      ZFEIND        F$4L3             8
     C*
     C*SI PLAT03<>'08' Y PLAT03<>'13' Y PLAT03<>'14' Y ZPLART=*BLANCO O
     C     PLAT03        IFNE      '08'
     C     PLAT03        ANDNE     '13'
     C     PLAT03        ANDNE     '14'
     C     ZPLART        ANDEQ     *BLANK
     C     ZTPGRT        ORNE      '08'
     C     ZTPGRT        ANDNE     '13'
     C     ZTPGRT        ANDNE     '14'
     C     ZPLART        ANDNE     *BLANK
     C*LIMPIAR ZFECHA
     C                   CLEAR                   ZFECHA
     C* Calcular fecha liq. int.
     C*PASAR ZIND '3'
     C                   MOVEL     '3'           ZIND
     C* Calcular fecha ult. liq int.
     C*EJECUTAR M12207
     C                   EXSR      M12207
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Leer afiliado y cuenta                                      ==
     C*==                                                              ==
     C*==================================================================
     C     M14020        BEGSR
     C*SI DETIN4 = *BLANCO Y ZT@002 ]= '3' O ZT@002 = '3'
     C     DETIN4        IFEQ      *BLANK
     C     ZT@002        ANDNE     '3'
     C     ZT@002        OREQ      '3'
     C* Identificación afiliado - alfa
     C*MOVER ZIDENA DETNU2
     C                   MOVE      DETNU2        ZIDENA
     C*INICIARI AFIARC (DETN04)
     C     DETN04        SETLL     AFIARC                                 35
     C     *IN35         IFEQ      '1'
     C                   MOVE      '0'           *IN35
     C                   ELSE
     C                   MOVE      '1'           *IN35
     C                   END
     C*SI NER(AFIARC)
     C     *IN35         IFEQ      '1'
     C* Número de identificación
     C*MOVER ZNUMAL DETNU2
     C                   MOVE      DETNU2        ZNUMAL
     C*OBTENER (1) ZERROR = 'No existe afiliado' || ZNUMAL
     C                   CLEAR                   ZERROR
     C     $HIL(049)     CAT       ZNUMAL:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*SINO
     C                   ELSE
     C*RECUPERARD (N) AFIARC (DETN04)
     C     DETN04        CHAIN     AFIARC                             3594
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SI ZINDSO |=  1
     C     ZINDSO        IFNE      1
     C* Número de identificación del afiliado
     C*MOVER ZIDENT AFIC01
     C                   Z-ADD     AFIC01        ZIDENT
     C* Ind. de llamado
     C*ASIGNAR ZINDOP '1'
     C                   MOVEL     '1'           ZINDOP
     C* Ind. de grabación interno
     C*LIMPIAR ZINDGR
     C                   CLEAR                   ZINDGR
     C* Reversa selección de modalidad
     C*LLAMAR TRSOLP55 (ZIDENT ZINDOP ZINDGR)
     C                   CALL      'TRSOLP55'
     C                   PARM                    ZIDENT
     C                   PARM                    ZINDOP
     C                   PARM                    ZINDGR
     C*FIN
     C                   END
     C* Si es RES cierre relaciones
     C*SI AFIES2 = 'RES' Y ZNOING = 'X'
     C     AFIES2        IFEQ      'RES'
     C     ZNOING        ANDEQ     'X'
     C* Novedad Retiro
     C*PASAR ZNORET 'X'
     C                   MOVEL     'X'           ZNORET
     C*FIN
     C                   END
     C*SI ZT@001<>*BLANCO Y ZT@003<>*BLANCO Y ZT@004=*BLANCO Y ZT@002='3
     C     ZT@001        IFNE      *BLANK
     C     ZT@003        ANDNE     *BLANK
     C     ZT@004        ANDEQ     *BLANK
     C     ZT@002        ANDEQ     '3'
     C*SINO
     C                   ELSE
     C* Código interno afil
     C*MOVER CUENUM AFINUM
     C                   Z-ADD     AFINUM        CUENUM
     C* Código fondo moderado
     C*PASAR CUEC17 ZFONDO
     C                   MOVEL     ZFONDO        CUEC17
     C*RECUPERARD CUEARC (CUENUM CUEC17)
     C     LL$066        KLIST
     C                   KFLD                    CUENUM
     C                   KFLD                    CUEC17
     C     LL$066        CHAIN     CUEARC                             4594
     C                   MOVE      *IN94         I$RND
     C     *IN45         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   CUEREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SINO
     C                   ELSE
     C*MOVER ZPLAER PLANUM
     C                   MOVE      PLANUM        ZPLAER
     C*MOVER ZAFIIN CUENUM
     C                   CLEAR                   ZAFIIN
     C                   MOVE      CUENUM        ZAFIIN
     C*OBTENER (1) ZERROR = 'CUEARC no disponible - M14020' || ZPLAER ||
     C                   CLEAR                   H$1
     C     $HIL(050)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*MOVER ZPLAER PLANUM
     C                   MOVE      PLANUM        ZPLAER
     C*MOVER ZAFIIN DETN04
     C                   CLEAR                   ZAFIIN
     C                   MOVE      DETN04        ZAFIIN
     C*OBTENER (1) ZERROR = 'AFIARC no disponible - M14020' || ZPLAER ||
     C                   CLEAR                   H$1
     C     $HIL(051)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LIMPIAR ZCOTOB ZCOTAR ZCOTVA ZCOTVE ZRENDI ZCOTFS COMVA8 ZCOTSF Z
     C                   CLEAR                   ZCOTOB
     C                   CLEAR                   ZCOTAR
     C                   CLEAR                   ZCOTVA
     C                   CLEAR                   ZCOTVE
     C                   CLEAR                   ZRENDI
     C                   CLEAR                   ZCOTFS
     C                   CLEAR                   COMVA8
     C                   CLEAR                   ZCOTSF
     C                   CLEAR                   ZCOTFG
     C                   ENDSR
     C*==================================================================
     C*==  Realiza validacion de tipo de cotizante                     ==
     C*==                                                              ==
     C*==================================================================
     C     M14027        BEGSR
     C*LIMPIAR ZTICOP ZINPEA
     C                   CLEAR                   ZTICOP
     C                   CLEAR                   ZINPEA
     C* Proteccion
     C*SI ZENTI1=4
     C     ZENTI1        IFEQ      4
     C*SQL
     C/EXEC SQL
     C+  SELECT COALESCE(DET457, 0) INTO :ZTICOP
     C+  FROM DETA67 WHERE
     C+  DET454=:PLANUM AND DET457 IN(43, 52, 57, 59)
     C+  FETCH FIRST ROW ONLY
     C/END-EXEC
     C* Colfondos
     C*SINO
     C                   ELSE
     C*SQL
     C/EXEC SQL
     C+  SELECT COALESCE(DETT09, 0) INTO :ZTICOP
     C+  FROM DETA58 WHERE
     C+  DETN16=:PLANUM AND DETT09 IN(43, 52, 57, 59)
     C+  FETCH FIRST ROW ONLY
     C/END-EXEC
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Genera movimiento de licencia                               ==
     C*==                                                              ==
     C*==================================================================
     C     M14030        BEGSR
     C* Posición en el arreglo
     C*MOVER L 1
     C                   Z-ADD     1             L
     C* Número depósitos procesados
     C*MIENTRAS L < K
     C     L             DOWLT     K
     C*INICIARUI MOVARC06 (ZFONDO PLANU1 DETPAG DETSEC)
     C     LL$067        KLIST
     C                   KFLD                    ZFONDO
     C                   KFLD                    PLANU1
     C                   KFLD                    DETPAG
     C                   KFLD                    DETSEC
     C     LL$067        SETLL     MOVARC06                               68
     C     *IN68         IFEQ      '1'
     C     LL$067        SETGT     MOVARC06                           68
     C                   MOVE      '0'           *IN68
     C                   ELSE
     C                   MOVE      '1'           *IN68
     C                   END
     C* Calcula último consecutivo
     C*EJECUTAR M14035
     C                   EXSR      M14035
     C* Situado hospital
     C*SI PLATIP='04' Y PLAT03='05'
     C     PLATIP        IFEQ      '04'
     C     PLAT03        ANDEQ     '05'
     C* Transacción
     C*MOVER MOVCO1 '02'
     C                   MOVE      '02'          MOVCO1
     C* Ind. vigencia Siafp
     C*PASAR MOVI11 '1'
     C                   MOVEL     '1'           MOVI11
     C* Acreditación por recaudo
     C*SI ZT@002 = '1'
     C     ZT@002        IFEQ      '1'
     C* Concepto
     C*PASAR MOVTIP '91'
     C                   MOVEL     '91'          MOVTIP
     C*SINO
     C                   ELSE
     C* Acreditación de rezagos
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C* Concepto
     C*PASAR MOVTIP '92'
     C                   MOVEL     '92'          MOVTIP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Salario calculado
     C*MOVER MOVSA2 DETVA7
     C                   Z-ADD     DETVA7        MOVSA2
     C* Salario informado
     C*MOVER MOVSAL DETSAL
     C                   Z-ADD     DETSAL        MOVSAL
     C* Otros
     C*SINO
     C                   ELSE
     C* Transacción
     C*MOVER MOVCO1 '02'
     C                   MOVE      '02'          MOVCO1
     C* Concepto
     C*MOVER MOVTIP '50'
     C                   MOVE      '50'          MOVTIP
     C*FIN
     C                   END
     C* Mover datos detalle de plan.
     C*EJECUTAR M14038
     C                   EXSR      M14038
     C*LIMPIAR ZVDFS ZVDIFS ZCUFS ZCUIFS ZVDSFS ZCUSFS ZVDISF ZCUISF
     C                   CLEAR                   ZVDFS
     C                   CLEAR                   ZVDIFS
     C                   CLEAR                   ZCUFS
     C                   CLEAR                   ZCUIFS
     C                   CLEAR                   ZVDSFS
     C                   CLEAR                   ZCUSFS
     C                   CLEAR                   ZVDISF
     C                   CLEAR                   ZCUISF
     C* No es proceso terceros
     C*SI ZINDTE <> 'S' O PLATIP <> '07'
     C     ZINDTE        IFNE      'S'
     C     PLATIP        ORNE      '07'
     C* Distribuir F.S.
     C*EJECUTAR M14115
     C                   EXSR      M14115
     C*FIN
     C                   END
     C*SI ZPDSFS <> *CERO
     C     ZPDSFS        IFNE      *ZERO
     C* Valor movimiento F.S
     C*CALCULAR (R) ZOVCO8 =(ZVDFS*ZPDSFS)/100
     C     ZVDFS         MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVCO8
     C* Valor movimiento int.F.S
     C*CALCULAR (R) ZOVIN2 =(ZVDIFS*ZPDSFS)/100
     C     ZVDIFS        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVIN2
     C* Valor movimiento F.S.P.
     C*MOVER MOVCO8 ZOVCO8
     C                   Z-ADD     ZOVCO8        MOVCO8
     C* Valor movimiento int. F.S.P
     C*MOVER MOVIN2 ZOVIN2
     C                   Z-ADD     ZOVIN2        MOVIN2
     C* Cuotas movimiento F.S.P
     C*CALCULAR (R) MOVCU8 =(ZCUFS*ZPDSFS)/100
     C     ZCUFS         MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           MOVCU8
     C* Cuotas movimiento int F.S
     C*CALCULAR (R) MOVC16=(ZCUIFS*ZPDSFS)/100
     C     ZCUIFS        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           MOVC16
     C*SINO
     C                   ELSE
     C* Valor movimiento F.S
     C*CALCULAR MOVCO8 = ZVDFS
     C                   Z-ADD     ZVDFS         MOVCO8
     C* Valor movimiento int. F.S.P
     C*CALCULAR MOVIN2 = ZVDIFS
     C                   Z-ADD     ZVDIFS        MOVIN2
     C* Cuotas movimiento F.S.P
     C*CALCULAR MOVCU8 = ZCUFS
     C                   Z-ADD     ZCUFS         MOVCU8
     C* Cuotas movimiento int F.S.P
     C*CALCULAR MOVC16 = ZCUIFS
     C                   Z-ADD     ZCUIFS        MOVC16
     C*FIN
     C                   END
     C*SFSP
     C* Valor SFSP
     C*CALCULAR ZOVV13 = ZVDSFS+(ZVDFS-MOVCO8)
     C     ZVDFS         SUB       MOVCO8        V$CA1           030 9
     C     ZVDSFS        ADD       V$CA1         ZOVV13
     C* Valor mov. SFSP sin decimal
     C*MOVER MOVV13 ZOVV13
     C                   Z-ADD     ZOVV13        MOVV13
     C* Cuotas SFSP
     C*CALCULAR MOV058 = ZCUSFS+(ZCUFS-MOVCU8)
     C     ZCUFS         SUB       MOVCU8        V$CA1           030 9
     C     ZCUSFS        ADD       V$CA1         MOV058
     C* Intereses SFSP
     C*CALCULAR ZOVI06 = ZVDISF+(ZVDIFS-MOVIN2)
     C     ZVDIFS        SUB       MOVIN2        V$CA1           030 9
     C     ZVDISF        ADD       V$CA1         ZOVI06
     C* Valor int. SFSP sin decimal
     C*MOVER MOVI06 ZOVI06
     C                   Z-ADD     ZOVI06        MOVI06
     C* Int. cuotas SFSP
     C*CALCULAR MOV059 = ZCUISF+(ZCUIFS-MOVC16)
     C     ZCUIFS        SUB       MOVC16        V$CA1           030 9
     C     ZCUISF        ADD       V$CA1         MOV059
     C* Agregar registro a movarc
     C*EJECUTAR M00009
     C                   EXSR      M00009
     C* Imprime reporte detallado
     C*EJECUTAR DET@01
     C                   EXSR      DET@01
     C*SUMAR 1 L
     C                   ADD       1             L
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular último consecutivo                                 ==
     C*==                                                              ==
     C*==================================================================
     C     M14035        BEGSR
     C*SI ERE(MOVARC06)
     C     *IN68         IFEQ      '0'
     C*LEEANT MOVARC06
     C                   READP     MOVARC06                               68
     C*SUMAR 1 MOVCON
     C                   ADD       1             MOVCON
     C*SINO
     C                   ELSE
     C*MOVER MOVCON 1
     C                   Z-ADD     1             MOVCON
     C*FIN
     C                   END
     C*LIMPIAR MOVCO4 MOVPER MOVFEC MOVTI5 MOVNU2 MOVPAG MOVSEC MOVPLA M
     C                   CLEAR                   MOVCO4
     C                   CLEAR                   MOVPER
     C                   CLEAR                   MOVFEC
     C                   CLEAR                   MOVTI5
     C                   CLEAR                   MOVNU2
     C                   CLEAR                   MOVPAG
     C                   CLEAR                   MOVSEC
     C                   CLEAR                   MOVPLA
     C                   CLEAR                   MOVSAL
     C*LIMPIAR MOVNUM MOVSA2 MOVCOT MOVCUO MOVCU2 MOVCOM MOVVAL MOVCU7 M
     C                   CLEAR                   MOVNUM
     C                   CLEAR                   MOVSA2
     C                   CLEAR                   MOVCOT
     C                   CLEAR                   MOVCUO
     C                   CLEAR                   MOVCU2
     C                   CLEAR                   MOVCOM
     C                   CLEAR                   MOVVAL
     C                   CLEAR                   MOVCU7
     C                   CLEAR                   MOVC24
     C*LIMPIAR MOVC25 MOVCO5 MOVCU3 MOVCO7 MOVCU5 MOVCO6 MOVCU4 MOVC27 M
     C                   CLEAR                   MOVC25
     C                   CLEAR                   MOVCO5
     C                   CLEAR                   MOVCU3
     C                   CLEAR                   MOVCO7
     C                   CLEAR                   MOVCU5
     C                   CLEAR                   MOVCO6
     C                   CLEAR                   MOVCU4
     C                   CLEAR                   MOVC27
     C                   CLEAR                   MOVC28
     C*LIMPIAR MOVINT MOVCU6 MOVVA4 MOVC19 MOVCO8 MOVCU8 MOVIN2 MOVC16 M
     C                   CLEAR                   MOVINT
     C                   CLEAR                   MOVCU6
     C                   CLEAR                   MOVVA4
     C                   CLEAR                   MOVC19
     C                   CLEAR                   MOVCO8
     C                   CLEAR                   MOVCU8
     C                   CLEAR                   MOVIN2
     C                   CLEAR                   MOVC16
     C                   CLEAR                   MOVRET
     C*LIMPIAR MOVEST MOVFE7 MOVHOR MOVFE1 MOVFE5 MOVFE6 MOVDIA MOVTA1 M
     C                   CLEAR                   MOVEST
     C                   CLEAR                   MOVFE7
     C                   CLEAR                   MOVHOR
     C                   CLEAR                   MOVFE1
     C                   CLEAR                   MOVFE5
     C                   CLEAR                   MOVFE6
     C                   CLEAR                   MOVDIA
     C                   CLEAR                   MOVTA1
     C                   CLEAR                   MOVC18
     C*LIMPIAR MOVCOD MOVCO1 MOVTIP MOVCDI MOVSU1
     C                   CLEAR                   MOVCOD
     C                   CLEAR                   MOVCO1
     C                   CLEAR                   MOVTIP
     C                   CLEAR                   MOVCDI
     C                   CLEAR                   MOVSU1
     C*LIMPIAR MOVV12 MOV056 MOVI05 MOV057 MOVV13 MOV058 MOVI06 MOV059 M
     C                   CLEAR                   MOVV12
     C                   CLEAR                   MOV056
     C                   CLEAR                   MOVI05
     C                   CLEAR                   MOV057
     C                   CLEAR                   MOVV13
     C                   CLEAR                   MOV058
     C                   CLEAR                   MOVI06
     C                   CLEAR                   MOV059
     C                   CLEAR                   MOVHO8
     C*LIMPIAR MOVT11 MOVT10 MOVV14 MOVI11 MOVI26 MOVR15 ZTOPAG
     C                   CLEAR                   MOVT11
     C                   CLEAR                   MOVT10
     C                   CLEAR                   MOVV14
     C                   CLEAR                   MOVI11
     C                   CLEAR                   MOVI26
     C                   CLEAR                   MOVR15
     C                   CLEAR                   ZTOPAG
     C                   ENDSR
     C*==================================================================
     C*==  Mover datos detalle de planilla                             ==
     C*==                                                              ==
     C*==================================================================
     C     M14038        BEGSR
     C* Código interno
     C*MOVER MOVCO4 DETN04
     C                   Z-ADD     DETN04        MOVCO4
     C* Período cotización
     C*PASAR MOVPER PLAPER
     C                   MOVEL     PLAPER        MOVPER
     C* Fecha de depósito
     C*PASAR MOVFEC ZFECDE
     C                   MOVEL     ZFECDE        MOVFEC
     C* Tipo de planilla
     C*PASAR MOVTI5 PLATIP
     C                   MOVEL     PLATIP        MOVTI5
     C* Si está marcado en DETA68
     C*SI ZMARCA = 'S'
     C     ZMARCA        IFEQ      'S'
     C* Tipo de pago '01'
     C*PASAR MOVT10 '01'
     C                   MOVEL     '01'          MOVT10
     C*SINO
     C                   ELSE
     C* Tipo de pago
     C*PASAR MOVT10 PLAT03
     C                   MOVEL     PLAT03        MOVT10
     C*FIN
     C                   END
     C* Número de planilla
     C*MOVER MOVNU2 PLANU1
     C                   Z-ADD     PLANU1        MOVNU2
     C* Página
     C*MOVER MOVPAG DETPAG
     C                   Z-ADD     DETPAG        MOVPAG
     C* Secuencia
     C*MOVER MOVSEC DETSEC
     C                   Z-ADD     DETSEC        MOVSEC
     C* Fecha fondo acreditación
     C*PASAR MOVFE7 HISFE3
     C                   MOVEL     HISFE3        MOVFE7
     C* Fecha sistema acreditación
     C*FUNCION QFECH1 (MOVFE1)
     C                   CALL      'RPRECFEC'                                   QFECH1
     C     MOVFE1        PARM      MOVFE1        F$2P1             8
     C*LIMPIAR ZRENTR
     C                   CLEAR                   ZRENTR
     C*FUNCION QHORA (MOVHOR)
     C                   CALL      'F012SNAP'                                   QHORA
     C     MOVHOR        PARM      MOVHOR        F$301             6
     C*SI PLAT03<>'09' Y PLAT03<>'10' Y PLAT03<>'11' Y PLAT03<>'12' O PL
     C     PLAT03        IFNE      '09'
     C     PLAT03        ANDNE     '10'
     C     PLAT03        ANDNE     '11'
     C     PLAT03        ANDNE     '12'
     C     PLAT03        OREQ      '09'
     C     ZMARCA        ANDEQ     'S'
     C     PLAT03        OREQ      '10'
     C     ZMARCA        ANDEQ     'S'
     C     PLAT03        OREQ      '11'
     C     ZMARCA        ANDEQ     'S'
     C* Días de licencia
     C*MOVER MOVDIA ZDILIC
     C                   Z-ADD     ZDILIC        MOVDIA
     C*FIN
     C                   END
     C* Tarifa alto riesgo
     C*MOVER MOVTA1 DETTAR
     C                   Z-ADD     DETTAR        MOVTA1
     C* Código actividad alto riesgo
     C*MOVER MOVC18 DETCOD
     C                   MOVE      DETCOD        MOVC18
     C* Plan. indep./vol./tercero
     C*SI PLATIP = '02' O PLATIP = '03' O PLATIP = '07'
     C     PLATIP        IFEQ      '02'
     C     PLATIP        OREQ      '03'
     C     PLATIP        OREQ      '07'
     C* Código interno empleador
     C*MOVER MOVCOD *CERO
     C                   MOVE      *ZERO         MOVCOD
     C*SINO
     C                   ELSE
     C* Código empleador
     C*MOVER MOVCOD PLACOD
     C                   Z-ADD     PLACOD        MOVCOD
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza relación afiliado empleador                       ==
     C*==                                                              ==
     C*==================================================================
     C     M14040        BEGSR
     C* Ingreso o Ingreso - Retiro de dependientes
     C* Tipo planilla y tipo cot
     C*EJECUTAR M14027
     C                   EXSR      M14027
     C* Nov ingreso ó retiro/ingreso
     C*SI ZNOING = 'X'
     C     ZNOING        IFEQ      'X'
     C* Depen/indep/situado/terceros/Volunta./cooperados
     C*SI ZTIPLA = '01' O ZTIPLA = '02' O ZTIPLA = '04' O ZTIPLA = '07'
     C     ZTIPLA        IFEQ      '01'
     C     ZTIPLA        OREQ      '02'
     C     ZTIPLA        OREQ      '04'
     C     ZTIPLA        OREQ      '07'
     C     ZTIPLA        OREQ      '03'
     C     ZTIPLA        OREQ      '08'
     C*SI AFITIP = '2' Y ZTIPLA = '01' O AFITIP = '1' Y ZTIPLA = '02' O
     C     AFITIP        IFEQ      '2'
     C     ZTIPLA        ANDEQ     '01'
     C     AFITIP        OREQ      '1'
     C     ZTIPLA        ANDEQ     '02'
     C     AFITIP        OREQ      '2'
     C     ZTIPLA        ANDEQ     '08'
     C     AFITIP        OREQ      '1'
     C     ZTIPLA        ANDEQ     '07'
     C     PLAT03        ANDEQ     '07'
     C* Tipo de afiliado
     C*PASAR ZFITIP AFITIP
     C                   MOVEL     AFITIP        ZFITIP
     C* Pasa afiliado a indep.-depen.
     C*ASIGNAR AFITIP '3'
     C                   MOVEL     '3'           AFITIP
     C* Afiliados
     C*GRABAR AFIARC
     C     *IN35         IFEQ      '0'
     C                   UPDATE    AFIREG                               94
     C                   ELSE
     C                   WRITE     AFIREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Entidad a leer AFIARC
     C*PASAR ZENTID  'G'
     C                   MOVEL     'G'           ZENTID
     C* Código interno afiliado
     C*MOVER ZNUM12 AFINUM
     C                   Z-ADD     AFINUM        ZNUM12
     C* Indicador de error
     C*LIMPIAR ZALFA5 ZINERE
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2 ZALFA8
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C                   CLEAR                   ZALFA8
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM21 ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM21
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C*FIN
     C                   END
     C* Tipo afiliado: Voluntario
     C*SI AFITIP = '4'
     C     AFITIP        IFEQ      '4'
     C*SI ZTIPLA = '02' O ZTIPLA = '07' Y PLAT03 = '07'
     C     ZTIPLA        IFEQ      '02'
     C     ZTIPLA        OREQ      '07'
     C     PLAT03        ANDEQ     '07'
     C* Tipo de afiliado
     C*PASAR ZFITIP AFITIP
     C                   MOVEL     AFITIP        ZFITIP
     C* Pasa afiliado a indep.
     C*ASIGNAR AFITIP '2'
     C                   MOVEL     '2'           AFITIP
     C* Afiliados
     C*GRABAR AFIARC
     C     *IN35         IFEQ      '0'
     C                   UPDATE    AFIREG                               94
     C                   ELSE
     C                   WRITE     AFIREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Entidad a leer AFIARC
     C*PASAR ZENTID  'G'
     C                   MOVEL     'G'           ZENTID
     C* Código interno afiliado
     C*MOVER ZNUM12 AFINUM
     C                   Z-ADD     AFINUM        ZNUM12
     C* Indicador de error
     C*LIMPIAR ZALFA5 ZINERE
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2 ZALFA8
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C                   CLEAR                   ZALFA8
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM21 ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM21
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Indicador novedad no aplica
     C*SI DETIN1 = 'N'
     C     DETIN1        IFEQ      'N'
     C* Recupera registro
     C*EJECUTAR M14047
     C                   EXSR      M14047
     C* Encontró relación
     C*SI ZINDIC = '1'
     C     ZINDIC        IFEQ      '1'
     C*INICIARUI AFIAR1 (AFINUM ZCODEM)
     C     LL$068        KLIST
     C                   KFLD                    AFINUM
     C                   KFLD                    ZCODEM
     C     LL$068        SETLL     AFIAR1                                 37
     C     *IN37         IFEQ      '1'
     C     LL$068        SETGT     AFIAR1                             37
     C                   MOVE      '0'           *IN37
     C                   ELSE
     C                   MOVE      '1'           *IN37
     C                   END
     C*SI ERE(AFIAR1)
     C     *IN37         IFEQ      '0'
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*FIN
     C                   END
     C* Actualiza datos registro
     C*EJECUTAR M14048
     C                   EXSR      M14048
     C* Actualiza rel. afiliado empleador(cont...)
     C*EJECUTAR M14041
     C                   EXSR      M14041
     C* Estado relac. afil-emplead
     C*SI AFIEST = 'INA'
     C     AFIEST        IFEQ      'INA'
     C* Graba area local de datos
     C*FUNCION QGRAALD (ZFUEIN 160 3)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZFUEIN        PARM      ZFUEIN        F$2Z1           250
     C                   PARM      160           F$2Z2             4 0
     C                   PARM      3             F$2Z3             4 0
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Si novedad aplica
     C*SINO
     C                   ELSE
     C* Procesa novedad de ingreso
     C*EJECUTAR M14043
     C                   EXSR      M14043
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Recupera registro
     C*EJECUTAR M14047
     C                   EXSR      M14047
     C* Encontró relación
     C*SI ZINDIC = '1'
     C     ZINDIC        IFEQ      '1'
     C*INICIARUI AFIAR1 (AFINUM ZCODEM)
     C     LL$069        KLIST
     C                   KFLD                    AFINUM
     C                   KFLD                    ZCODEM
     C     LL$069        SETLL     AFIAR1                                 37
     C     *IN37         IFEQ      '1'
     C     LL$069        SETGT     AFIAR1                             37
     C                   MOVE      '0'           *IN37
     C                   ELSE
     C                   MOVE      '1'           *IN37
     C                   END
     C*SI ERE(AFIAR1)
     C     *IN37         IFEQ      '0'
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*FIN
     C                   END
     C* Actualiza datos registro
     C*EJECUTAR M14048
     C                   EXSR      M14048
     C* Actualiza rel. afiliado empleador(cont...)
     C*EJECUTAR M14041
     C                   EXSR      M14041
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Recupera registro
     C*EJECUTAR M14047
     C                   EXSR      M14047
     C* Encontró relación
     C*SI ZINDIC = '1'
     C     ZINDIC        IFEQ      '1'
     C* Cancel deuda / rezag
     C*SI PLAT03<>'02' Y ZT@003=*BLANCO O ZT@002='3'
     C     PLAT03        IFNE      '02'
     C     ZT@003        ANDEQ     *BLANK
     C     ZT@002        OREQ      '3'
     C*INICIARUI AFIAR1 (AFINUM ZCODEM)
     C     LL$070        KLIST
     C                   KFLD                    AFINUM
     C                   KFLD                    ZCODEM
     C     LL$070        SETLL     AFIAR1                                 37
     C     *IN37         IFEQ      '1'
     C     LL$070        SETGT     AFIAR1                             37
     C                   MOVE      '0'           *IN37
     C                   ELSE
     C                   MOVE      '1'           *IN37
     C                   END
     C*SI ERE(AFIAR1)
     C     *IN37         IFEQ      '0'
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*FIN
     C                   END
     C* Actualiza datos registro
     C*EJECUTAR M14048
     C                   EXSR      M14048
     C* Act rel afil empl(cont...)
     C*EJECUTAR M14041
     C                   EXSR      M14041
     C*FIN
     C                   END
     C* Verificación y creación de contrato
     C*EJECUTAR M00110
     C                   EXSR      M00110
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Depura dup A-E volunt
     C*EJECUTAR M00119
     C                   EXSR      M00119
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza relación afiliado empleador (continuación)        ==
     C*==                                                              ==
     C*==================================================================
     C     M14041        BEGSR
     C* Se cierra la relación SI:
     C* Retiro que sea mayor o igual al ult. per. acreditado o novedad d
     C* ingreso-retiro para el último período cotizado del afiliado  o
     C* si afiliado es 'RES' y desarrollo 13422 activo.
     C*
     C*LIMPIAR ZIRRES
     C                   CLEAR                   ZIRRES
     C*SI AFIES2 = 'RES' Y ZR3422=1
     C     AFIES2        IFEQ      'RES'
     C     ZR3422        ANDEQ     1
     C* Inactivar relación de afiliado RES
     C*PASAR ZIRRES 'S'
     C                   MOVEL     'S'           ZIRRES
     C*FIN
     C                   END
     C*SI ZNORET='X' Y ZPERCO>=AFIUL6 O ZNORET='X' Y ZNOING='X' Y ZINARE
     C     ZNORET        IFEQ      'X'
     C     ZPERCO        ANDGE     AFIUL6
     C     ZNORET        OREQ      'X'
     C     ZNOING        ANDEQ     'X'
     C     ZINARE        ANDEQ     '1'
     C     ZNORET        OREQ      'X'
     C     ZNOING        ANDEQ     'X'
     C     ZPERCO        ANDGE     AFIUL6
     C     ZR9601        ANDEQ     1
     C     ZIRRES        OREQ      'S'
     C* Planilla normal o de situados
     C*SI ZTIPLA ='01' O ZTIPLA = '02' O ZTIPLA = '08' O ZTIPLA = '04' Y
     C     ZTIPLA        IFEQ      '01'
     C     ZTIPLA        OREQ      '02'
     C     ZTIPLA        OREQ      '08'
     C     ZTIPLA        OREQ      '04'
     C     PLAT03        ANDEQ     '05'
     C* Relación activa
     C*SI AFIEST = 'ACT'
     C     AFIEST        IFEQ      'ACT'
     C* Estado de la relación
     C*ASIGNAR AFIEST 'INA'
     C                   MOVEL     'INA'         AFIEST
     C* Fecha término de contrato
     C*EJECUTAR M14058
     C                   EXSR      M14058
     C* Estado relac. afil-emplead
     C*SI AFIEST = 'INA'
     C     AFIEST        IFEQ      'INA'
     C* Graba en área local de datos
     C*FUNCION QGRAALD (ZFUEIN 160 3)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZFUEIN        PARM      ZFUEIN        F$2Z1           250
     C                   PARM      160           F$2Z2             4 0
     C                   PARM      3             F$2Z3             4 0
     C*FIN
     C                   END
     C* Origen del cierre
     C*PASAR AFIOR2 '01'
     C                   MOVEL     '01'          AFIOR2
     C* Código fuente inactivación
     C*PASAR AFIC82 ZFUEIN
     C                   MOVEL     ZFUEIN        AFIC82
     C* Fecha de inactivación
     C*PASAR AFIF63 ZFESIS
     C                   MOVEL     ZFESIS        AFIF63
     C* Usuario de inactivación
     C*PASAR AFIU13 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        AFIU13
     C* Ilocalizable y tx 02
     C*SI AFIIN6 = '5' Y AFIT17='1'
     C     AFIIN6        IFEQ      '5'
     C     AFIT17        ANDEQ     '1'
     C* Dependiente
     C*SI ZOVCO1 = '02'
     C     ZOVCO1        IFEQ      '02'
     C*CASO ZOVTIP='31' O ZOVTIP='32' O ZOVTIP='34' O ZOVTIP='35' O ZOVT
     C                   SELECT
     C     ZOVTIP        WHENEQ    '31'
     C     ZOVTIP        OREQ      '32'
     C     ZOVTIP        OREQ      '34'
     C     ZOVTIP        OREQ      '35'
     C     ZOVTIP        OREQ      '71'
     C     ZOVTIP        OREQ      '72'
     C* Activa afiliado con ind. ilocalizad
     C*EJECUTAR M00035
     C                   EXSR      M00035
     C*CASO ZOVTIP='74' O ZOVTIP='75' O ZOVTIP='91' O ZOVTIP='92' O ZOVT
     C     ZOVTIP        WHENEQ    '74'
     C     ZOVTIP        OREQ      '75'
     C     ZOVTIP        OREQ      '91'
     C     ZOVTIP        OREQ      '92'
     C     ZOVTIP        OREQ      '94'
     C     ZOVTIP        OREQ      '95'
     C* Activa afiliado con ind. ilocalizad
     C*EJECUTAR M00035
     C                   EXSR      M00035
     C*FINCASOS
     C                   ENDSL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI AFIEST = 'INA' Y ZTIPLA = '02'
     C     AFIEST        IFEQ      'INA'
     C     ZTIPLA        ANDEQ     '02'
     C* Fecha término de contrato
     C*EJECUTAR M14058
     C                   EXSR      M14058
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Relac. afil-emplead
     C*GRABAR AFIAR1
     C     *IN37         IFEQ      '0'
     C                   UPDATE    AFIRE1                               94
     C                   ELSE
     C                   WRITE     AFIRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Cesantes
     C* Cobra comisión
     C*PASAR ZINCOM 'C'
     C                   MOVEL     'C'           ZINCOM
     C* Proceso de comisiones
     C*EJECUTAR M74140
     C                   EXSR      M74140
     C* Fecha de trabajo
     C*LIMPIAR ZFECH2
     C                   CLEAR                   ZFECH2
     C* Causal anulación deuda
     C*PASAR ZCAAND 'A23'
     C                   MOVEL     'A23'         ZCAAND
     C* Libera registro
     C*INICIAR DETAR201
     C     *LOVAL        SETLL     DETAR201                           48
     C* Ind. finalizar DEUD79
     C*LIMPIAR ZFINOK
     C                   CLEAR                   ZFINOK
     C* Anular deudas presuntas
     C*LLAMAR TRDEUD79 (AFINU3 AFICO7 AFIFE5 ZFECH2 ZCAAND AFIFE9 ZFINOK
     C                   CALL      'TRDEUD79'
     C                   PARM                    AFINU3
     C                   PARM                    AFICO7
     C                   PARM                    AFIFE5
     C                   PARM                    ZFECH2
     C                   PARM                    ZCAAND
     C                   PARM                    AFIFE9
     C                   PARM                    ZFINOK
     C*SI ZFINOK != *BLANCO
     C     ZFINOK        IFNE      *BLANK
     C*PASAR ZERROR 'Error al actualizar HISAR4 en DEUD79, revise spool'
     C                   MOVEL     $HIL(052)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI ZTIPLA ='02' O ZTIPLA = '03'
     C     ZTIPLA        IFEQ      '02'
     C     ZTIPLA        OREQ      '03'
     C* Relac. afil-emplead
     C*GRABAR AFIAR1
     C     *IN37         IFEQ      '0'
     C                   UPDATE    AFIRE1                               94
     C                   ELSE
     C                   WRITE     AFIRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Retiro dependientes y mayor o igual al ult. per. acreditado
     C*SINO
     C                   ELSE
     C* Relac. afil-emplead
     C*GRABAR AFIAR1
     C     *IN37         IFEQ      '0'
     C                   UPDATE    AFIRE1                               94
     C                   ELSE
     C                   WRITE     AFIRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Ilocalizable y tx 02
     C*SI AFIIN6 = '5' Y AFIT17='1'
     C     AFIIN6        IFEQ      '5'
     C     AFIT17        ANDEQ     '1'
     C* Dependiente
     C*SI ZOVCO1 = '02'
     C     ZOVCO1        IFEQ      '02'
     C*CASO ZOVTIP = '31' O ZOVTIP = '32' O ZOVTIP = '34' O  ZOVTIP = '3
     C                   SELECT
     C     ZOVTIP        WHENEQ    '31'
     C     ZOVTIP        OREQ      '32'
     C     ZOVTIP        OREQ      '34'
     C     ZOVTIP        OREQ      '35'
     C     ZOVTIP        OREQ      '71'
     C     ZOVTIP        OREQ      '72'
     C* Activa afiliado con ind. ilocalizado
     C*EJECUTAR M00035
     C                   EXSR      M00035
     C*CASO ZOVTIP='74' O ZOVTIP='75' O ZOVTIP='91' O ZOVTIP='92' O ZOVT
     C     ZOVTIP        WHENEQ    '74'
     C     ZOVTIP        OREQ      '75'
     C     ZOVTIP        OREQ      '91'
     C     ZOVTIP        OREQ      '92'
     C     ZOVTIP        OREQ      '94'
     C     ZOVTIP        OREQ      '95'
     C* Activa afiliado con ind. ilocalizado
     C*EJECUTAR M00035
     C                   EXSR      M00035
     C*FINCASOS
     C                   ENDSL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Proceso de comisiones circular 040 mayo 12 de 2000
     C* Indicador cobro cesantes
     C*LIMPIAR ZINDCE
     C                   CLEAR                   ZINDCE
     C* Período > vigencia de cesantes
     C*SI ZPERCO >= ZPEVIG
     C     ZPERCO        IFGE      ZPEVIG
     C* Indicador de cobro rev cesantes
     C*PASAR ZINDCE 'S'
     C                   MOVEL     'S'           ZINDCE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Evaluar novedad vs relación                                 ==
     C*==                                                              ==
     C*==================================================================
     C     M14042        BEGSR
     C*LIMPIAR ZRENTR ZERRO2 ZFECP1
     C                   CLEAR                   ZRENTR
     C                   CLEAR                   ZERRO2
     C                   CLEAR                   ZFECP1
     C* 1 día período de la planilla
     C*OBTENER (0) ZFECP1 = ZPERCO || '01'
     C                   CLEAR                   ZFECP1
     C     ZPERCO        CAT       '01':0        ZFECP1
     C* SUMAR 1 MES AL ÚLT. PER. COT.
     C*FUNCION QSUMME1 (ZAFUL2 1 ZAFUL2)
     C                   CALL      'RPSUMME1'                                   QSUMME1
     C     ZAFUL2        PARM      ZAFUL2        F$4O1             8
     C                   PARM      1             F$4O2             8 0
     C     ZAFUL2        PARM      ZAFUL2        F$4O3             8
     C* Ubicarse en relación anterior al periodo
     C*INICIAR AFIAR1 (AFINUM ZCODEM ZFECP1)
     C     LL$071        KLIST
     C                   KFLD                    AFINUM
     C                   KFLD                    ZCODEM
     C                   KFLD                    ZFECP1
     C     LL$071        SETLL     AFIAR1                             37
     C*SI ERE (AFIAR1) Y AFINU3 = AFINUM Y AFICO7 = ZCODEM
     C     *IN37         IFEQ      '0'
     C     AFINU3        ANDEQ     AFINUM
     C     AFICO7        ANDEQ     ZCODEM
     C*LEER AFIAR1
     C                   READ      AFIAR1                                 37
     C*FIN
     C                   END
     C*
     C*FUNCION QRESME1 (AFIFE9 1 ZFAFIR)
     C                   CALL      'RPRESME1'                                   QRESME1
     C     AFIFE9        PARM      AFIFE9        F$4D1             8
     C                   PARM      1             F$4D2             8 0
     C     ZFAFIR        PARM      ZFAFIR        F$4D3             8
     C* Per. ant. inicio rel. A-E
     C*PASAR ZPEAIR ZFAFIR
     C                   MOVEL     ZFAFIR        ZPEAIR
     C* Fecha últ. per. bien cot.
     C*OBTENER (0) ZAFUL2 = AFIUL2 || '01'
     C                   CLEAR                   ZAFUL2
     C     AFIUL2        CAT       '01':0        ZAFUL2
     C* Sumar 1 mes al últ. periodo cotiz
     C*FUNCION QSUMME1 (ZAFUL2 1 ZAFUL2)
     C                   CALL      'RPSUMME1'                                   QSUMME1
     C     ZAFUL2        PARM      ZAFUL2        F$4O1             8
     C                   PARM      1             F$4O2             8 0
     C     ZAFUL2        PARM      ZAFUL2        F$4O3             8
     C* Último período a cotizar
     C*PASAR ZULPER ZAFUL2
     C                   MOVEL     ZAFUL2        ZULPER
     C*
     C* Evaluar la forma de actualizar la relación afiliado empleador
     C*
     C*CASO AFIEST = 'ACT' Y ZNOING = 'X' Y ZNORET='X' Y ZPERCO = ZULPER
     C                   SELECT
     C     AFIEST        WHENEQ    'ACT'
     C     ZNOING        ANDEQ     'X'
     C     ZNORET        ANDEQ     'X'
     C     ZPERCO        ANDEQ     ZULPER
     C* Relación activa y novedad ingreso-retiro para el último período
     C* de cotización del afiliado.
     C* Ind. inactivar relación
     C*PASAR ZINARE '1'
     C                   MOVEL     '1'           ZINARE
     C*CASO AFIEST = 'ACT' Y ZNOING = 'X' Y ZNORET='X' Y ZPERCO = ZPEAIR
     C     AFIEST        WHENEQ    'ACT'
     C     ZNOING        ANDEQ     'X'
     C     ZNORET        ANDEQ     'X'
     C     ZPERCO        ANDEQ     ZPEAIR
     C* Relación activa con novedad ingreso-retiro y la planilla
     C* corresponde al período anterior a la fecha inicio de la relación
     C* y no existe otra relación para el período anterior a la planilla
     C* Buscar una relación anterior
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*
     C* Existe relación inactiva y no es acreditación de rezago
     C*SI ERE(AFIAR1) Y AFINU3=AFINUM Y AFICO7=ZCODEM Y ZT@002<>'3' Y ZF
     C     *IN37         IFEQ      '0'
     C     AFINU3        ANDEQ     AFINUM
     C     AFICO7        ANDEQ     ZCODEM
     C     ZT@002        ANDNE     '3'
     C     ZFECPE        ANDLE     AFIFE5
     C     ZFECPE        ANDGE     AFIFE9
     C*SINO
     C                   ELSE
     C* Indicador de aplica novedad
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*FIN
     C                   END
     C*CASO AFIEST = 'ACT' Y ZNOING = 'X' Y ZPERCO = ZPEAIR
     C     AFIEST        WHENEQ    'ACT'
     C     ZNOING        ANDEQ     'X'
     C     ZPERCO        ANDEQ     ZPEAIR
     C* Relación activa con novedad  de ingreso y la planilla
     C* corresponde al período anterior a la fecha inicio de la relación
     C* y no existe otra relación para el período anterior a la planilla
     C* Buscar una relación anterior
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C* Existe relación inactiva y no es solución de rezagos
     C*SI ERE(AFIAR1) Y AFINU3=AFINUM Y AFICO7=ZCODEM Y ZT@002<>'3' Y ZF
     C     *IN37         IFEQ      '0'
     C     AFINU3        ANDEQ     AFINUM
     C     AFICO7        ANDEQ     ZCODEM
     C     ZT@002        ANDNE     '3'
     C     ZFECPE        ANDLE     AFIFE5
     C     ZFECPE        ANDGE     AFIFE9
     C*SINO
     C                   ELSE
     C* Ubicarse en la relación inmeditamente posterior al periodo de la
     C*INICIAR AFIAR1 (AFINUM ZCODEM ZFECP1)
     C     LL$072        KLIST
     C                   KFLD                    AFINUM
     C                   KFLD                    ZCODEM
     C                   KFLD                    ZFECP1
     C     LL$072        SETLL     AFIAR1                             37
     C*LEER AFIAR1
     C                   READ      AFIAR1                                 37
     C*SI ERE (AFIAR1) Y AFINU3 = AFINUM Y AFICO7 = ZCODEM
     C     *IN37         IFEQ      '0'
     C     AFINU3        ANDEQ     AFINUM
     C     AFICO7        ANDEQ     ZCODEM
     C* Fecha inicio de la relación
     C*PASAR AFIFE9 ZFECPE
     C                   MOVEL     ZFECPE        AFIFE9
     C* Fecha último cambio
     C*PASAR AFIF01 ZFESIS
     C                   MOVEL     ZFESIS        AFIF01
     C* Período devenga primer aporte
     C*PASAR AFIME1 ZPERCO
     C                   MOVEL     ZPERCO        AFIME1
     C*SI ZTIPLA='01' Y AFIT17='1'
     C     ZTIPLA        IFEQ      '01'
     C     AFIT17        ANDEQ     '1'
     C* Meses a sumar
     C*MOVER ZMESES 1
     C                   Z-ADD     1             ZMESES
     C* Sumar 1 mes fecha ini
     C*LLAMAR RPSUMME1(AFIFE9 ZMESES ZFECPR)
     C                   CALL      'RPSUMME1'
     C                   PARM                    AFIFE9
     C                   PARM                    ZMESES
     C                   PARM                    ZFECPR
     C* Pasar a mes de pago
     C*PASAR AFIME2 ZFECPR
     C                   MOVEL     ZFECPR        AFIME2
     C*SINO
     C                   ELSE
     C* Mes de pago primer aporte
     C*ASIGNAR AFIME2 ZPERCO
     C                   MOVEL     ZPERCO        AFIME2
     C* Acumula AFIPE3
     C*EJECUTAR M14098
     C                   EXSR      M14098
     C*FIN
     C                   END
     C* Primer periodo acreditado
     C*PASAR AFIPR4 ZPERCO
     C                   MOVEL     ZPERCO        AFIPR4
     C*GRABAR AFIAR1
     C     *IN37         IFEQ      '0'
     C                   UPDATE    AFIRE1                               94
     C                   ELSE
     C                   WRITE     AFIRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C* Ilocalizable y tx 02
     C*SI AFIIN6 = '5' Y AFIT17='1'
     C     AFIIN6        IFEQ      '5'
     C     AFIT17        ANDEQ     '1'
     C* Dependiente
     C*SI ZOVCO1 = '02'
     C     ZOVCO1        IFEQ      '02'
     C*SI ZOVTIP='31' O ZOVTIP='32' O ZOVTIP='34' O ZOVTIP='35' O ZOVTIP
     C     ZOVTIP        IFEQ      '31'
     C     ZOVTIP        OREQ      '32'
     C     ZOVTIP        OREQ      '34'
     C     ZOVTIP        OREQ      '35'
     C     ZOVTIP        OREQ      '71'
     C     ZOVTIP        OREQ      '72'
     C* Activa afiliado con ind. ilocalizad
     C*EJECUTAR M00035
     C                   EXSR      M00035
     C*FIN
     C                   END
     C*SI  ZOVTIP='74' O ZOVTIP='75' O ZOVTIP='91' O ZOVTIP='92' O ZOVTI
     C     ZOVTIP        IFEQ      '74'
     C     ZOVTIP        OREQ      '75'
     C     ZOVTIP        OREQ      '91'
     C     ZOVTIP        OREQ      '92'
     C     ZOVTIP        OREQ      '94'
     C     ZOVTIP        OREQ      '95'
     C* Activa afiliado con ind. ilocalizad
     C*EJECUTAR M00035
     C                   EXSR      M00035
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*CASO AFIEST = 'INA' Y ZNOING = 'X' Y ZNORET='X' Y ZPERCO = ZPEAIR
     C     AFIEST        WHENEQ    'INA'
     C     ZNOING        ANDEQ     'X'
     C     ZNORET        ANDEQ     'X'
     C     ZPERCO        ANDEQ     ZPEAIR
     C*SI AFIT17 <> '2' Y ZR3422 = 1
     C     AFIT17        IFNE      '2'
     C     ZR3422        ANDEQ     1
     C* Relación inactiva con novedad ingreso-retiro y la planilla
     C* corresponde al período anterior a la fecha inicio de la relación
     C* y existe relación inactiva para el período anterior a la planill
     C* Buscar una relación anterior
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*  Existe otra relación inactiva
     C*SI ERE(AFIAR1) Y AFINU3=AFINUM Y AFICO7=ZCODEM Y AFIEST='INA' Y Z
     C     *IN37         IFEQ      '0'
     C     AFINU3        ANDEQ     AFINUM
     C     AFICO7        ANDEQ     ZCODEM
     C     AFIEST        ANDEQ     'INA'
     C     ZFECPE        ANDLE     AFIFE5
     C     ZFECPE        ANDGE     AFIFE9
     C*FUNCION QRESME1 (ZFECPE 1 ZFAFIR)
     C                   CALL      'RPRESME1'                                   QRESME1
     C     ZFECPE        PARM      ZFECPE        F$4D1             8
     C                   PARM      1             F$4D2             8 0
     C     ZFAFIR        PARM      ZFAFIR        F$4D3             8
     C* Período ant. a la planilla
     C*PASAR ZPAFIR ZFAFIR
     C                   MOVEL     ZFAFIR        ZPAFIR
     C* Período fin de la relación
     C*PASAR ZULPER AFIFE5
     C                   MOVEL     AFIFE5        ZULPER
     C* Existe relación inactiva para el período anterior al de la plan
     C* Período ant. plan. = F. fin rel
     C*SI ZPAFIR = ZULPER
     C     ZPAFIR        IFEQ      ZULPER
     C* Indicador de aplica novedad
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Indicador de aplica novedad
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*CASO AFIEST = 'INA' Y ZNOING = 'X' Y ZPERCO = ZPEAIR
     C     AFIEST        WHENEQ    'INA'
     C     ZNOING        ANDEQ     'X'
     C     ZPERCO        ANDEQ     ZPEAIR
     C*SI AFIT17 <> '2' Y ZR3422 = 1
     C     AFIT17        IFNE      '2'
     C     ZR3422        ANDEQ     1
     C* Relación inactiva, novedad de ingreso, y la planilla corresponde
     C* al período anterior a la fecha inicio de la relación
     C* Buscar una relación anterior
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C* Existe otra rel
     C*SI ERE(AFIAR1) Y AFINU3=AFINUM Y AFICO7=ZCODEM Y ZFECPE<=AFIFE5 Y
     C     *IN37         IFEQ      '0'
     C     AFINU3        ANDEQ     AFINUM
     C     AFICO7        ANDEQ     ZCODEM
     C     ZFECPE        ANDLE     AFIFE5
     C     ZFECPE        ANDGE     AFIFE9
     C* La relación está inactiva
     C*SI AFIEST = 'INA'
     C     AFIEST        IFEQ      'INA'
     C*FUNCION QRESME1 (ZFECPE 1 ZFAFIR)
     C                   CALL      'RPRESME1'                                   QRESME1
     C     ZFECPE        PARM      ZFECPE        F$4D1             8
     C                   PARM      1             F$4D2             8 0
     C     ZFAFIR        PARM      ZFAFIR        F$4D3             8
     C* Período ant. a la planilla
     C*PASAR ZPAFIR ZFAFIR
     C                   MOVEL     ZFAFIR        ZPAFIR
     C* Período fin de la relación
     C*PASAR ZULPER AFIFE5
     C                   MOVEL     AFIFE5        ZULPER
     C* Existe relación inactiva para el período anterior al de la plan
     C* Período ant. plan. = F. fin rel
     C*SI ZPAFIR = ZULPER
     C     ZPAFIR        IFEQ      ZULPER
     C* Calcular número de días del período de la planilla
     C*LIMPIAR ZRENTR ZERRO2 ZFEDPE
     C                   CLEAR                   ZRENTR
     C                   CLEAR                   ZERRO2
     C                   CLEAR                   ZFEDPE
     C* Fecha período de la plan
     C*OBTENER (0) ZFEDPE = ZPERCO || '01'
     C                   CLEAR                   ZFEDPE
     C     ZPERCO        CAT       '01':0        ZFEDPE
     C* Suma un mes a la planilla
     C*FUNCION QSUMME1 (ZFEDPE 1 ZFEDPE)
     C                   CALL      'RPSUMME1'                                   QSUMME1
     C     ZFEDPE        PARM      ZFEDPE        F$4O1             8
     C                   PARM      1             F$4O2             8 0
     C     ZFEDPE        PARM      ZFEDPE        F$4O3             8
     C* Resta un día
     C*FUNCION QRESDI1 (ZFEDPE 1 ZFEDPE)
     C                   CALL      'RPRESDI1'                                   QRESDI1
     C     ZFEDPE        PARM      ZFEDPE        F$431             8
     C                   PARM      1             F$432             5 0
     C     ZFEDPE        PARM      ZFEDPE        F$433             8
     C* Obtiene el últ. día del per.
     C*ASIGNARD ZDIASM ZFEDPE
     C                   MOVE      ZFEDPE        ZDIASM
     C*
     C* La fecha fin de la relación debe ser la del útimo día del mes de
     C* de la planilla.
     C* Correr un mes fecha term.
     C*OBTENER (0) AFIFE5 = ZPERCO||ZDIASM
     C                   CLEAR                   AFIFE5
     C     ZPERCO        CAT       ZDIASM:0      AFIFE5
     C* Actualiza datos registro
     C*EJECUTAR M14048
     C                   EXSR      M14048
     C* Actualiza rel. A-E (cont...)
     C*EJECUTAR M14041
     C                   EXSR      M14041
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* No existe relación para el período anterior al de la planilla
     C* Ubicarse en la relación inmeditamente posterior al periodo de la
     C*INICIAR AFIAR1 (AFINUM ZCODEM ZFECP1)
     C     LL$073        KLIST
     C                   KFLD                    AFINUM
     C                   KFLD                    ZCODEM
     C                   KFLD                    ZFECP1
     C     LL$073        SETLL     AFIAR1                             37
     C*LEER AFIAR1
     C                   READ      AFIAR1                                 37
     C*SI ERE (AFIAR1) Y AFINU3 = AFINUM Y AFICO7 = ZCODEM
     C     *IN37         IFEQ      '0'
     C     AFINU3        ANDEQ     AFINUM
     C     AFICO7        ANDEQ     ZCODEM
     C* Fecha inicio de la relación
     C*PASAR AFIFE9 ZFECPE
     C                   MOVEL     ZFECPE        AFIFE9
     C* Fecha último cambio
     C*PASAR AFIF01 ZFESIS
     C                   MOVEL     ZFESIS        AFIF01
     C* Período devenga primer aporte
     C*PASAR AFIME1 ZPERCO
     C                   MOVEL     ZPERCO        AFIME1
     C* Mes de pago primer aporte
     C*ASIGNAR AFIME2 ZPERCO
     C                   MOVEL     ZPERCO        AFIME2
     C* Primer periodo acreditado
     C*PASAR AFIPR4 ZPERCO
     C                   MOVEL     ZPERCO        AFIPR4
     C* Acumula AFIPE3
     C*EJECUTAR M14098
     C                   EXSR      M14098
     C*GRABAR AFIAR1
     C     *IN37         IFEQ      '0'
     C                   UPDATE    AFIRE1                               94
     C                   ELSE
     C                   WRITE     AFIRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C* Ilocalizable y tx 02
     C*SI AFIIN6 = '5' Y AFIT17='1'
     C     AFIIN6        IFEQ      '5'
     C     AFIT17        ANDEQ     '1'
     C* Dependiente
     C*SI ZOVCO1 = '02'
     C     ZOVCO1        IFEQ      '02'
     C*SI ZOVTIP='31' O ZOVTIP='32' O ZOVTIP='34' O ZOVTIP='35' O ZOVTIP
     C     ZOVTIP        IFEQ      '31'
     C     ZOVTIP        OREQ      '32'
     C     ZOVTIP        OREQ      '34'
     C     ZOVTIP        OREQ      '35'
     C     ZOVTIP        OREQ      '71'
     C     ZOVTIP        OREQ      '72'
     C* Activa afiliado con ind. ilocalizad
     C*EJECUTAR M00035
     C                   EXSR      M00035
     C*FIN
     C                   END
     C*SI ZOVTIP='74' O ZOVTIP='75' O ZOVTIP='91' O ZOVTIP='92' O ZOVTIP
     C     ZOVTIP        IFEQ      '74'
     C     ZOVTIP        OREQ      '75'
     C     ZOVTIP        OREQ      '91'
     C     ZOVTIP        OREQ      '92'
     C     ZOVTIP        OREQ      '94'
     C     ZOVTIP        OREQ      '95'
     C* Activa afiliado con ind. ilocalizad
     C*EJECUTAR M00035
     C                   EXSR      M00035
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*CASO ERE(AFIAR1) Y ZNOING='X' Y ZNORET='X' Y ZPERCO<ZPEAIR
     C     *IN37         WHENEQ    '0'
     C     ZNOING        ANDEQ     'X'
     C     ZNORET        ANDEQ     'X'
     C     ZPERCO        ANDLT     ZPEAIR
     C*SI AFIT17 <> '2' Y ZR3422 = 1
     C     AFIT17        IFNE      '2'
     C     ZR3422        ANDEQ     1
     C* Aplique novedad de ingreso y retiro SI:
     C* Existe relación DIFERENTE de independiente y es posterior a peri
     C* aporte y se reporta novedad ingreso-retiro y el periodo no es
     C* inmediatamente anterior al periodo inicio de la relación  y esta
     C* habilitado el desarrollo especial req. 13422.
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*FIN
     C                   END
     C*SI AFIES2 = 'RES' Y ZT@002 = '1' O AFIES2 = 'RES' Y ZT@002 = '3'
     C     AFIES2        IFEQ      'RES'
     C     ZT@002        ANDEQ     '1'
     C     AFIES2        OREQ      'RES'
     C     ZT@002        ANDEQ     '3'
     C* Aplique novedad de ingreso y retiro si el periodo aporte es meno
     C* al periodo inmeditamente anterior a la relación y el afiliado es
     C* RES y el proceso ejecutado es acreditación normal o rezagos
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*FIN
     C                   END
     C*CASO ERE(AFIAR1) Y ZNOING = 'X' Y ZPERCO < ZPEAIR
     C     *IN37         WHENEQ    '0'
     C     ZNOING        ANDEQ     'X'
     C     ZPERCO        ANDLT     ZPEAIR
     C*SI AFIT17 <> '2' Y ZR3422 = 1
     C     AFIT17        IFNE      '2'
     C     ZR3422        ANDEQ     1
     C* Aplique novedad de ingreso SI:
     C* Existe relación DIFERENTE de independiente y es posterior a peri
     C* aporte y se reporta novedad ingreso y el periodo no es inmeditam
     C* anterior al periodo inicio de la relación  y esta habilitado el
     C* desarrollo especial req. 13422.
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*FIN
     C                   END
     C*FINCASOS
     C                   ENDSL
     C                   ENDSR
     C*==================================================================
     C*==  Procesa novedad de ingreso                                  ==
     C*==                                                              ==
     C*==================================================================
     C     M14043        BEGSR
     C* Ind. de encontró registro
     C*PASAR ZINDIC '0'
     C                   MOVEL     '0'           ZINDIC
     C* Ind. inactivar relación A-E
     C*PASAR ZINARE '0'
     C                   MOVEL     '0'           ZINARE
     C* Planilla indep/volunt/terceros/Cooperados
     C*SI ZTIPLA = '02' O ZTIPLA = '03' O ZTIPLA = '07'
     C     ZTIPLA        IFEQ      '02'
     C     ZTIPLA        OREQ      '03'
     C     ZTIPLA        OREQ      '07'
     C* Código int. empleador = 0
     C*MOVER ZCODEM *CERO
     C                   MOVE      *ZERO         ZCODEM
     C*SINO
     C                   ELSE
     C* Código interno del emplador
     C*MOVER ZCODEM PLACOD
     C                   Z-ADD     PLACOD        ZCODEM
     C*FIN
     C                   END
     C*
     C* Verifica período válido
     C*EJECUTAR M00022
     C                   EXSR      M00022
     C*SI ZT@IPV = 'N'
     C     ZT@IPV        IFEQ      'N'
     C* Número de identificación
     C*MOVER ZNUMAL DETNU2
     C                   MOVE      DETNU2        ZNUMAL
     C*OBTENER (1) ZERROR = 'Período de planilla en vinculación eliminad
     C                   CLEAR                   ZERROR
     C     $HIL(053)     CAT       ZNUMAL:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*SINO
     C                   ELSE
     C* Busca relaciones afil-emple
     C*INICIARUI AFIAR1 (AFINUM ZCODEM)
     C     LL$074        KLIST
     C                   KFLD                    AFINUM
     C                   KFLD                    ZCODEM
     C     LL$074        SETLL     AFIAR1                                 37
     C     *IN37         IFEQ      '1'
     C     LL$074        SETGT     AFIAR1                             37
     C                   MOVE      '0'           *IN37
     C                   ELSE
     C                   MOVE      '1'           *IN37
     C                   END
     C*SI NER(AFIAR1)
     C     *IN37         IFEQ      '1'
     C* Calcula fecha inicio relación
     C*EJECUTAR M14045
     C                   EXSR      M14045
     C* Indicador aplica novedad
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*SINO
     C                   ELSE
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C* Calcula fecha inicio relación
     C*EJECUTAR M14045
     C                   EXSR      M14045
     C* Pl voluntario y Terceros voluntarios
     C*SI ZTIPLA='03' O ZTIPLA='07' Y PLAT03='08' O ZTIPLA='07' Y PLAT03
     C     ZTIPLA        IFEQ      '03'
     C     ZTIPLA        OREQ      '07'
     C     PLAT03        ANDEQ     '08'
     C     ZTIPLA        OREQ      '07'
     C     PLAT03        ANDEQ     '13'
     C     ZTIPLA        OREQ      '07'
     C     PLAT03        ANDEQ     '14'
     C*MIENTRAS NFA(AFIAR1) Y ZCODEM = AFICO7 Y AFINUM = AFINU3
     C     *IN37         DOWEQ     '0'
     C     ZCODEM        ANDEQ     AFICO7
     C     AFINUM        ANDEQ     AFINU3
     C* Relación como voluntario
     C*SI AFIT17 = '4'
     C     AFIT17        IFEQ      '4'
     C* Indicador de aplica novedad
     C*PASAR ZINDIC '0'
     C                   MOVEL     '0'           ZINDIC
     C* Indicador de aplica novedad
     C*PASAR ZFIRVO '0'
     C                   MOVEL     '0'           ZFIRVO
     C*SI AFIFE5 = *BLANCO Y AFIME1 > ZFECPE
     C     AFIFE5        IFEQ      *BLANK
     C     AFIME1        ANDGT     ZFECPE
     C* Indicador de aplica novedad
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C* Indicador de aplica novedad
     C*PASAR ZFIRVO '1'
     C                   MOVEL     '1'           ZFIRVO
     C*SINO
     C                   ELSE
     C*SI AFIFE5 <> *BLANCO Y AFIME1 < ZFECPE
     C     AFIFE5        IFNE      *BLANK
     C     AFIME1        ANDLT     ZFECPE
     C* Indicador de aplica novedad
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C* Indicador de aplica novedad
     C*PASAR ZFIRVO '1'
     C                   MOVEL     '1'           ZFIRVO
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Indicador de aplica novedad
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*FIN
     C                   END
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI AFIEST='INA' Y ZFECPE > AFIFE5 O AFIT17='2' Y ZFECPE < AFIFE9
     C     AFIEST        IFEQ      'INA'
     C     ZFECPE        ANDGT     AFIFE5
     C     AFIT17        OREQ      '2'
     C     ZFECPE        ANDLT     AFIFE9
     C*
     C* Ya existe una relación como voluntario pero para un período
     C* posterior al de la planilla.
     C*
     C* Procesar relación
     C*PASAR ZT@PRO 'S'
     C                   MOVEL     'S'           ZT@PRO
     C*
     C* Relación inválida
     C*SI AFII30 = 'S'
     C     AFII30        IFEQ      'S'
     C* Período no válido
     C*SI ZT@IPV = 'N'
     C     ZT@IPV        IFEQ      'N'
     C* No procesar relación
     C*PASAR ZT@PRO 'N'
     C                   MOVEL     'N'           ZT@PRO
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Procesar relación
     C*SI ZT@PRO = 'S'
     C     ZT@PRO        IFEQ      'S'
     C*SI ZTIPLA='07' Y PLAT03 = '07' Y AFIT17='2' O ZTIPLA='02' Y PLAT0
     C     ZTIPLA        IFEQ      '07'
     C     PLAT03        ANDEQ     '07'
     C     AFIT17        ANDEQ     '2'
     C     ZTIPLA        OREQ      '02'
     C     PLAT03        ANDEQ     '01'
     C     ZTIPLP        ANDEQ     'I'
     C     ZTICOP        ANDEQ     59
     C     AFIT17        ANDEQ     '2'
     C* No se marca ZINDIC en 1 para que se actualice
     C* La relación ya existente
     C*SINO
     C                   ELSE
     C*SI ZTIPLA='02' Y PLAT03 = '01' Y ZTIPLP='I' Y ZTICOP=57 Y AFIT17=
     C     ZTIPLA        IFEQ      '02'
     C     PLAT03        ANDEQ     '01'
     C     ZTIPLP        ANDEQ     'I'
     C     ZTICOP        ANDEQ     57
     C     AFIT17        ANDEQ     '2'
     C* No se marca ZINDIC en 1 para que se actualice
     C* La relación ya existente
     C*SINO
     C                   ELSE
     C*SI ZTIPLA='02' Y PLAT03 = '01' Y AFIT17='2'
     C     ZTIPLA        IFEQ      '02'
     C     PLAT03        ANDEQ     '01'
     C     AFIT17        ANDEQ     '2'
     C* No se marca ZINDIC en 1 para que se actualice
     C* La relación ya existente
     C*SINO
     C                   ELSE
     C* Indicador de aplica novedad
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Evaluar novedad vs relación
     C*EJECUTAR M14042
     C                   EXSR      M14042
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Si ingreso y retiro - y no tiene dias cotizados
     C*SI ZNOING='X' Y ZNORET='X' Y ZDITRA=*CERO Y ZDILIC=*CERO
     C     ZNOING        IFEQ      'X'
     C     ZNORET        ANDEQ     'X'
     C     ZDITRA        ANDEQ     *ZERO
     C     ZDILIC        ANDEQ     *ZERO
     C* No aplica la novedad
     C*PASAR ZINDIC '0'
     C                   MOVEL     '0'           ZINDIC
     C*FIN
     C                   END
     C*
     C*
     C* Calcula último salario
     C*EJECUTAR M14049
     C                   EXSR      M14049
     C*
     C* Ind. de encontró registro
     C*SI ZINDIC = '1'
     C     ZINDIC        IFEQ      '1'
     C* Procesa nov. de ingreso (cont..)
     C*EJECUTAR M14044
     C                   EXSR      M14044
     C*SINO
     C                   ELSE
     C* Verificación y creación de contrato
     C*EJECUTAR M00110
     C                   EXSR      M00110
     C* Recupera registro
     C*EJECUTAR M14047
     C                   EXSR      M14047
     C* Encontró relación
     C*SI ZINDIC = '1'
     C     ZINDIC        IFEQ      '1'
     C* Actualiza datos registro
     C*EJECUTAR M14048
     C                   EXSR      M14048
     C* Actualiza relación afiliado empleador(cont...)
     C*EJECUTAR M14041
     C                   EXSR      M14041
     C* Estado relac. afil-emplead
     C*SI AFIEST = 'INA'
     C     AFIEST        IFEQ      'INA'
     C* Graba area local de datos
     C*FUNCION QGRAALD (ZFUEIN 160 3)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZFUEIN        PARM      ZFUEIN        F$2Z1           250
     C                   PARM      160           F$2Z2             4 0
     C                   PARM      3             F$2Z3             4 0
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Inactivar rel. con novedad O
     C*SI ZINARE = '1'
     C     ZINARE        IFEQ      '1'
     C* Actualiza datos registro
     C*EJECUTAR M14048
     C                   EXSR      M14048
     C* Actualiza rel. A-E (cont...)
     C*EJECUTAR M14041
     C                   EXSR      M14041
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesa novedad de ingreso (continua M14043)                ==
     C*==                                                              ==
     C*==================================================================
     C     M14044        BEGSR
     C*LIMPIAR ZPER02
     C                   CLEAR                   ZPER02
     C* Siempre agregar relaciones
     C*MOVER ZSIAGR 1
     C                   Z-ADD     1             ZSIAGR
     C*SI Z12541=1 Y ZGNCON='S' Y ZTIPLA='02' Y ZNOING='X'
     C     Z12541        IFEQ      1
     C     ZGNCON        ANDEQ     'S'
     C     ZTIPLA        ANDEQ     '02'
     C     ZNOING        ANDEQ     'X'
     C* Verifica relación igual
     C*INICIARI AFIAR2 (AFINU3 AFICO7 ZFECPE)
     C     LL$075        KLIST
     C                   KFLD                    AFINU3
     C                   KFLD                    AFICO7
     C                   KFLD                    ZFECPE
     C     LL$075        SETLL     AFIAR2                                 86
     C     *IN86         IFEQ      '1'
     C                   MOVE      '0'           *IN86
     C                   ELSE
     C                   MOVE      '1'           *IN86
     C                   END
     C* Existe relación para afi, emp0 y fe
     C*SI ERE (AFIAR2)
     C     *IN86         IFEQ      '0'
     C* Relación existe como voluntaria
     C*SI AFIT17='4'
     C     AFIT17        IFEQ      '4'
     C* Relación pasa a ser '2' Independien
     C*PASAR AFIT17 '2'
     C                   MOVEL     '2'           AFIT17
     C* Fecha última modificación
     C*PASAR AFIF01 ZFESIS
     C                   MOVEL     ZFESIS        AFIF01
     C* Último salario
     C*MOVER AFIULT ZSALAR
     C                   Z-ADD     ZSALAR        AFIULT
     C*SI AFIME1=*BLANCO O AFIME1>ZPERCO
     C     AFIME1        IFEQ      *BLANK
     C     AFIME1        ORGT      ZPERCO
     C* Mes que devenga primer aporte
     C*PASAR AFIME1 ZPERCO
     C                   MOVEL     ZPERCO        AFIME1
     C*FIN
     C                   END
     C*OBTENER (0) ZFECPA = ZPERCO || '01'
     C                   CLEAR                   ZFECPA
     C     ZPERCO        CAT       '01':0        ZFECPA
     C* Calcula fecha planilla + 1 mes
     C*F QSUMME1 (ZFECPA 1 ZFECPA)
     C                   CALL      'RPSUMME1'                                   QSUMME1
     C     ZFECPA        PARM      ZFECPA        F$4O1             8
     C                   PARM      1             F$4O2             8 0
     C     ZFECPA        PARM      ZFECPA        F$4O3             8
     C* Periodo de primer pago
     C*PASAR ZPER02 ZFECPA
     C                   MOVEL     ZFECPA        ZPER02
     C*SI AFIME2=*BLANCO O AFIME2>ZPER02
     C     AFIME2        IFEQ      *BLANK
     C     AFIME2        ORGT      ZPER02
     C* Mes de pago primer aporte
     C*PASAR AFIME2 ZPER02
     C                   MOVEL     ZPER02        AFIME2
     C*FIN
     C                   END
     C*SI AFIUL2=*BLANCO O AFIUL2<ZPERCO
     C     AFIUL2        IFEQ      *BLANK
     C     AFIUL2        ORLT      ZPERCO
     C* Último periodo bien cotizado
     C*PASAR AFIUL2 ZPERCO
     C                   MOVEL     ZPERCO        AFIUL2
     C*FIN
     C                   END
     C*SI AFIUL6=*BLANCO O AFIUL6<ZPERCO
     C     AFIUL6        IFEQ      *BLANK
     C     AFIUL6        ORLT      ZPERCO
     C* Último periodo acreditado
     C*PASAR AFIUL6 ZPERCO
     C                   MOVEL     ZPERCO        AFIUL6
     C*FIN
     C                   END
     C*SI AFIPR4=*BLANCO O AFIPR4>ZPERCO
     C     AFIPR4        IFEQ      *BLANK
     C     AFIPR4        ORGT      ZPERCO
     C* Primer periodo acreditado
     C*PASAR AFIPR4 ZPERCO
     C                   MOVEL     ZPERCO        AFIPR4
     C*FIN
     C                   END
     C* Numero de periodos cotizados
     C*SUMAR 1 AFIPE3
     C                   ADD       1             AFIPE3
     C* Actualiza la relación
     C*GRABAR AFIAR1
     C     *IN37         IFEQ      '0'
     C                   UPDATE    AFIRE1                               94
     C                   ELSE
     C                   WRITE     AFIRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Ya no se agrega nueva relación emp0
     C*LIMPIAR ZSIAGR
     C                   CLEAR                   ZSIAGR
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSIAGR=1
     C     ZSIAGR        IFEQ      1
     C* Número asignado afiliado
     C*MOVER AFINU3 AFINUM
     C                   Z-ADD     AFINUM        AFINU3
     C* Código interno del empleador
     C*MOVER AFICO7 ZCODEM
     C                   Z-ADD     ZCODEM        AFICO7
     C*SI ZSUCPR = *BLANCO O ZSUCPR = '0000000000'
     C     ZSUCPR        IFEQ      *BLANK
     C     ZSUCPR        OREQ      $HIL(054)
     C*INICIARI EMPAR204 (PLANU4)
     C     PLANU4        SETLL     EMPAR204                               58
     C     *IN58         IFEQ      '1'
     C                   MOVE      '0'           *IN58
     C                   ELSE
     C                   MOVE      '1'           *IN58
     C                   END
     C* Empleadores del sistema
     C*SI ERE(EMPAR204)
     C     *IN58         IFEQ      '0'
     C*LEER EMPAR204
     C                   READ      EMPAR204                               58
     C* Código sucursal principal
     C*PASAR ZSUCPR EMPCOS
     C                   MOVEL     EMPCOS        ZSUCPR
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Código sucursal principal
     C*PASAR AFISUC ZSUCPR
     C                   MOVEL     ZSUCPR        AFISUC
     C* Fecha inicio de la relación
     C*PASAR AFIFE9 ZFECPE
     C                   MOVEL     ZFECPE        AFIFE9
     C* Identificación del afiliado
     C*MOVER AFIC24 DETNU2
     C                   Z-ADD     DETNU2        AFIC24
     C* Estado de la relación
     C*PASAR AFIEST 'ACT'
     C                   MOVEL     'ACT'         AFIEST
     C* Último salario
     C*MOVER AFIULT ZSALAR
     C                   Z-ADD     ZSALAR        AFIULT
     C* Fecha generación del registro
     C*PASAR AFIF01 ZFESIS
     C                   MOVEL     ZFESIS        AFIF01
     C* Tarifa alto riesgo
     C*MOVER AFITAR DETTAR
     C                   Z-ADD     DETTAR        AFITAR
     C* Codigo sucursal
     C*PASAR AFIC08 PLAC11
     C                   MOVEL     PLAC11        AFIC08
     C* Tipo de identificacion
     C*PASAR AFITI4 DETTI2
     C                   MOVEL     DETTI2        AFITI4
     C*LIMPIAR AFIFE5 AFIIN8 AFINOM ZCONRE AFIN13
     C                   CLEAR                   AFIFE5
     C                   CLEAR                   AFIIN8
     C                   CLEAR                   AFINOM
     C                   CLEAR                   ZCONRE
     C                   CLEAR                   AFIN13
     C*LIMPIAR AFIOR2 AFIU13 AFIF63 AFIC82
     C                   CLEAR                   AFIOR2
     C                   CLEAR                   AFIU13
     C                   CLEAR                   AFIF63
     C                   CLEAR                   AFIC82
     C* Calcular consecutivo relación
     C*LLAMAR TRAFEM5D (AFINUM ZCODEM ZCONRE)
     C                   CALL      'TRAFEM5D'
     C                   PARM                    AFINUM
     C                   PARM                    ZCODEM
     C                   PARM                    ZCONRE
     C* Relación debe crearse cerrada
     C*SI ZFEINX=*BLANCO Y ZFEINY<>*BLANCO
     C     ZFEINX        IFEQ      *BLANK
     C     ZFEINY        ANDNE     *BLANK
     C* Calcula fecha término contrato
     C*EJECUTAR M14058
     C                   EXSR      M14058
     C* Estado de la relación
     C*PASAR AFIEST 'INA'
     C                   MOVEL     'INA'         AFIEST
     C*FIN
     C                   END
     C* Consecutivo de relación
     C*MOVER AFIC80 ZCONRE
     C                   Z-ADD     ZCONRE        AFIC80
     C* Origen de creación
     C*PASAR AFIOR1 '01'
     C                   MOVEL     '01'          AFIOR1
     C* Relación inválida
     C*PASAR AFII30 'N'
     C                   MOVEL     'N'           AFII30
     C* Origen de cierre
     C*LIMPIAR AFIOR2
     C                   CLEAR                   AFIOR2
     C* Planilla de cooperados
     C*SI ZTIPLA = '08'
     C     ZTIPLA        IFEQ      '08'
     C* Ind. afiliado cooperado
     C*PASAR AFII29 'S'
     C                   MOVEL     'S'           AFII29
     C*SINO
     C                   ELSE
     C* Ind. afiliado cooperado
     C*PASAR AFII29 'N'
     C                   MOVEL     'N'           AFII29
     C*FIN
     C                   END
     C* Usuario de creación
     C*PASAR AFIU14 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        AFIU14
     C* Fecha del sistema creación
     C*PASAR AFIF64 ZFESIS
     C                   MOVEL     ZFESIS        AFIF64
     C* Hora de creación sistema
     C*PASAR AFIH01 ZHOR
     C                   MOVEL     ZHOR          AFIH01
     C* Indicador de Siafp
     C*PASAR AFII31 '1'
     C                   MOVEL     '1'           AFII31
     C*Independientes
     C*CASO ZTIPLA='02' O ZTIPLA='07' Y PLAT03<>'08' Y PLAT03<>'13' Y PL
     C                   SELECT
     C     ZTIPLA        WHENEQ    '02'
     C     ZTIPLA        OREQ      '07'
     C     PLAT03        ANDNE     '08'
     C     PLAT03        ANDNE     '13'
     C     PLAT03        ANDNE     '14'
     C* Tipo de plan. ind.
     C*SI ZTIPLA = '02' O PLAT03='07'
     C     ZTIPLA        IFEQ      '02'
     C     PLAT03        OREQ      '07'
     C* Estado de la relación
     C*PASAR AFIEST 'INA'
     C                   MOVEL     'INA'         AFIEST
     C*FIN
     C                   END
     C* Tipo de afiliado
     C*PASAR AFIT17 '2'
     C                   MOVEL     '2'           AFIT17
     C*SI ZTIPLA='07' Y PLAT03='07' O ZTIPLA='02' Y PLAT03='01' Y ZTIPLP
     C     ZTIPLA        IFEQ      '07'
     C     PLAT03        ANDEQ     '07'
     C     ZTIPLA        OREQ      '02'
     C     PLAT03        ANDEQ     '01'
     C     ZTIPLP        ANDEQ     'I'
     C     ZTICOP        ANDEQ     59
     C*LIMPIAR $$CNAF
     C                   CLEAR                   $$CNAF
     C* Código interno del afiliado
     C*MOVER ZCNN22 AFINU3
     C                   Z-ADD     AFINU3        ZCNN22
     C* Tipo de identificación
     C*PASAR ZCNT37 PLATI1
     C                   MOVEL     PLATI1        ZCNT37
     C* Número identificación del t
     C*MOVER ZCNN23 PLANU4
     C                   Z-ADD     PLANU4        ZCNN23
     C* Consecutivo contrato
     C*MOVER ZCNC48 *CERO
     C                   MOVE      *ZERO         ZCNC48
     C* Tipo de contrato
     C*PASAR ZCNT38 '1'
     C                   MOVEL     '1'           ZCNT38
     C* Fecha inicio del contrato
     C*OBTENER ZCNF84 = PLAPER || '01'
     C     PLAPER        CAT       '01'          ZCNF84
     C* Fecha fin contrato
     C*LLAMAR TRULTDIA (ZCNF84 ZCNF85)
     C                   CALL      'TRULTDIA'
     C                   PARM                    ZCNF84
     C                   PARM                    ZCNF85
     C* Valor del contrato
     C*MOVER ZCNV18 DETSAL
     C                   Z-ADD     DETSAL        ZCNV18
     C* Ingreso base cotización
     C*MOVER ZCNIBC DETSAL
     C                   Z-ADD     DETSAL        ZCNIBC
     C* Novedad de retiro
     C*PASAR ZCNNOV *BLANCO
     C                   MOVEL     *BLANK        ZCNNOV
     C* Fecha creación
     C*PASAR ZCNF86 ZFESIS
     C                   MOVEL     ZFESIS        ZCNF86
     C* Usuario creación
     C*PASAR ZCNU25 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        ZCNU25
     C* Indicador de vigencia de SI
     C*PASAR ZCNI15 '1'
     C                   MOVEL     '1'           ZCNI15
     C* Hora de creación
     C*F QHORA (ZCNH16)
     C                   CALL      'F012SNAP'                                   QHORA
     C     ZCNH16        PARM      ZCNH16        F$301             6
     C* Campo FILLER/extra para reconstruc
     C*PASAR ZCNFIL *BLANCO
     C                   MOVEL     *BLANK        ZCNFIL
     C* Acción Actualizar
     C*PASAR ZCNACC 'A'
     C                   MOVEL     'A'           ZCNACC
     C* Ind. de error (0:No Error, 1:Error)
     C*PASAR ZCNERR *BLANCO
     C                   MOVEL     *BLANK        ZCNERR
     C* Error que retorna SQL
     C*MOVER ZCNSQL *CERO
     C                   MOVE      *ZERO         ZCNSQL
     C* Genera contrato
     C*LLAMAR TRCNAF52 ($$CNAF)
     C                   CALL      'TRCNAF52'
     C                   PARM                    $$CNAF
     C* Acción Actualizar
     C*PASAR ZCNACC 'F'
     C                   MOVEL     'F'           ZCNACC
     C* Genera contrato
     C*LLAMAR TRCNAF52 ($$CNAF)
     C                   CALL      'TRCNAF52'
     C                   PARM                    $$CNAF
     C*SI ZCNF84 <> *BLANCO
     C     ZCNF84        IFNE      *BLANK
     C* Fecha inicio de la relación
     C*PASAR AFIFE9 ZCNF84
     C                   MOVEL     ZCNF84        AFIFE9
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* 1er día del período de cot.
     C*OBTENER (0) ZFEPER = PLAPER || '01'
     C                   CLEAR                   ZFEPER
     C     PLAPER        CAT       '01':0        ZFEPER
     C* Fecha término según contratos
     C*LLAMAR TRAFEM70(AFINU3 ZFEPER AFIFE5)
     C                   CALL      'TRAFEM70'
     C                   PARM                    AFINU3
     C                   PARM                    ZFEPER
     C                   PARM                    AFIFE5
     C*SI AFIFE5 = *BLANCO Y AFIEST = 'INA' O AFIFE5 < ZFEPER Y AFIEST =
     C     AFIFE5        IFEQ      *BLANK
     C     AFIEST        ANDEQ     'INA'
     C     AFIFE5        ORLT      ZFEPER
     C     AFIEST        ANDEQ     'INA'
     C*LIMPIAR AFIFE5
     C                   CLEAR                   AFIFE5
     C*EJECUTAR M14058
     C                   EXSR      M14058
     C*FIN
     C                   END
     C* Fecha término dif. blanco
     C*SI AFIFE5 != *BLANCO
     C     AFIFE5        IFNE      *BLANK
     C* Origen del cierre
     C*PASAR AFIOR2 '01'
     C                   MOVEL     '01'          AFIOR2
     C*FIN
     C                   END
     C* Fecha de inactivación
     C*PASAR AFIF63 ZFESIS
     C                   MOVEL     ZFESIS        AFIF63
     C* Usuario de inactivación
     C*PASAR AFIU13 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        AFIU13
     C* Voluntario y Terceros Vol.
     C*CASO ZTIPLA='03' O ZTIPLA='07'
     C     ZTIPLA        WHENEQ    '03'
     C     ZTIPLA        OREQ      '07'
     C* Tipo de afiliado
     C*PASAR AFIT17 '4'
     C                   MOVEL     '4'           AFIT17
     C* Estado de la relación
     C*PASAR AFIEST 'INA'
     C                   MOVEL     'INA'         AFIEST
     C* Colocar fecha term. contrato
     C*SI ZFIRVO = '1'
     C     ZFIRVO        IFEQ      '1'
     C* Fecha fin del contrato
     C*EJECUTAR M14058
     C                   EXSR      M14058
     C*FIN
     C                   END
     C* Fecha fin dif. blanco
     C*SI AFIFE5 != *BLANCO
     C     AFIFE5        IFNE      *BLANK
     C* Origen del cierre
     C*PASAR AFIOR2 '01'
     C                   MOVEL     '01'          AFIOR2
     C*FIN
     C                   END
     C* Fecha de inactivación
     C*PASAR AFIF63 ZFESIS
     C                   MOVEL     ZFESIS        AFIF63
     C* Usuario de inactivación
     C*PASAR AFIU13 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        AFIU13
     C*SINO
     C                   OTHER
     C* Tipo de afiliado
     C*PASAR AFIT17 '1'
     C                   MOVEL     '1'           AFIT17
     C*FINCASOS
     C                   ENDSL
     C* Procesa nov. ingreso (cont..)
     C*EJECUTAR M14046
     C                   EXSR      M14046
     C*SI ZNOING = 'X' Y ZNORET='X' O ZNOING='X' Y ZPERCO<ZPEAIR Y ZR342
     C     ZNOING        IFEQ      'X'
     C     ZNORET        ANDEQ     'X'
     C     ZNOING        OREQ      'X'
     C     ZPERCO        ANDLT     ZPEAIR
     C     ZR3422        ANDEQ     1
     C* Estado de la relación
     C*ASIGNAR AFIEST 'INA'
     C                   MOVEL     'INA'         AFIEST
     C* Fecha fin del contrato
     C*EJECUTAR M14058
     C                   EXSR      M14058
     C*SI AFIFE5 != *BLANCO
     C     AFIFE5        IFNE      *BLANK
     C* Origen del cierre
     C*PASAR AFIOR2 '01'
     C                   MOVEL     '01'          AFIOR2
     C*FIN
     C                   END
     C* Fecha de inactivación
     C*PASAR AFIF63 ZFESIS
     C                   MOVEL     ZFESIS        AFIF63
     C* Usuario de inactivación
     C*PASAR AFIU13 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        AFIU13
     C*FIN
     C                   END
     C* Estad relac. afil-emplead
     C*SI AFIEST = 'INA'
     C     AFIEST        IFEQ      'INA'
     C* Ind. area local de datos
     C*FUNCION QGRAALD (ZFUEIN 160 3)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZFUEIN        PARM      ZFUEIN        F$2Z1           250
     C                   PARM      160           F$2Z2             4 0
     C                   PARM      3             F$2Z3             4 0
     C*FIN
     C                   END
     C*
     C* Existe BUC
     C*SI ZDESDB = 'S'
     C     ZDESDB        IFEQ      'S'
     C* Sucursal empleador
     C*LIMPIAR AFISUC ZCONSU
     C                   CLEAR                   AFISUC
     C                   CLEAR                   ZCONSU
     C* Consecutivo de sucursal
     C*FUNCION QGRAALD (ZCONSU 163 5)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZCONSU        PARM      ZCONSU        F$2Z1           250
     C                   PARM      163           F$2Z2             4 0
     C                   PARM      5             F$2Z3             4 0
     C*FIN
     C                   END
     C* Depura dup A-E volunt
     C*EJECUTAR M00119
     C                   EXSR      M00119
     C*SI ZEXREG = '0'
     C     ZEXREG        IFEQ      '0'
     C*INICIARI AFIAR2 (AFINU3 AFICO7 AFIFE9)
     C     LL$076        KLIST
     C                   KFLD                    AFINU3
     C                   KFLD                    AFICO7
     C                   KFLD                    AFIFE9
     C     LL$076        SETLL     AFIAR2                                 86
     C     *IN86         IFEQ      '1'
     C                   MOVE      '0'           *IN86
     C                   ELSE
     C                   MOVE      '1'           *IN86
     C                   END
     C*SI ERE (AFIAR2)
     C     *IN86         IFEQ      '0'
     C*MIENTRAS ERE (AFIAR2)
     C     *IN86         DOWEQ     '0'
     C* FECHA INICIO DE RELACIÒN
     C*FUNCION QSUMDI1 (AFIFE9 1 AFIFE9)
     C                   CALL      'RPSUMDI1'                                   QSUMDI1
     C     AFIFE9        PARM      AFIFE9        F$4L1             8
     C                   PARM      1             F$4L2             5 0
     C     AFIFE9        PARM      AFIFE9        F$4L3             8
     C*INICIARI AFIAR2 (AFINU3 AFICO7 AFIFE9)
     C     LL$077        KLIST
     C                   KFLD                    AFINU3
     C                   KFLD                    AFICO7
     C                   KFLD                    AFIFE9
     C     LL$077        SETLL     AFIAR2                                 86
     C     *IN86         IFEQ      '1'
     C                   MOVE      '0'           *IN86
     C                   ELSE
     C                   MOVE      '1'           *IN86
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Relac afil-emlpead
     C*AGREGAR AFIAR1
     C                   WRITE     AFIRE1                               94
     C                   MOVE      *IN94         I$DUP
     C* ind corres ilocalizable y indep
     C*SI AFIIN6 = '5' Y AFIT17='1'
     C     AFIIN6        IFEQ      '5'
     C     AFIT17        ANDEQ     '1'
     C* tipo transaccion
     C*SI ZOVCO1 = '02'
     C     ZOVCO1        IFEQ      '02'
     C*CASO ZOVTIP='31' O ZOVTIP='32' O ZOVTIP='34' O ZOVTIP='35' O ZOVT
     C                   SELECT
     C     ZOVTIP        WHENEQ    '31'
     C     ZOVTIP        OREQ      '32'
     C     ZOVTIP        OREQ      '34'
     C     ZOVTIP        OREQ      '35'
     C     ZOVTIP        OREQ      '71'
     C     ZOVTIP        OREQ      '72'
     C*SI PLAT03!='06' Y PLATIP != '05'
     C     PLAT03        IFNE      '06'
     C     PLATIP        ANDNE     '05'
     C*FUNCION QRESME1 (HISFE3 INDMRA ZFETMP)
     C                   CALL      'RPRESME1'                                   QRESME1
     C     HISFE3        PARM      HISFE3        F$4D1             8
     C     INDMRA        PARM      INDMRA        F$4D2             8 0
     C     ZFETMP        PARM      ZFETMP        F$4D3             8
     C* Periodo fecha restada
     C*PASAR ZPERT2 ZFETMP
     C                   MOVEL     ZFETMP        ZPERT2
     C* Periodo fecha fondo
     C*PASAR ZPERT1 HISFE3
     C                   MOVEL     HISFE3        ZPERT1
     C* Esta en rango
     C*SI ZOVPER >= ZPERT2 Y ZOVPER <= ZPERT1
     C     ZOVPER        IFGE      ZPERT2
     C     ZOVPER        ANDLE     ZPERT1
     C* Llena registro
     C*LLAMAR TRAFIC51 (AFINU3 AFICO7 AFIFE9)
     C                   CALL      'TRAFIC51'
     C                   PARM                    AFINU3
     C                   PARM                    AFICO7
     C                   PARM                    AFIFE9
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*CASO ZOVTIP='74' O ZOVTIP='75' O ZOVTIP='91' O ZOVTIP='92' O ZOVT
     C     ZOVTIP        WHENEQ    '74'
     C     ZOVTIP        OREQ      '75'
     C     ZOVTIP        OREQ      '91'
     C     ZOVTIP        OREQ      '92'
     C     ZOVTIP        OREQ      '94'
     C     ZOVTIP        OREQ      '95'
     C*SI PLAT03!='06' Y PLATIP != '05'
     C     PLAT03        IFNE      '06'
     C     PLATIP        ANDNE     '05'
     C*FUNCION QRESME1 (HISFE3 INDMRA ZFETMP)
     C                   CALL      'RPRESME1'                                   QRESME1
     C     HISFE3        PARM      HISFE3        F$4D1             8
     C     INDMRA        PARM      INDMRA        F$4D2             8 0
     C     ZFETMP        PARM      ZFETMP        F$4D3             8
     C* Periodo fecha restada
     C*PASAR ZPERT2 ZFETMP
     C                   MOVEL     ZFETMP        ZPERT2
     C* Periodo fecha fondo
     C*PASAR ZPERT1 HISFE3
     C                   MOVEL     HISFE3        ZPERT1
     C* Esta en rango
     C*SI ZOVPER >= ZPERT2 Y ZOVPER <= ZPERT1
     C     ZOVPER        IFGE      ZPERT2
     C     ZOVPER        ANDLE     ZPERT1
     C* Llena registro
     C*LLAMAR TRAFIC51 (AFINU3 AFICO7 AFIFE9)
     C                   CALL      'TRAFIC51'
     C                   PARM                    AFINU3
     C                   PARM                    AFICO7
     C                   PARM                    AFIFE9
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FINCASOS
     C                   ENDSL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Proceso de comisiones circular 040 mayo 12 del 2000
     C* Indicador cobro cesantes
     C*LIMPIAR ZINDCE
     C                   CLEAR                   ZINDCE
     C* Período > vigencia de cesantes
     C*SI ZPERCO >= ZPEVIG
     C     ZPERCO        IFGE      ZPEVIG
     C* Indicador de cobro rev cesantes
     C*PASAR ZINDCE 'S'
     C                   MOVEL     'S'           ZINDCE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcula fecha inicio de la relación                         ==
     C*==                                                              ==
     C*==================================================================
     C     M14045        BEGSR
     C*MOVER ZMES ZPERCO
     C                   MOVE      ZPERCO        ZMES
     C*SI ZMES = '02'
     C     ZMES          IFEQ      '02'
     C* Año del periodo
     C*PASAR ZANOPE ZPERCO
     C                   MOVEL     ZPERCO        ZANOPE
     C*CALCULAR ZANOBI = ZANOPE / 4
     C     ZANOPE        DIV       4             ZANOBI
     C* Se determina año bisiesto
     C*CALCULAR ZANOBI = ZANOBI * 4
     C     ZANOBI        MULT      4             ZANOBI
     C* Si el año es bisiesto
     C*SI ZANOPE = ZANOBI
     C     ZANOPE        IFEQ      ZANOBI
     C* Días del mes son 29
     C*MOVER ZDIAME 29
     C                   Z-ADD     29            ZDIAME
     C*SINO
     C                   ELSE
     C*MOVER ZDIAME 28
     C                   Z-ADD     28            ZDIAME
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI ZMES = '04' O ZMES = '06' O ZMES = '09' O ZMES = '11'
     C     ZMES          IFEQ      '04'
     C     ZMES          OREQ      '06'
     C     ZMES          OREQ      '09'
     C     ZMES          OREQ      '11'
     C*MOVER ZDIAME 30
     C                   Z-ADD     30            ZDIAME
     C*SINO
     C                   ELSE
     C*MOVER ZDIAME 31
     C                   Z-ADD     31            ZDIAME
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C*CALCULAR ZDIATO=ZDITRA+ZDILIC
     C     ZDITRA        ADD       ZDILIC        ZDIATO
     C*SI ZDIAME = ZDIATO O ZDIATO >= 30
     C     ZDIAME        IFEQ      ZDIATO
     C     ZDIATO        ORGE      30
     C*OBTENER ZFECPE = ZPERCO || '01'
     C     ZPERCO        CAT       '01'          ZFECPE
     C*SINO
     C                   ELSE
     C*SI ZDIATO != *CERO
     C     ZDIATO        IFNE      *ZERO
     C* Pasa los días a alfa
     C*ASIGNAR ZDIASM ZDIAME
     C                   MOVEL     ZDIAME        ZDIASM
     C*OBTENER ZFECPE = ZPERCO || ZDIASM
     C     ZPERCO        CAT       ZDIASM        ZFECPE
     C*SI ZDIASM = '28' Y ZDIATO = 29
     C     ZDIASM        IFEQ      '28'
     C     ZDIATO        ANDEQ     29
     C*RESTAR 2 ZDIATO
     C                   SUB       2             ZDIATO
     C*SINO
     C                   ELSE
     C* Número de días cotizados
     C*RESTAR 1 ZDIATO
     C                   SUB       1             ZDIATO
     C*FIN
     C                   END
     C*FUNCION QRESDI1 (ZFECPE ZDIATO ZFECPE)
     C                   CALL      'RPRESDI1'                                   QRESDI1
     C     ZFECPE        PARM      ZFECPE        F$431             8
     C     ZDIATO        PARM      ZDIATO        F$432             5 0
     C     ZFECPE        PARM      ZFECPE        F$433             8
     C*SI ZDIASM = '28' Y ZDIATO = 29
     C     ZDIASM        IFEQ      '28'
     C     ZDIATO        ANDEQ     29
     C*SUMAR 2 ZDIATO
     C                   ADD       2             ZDIATO
     C*SINO
     C                   ELSE
     C* Número de dias cotizados
     C*SUMAR 1 ZDIATO
     C                   ADD       1             ZDIATO
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (0) ZFECPE = ZPERCO || '01'
     C                   CLEAR                   ZFECPE
     C     ZPERCO        CAT       '01':0        ZFECPE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesa novedad de ingreso (continua M14044)                ==
     C*==                                                              ==
     C*==================================================================
     C     M14046        BEGSR
     C*CALCULAR ZDIATO=ZDITRA+ZDILIC
     C     ZDITRA        ADD       ZDILIC        ZDIATO
     C* Número meses a restar o sumar
     C*MOVER ZNUME1 1
     C                   Z-ADD     1             ZNUME1
     C* Dias trabajados
     C*SI ZDIATO != *CERO
     C     ZDIATO        IFNE      *ZERO
     C* Último periodo bien cotizado
     C*PASAR AFIUL2 ZPERCO
     C                   MOVEL     ZPERCO        AFIUL2
     C* Mes que devenga primer aport
     C*ASIGNAR AFIME1 ZPERCO
     C                   MOVEL     ZPERCO        AFIME1
     C*LIMPIAR ZRENTR ZERRO2 ZFECPA
     C                   CLEAR                   ZRENTR
     C                   CLEAR                   ZERRO2
     C                   CLEAR                   ZFECPA
     C*OBTENER (0) ZFECPA = ZPERCO || '01'
     C                   CLEAR                   ZFECPA
     C     ZPERCO        CAT       '01':0        ZFECPA
     C*F QSUMME1 (ZFECPA 1 ZFECPA)
     C                   CALL      'RPSUMME1'                                   QSUMME1
     C     ZFECPA        PARM      ZFECPA        F$4O1             8
     C                   PARM      1             F$4O2             8 0
     C     ZFECPA        PARM      ZFECPA        F$4O3             8
     C* Mes de pago primer aporte
     C*ASIGNAR AFIME2 ZFECPA
     C                   MOVEL     ZFECPA        AFIME2
     C* Numero de periodos cotizados
     C*MOVER AFIPE3 1
     C                   Z-ADD     1             AFIPE3
     C* Último periodo acreditado
     C*PASAR AFIUL6 ZPERCO
     C                   MOVEL     ZPERCO        AFIUL6
     C* Primer periodo acreditado
     C*PASAR AFIPR4 ZPERCO
     C                   MOVEL     ZPERCO        AFIPR4
     C*SINO
     C                   ELSE
     C* Último periodo bien acreditado
     C*PASAR AFIUL2 *BLANCO
     C                   MOVEL     *BLANK        AFIUL2
     C* Mes que devenga primer aport
     C*PASAR AFIME1 ZFECPE
     C                   MOVEL     ZFECPE        AFIME1
     C*PASAR ZFECPA ZFECPE
     C                   MOVEL     ZFECPE        ZFECPA
     C*F QSUMME1 (ZFECPA 1 ZFECPA)
     C                   CALL      'RPSUMME1'                                   QSUMME1
     C     ZFECPA        PARM      ZFECPA        F$4O1             8
     C                   PARM      1             F$4O2             8 0
     C     ZFECPA        PARM      ZFECPA        F$4O3             8
     C* Mes de pago primer aporte
     C*ASIGNAR AFIME2 ZFECPA
     C                   MOVEL     ZFECPA        AFIME2
     C* Número de períodos cotizados
     C*MOVER AFIPE3 *CERO
     C                   MOVE      *ZERO         AFIPE3
     C* Último período acreditado
     C*PASAR AFIUL6 *BLANCO
     C                   MOVEL     *BLANK        AFIUL6
     C* Primer período acreditado
     C*PASAR AFIPR4 *BLANCO
     C                   MOVEL     *BLANK        AFIPR4
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Recuperar registro relación afiliado empleador              ==
     C*==                                                              ==
     C*==================================================================
     C     M14047        BEGSR
     C*PASAR ZINDIC '0'
     C                   MOVEL     '0'           ZINDIC
     C*LIMPIAR ZFEINX ZFEINY ZPEINY
     C                   CLEAR                   ZFEINX
     C                   CLEAR                   ZFEINY
     C                   CLEAR                   ZPEINY
     C* Planilla indep/volunt/terc
     C*SI ZTIPLA='02' O ZTIPLA='03' O ZTIPLA='07'
     C     ZTIPLA        IFEQ      '02'
     C     ZTIPLA        OREQ      '03'
     C     ZTIPLA        OREQ      '07'
     C* Código int. empleador = 0
     C*MOVER ZCODEM *CERO
     C                   MOVE      *ZERO         ZCODEM
     C*SINO
     C                   ELSE
     C* Código interno empleador
     C*MOVER ZCODEM PLACOD
     C                   Z-ADD     PLACOD        ZCODEM
     C*FIN
     C                   END
     C* Verifica período válido
     C*EJECUTAR M00022
     C                   EXSR      M00022
     C* Verifica última relación laboral
     C*INICIARUI AFIAR1 (AFINUM ZCODEM)
     C     LL$078        KLIST
     C                   KFLD                    AFINUM
     C                   KFLD                    ZCODEM
     C     LL$078        SETLL     AFIAR1                                 37
     C     *IN37         IFEQ      '1'
     C     LL$078        SETGT     AFIAR1                             37
     C                   MOVE      '0'           *IN37
     C                   ELSE
     C                   MOVE      '1'           *IN37
     C                   END
     C* Encontró relación laboral
     C*SI ERE(AFIAR1)
     C     *IN37         IFEQ      '0'
     C* Lee relación laboral
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*MIENTRAS NFA(AFIAR1) Y AFINUM=AFINU3 Y ZCODEM=AFICO7 Y ZINDIC = '
     C     *IN37         DOWEQ     '0'
     C     AFINUM        ANDEQ     AFINU3
     C     ZCODEM        ANDEQ     AFICO7
     C     ZINDIC        ANDEQ     '0'
     C* Procesar relación
     C*PASAR ZT@PRO 'S'
     C                   MOVEL     'S'           ZT@PRO
     C*
     C* Relación inválida
     C*SI AFII30='S'
     C     AFII30        IFEQ      'S'
     C* Período no válido
     C*SI ZT@IPV='N'
     C     ZT@IPV        IFEQ      'N'
     C* No procesar relación
     C*PASAR ZT@PRO 'N'
     C                   MOVEL     'N'           ZT@PRO
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* No procesar relación
     C*SI ZT@PRO = 'N'
     C     ZT@PRO        IFEQ      'N'
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*SINO
     C                   ELSE
     C*
     C* Planilla de cooperado
     C*SI ZTIPLA='08' Y AFII29!='S'
     C     ZTIPLA        IFEQ      '08'
     C     AFII29        ANDNE     'S'
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*SINO
     C                   ELSE
     C* Período inicio relación
     C*PASAR ZPERIN AFIFE9
     C                   MOVEL     AFIFE9        ZPERIN
     C* Período fin relación
     C*PASAR ZPERFI AFIFE5
     C                   MOVEL     AFIFE5        ZPERFI
     C* Relación tiene fecha final
     C*SI ZPERFI|=*BLANCO
     C     ZPERFI        IFNE      *BLANK
     C*SI ZPERCO>=ZPERIN Y ZPERCO<=ZPERFI
     C     ZPERCO        IFGE      ZPERIN
     C     ZPERCO        ANDLE     ZPERFI
     C* Pl vol y rel<>vol
     C*CASO ZTIPLA='03' Y AFIT17<>'4'
     C                   SELECT
     C     ZTIPLA        WHENEQ    '03'
     C     AFIT17        ANDNE     '4'
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C* Pl ind. y Rel<>Ind
     C*CASO ZTIPLA='02' Y AFIT17<>'2'
     C     ZTIPLA        WHENEQ    '02'
     C     AFIT17        ANDNE     '2'
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C* Pl terceros y <> Agrem/Pensión T/Vol T. y Rel<>Ind
     C*CASO ZPLART='07' Y ZTPGRT<>'08' Y ZTPGRT<>'13' Y ZTPGRT<>'14' Y A
     C     ZPLART        WHENEQ    '07'
     C     ZTPGRT        ANDNE     '08'
     C     ZTPGRT        ANDNE     '13'
     C     ZTPGRT        ANDNE     '14'
     C     AFIT17        ANDNE     '2'
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*CASO ZTIPLA='07' Y PLAT03<>'08' Y PLAT03<>'13' Y PLAT03<>'14' Y A
     C     ZTIPLA        WHENEQ    '07'
     C     PLAT03        ANDNE     '08'
     C     PLAT03        ANDNE     '13'
     C     PLAT03        ANDNE     '14'
     C     AFIT17        ANDNE     '2'
     C     ZPLART        ANDEQ     *BLANK
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C* Pl Tercero y Rel<>Vol
     C*CASO ZTIPLA='07' Y AFIT17<>'4'
     C     ZTIPLA        WHENEQ    '07'
     C     AFIT17        ANDNE     '4'
     C*SI PLAT03='08' O PLAT03='13' O PLAT03='14' O ZTPGRT='08' O ZTPGRT
     C     PLAT03        IFEQ      '08'
     C     PLAT03        OREQ      '13'
     C     PLAT03        OREQ      '14'
     C     ZTPGRT        OREQ      '08'
     C     ZTPGRT        OREQ      '13'
     C     ZTPGRT        OREQ      '14'
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*SINO
     C                   ELSE
     C* Indicador encontró registro
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*LIMPIAR ZPERMN ZPERMY
     C                   CLEAR                   ZPERMN
     C                   CLEAR                   ZPERMY
     C*FIN
     C                   END
     C*SINO
     C                   OTHER
     C* Indicador encontró resgistro
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*LIMPIAR ZPERMN ZPERMY
     C                   CLEAR                   ZPERMN
     C                   CLEAR                   ZPERMY
     C*FINCASOS
     C                   ENDSL
     C*SINO
     C                   ELSE
     C* Tipo afiliado '1' y per<
     C*SI AFIT17='1' Y ZPERCO<ZPERIN
     C     AFIT17        IFEQ      '1'
     C     ZPERCO        ANDLT     ZPERIN
     C* Fechas iniciales relación dep/sit
     C*EJECUTAR M00160
     C                   EXSR      M00160
     C*FIN
     C                   END
     C* Pla dep,p>f
     C*SI AFIT17='1' Y ZPERCO>ZPERFI
     C     AFIT17        IFEQ      '1'
     C     ZPERCO        ANDGT     ZPERFI
     C* Pla dep,p>f
     C*SI ZTIPLA='01' O ZTIPLA='04'
     C     ZTIPLA        IFEQ      '01'
     C     ZTIPLA        OREQ      '04'
     C*PASAR ZPERMY '1'
     C                   MOVEL     '1'           ZPERMY
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LIMPIAR ZPLA07
     C                   CLEAR                   ZPLA07
     C*SI ZTIPLA='07' Y PLAT03='07' O ZPLART='07' Y ZTPGRT='07'
     C     ZTIPLA        IFEQ      '07'
     C     PLAT03        ANDEQ     '07'
     C     ZPLART        OREQ      '07'
     C     ZTPGRT        ANDEQ     '07'
     C* Viene planilla 07-07
     C*MOVER ZPLA07 1
     C                   Z-ADD     1             ZPLA07
     C*FIN
     C                   END
     C*LIMPIAR ZPLA02
     C                   CLEAR                   ZPLA02
     C*SI ZTIPLA='02' Y PLAT03='01'
     C     ZTIPLA        IFEQ      '02'
     C     PLAT03        ANDEQ     '01'
     C* Viene planilla 02-01
     C*MOVER ZPLA02 1
     C                   Z-ADD     1             ZPLA02
     C*FIN
     C                   END
     C*SI ZPLA07=1 O ZPLA02=1 O ZPLA02=1 Y ZTIPLP='I' Y ZTICOP=59 O ZPLA
     C     ZPLA07        IFEQ      1
     C     ZPLA02        OREQ      1
     C     ZPLA02        OREQ      1
     C     ZTIPLP        ANDEQ     'I'
     C     ZTICOP        ANDEQ     59
     C     ZPLA02        OREQ      1
     C     Z12541        ANDEQ     1
     C     ZGNCON        ANDEQ     'S'
     C*SI AFIT17='2' Y ZPERCO<ZPERIN
     C     AFIT17        IFEQ      '2'
     C     ZPERCO        ANDLT     ZPERIN
     C*LIMPIAR $$CNAF
     C                   CLEAR                   $$CNAF
     C* Código interno del afiliado
     C*MOVER ZCNN22 AFINU3
     C                   Z-ADD     AFINU3        ZCNN22
     C* Acción Actualizar
     C*PASAR ZCNACC 'F'
     C                   MOVEL     'F'           ZCNACC
     C* Genera contrato
     C*LLAMAR TRCNAF52 ($$CNAF)
     C                   CALL      'TRCNAF52'
     C                   PARM                    $$CNAF
     C*SI ZCNF84 <> *BLANCO
     C     ZCNF84        IFNE      *BLANK
     C* Primer periodo contrato
     C*PASAR ZPINCO ZCNF84
     C                   MOVEL     ZCNF84        ZPINCO
     C*SI ZCNF84 > AFIFE5  O ZPERCO < ZPINCO
     C     ZCNF84        IFGT      AFIFE5
     C     ZPERCO        ORLT      ZPINCO
     C* Primer día Periodo cotizado
     C*OBTENER (0) ZCNF84 = ZPERCO||'01'
     C                   CLEAR                   ZCNF84
     C     ZPERCO        CAT       '01':0        ZCNF84
     C*FIN
     C                   END
     C* Fecha último cambio
     C*PASAR AFIF01 ZFESIS
     C                   MOVEL     ZFESIS        AFIF01
     C* Fecha inicio de la relación
     C*PASAR AFIFE9 ZCNF84
     C                   MOVEL     ZCNF84        AFIFE9
     C* Primer período acreditado
     C*PASAR AFIPR4 ZCNF84
     C                   MOVEL     ZCNF84        AFIPR4
     C* Mes devengue primer aporte
     C*PASAR AFIME1 AFIFE9
     C                   MOVEL     AFIFE9        AFIME1
     C* Ultimo período bien cotizado
     C*PASAR AFIUL2 AFIFE9
     C                   MOVEL     AFIFE9        AFIUL2
     C*SI AFIUL6=*BLANCO O ZPERCO>AFIUL6
     C     AFIUL6        IFEQ      *BLANK
     C     ZPERCO        ORGT      AFIUL6
     C* Último periodo acreditado
     C*PASAR AFIUL6 ZPERCO
     C                   MOVEL     ZPERCO        AFIUL6
     C*FIN
     C                   END
     C* Acumula AFIPE3
     C*EJECUTAR M14098
     C                   EXSR      M14098
     C* Meses a sumar
     C*MOVER ZMESES 1
     C                   Z-ADD     1             ZMESES
     C* Sumar 1 mes a fecha inicio
     C*LLAMAR RPSUMME1(AFIFE9 ZMESES ZFECPR)
     C                   CALL      'RPSUMME1'
     C                   PARM                    AFIFE9
     C                   PARM                    ZMESES
     C                   PARM                    ZFECPR
     C* Pasar a mes de pago
     C*PASAR AFIME2 ZFECPR
     C                   MOVEL     ZFECPR        AFIME2
     C*GRABAR AFIAR1
     C     *IN37         IFEQ      '0'
     C                   UPDATE    AFIRE1                               94
     C                   ELSE
     C                   WRITE     AFIRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Indicador encontró resgistro
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZPLA07=1 O ZPLA02=1 Y ZTIPLP='I' Y ZTICOP=59 O ZPLA02=1 Y Z125
     C     ZPLA07        IFEQ      1
     C     ZPLA02        OREQ      1
     C     ZTIPLP        ANDEQ     'I'
     C     ZTICOP        ANDEQ     59
     C     ZPLA02        OREQ      1
     C     Z12541        ANDEQ     1
     C     ZGNCON        ANDEQ     'S'
     C* Pla dep,per>f
     C*SI AFIT17='2' Y ZPERCO>ZPERFI
     C     AFIT17        IFEQ      '2'
     C     ZPERCO        ANDGT     ZPERFI
     C*LIMPIAR $$CNAF
     C                   CLEAR                   $$CNAF
     C* Código interno del afiliado
     C*MOVER ZCNN22 AFINU3
     C                   Z-ADD     AFINU3        ZCNN22
     C* Acción Actualizar
     C*PASAR ZCNACC 'F'
     C                   MOVEL     'F'           ZCNACC
     C* Genera contrato
     C*LLAMAR TRCNAF52 ($$CNAF)
     C                   CALL      'TRCNAF52'
     C                   PARM                    $$CNAF
     C*SI ZCNF85 <> *BLANCO
     C     ZCNF85        IFNE      *BLANK
     C* Ultimo periodo contrato
     C*PASAR ZPFICO ZCNF85
     C                   MOVEL     ZCNF85        ZPFICO
     C*SI ZCNF85 < AFIFE9 O ZPERCO > ZPFICO
     C     ZCNF85        IFLT      AFIFE9
     C     ZPERCO        ORGT      ZPFICO
     C* Primer día Periodo cotizado
     C*OBTENER (0) ZCNF85 = ZPERCO||'01'
     C                   CLEAR                   ZCNF85
     C     ZPERCO        CAT       '01':0        ZCNF85
     C* Fecha fin contrato
     C*LLAMAR TRULTDIA (ZCNF85 ZCNF85)
     C                   CALL      'TRULTDIA'
     C                   PARM                    ZCNF85
     C                   PARM                    ZCNF85
     C*FIN
     C                   END
     C* Fecha último cambio
     C*PASAR AFIF01 ZFESIS
     C                   MOVEL     ZFESIS        AFIF01
     C* Ultimo período bien cotizado
     C*PASAR AFIUL2 ZCNF85
     C                   MOVEL     ZCNF85        AFIUL2
     C* Ultimo período bien ACR
     C*PASAR AFIUL6 ZCNF85
     C                   MOVEL     ZCNF85        AFIUL6
     C* Fecha fin
     C*PASAR AFIFE5 ZCNF85
     C                   MOVEL     ZCNF85        AFIFE5
     C* Actualiza campos relación
     C*EJECUTAR M14097
     C                   EXSR      M14097
     C* Acumula AFIPE3
     C*EJECUTAR M14098
     C                   EXSR      M14098
     C*GRABAR AFIAR1
     C     *IN37         IFEQ      '0'
     C                   UPDATE    AFIRE1                               94
     C                   ELSE
     C                   WRITE     AFIRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Indicador encontró resgistro
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZINDIC<>'1'
     C     ZINDIC        IFNE      '1'
     C* Lee relación laboral
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Periodo >= inicio relación
     C*SI ZPERCO>=ZPERIN
     C     ZPERCO        IFGE      ZPERIN
     C* Pl vol y rel<>vol
     C*CASO ZTIPLA='03' Y AFIT17<>'4'
     C                   SELECT
     C     ZTIPLA        WHENEQ    '03'
     C     AFIT17        ANDNE     '4'
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C* Pl ind. y Rel<>Ind
     C*CASO ZTIPLA='02' Y AFIT17<>'2'
     C     ZTIPLA        WHENEQ    '02'
     C     AFIT17        ANDNE     '2'
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C* Pl terceros y <> Agrem/Pensión T/Vol T. y Rel<>Ind
     C*CASO ZPLART='07' Y ZTPGRT<>'08' Y ZTPGRT<>'13' Y ZTPGRT<>'14' Y A
     C     ZPLART        WHENEQ    '07'
     C     ZTPGRT        ANDNE     '08'
     C     ZTPGRT        ANDNE     '13'
     C     ZTPGRT        ANDNE     '14'
     C     AFIT17        ANDNE     '2'
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*CASO ZTIPLA='07' Y PLAT03<>'08' Y PLAT03<>'13' Y PLAT03<>'14' Y A
     C     ZTIPLA        WHENEQ    '07'
     C     PLAT03        ANDNE     '08'
     C     PLAT03        ANDNE     '13'
     C     PLAT03        ANDNE     '14'
     C     AFIT17        ANDNE     '2'
     C     ZPLART        ANDEQ     *BLANK
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C* Pl Tercero y Rel<>Vol
     C*CASO ZTIPLA='07' Y AFIT17<>'4'
     C     ZTIPLA        WHENEQ    '07'
     C     AFIT17        ANDNE     '4'
     C* Tipo pago Agrem/Pensión T./Vol T.
     C*SI PLAT03='08' O PLAT03='13' O PLAT03='14' O ZTPGRT='08' O ZTPGRT
     C     PLAT03        IFEQ      '08'
     C     PLAT03        OREQ      '13'
     C     PLAT03        OREQ      '14'
     C     ZTPGRT        OREQ      '08'
     C     ZTPGRT        OREQ      '13'
     C     ZTPGRT        OREQ      '14'
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*SINO
     C                   ELSE
     C* Indicador encontró registro
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*LIMPIAR ZPERMN ZPERMY
     C                   CLEAR                   ZPERMN
     C                   CLEAR                   ZPERMY
     C*FIN
     C                   END
     C*SINO
     C                   OTHER
     C* Indicador encontró registro
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*LIMPIAR ZPERMN ZPERMY
     C                   CLEAR                   ZPERMN
     C                   CLEAR                   ZPERMY
     C*FINCASOS
     C                   ENDSL
     C*SINO
     C                   ELSE
     C* Si es voluntario corre la fecha inicio de la relación
     C* Vol
     C*SI ZTIPLA='03' Y AFIT17='4' O ZTIPLA='07' Y AFIT17='4'
     C     ZTIPLA        IFEQ      '03'
     C     AFIT17        ANDEQ     '4'
     C     ZTIPLA        OREQ      '07'
     C     AFIT17        ANDEQ     '4'
     C* Agrem/Pens
     C*SI PLATIP='03' O PLAT03='08' O PLAT03='13' O PLAT03='14' O ZTPGRT
     C     PLATIP        IFEQ      '03'
     C     PLAT03        OREQ      '08'
     C     PLAT03        OREQ      '13'
     C     PLAT03        OREQ      '14'
     C     ZTPGRT        OREQ      '08'
     C     ZTPGRT        OREQ      '13'
     C     ZTPGRT        OREQ      '14'
     C* Calcula fecha inicio
     C*EJECUTAR M14045
     C                   EXSR      M14045
     C* Fecha inicio de la relación
     C*PASAR AFIFE9 ZFECPE
     C                   MOVEL     ZFECPE        AFIFE9
     C* Fecha último cambio
     C*PASAR AFIF01 ZFESIS
     C                   MOVEL     ZFESIS        AFIF01
     C* Período devenga primer aporte
     C*PASAR AFIME1 ZPERCO
     C                   MOVEL     ZPERCO        AFIME1
     C* Mes de pago 1er aporte
     C*PASAR AFIME2 ZPERCO
     C                   MOVEL     ZPERCO        AFIME2
     C* Primer período acreditado
     C*PASAR AFIPR4 ZPERCO
     C                   MOVEL     ZPERCO        AFIPR4
     C*SI AFIUL6=*BLANCO O ZPERCO>AFIUL6
     C     AFIUL6        IFEQ      *BLANK
     C     ZPERCO        ORGT      AFIUL6
     C* Último periodo acreditado
     C*PASAR AFIUL6 ZPERCO
     C                   MOVEL     ZPERCO        AFIUL6
     C*FIN
     C                   END
     C* Acumula AFIPE3
     C*EJECUTAR M14098
     C                   EXSR      M14098
     C*INICIARI AFIAR2 (AFINU3 AFICO7 AFIFE9)
     C     LL$079        KLIST
     C                   KFLD                    AFINU3
     C                   KFLD                    AFICO7
     C                   KFLD                    AFIFE9
     C     LL$079        SETLL     AFIAR2                                 86
     C     *IN86         IFEQ      '1'
     C                   MOVE      '0'           *IN86
     C                   ELSE
     C                   MOVE      '1'           *IN86
     C                   END
     C*SI ERE (AFIAR2)
     C     *IN86         IFEQ      '0'
     C*MIENTRAS ERE (AFIAR2)
     C     *IN86         DOWEQ     '0'
     C* Fecha inicio
     C*FUNCION QSUMDI1 (AFIFE9 1 AFIFE9)
     C                   CALL      'RPSUMDI1'                                   QSUMDI1
     C     AFIFE9        PARM      AFIFE9        F$4L1             8
     C                   PARM      1             F$4L2             5 0
     C     AFIFE9        PARM      AFIFE9        F$4L3             8
     C*INICIARI AFIAR2 (AFINU3 AFICO7 AFIFE9)
     C     LL$080        KLIST
     C                   KFLD                    AFINU3
     C                   KFLD                    AFICO7
     C                   KFLD                    AFIFE9
     C     LL$080        SETLL     AFIAR2                                 86
     C     *IN86         IFEQ      '1'
     C                   MOVE      '0'           *IN86
     C                   ELSE
     C                   MOVE      '1'           *IN86
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*GRABAR AFIAR1
     C     *IN37         IFEQ      '0'
     C                   UPDATE    AFIRE1                               94
     C                   ELSE
     C                   WRITE     AFIRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SINO
     C                   ELSE
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Tipo afiliado '1' y per<
     C*SI AFIT17='1' Y ZPERCO<ZPERIN
     C     AFIT17        IFEQ      '1'
     C     ZPERCO        ANDLT     ZPERIN
     C* Fechas iniciales relación dep/sit
     C*EJECUTAR M00160
     C                   EXSR      M00160
     C*FIN
     C                   END
     C* Pla dep,p>f
     C*SI AFIT17='1' Y ZPERCO>ZPERFI
     C     AFIT17        IFEQ      '1'
     C     ZPERCO        ANDGT     ZPERFI
     C* Pla dep,p>f
     C*SI ZTIPLA='01' O ZTIPLA='04'
     C     ZTIPLA        IFEQ      '01'
     C     ZTIPLA        OREQ      '04'
     C*PASAR ZPERMY '1'
     C                   MOVEL     '1'           ZPERMY
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LEEANT AFIAR1
     C                   READP     AFIAR1                                 37
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Ind. no encontró registro
     C*PASAR ZINDIC '2'
     C                   MOVEL     '2'           ZINDIC
     C*FIN
     C                   END
     C*
     C*SI ZPERMN='1' O ZPERMY='1'
     C     ZPERMN        IFEQ      '1'
     C     ZPERMY        OREQ      '1'
     C*OBTENER ZFECPE = ZPERCO || '01'
     C     ZPERCO        CAT       '01'          ZFECPE
     C* Periodo menor a inicio relación
     C*SI ZPERMN='1'
     C     ZPERMN        IFEQ      '1'
     C* Genera rezago 08 si no generó mov
     C*SI ZGENMV<>'1'
     C     ZGENMV        IFNE      '1'
     C* Indicador de rezago '08'
     C*PASAR DETIN4 '08'
     C                   MOVEL     '08'          DETIN4
     C* Genera rezago 08
     C*EJECUTAR M14060
     C                   EXSR      M14060
     C*SINO
     C                   ELSE
     C*SI ZFEINX<>*BLANCO
     C     ZFEINX        IFNE      *BLANK
     C* Actualiza relación
     C*RECUPERARD AFIAR1 (AFINUM ZCODEM ZFEINX)
     C     LL$081        KLIST
     C                   KFLD                    AFINUM
     C                   KFLD                    ZCODEM
     C                   KFLD                    ZFEINX
     C     LL$081        CHAIN     AFIAR1                             3794
     C                   MOVE      *IN94         I$RND
     C     *IN37         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   AFIRE1
     C                   END
     C* AFIAR1 disponible para actualizar
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Actualiza fecha inicial relación
     C*PASAR AFIFE9 ZFECPE
     C                   MOVEL     ZFECPE        AFIFE9
     C* Mes devengue primer aporte
     C*PASAR AFIME1 ZFECPE
     C                   MOVEL     ZFECPE        AFIME1
     C* Meses a sumar
     C*MOVER ZMESES 1
     C                   Z-ADD     1             ZMESES
     C* Sumar 1 mes fecha ini
     C*LLAMAR RPSUMME1(AFIFE9 ZMESES ZFECPR)
     C                   CALL      'RPSUMME1'
     C                   PARM                    AFIFE9
     C                   PARM                    ZMESES
     C                   PARM                    ZFECPR
     C* Pasar a mes de pago
     C*PASAR AFIME2 ZFECPR
     C                   MOVEL     ZFECPR        AFIME2
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Salario detalle
     C*MOVER ZSALAR DETSAL
     C                   Z-ADD     DETSAL        ZSALAR
     C* Crea relación abierta
     C*EJECUTAR M14044
     C                   EXSR      M14044
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Salario detalle
     C*MOVER ZSALAR DETSAL
     C                   Z-ADD     DETSAL        ZSALAR
     C* Crea relación abierta
     C*EJECUTAR M14044
     C                   EXSR      M14044
     C*FIN
     C                   END
     C*PASAR ZINDIC '1'
     C                   MOVEL     '1'           ZINDIC
     C*FIN
     C                   END
     C*
     C*SI ZINDIC != '1'
     C     ZINDIC        IFNE      '1'
     C* Número de identificación
     C*MOVER ZNUMAL DETNU2
     C                   MOVE      DETNU2        ZNUMAL
     C*OBTENER (1) ZERROR = 'No existe relación afiliado-empleador del a
     C                   CLEAR                   ZERROR
     C     $HIL(055)     CAT       ZNUMAL:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza registro afiliado empleador                       ==
     C*==                                                              ==
     C*==================================================================
     C     M14048        BEGSR
     C*CALCULAR ZDIATO=ZDITRA+ZDILIC
     C     ZDITRA        ADD       ZDILIC        ZDIATO
     C* Calcula último salario
     C*EJECUTAR M14049
     C                   EXSR      M14049
     C*SI PLAT03 <> '09' Y PLAT03 <> '10' Y PLAT03 <> '11' Y PLAT03 <> '
     C     PLAT03        IFNE      '09'
     C     PLAT03        ANDNE     '10'
     C     PLAT03        ANDNE     '11'
     C     PLAT03        ANDNE     '12'
     C     PLAT03        OREQ      '09'
     C     ZMARCA        ANDEQ     'S'
     C     PLAT03        OREQ      '10'
     C     ZMARCA        ANDEQ     'S'
     C     PLAT03        OREQ      '11'
     C     ZMARCA        ANDEQ     'S'
     C* Si no es decl.y no pago
     C*SI PLAT03 |= '03' Y ZPLOTE |= 'PLIC'
     C     PLAT03        IFNE      '03'
     C     ZPLOTE        ANDNE     'PLIC'
     C*LIMPIAR ZULTPE ZULTP1
     C                   CLEAR                   ZULTPE
     C                   CLEAR                   ZULTP1
     C* Último per bien cotiz
     C*ASIGNAR ZULTPE AFIUL2
     C                   MOVEL     AFIUL2        ZULTPE
     C*ASIGNARD ZULTPE '01'
     C                   MOVE      '01'          ZULTPE
     C* SUMAMOS UN MES
     C*FUNCION QSUMME1(ZULTPE 1 ZULTPE)
     C                   CALL      'RPSUMME1'                                   QSUMME1
     C     ZULTPE        PARM      ZULTPE        F$4O1             8
     C                   PARM      1             F$4O2             8 0
     C     ZULTPE        PARM      ZULTPE        F$4O3             8
     C*ASIGNAR ZULTP1 ZULTPE
     C                   MOVEL     ZULTPE        ZULTP1
     C*SI ZULTP1 = ZPERCO
     C     ZULTP1        IFEQ      ZPERCO
     C* Si es retiro y no tiene dias cotizados no actualizamos como ult.
     C*SI ZNORET = 'X' Y ZDIATO = *CERO
     C     ZNORET        IFEQ      'X'
     C     ZDIATO        ANDEQ     *ZERO
     C*SINO
     C                   ELSE
     C* Último período cotizado
     C*ASIGNAR AFIUL2 ZPERCO
     C                   MOVEL     ZPERCO        AFIUL2
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Vol/Tercero
     C*SI ZTIPLA='03' O ZTIPLA='07'
     C     ZTIPLA        IFEQ      '03'
     C     ZTIPLA        OREQ      '07'
     C* Vol/Agrem/Pensión temp/Vol. T.
     C*SI ZTIPLA='03' O PLAT03='08' O PLAT03='13' O PLAT03='14'
     C     ZTIPLA        IFEQ      '03'
     C     PLAT03        OREQ      '08'
     C     PLAT03        OREQ      '13'
     C     PLAT03        OREQ      '14'
     C*SI ZSALAR != *CERO
     C     ZSALAR        IFNE      *ZERO
     C* Valor sal calculado
     C*MOVER AFIREN ZSALAR
     C                   Z-ADD     ZSALAR        AFIREN
     C*FIN
     C                   END
     C*LIMPIAR AFIULT
     C                   CLEAR                   AFIULT
     C* Afiliados
     C*GRABAR AFIARC
     C     *IN35         IFEQ      '0'
     C                   UPDATE    AFIREG                               94
     C                   ELSE
     C                   WRITE     AFIREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Último per acreditado
     C*SI AFIUL6 < ZPERCO
     C     AFIUL6        IFLT      ZPERCO
     C* Si es retiro y no tiene dias cotizados no actualizamos como ult.
     C*SI ZNORET = 'X' Y ZDIATO = *CERO
     C     ZNORET        IFEQ      'X'
     C     ZDIATO        ANDEQ     *ZERO
     C*SINO
     C                   ELSE
     C* Último período acreditado
     C*PASAR AFIUL6 ZPERCO
     C                   MOVEL     ZPERCO        AFIUL6
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C*SI AFIPR4 > ZPERCO O AFIPR4 = *BLANCO
     C     AFIPR4        IFGT      ZPERCO
     C     AFIPR4        OREQ      *BLANK
     C* Primer período acreditado
     C*PASAR AFIPR4 ZPERCO
     C                   MOVEL     ZPERCO        AFIPR4
     C*FIN
     C                   END
     C* Si es retiro y no tiene dias
     C*SI ZNORET = 'X' Y ZDIATO = *CERO
     C     ZNORET        IFEQ      'X'
     C     ZDIATO        ANDEQ     *ZERO
     C*SINO
     C                   ELSE
     C*SI PLAT03|='05' Y PLAT03<>'09' Y PLAT03<>'10' Y PLAT03<>'11' Y PL
     C     PLAT03        IFNE      '05'
     C     PLAT03        ANDNE     '09'
     C     PLAT03        ANDNE     '10'
     C     PLAT03        ANDNE     '11'
     C     PLAT03        ANDNE     '12'
     C     PLAT03        OREQ      '09'
     C     ZMARCA        ANDEQ     'S'
     C     PLAT03        OREQ      '10'
     C     ZMARCA        ANDEQ     'S'
     C* Acumula AFIPE3
     C*EJECUTAR M14098
     C                   EXSR      M14098
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Tarifa alto riesgo
     C*MOVER AFITAR DETTAR
     C                   Z-ADD     DETTAR        AFITAR
     C*FIN
     C                   END
     C*SI ZPERCO >= AFIUL6 Y ZSALAR |= *CERO Y ZNORET |= 'X' Y ZDIATO >
     C     ZPERCO        IFGE      AFIUL6
     C     ZSALAR        ANDNE     *ZERO
     C     ZNORET        ANDNE     'X'
     C     ZDIATO        ANDGT     *ZERO
     C* Último período acreditado
     C*MOVER AFIULT ZSALAR
     C                   Z-ADD     ZSALAR        AFIULT
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Valor del salario calculado
     C*SUMAR ZSALAR AFIULT
     C                   ADD       ZSALAR        AFIULT
     C*FIN
     C                   END
     C*
     C* Fecha generación registro
     C*PASAR AFIF01 ZFESIS
     C                   MOVEL     ZFESIS        AFIF01
     C                   ENDSR
     C*==================================================================
     C*==  Calcula último salario                                      ==
     C*==                                                              ==
     C*==================================================================
     C     M14049        BEGSR
     C*
     C* Fecha del período de la plan
     C*OBTENER (0) ZFEDPE = ZPERCO || '01'
     C                   CLEAR                   ZFEDPE
     C     ZPERCO        CAT       '01':0        ZFEDPE
     C* SUMA UN MES A LA PLANILLA
     C*FUNCION QSUMME1 (ZFEDPE 1 ZFEDPE)
     C                   CALL      'RPSUMME1'                                   QSUMME1
     C     ZFEDPE        PARM      ZFEDPE        F$4O1             8
     C                   PARM      1             F$4O2             8 0
     C     ZFEDPE        PARM      ZFEDPE        F$4O3             8
     C*
     C* RESTA UN DÍA
     C*FUNCION QRESDI1 (ZFEDPE 1 ZFEDPE)
     C                   CALL      'RPRESDI1'                                   QRESDI1
     C     ZFEDPE        PARM      ZFEDPE        F$431             8
     C                   PARM      1             F$432             5 0
     C     ZFEDPE        PARM      ZFEDPE        F$433             8
     C*
     C* Obtiene el últ. día del per.
     C*ASIGNARD ZDIAME ZFEDPE
     C                   MOVE      ZFEDPE        ZDIAME
     C*
     C*LIMPIAR ZSALAR
     C                   CLEAR                   ZSALAR
     C* Si el sal. básico report. >= minimo y <= sal. máximo
     C*SI DETS12 >= ZSALMI Y DETS12 <= ZSALMA
     C     DETS12        IFGE      ZSALMI
     C     DETS12        ANDLE     ZSALMA
     C* Salario básico
     C*MOVER ZSALAR DETS12
     C                   Z-ADD     DETS12        ZSALAR
     C*SINO
     C                   ELSE
     C*CALCULAR ZCDIAS=ZDITRA+ZDILIC
     C     ZDITRA        ADD       ZDILIC        ZCDIAS
     C*SI ZDIAME |= ZCDIAS Y ZCDIAS |= *CERO
     C     ZDIAME        IFNE      ZCDIAS
     C     ZCDIAS        ANDNE     *ZERO
     C* Último salario
     C*CALCULAR (R) ZSALAR = (DETSAL * 30)/ZCDIAS
     C     DETSAL        MULT      30            V$CA1           030 9
     C     V$CA1         DIV(H)    ZCDIAS        ZSALAR
     C*SINO
     C                   ELSE
     C*SI DETSAL |= *CERO
     C     DETSAL        IFNE      *ZERO
     C* Último salario
     C*MOVER ZSALAR DETSAL
     C                   Z-ADD     DETSAL        ZSALAR
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Anula deudas presuntas del período                          ==
     C*==                                                              ==
     C*==================================================================
     C     M14050        BEGSR
     C* Pl independ./Tercero Ind.
     C*SI PLATIP='02' O PLATIP='07'
     C     PLATIP        IFEQ      '02'
     C     PLATIP        OREQ      '07'
     C* Identificación afiliado
     C*MOVER ZEMPLE DETNU2
     C                   Z-ADD     DETNU2        ZEMPLE
     C*SINO
     C                   ELSE
     C* Identificación empleador
     C*MOVER ZEMPLE PLANU4
     C                   Z-ADD     PLANU4        ZEMPLE
     C*FIN
     C                   END
     C* Presuntas afil. anteriores
     C*PASAR DEUTIP '06'
     C                   MOVEL     '06'          DEUTIP
     C* No es sector salud
     C*SI PLATIP |= '04'
     C     PLATIP        IFNE      '04'
     C* Tipo de deuda
     C*PASAR ZTIPDE DEUTIP
     C                   MOVEL     DEUTIP        ZTIPDE
     C*  Se posiciona en el archivo
     C*INICIAR DEUARC08 (ZTIPDE ZEMPLE PLAPER)
     C     LL$082        KLIST
     C                   KFLD                    ZTIPDE
     C                   KFLD                    ZEMPLE
     C                   KFLD                    PLAPER
     C     LL$082        SETLL     DEUARC08                           53
     C* Lee el registro
     C*LEER DEUARC08(ZTIPDE ZEMPLE PLAPER)
     C     LL$083        KLIST
     C                   KFLD                    ZTIPDE
     C                   KFLD                    ZEMPLE
     C                   KFLD                    PLAPER
     C     LL$083        READE     DEUARC08                               53
     C*MIENTRAS NFA(DEUARC08) Y DEUTIP=ZTIPDE Y DEUNRO=ZEMPLE Y DEUPER=P
     C     *IN53         DOWEQ     '0'
     C     DEUTIP        ANDEQ     ZTIPDE
     C     DEUNRO        ANDEQ     ZEMPLE
     C     DEUPER        ANDEQ     PLAPER
     C     ZSALIR        ANDNE     '1'
     C* Proceso de anulación
     C*EJECUTAR M14052
     C                   EXSR      M14052
     C* Lee el registro
     C*LEER DEUARC08(ZTIPDE ZEMPLE PLAPER)
     C     LL$084        KLIST
     C                   KFLD                    ZTIPDE
     C                   KFLD                    ZEMPLE
     C                   KFLD                    PLAPER
     C     LL$084        READE     DEUARC08                               53
     C*FIN
     C                   END
     C*INICIAR DEUARC08
     C     *LOVAL        SETLL     DEUARC08                           53
     C*SINO
     C                   ELSE
     C* Tipo de pago situados
     C*SI PLAT03 = '04'
     C     PLAT03        IFEQ      '04'
     C* Situados
     C*PASAR ZTIPAG '04'
     C                   MOVEL     '04'          ZTIPAG
     C*SINO
     C                   ELSE
     C* Hospitales
     C*PASAR ZTIPAG '05'
     C                   MOVEL     '05'          ZTIPAG
     C*FIN
     C                   END
     C* Tipo de deuda
     C*PASAR ZTIPDE DEUTIP
     C                   MOVEL     DEUTIP        ZTIPDE
     C* Se posiciona en el archivo
     C*INICIAR DEUARC10 (DEUTIP ZEMPLE PLAPER ZTIPAG)
     C     LL$085        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    ZEMPLE
     C                   KFLD                    PLAPER
     C                   KFLD                    ZTIPAG
     C     LL$085        SETLL     DEUARC10                           83
     C*LEER DEUARC10(DEUTIP ZEMPLE PLAPER ZTIPAG)
     C     LL$086        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    ZEMPLE
     C                   KFLD                    PLAPER
     C                   KFLD                    ZTIPAG
     C     LL$086        READE     DEUARC10                               83
     C*MIENTRAS NFA(DEUARC10) Y DEUTIP=ZTIPDE Y DEUNRO=ZEMPLE Y DEUPER=P
     C     *IN83         DOWEQ     '0'
     C     DEUTIP        ANDEQ     ZTIPDE
     C     DEUNRO        ANDEQ     ZEMPLE
     C     DEUPER        ANDEQ     PLAPER
     C     DEUT01        ANDEQ     ZTIPAG
     C     ZSALIR        ANDNE     '1'
     C* Anulación deudas sector salud
     C*EJECUTAR M14052
     C                   EXSR      M14052
     C*LEER DEUARC10(DEUTIP ZEMPLE PLAPER ZTIPAG)
     C     LL$087        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    ZEMPLE
     C                   KFLD                    PLAPER
     C                   KFLD                    ZTIPAG
     C     LL$087        READE     DEUARC10                               83
     C*FIN
     C                   END
     C*INICIAR DEUARC10
     C     *LOVAL        SETLL     DEUARC10                           83
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Presuntas
     C*PASAR DEUTIP '02'
     C                   MOVEL     '02'          DEUTIP
     C* No es sector salud
     C*SI PLATIP |= '04'
     C     PLATIP        IFNE      '04'
     C* Tipo de deuda
     C*PASAR ZTIPDE DEUTIP
     C                   MOVEL     DEUTIP        ZTIPDE
     C*  Se posiciona en el archivo
     C*INICIAR DEUARC08 (ZTIPDE ZEMPLE PLAPER)
     C     LL$088        KLIST
     C                   KFLD                    ZTIPDE
     C                   KFLD                    ZEMPLE
     C                   KFLD                    PLAPER
     C     LL$088        SETLL     DEUARC08                           53
     C* Lee el registro
     C*LEER DEUARC08(ZTIPDE ZEMPLE PLAPER)
     C     LL$089        KLIST
     C                   KFLD                    ZTIPDE
     C                   KFLD                    ZEMPLE
     C                   KFLD                    PLAPER
     C     LL$089        READE     DEUARC08                               53
     C*MIENTRAS NFA(DEUARC08) Y DEUTIP=ZTIPDE Y DEUNRO=ZEMPLE Y DEUPER=P
     C     *IN53         DOWEQ     '0'
     C     DEUTIP        ANDEQ     ZTIPDE
     C     DEUNRO        ANDEQ     ZEMPLE
     C     DEUPER        ANDEQ     PLAPER
     C     ZSALIR        ANDNE     '1'
     C* Proceso de anulación
     C*EJECUTAR M14052
     C                   EXSR      M14052
     C*LEER DEUARC08(ZTIPDE ZEMPLE PLAPER)
     C     LL$090        KLIST
     C                   KFLD                    ZTIPDE
     C                   KFLD                    ZEMPLE
     C                   KFLD                    PLAPER
     C     LL$090        READE     DEUARC08                               53
     C*FIN
     C                   END
     C*INICIAR DEUARC08
     C     *LOVAL        SETLL     DEUARC08                           53
     C*SINO
     C                   ELSE
     C* Tipo de pago situados
     C*SI PLAT03 = '04'
     C     PLAT03        IFEQ      '04'
     C* Situados
     C*PASAR ZTIPAG '04'
     C                   MOVEL     '04'          ZTIPAG
     C*SINO
     C                   ELSE
     C* Hospitales
     C*PASAR ZTIPAG '05'
     C                   MOVEL     '05'          ZTIPAG
     C*FIN
     C                   END
     C* Tipo de deuda
     C*PASAR ZTIPDE DEUTIP
     C                   MOVEL     DEUTIP        ZTIPDE
     C* Se posiciona en el archivo
     C*INICIAR DEUARC10 (DEUTIP ZEMPLE PLAPER ZTIPAG)
     C     LL$091        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    ZEMPLE
     C                   KFLD                    PLAPER
     C                   KFLD                    ZTIPAG
     C     LL$091        SETLL     DEUARC10                           83
     C*LEER DEUARC10(DEUTIP ZEMPLE PLAPER ZTIPAG)
     C     LL$092        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    ZEMPLE
     C                   KFLD                    PLAPER
     C                   KFLD                    ZTIPAG
     C     LL$092        READE     DEUARC10                               83
     C*MIENTRAS NFA(DEUARC10) Y DEUTIP=ZTIPDE Y DEUNRO=ZEMPLE Y DEUPER=P
     C     *IN83         DOWEQ     '0'
     C     DEUTIP        ANDEQ     ZTIPDE
     C     DEUNRO        ANDEQ     ZEMPLE
     C     DEUPER        ANDEQ     PLAPER
     C     DEUT01        ANDEQ     ZTIPAG
     C     ZSALIR        ANDNE     '1'
     C* Anulación deudas sector salud
     C*EJECUTAR M14052
     C                   EXSR      M14052
     C*LEER DEUARC10(DEUTIP ZEMPLE PLAPER ZTIPAG)
     C     LL$093        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    ZEMPLE
     C                   KFLD                    PLAPER
     C                   KFLD                    ZTIPAG
     C     LL$093        READE     DEUARC10                               83
     C*FIN
     C                   END
     C*INICIAR DEUARC10
     C     *LOVAL        SETLL     DEUARC10                           83
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Proceso de anulación                                        ==
     C*==                                                              ==
     C*==================================================================
     C     M14052        BEGSR
     C* Si estado deuda no AND y CAN
     C*SI DEUEST |= 'AND' Y DEUEST != 'CAN'
     C     DEUEST        IFNE      'AND'
     C     DEUEST        ANDNE     'CAN'
     C* Valor anulado deuda
     C*LIMPIAR ZVRAND
     C                   CLEAR                   ZVRAND
     C*INICIAR DETAR201 (DEUTIP DEUNUM DETNU2)
     C     LL$094        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C                   KFLD                    DETNU2
     C     LL$094        SETLL     DETAR201                           48
     C*LEER DETAR201(DEUTIP DEUNUM DETNU2)
     C     LL$095        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C                   KFLD                    DETNU2
     C     LL$095        READE     DETAR201                               48
     C*MIENTRAS NFA(DETAR201) Y DEUTIP=DETTIP Y DEUNUM=DETNU9 Y DETNU2=D
     C     *IN48         DOWEQ     '0'
     C     DEUTIP        ANDEQ     DETTIP
     C     DEUNUM        ANDEQ     DETNU9
     C     DETNU2        ANDEQ     DETNR1
     C* Si detalle no AND ni CAN
     C*SI DETEST |= 'AND' Y DETEST |= 'CAN'
     C     DETEST        IFNE      'AND'
     C     DETEST        ANDNE     'CAN'
     C* Anula detalle de deuda
     C*ASIGNAR DETEST 'AND'
     C                   MOVEL     'AND'         DETEST
     C* Declaración y no pago
     C*SI PLAT03 = '03' O ZPLOTE = 'PLIC'
     C     PLAT03        IFEQ      '03'
     C     ZPLOTE        OREQ      'PLIC'
     C* Des. especial activo 1199
     C*SI ZD1199 = 1
     C     ZD1199        IFEQ      1
     C* Prefijo de lote
     C*PASAR ZCARAC ZPREFI
     C                   CLEAR                   ZCARAC
     C                   MOVEL     ZPREFI        ZCARAC
     C* Obtienen el número de caracteres
     C*F QNUMCAR (ZCARAC ZNUMCA)
     C                   CALL      'F037SNAP'                                   QNUMCAR
     C     ZCARAC        PARM      ZCARAC        F$3H1           255
     C     ZNUMCA        PARM      ZNUMCA        F$3H2             3 0
     C*OBTENER ZPREF1 = *EXT (PLANU3 1 ZNUMCA)
     C                   CLEAR                   H$1
     C     ZNUMCA        SUBST     PLANU3:1      H$1             256
     C                   MOVEL     H$1           ZPREF1
     C* Lote de planilla = variable
     C*SI ZPREF1 = ZPREFI
     C     ZPREF1        IFEQ      ZPREFI
     C* Causal de anulación
     C*PASAR DETC56 'A77'
     C                   MOVEL     'A77'         DETC56
     C*SINO
     C                   ELSE
     C* Causal anulación deuda
     C*PASAR DETC56 'A30'
     C                   MOVEL     'A30'         DETC56
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Causal anulación deuda
     C*PASAR DETC56 'A30'
     C                   MOVEL     'A30'         DETC56
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI ZR7421 = '1' Y ZFECDE < DETFE9
     C     ZR7421        IFEQ      '1'
     C     ZFECDE        ANDLT     DETFE9
     C* Causal anulación deuda
     C*PASAR DETC56 'A37'
     C                   MOVEL     'A37'         DETC56
     C*SINO
     C                   ELSE
     C* Causal anulación deuda
     C*PASAR DETC56 'A23'
     C                   MOVEL     'A23'         DETC56
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Fecha fondo ultimo estado
     C*ASIGNAR DETFE2 HISFE3
     C                   MOVEL     HISFE3        DETFE2
     C* Usuario
     C*ASIGNAR DETUS3 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        DETUS3
     C*CALCULAR ZVRAND = DETSA1 + DETSA4 + DETSA3 + DETSA7 + DETSA5 + DE
     C     DETSA1        ADD       DETSA4        V$CA1           030 9
     C     V$CA1         ADD       DETSA3        V$CA1
     C     V$CA1         ADD       DETSA7        V$CA1
     C     V$CA1         ADD       DETSA5        V$CA1
     C     V$CA1         ADD       DETS07        V$CA1
     C     V$CA1         ADD       DETS01        V$CA1
     C     V$CA1         ADD       DETS95        V$CA1
     C     V$CA1         ADD       DETS96        V$CA1
     C     V$CA1         ADD       DETS97        V$CA1
     C     V$CA1         ADD       DETS98        V$CA1
     C     V$CA1         ADD       DET120        V$CA1
     C     V$CA1         ADD       DET125        V$CA1
     C     V$CA1         ADD       DET126        V$CA1
     C     V$CA1         ADD       DET127        ZVRAND
     C*CALCULAR DEUSAL = DEUSAL - DETSA1 - DETSA4 - DETSA3 - DETSA7 - DE
     C     DEUSAL        SUB       DETSA1        V$CA1           030 9
     C     V$CA1         SUB       DETSA4        V$CA1
     C     V$CA1         SUB       DETSA3        V$CA1
     C     V$CA1         SUB       DETSA7        V$CA1
     C     V$CA1         SUB       DETS01        V$CA1
     C     V$CA1         SUB       DETS95        V$CA1
     C     V$CA1         SUB       DETS97        DEUSAL
     C*CALCULAR DEUSA1 = DEUSA1 - DETS07 - DETSA5 - DETS96 - DETS98
     C     DEUSA1        SUB       DETS07        V$CA1           030 9
     C     V$CA1         SUB       DETSA5        V$CA1
     C     V$CA1         SUB       DETS96        V$CA1
     C     V$CA1         SUB       DETS98        DEUSA1
     C*CALCULAR DEUS03 = DEUS03 - DET120 - DET125 - DET126 - DET127
     C     DEUS03        SUB       DET120        V$CA1           030 9
     C     V$CA1         SUB       DET125        V$CA1
     C     V$CA1         SUB       DET126        V$CA1
     C     V$CA1         SUB       DET127        DEUS03
     C* Transacción
     C*MOVER ZTRANS '03'
     C                   MOVE      '03'          ZTRANS
     C* Concepto
     C*MOVER ZCONCE '23'
     C                   MOVE      '23'          ZCONCE
     C* Planilla de cancelación
     C*MOVER ZPLACA PLANU1
     C                   Z-ADD     PLANU1        ZPLACA
     C* Imprime reporte detallado
     C*EJECUTAR DET@02
     C                   EXSR      DET@02
     C* SAE
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C*CALCULAR ZDEUDE = DETSA1+DETSA4+DETSA3+DETSA7+DETS95+DETS97
     C     DETSA1        ADD       DETSA4        V$CA1           030 9
     C     V$CA1         ADD       DETSA3        V$CA1
     C     V$CA1         ADD       DETSA7        V$CA1
     C     V$CA1         ADD       DETS95        V$CA1
     C     V$CA1         ADD       DETS97        ZDEUDE
     C*PASAR ZSIGNO '-'
     C                   MOVEL     '-'           ZSIGNO
     C*SAE
     C*LLAMAR TRINCE64(DETTIP DETNU9 DETPA2 DETSE4 DETNR1 ZDEUDE ZSIGNO
     C                   CALL      'TRINCE64'
     C                   PARM                    DETTIP
     C                   PARM                    DETNU9
     C                   PARM                    DETPA2
     C                   PARM                    DETSE4
     C                   PARM                    DETNR1
     C                   PARM                    ZDEUDE
     C                   PARM                    ZSIGNO
     C                   PARM                    ZERCON
     C* Error concurrencia TRDEUD79
     C*SI ZERCON = '1'
     C     ZERCON        IFEQ      '1'
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C* Rollback
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C* Finaliza proceso
     C*LLAMAR TRCTPR51 (FUNCIO ZMODO ZNRTRA)
     C                   CALL      'TRCTPR51'
     C                   PARM                    FUNCIO
     C                   PARM                    ZMODO
     C                   PARM                    ZNRTRA
     C*TERMINAR
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LIMPIAR DETSA1 DETSA4 DETSA3 DETSA7 DETSA5 DETS07 DETS01
     C                   CLEAR                   DETSA1
     C                   CLEAR                   DETSA4
     C                   CLEAR                   DETSA3
     C                   CLEAR                   DETSA7
     C                   CLEAR                   DETSA5
     C                   CLEAR                   DETS07
     C                   CLEAR                   DETS01
     C*LIMPIAR DETS95 DETS96 DETS97 DETS98 DET120 DET125 DET126 DET127
     C                   CLEAR                   DETS95
     C                   CLEAR                   DETS96
     C                   CLEAR                   DETS97
     C                   CLEAR                   DETS98
     C                   CLEAR                   DET120
     C                   CLEAR                   DET125
     C                   CLEAR                   DET126
     C                   CLEAR                   DET127
     C* No ha consultado empleador
     C*SI ZEMPAR = 0
     C     ZEMPAR        IFEQ      0
     C* No vuelve a consultar empleador.
     C*MOVER ZEMPAR 1
     C                   Z-ADD     1             ZEMPAR
     C* Aux subestado
     C*LIMPIAR ZETSUB
     C                   CLEAR                   ZETSUB
     C* SQLCOD antes.
     C*MOVER SQLCOZ SQLCOD
     C                   Z-ADD     SQLCOD        SQLCOZ
     C*SQL
     C/EXEC SQL
     C+  SELECT COALESCE(MAX(EMPI20), ' ')  INTO :ZMPI20
     C+  FROM EMPAR2
     C+  WHERE
     C+  EMPNU2 = :DETID2 AND EMPTI1 = :DETTI6
     C/END-EXEC
     C* ILOCALIZADO.
     C*SI ZMPI20 = 'N'
     C     ZMPI20        IFEQ      'N'
     C* SUBESTADO
     C*PASAR ZETSUB 'ILO'
     C                   MOVEL     'ILO'         ZETSUB
     C*SINO
     C                   ELSE
     C* SE DESMARCA SUBESTADO, ES LOCALIZAD
     C*LIMPIAR ZETSUB
     C                   CLEAR                   ZETSUB
     C*FIN
     C                   END
     C* SQLCOD despues.
     C*MOVER SQLCOD SQLCOZ
     C                   Z-ADD     SQLCOZ        SQLCOD
     C*FIN
     C                   END
     C* Ilocalizado
     C*CASO DETSUB = 'ILO' O DETSUB = *BLANCO
     C                   SELECT
     C     DETSUB        WHENEQ    'ILO'
     C     DETSUB        OREQ      *BLANK
     C* Sub estado de deuda
     C*PASAR DETSUB ZETSUB
     C                   MOVEL     ZETSUB        DETSUB
     C*FINCASOS
     C                   ENDSL
     C*GRABAR DETAR201
     C     *IN48         IFEQ      '0'
     C                   UPDATE    DETRE101                             94
     C                   ELSE
     C                   WRITE     DETRE101                             94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*MOVER MOVVA1 ZVRAND
     C                   Z-ADD     ZVRAND        MOVVA1
     C* Cód. transacción
     C*PASAR ZCODTX '03'
     C                   MOVEL     '03'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '23'
     C                   MOVEL     '23'          ZCONCE
     C* Página
     C*MOVER MOVPA2 DETPA2
     C                   Z-ADD     DETPA2        MOVPA2
     C* Secuencia
     C*MOVER MOVSE2 DETSE4
     C                   Z-ADD     DETSE4        MOVSE2
     C*EJECUTAR M14391
     C                   EXSR      M14391
     C* Total deuda presunta
     C*SUMAR ZVRAND ZTOTDP
     C                   ADD       ZVRAND        ZTOTDP
     C*FIN
     C                   END
     C*LEER DETAR201(DEUTIP DEUNUM DETNU2)
     C     LL$096        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C                   KFLD                    DETNU2
     C     LL$096        READE     DETAR201                               48
     C*FIN
     C                   END
     C* Si anulo algún detalle
     C*SI ZVRAND > 0
     C     ZVRAND        IFGT      0
     C* Cód. transacción
     C*PASAR ZCODTX '03'
     C                   MOVEL     '03'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '23'
     C                   MOVEL     '23'          ZCONCE
     C* Valor histórico
     C*MOVER ZVALHI ZVRAND
     C                   Z-ADD     ZVRAND        ZVALHI
     C*LIMPIAR ZCUOHI
     C                   CLEAR                   ZCUOHI
     C* Actualizar HISAR4
     C*EJECUTAR M00055
     C                   EXSR      M00055
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*
     C* Ind. anulación del situado
     C*PASAR ZGRDSF '0'
     C                   MOVEL     '0'           ZGRDSF
     C* Grabar deuda cancelada
     C*EJECUTAR M14392
     C                   EXSR      M14392
     C* Actualizar histórico deudas
     C*EJECUTAR M14057
     C                   EXSR      M14057
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualizar histórico de deudas                              ==
     C*==                                                              ==
     C*==================================================================
     C     M14057        BEGSR
     C*INICIARUI HISAR7 (DEUTIP DEUNUM)
     C     LL$097        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C     LL$097        SETLL     HISAR7                                 63
     C     *IN63         IFEQ      '1'
     C     LL$097        SETGT     HISAR7                             63
     C                   MOVE      '0'           *IN63
     C                   ELSE
     C                   MOVE      '1'           *IN63
     C                   END
     C*SI NFA (HISAR7)
     C     *IN63         IFEQ      '0'
     C*LEEANT HISAR7
     C                   READP     HISAR7                                 63
     C*SUMAR 1 HISSE3
     C                   ADD       1             HISSE3
     C*SINO
     C                   ELSE
     C*MOVER HISSE3 1
     C                   Z-ADD     1             HISSE3
     C*FIN
     C                   END
     C*LIMPIAR HISOBS
     C                   CLEAR                   HISOBS
     C*PASAR HISTI3 DEUTIP
     C                   MOVEL     DEUTIP        HISTI3
     C*MOVER HISN25 DEUNUM
     C                   Z-ADD     DEUNUM        HISN25
     C*PASAR HISF01 ZFESIS
     C                   MOVEL     ZFESIS        HISF01
     C*PASAR HISOBS 'DEUDA/DETALLE ANULADA POR ACREDITACION'
     C                   MOVEL     $HIL(056)     HISOBS
     C*PASAR HISEST DEUEST
     C                   MOVEL     DEUEST        HISEST
     C*PASAR HIST07 '1'
     C                   MOVEL     '1'           HIST07
     C*PASAR HISUS3 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        HISUS3
     C*AGREGAR HISAR7
     C                   WRITE     HISRE7                               94
     C                   MOVE      *IN94         I$DUP
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza fecha término de contrato                         ==
     C*==                                                              ==
     C*==================================================================
     C     M14058        BEGSR
     C*SI ZIRRES = 'S' Y AFIUL6 <> *BLANCO
     C     ZIRRES        IFEQ      'S'
     C     AFIUL6        ANDNE     *BLANK
     C* Fecha fin del contrato
     C*OBTENER AFIFE5 = AFIUL6 || '01'
     C     AFIUL6        CAT       '01'          AFIFE5
     C* Validar último día del mes
     C*LLAMAR TRFECTER (AFIFE5)
     C                   CALL      'TRFECTER'
     C                   PARM                    AFIFE5
     C*SINO
     C                   ELSE
     C*CALCULAR ZDIATO=ZDITRA+ZDILIC
     C     ZDITRA        ADD       ZDILIC        ZDIATO
     C* Período fecha inicio
     C*PASAR ZPEFEI AFIFE9
     C                   MOVEL     AFIFE9        ZPEFEI
     C*FUNCION QSUBSTR (ZPEFEI 5 2 ZMESCO)
     C                   CALL      'F160SNAP'                                   QSUBSTR
     C     ZPEFEI        PARM      ZPEFEI        F$4H1           240
     C                   PARM      5             F$4H2             4 0
     C                   PARM      2             F$4H3             4 0
     C     ZMESCO        PARM      ZMESCO        F$4H4           240
     C* Período F.inicio = Per.planilla
     C*SI ZPEFEI = ZPERCO
     C     ZPEFEI        IFEQ      ZPERCO
     C* Mes: Febrero
     C*SI ZDIATO >=29 Y ZMESCO = '02'
     C     ZDIATO        IFGE      29
     C     ZMESCO        ANDEQ     '02'
     C* Año del periodo
     C*PASAR ZANOPE ZPERCO
     C                   MOVEL     ZPERCO        ZANOPE
     C*CALCULAR ZANOBI = ZANOPE / 4
     C     ZANOPE        DIV       4             ZANOBI
     C*CALCULAR ZANOBI = ZANOBI * 4
     C     ZANOBI        MULT      4             ZANOBI
     C* Si el año es bisiesto
     C*SI ZANOPE = ZANOBI
     C     ZANOPE        IFEQ      ZANOBI
     C* Suma 28 dias
     C*MOVER ZDIASC 28
     C                   Z-ADD     28            ZDIASC
     C*SINO
     C                   ELSE
     C* Suma 27 dias
     C*MOVER ZDIASC 27
     C                   Z-ADD     27            ZDIASC
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Días cotizados
     C*CALCULAR ZDIASC = ZDIATO - 1
     C     ZDIATO        SUB       1             ZDIASC
     C*FIN
     C                   END
     C*FUNCION QSUMDI1 (AFIFE9 ZDIASC AFIFE5)
     C                   CALL      'RPSUMDI1'                                   QSUMDI1
     C     AFIFE9        PARM      AFIFE9        F$4L1             8
     C     ZDIASC        PARM      ZDIASC        F$4L2             5 0
     C     AFIFE5        PARM      AFIFE5        F$4L3             8
     C* Validar último día del mes
     C*LLAMAR TRFECTER (AFIFE5)
     C                   CALL      'TRFECTER'
     C                   PARM                    AFIFE5
     C*SINO
     C                   ELSE
     C* Dias trabajados
     C*SI ZDIATO |= *CERO
     C     ZDIATO        IFNE      *ZERO
     C* Días del mes en alfa
     C*PASAR ZDIASM '00'
     C                   MOVEL     '00'          ZDIASM
     C* Días del mes en alfa
     C*ASIGNARD ZDIASM ZDIATO
     C                   MOVE      ZDIATO        ZDIASM
     C*OBTENER AFIFE5 = ZPERCO || ZDIASM
     C     ZPERCO        CAT       ZDIASM        AFIFE5
     C* Validar último día del mes
     C*LLAMAR TRFECTER (AFIFE5)
     C                   CALL      'TRFECTER'
     C                   PARM                    AFIFE5
     C*SINO
     C                   ELSE
     C*OBTENER AFIFE5 = ZPERCO || '01'
     C     ZPERCO        CAT       '01'          AFIFE5
     C* Validar último día del mes
     C*LLAMAR TRFECTER (AFIFE5)
     C                   CALL      'TRFECTER'
     C                   PARM                    AFIFE5
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Genera rezago                                               ==
     C*==                                                              ==
     C*==================================================================
     C     M14060        BEGSR
     C* Cuotas para cubrir compensación
     C*LIMPIAR ZCUCOM ZVAREZ ZCUORE ZFS
     C                   CLEAR                   ZCUCOM
     C                   CLEAR                   ZVAREZ
     C                   CLEAR                   ZCUORE
     C                   CLEAR                   ZFS
     C* Ind. de distrib. p.e. en rezarc
     C*LIMPIAR ZDISPE
     C                   CLEAR                   ZDISPE
     C*CALCULAR ZTODET = DETCOT+DETCO1+DETCO2+DETV14+ZINTRE+ZIFSRE
     C     DETCOT        ADD       DETCO1        V$CA1           030 9
     C     V$CA1         ADD       DETCO2        V$CA1
     C     V$CA1         ADD       DETV14        V$CA1
     C     V$CA1         ADD       ZINTRE        V$CA1
     C     V$CA1         ADD       ZIFSRE        ZTODET
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*CALCULAR ZFS = (ZZAFSP + ZVZFSP)
     C     ZZAFSP        ADD       ZVZFSP        V$CA1           030 9
     C                   Z-ADD     V$CA1         ZFS
     C*SI DETCTA > ZFS
     C     DETCTA        IFGT      ZFS
     C*CALCULAR ZTODET = ZTODET + DETCTA
     C     ZTODET        ADD       DETCTA        ZTODET
     C*SINO
     C                   ELSE
     C*CALCULAR ZTODET = ZTODET + ZFS
     C     ZTODET        ADD       ZFS           ZTODET
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*CALCULAR ZTODET = ZTODET + DETCTA
     C     ZTODET        ADD       DETCTA        ZTODET
     C*FIN
     C                   END
     C* Total de valores necesarios para rezagos
     C*SI ZTODET |= 0 O ZNOSLN = 'X'
     C     ZTODET        IFNE      0
     C     ZNOSLN        OREQ      'X'
     C* Mueve valores de rezagos
     C*EJECUTAR M14066
     C                   EXSR      M14066
     C* Actualiza estadísticas rezago
     C*EJECUTAR M14065
     C                   EXSR      M14065
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Genera registro en rezago por fecha fondo                   ==
     C*==                                                              ==
     C*==================================================================
     C     M14061        BEGSR
     C* Limpia planilla P.A.Para PAGA04
     C*LIMPIAR ZT@018
     C                   CLEAR                   ZT@018
     C* Carga N. planilla para PAGA04
     C*MOVER ZT@010 REZNRO
     C                   Z-ADD     REZNRO        ZT@010
     C* Carga pagina para PAGA04
     C*MOVER ZT@011 REZNR1
     C                   Z-ADD     REZNR1        ZT@011
     C* Carga secuencia para PAGA04
     C*MOVER ZT@012 REZNR2
     C                   Z-ADD     REZNR2        ZT@012
     C* Carga transacción para PAGA04
     C*ASIGNAR ZT@013 '05'
     C                   MOVEL     '05'          ZT@013
     C* Carga concepto para PAGA04
     C*ASIGNAR ZT@014 '60'
     C                   MOVEL     '60'          ZT@014
     C* Carga fecha fondo para PAGA04
     C*ASIGNAR ZT@015 HISFE3
     C                   MOVEL     HISFE3        ZT@015
     C* Carga valor para PAGA04
     C*MOVER ZT@016 ZVRREZ
     C                   Z-ADD     ZVRREZ        ZT@016
     C* Carga cuotas para PAGA04
     C*MOVER ZT@017 ZCUREZ
     C                   Z-ADD     ZCUREZ        ZT@017
     C*LLAMAR TRPLAN90 (ZFONDO ZT@010 ZT@011 ZT@012 ZT@013 ZT@014 ZT@015
     C                   CALL      'TRPLAN90'
     C                   PARM                    ZFONDO
     C                   PARM                    ZT@010
     C                   PARM                    ZT@011
     C                   PARM                    ZT@012
     C                   PARM                    ZT@013
     C                   PARM                    ZT@014
     C                   PARM                    ZT@015
     C                   PARM                    ZT@016
     C                   PARM                    ZT@017
     C                   PARM                    ZT@018
     C                   ENDSR
     C*==================================================================
     C*==  Verifica compensación x dev. rezagos                        ==
     C*==                                                              ==
     C*==================================================================
     C     M14062        BEGSR
     C* Valor a cubrir de la compensación
     C*LIMPIAR ZVLCOM ZDICCR ZICRSF
     C                   CLEAR                   ZVLCOM
     C                   CLEAR                   ZDICCR
     C                   CLEAR                   ZICRSF
     C* Ind. entrar a procesar
     C*LIMPIAR ZENTRA
     C                   CLEAR                   ZENTRA
     C* Nro planilla físico
     C*MOVER COMNU7 REZNRO
     C                   Z-ADD     REZNRO        COMNU7
     C* Nro de página
     C*MOVER COMPAG REZNR1
     C                   Z-ADD     REZNR1        COMPAG
     C* Nro de secuencia
     C*MOVER COMSEC REZNR2
     C                   Z-ADD     REZNR2        COMSEC
     C*
     C* Buscar las compensaciones propias de la planilla del situado
     C*SI PLATIP = '04' Y PLAT03 = '04'
     C     PLATIP        IFEQ      '04'
     C     PLAT03        ANDEQ     '04'
     C* Ind. cruce compensación S.F
     C*PASAR ZICRSF '1'
     C                   MOVEL     '1'           ZICRSF
     C*RECUPERARD COMAR5 (COMNU7 COMPAG COMSEC)
     C     LL$098        KLIST
     C                   KFLD                    COMNU7
     C                   KFLD                    COMPAG
     C                   KFLD                    COMSEC
     C     LL$098        CHAIN     COMAR5                             8494
     C                   MOVE      *IN94         I$RND
     C     *IN84         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   COMRE5
     C                   END
     C*SI RED Y COMTI4 = '1'
     C     I$RND         IFEQ      '0'
     C     COMTI4        ANDEQ     '1'
     C* Existe saldo en la compensación
     C*SI COMSA1 >= *CERO
     C     COMSA1        IFGE      *ZERO
     C*EJECUTAR M14063
     C                   EXSR      M14063
     C*FIN
     C                   END
     C* Ind. no entrar a procesar
     C*PASAR ZENTRA '1'
     C                   MOVEL     '1'           ZENTRA
     C* No tiene compensaciones propias
     C*SINO
     C                   ELSE
     C* Si la planilla que se acredita es del situado verificar si la pl
     C* de hospital que la generó, existe en el archivo de planillas del
     C* reversadas.  si existe la llave para recuperar la compensación e
     C* número de planilla = planilla origen, página y sec.= planilla si
     C* este bloque de instrucciones no aplica para las planillas de hos
     C* ya que para ellas si existe registro en COMAR5.
     C*
     C* Se cambió de planilla
     C*SI ZPLAGE <> REZNRO
     C     ZPLAGE        IFNE      REZNRO
     C* Variables de trabajo
     C*LIMPIAR ZPLAOR ZINDER ZICRSF
     C                   CLEAR                   ZPLAOR
     C                   CLEAR                   ZINDER
     C                   CLEAR                   ZICRSF
     C* Llamado en consulta
     C*PASAR ZPROEJ 'C'
     C                   MOVEL     'C'           ZPROEJ
     C* Planilla del rezago
     C*MOVER ZPLAGE REZNRO
     C                   Z-ADD     REZNRO        ZPLAGE
     C* Buscar planilla
     C*LLAMAR TRPLSF60 (ZPLAOR ZPLAGE PLAPER ZINDER ZPROEJ)
     C                   CALL      'TRPLSF60'
     C                   PARM                    ZPLAOR
     C                   PARM                    ZPLAGE
     C                   PARM                    PLAPER
     C                   PARM                    ZINDER
     C                   PARM                    ZPROEJ
     C*FIN
     C                   END
     C* Existe planilla origen
     C*SI ZPLAOR <> *CERO Y ZINDER = '0'
     C     ZPLAOR        IFNE      *ZERO
     C     ZINDER        ANDEQ     '0'
     C* Número de planilla para la comp.
     C*MOVER COMNU7 ZPLAOR
     C                   Z-ADD     ZPLAOR        COMNU7
     C* Ind. cruce compensación S.F
     C*PASAR ZICRSF '0'
     C                   MOVEL     '0'           ZICRSF
     C*FIN
     C                   END
     C* No encontró planilla origen PLAA05
     C*SI ZINDER = '1'
     C     ZINDER        IFEQ      '1'
     C* Planilla del rezago
     C*MOVER ZPLARE REZNRO
     C                   MOVE      REZNRO        ZPLARE
     C*OBTENER (1) ZERROR = 'No existe planilla origen para el situado'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(057)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* La planilla del situado se generó normalmente por el módulo
     C* de situados y la planilla no existe en PLAA16 porque no se
     C* reversó como 01-01.
     C* Planilla no existe en PLAA16
     C*SI ZINDER = '5'
     C     ZINDER        IFEQ      '5'
     C* Ind. no entrar a procesar
     C*PASAR ZENTRA '1'
     C                   MOVEL     '1'           ZENTRA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR <> '1' Y ZENTRA = *BLANCO
     C     ZSALIR        IFNE      '1'
     C     ZENTRA        ANDEQ     *BLANK
     C*INICIARI COMAR5 (COMNU7 COMPAG COMSEC)
     C     LL$099        KLIST
     C                   KFLD                    COMNU7
     C                   KFLD                    COMPAG
     C                   KFLD                    COMSEC
     C     LL$099        SETLL     COMAR5                                 84
     C     *IN84         IFEQ      '1'
     C                   MOVE      '0'           *IN84
     C                   ELSE
     C                   MOVE      '1'           *IN84
     C                   END
     C*SI ERE (COMAR5)
     C     *IN84         IFEQ      '0'
     C*RECUPERARD COMAR5 (COMNU7 COMPAG COMSEC)
     C     LL$100        KLIST
     C                   KFLD                    COMNU7
     C                   KFLD                    COMPAG
     C                   KFLD                    COMSEC
     C     LL$100        CHAIN     COMAR5                             8494
     C                   MOVE      *IN94         I$RND
     C     *IN84         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   COMRE5
     C                   END
     C*SI RED Y COMTI4 = '1'
     C     I$RND         IFEQ      '0'
     C     COMTI4        ANDEQ     '1'
     C*SI COMSA1 >= *CERO
     C     COMSA1        IFGE      *ZERO
     C*EJECUTAR M14063
     C                   EXSR      M14063
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'COMAR5 no disponible - M14062'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(058)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualice comp. positiva                                    ==
     C*==                                                              ==
     C*==================================================================
     C     M14063        BEGSR
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*CALCULAR ZCUCOM = ZCUCOM - (ZZUFSP + ZCSFSP + ZCIFSP + ZCISUB)
     C     ZZUFSP        ADD       ZCSFSP        V$CA1           030 9
     C     V$CA1         ADD       ZCIFSP        V$CA1
     C     V$CA1         ADD       ZCISUB        V$CA1
     C     ZCUCOM        SUB       V$CA1         ZCUCOM
     C*FIN
     C                   END
     C* Diferencia en cuotas entre el rezago
     C*CALCULAR ZDICCR = ZCUCOM - COMSA1
     C     ZCUCOM        SUB       COMSA1        ZDICCR
     C*SI ZCUCOM <= COMSA1
     C     ZCUCOM        IFLE      COMSA1
     C* Actualice saldo compensación
     C*EJECUTAR M14067
     C                   EXSR      M14067
     C*SINO
     C                   ELSE
     C* Dev. A.F.P. o Emp. x no vinc.
     C*SI COMTI5 = 'B' O COMTI5 = 'C'
     C     COMTI5        IFEQ      'B'
     C     COMTI5        OREQ      'C'
     C* Marca rezago no vinculado
     C*PASAR REZI01 '1'
     C                   MOVEL     '1'           REZI01
     C*LLAMAR TRREZA5D (COMTI6 COMNU8 REZCDI)
     C                   CALL      'TRREZA5D'
     C                   PARM                    COMTI6
     C                   PARM                    COMNU8
     C                   PARM                    REZCDI
     C*FIN
     C                   END
     C* Si se cubren las cuotas de la compensación en el momento de gen
     C* Sobran cuotas del p.e. en el rezago
     C*SI ZCUCOM > COMSA1 Y ZDISPE = '1'
     C     ZCUCOM        IFGT      COMSA1
     C     ZDISPE        ANDEQ     '1'
     C*MOVER COMSAL COMV01
     C                   Z-ADD     COMV01        COMSAL
     C*MOVER COMSA1 COMCU1
     C                   Z-ADD     COMCU1        COMSA1
     C*GRABAR COMAR5
     C     *IN84         IFEQ      '0'
     C                   UPDATE    COMRE5                               94
     C                   ELSE
     C                   WRITE     COMRE5                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*PASAR REZEST 'GEN'
     C                   MOVEL     'GEN'         REZEST
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza estadísticas de rezagos                           ==
     C*==                                                              ==
     C*==================================================================
     C     M14065        BEGSR
     C* Tipo de rezago
     C*ASIGNAR ESTTIP DETIN4
     C                   MOVEL     DETIN4        ESTTIP
     C* Fecha de generacion
     C*ASIGNAR ESTFE3 ZFESIS
     C                   MOVEL     ZFESIS        ESTFE3
     C* Tipo llamado masivo
     C*SI ZTIPXX <> 'W' Y ZTLLAM <> 'X'
     C     ZTIPXX        IFNE      'W'
     C     ZTLLAM        ANDNE     'X'
     C*RECUPERARD ESTAR1 (ESTTIP ESTFE3)
     C     LL$101        KLIST
     C                   KFLD                    ESTTIP
     C                   KFLD                    ESTFE3
     C     LL$101        CHAIN     ESTAR1                             5994
     C                   MOVE      *IN94         I$RND
     C     *IN59         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   ESTRE1
     C                   END
     C* Registro ESTAR1 disponible
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Numero de rezagos generados
     C*SUMAR 1 ESTNRO
     C                   ADD       1             ESTNRO
     C* Valor del rezago
     C*SUMAR ZVRREZ ESTVAL
     C                   ADD       ZVRREZ        ESTVAL
     C*GRABAR ESTAR1
     C     *IN59         IFEQ      '0'
     C                   UPDATE    ESTRE1                               94
     C                   ELSE
     C                   WRITE     ESTRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'ESTAR1 no disponible - M14065'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(059)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Valor del rezago
     C*MOVER ZVALHI ZVRREZ
     C                   Z-ADD     ZVRREZ        ZVALHI
     C* Tipo de Rezago
     C*PASAR ZCODTX DETIN4
     C                   MOVEL     DETIN4        ZCODTX
     C* Rezago generado
     C*PASAR ZFI 'R'
     C                   MOVEL     'R'           ZFI
     C*LLAMAR TRPLANB1(ZFONDO ZFESIS PLANUM ZCODTX ZCONCE ZVALHI ZCUOHI
     C                   CALL      'TRPLANB1'
     C                   PARM                    ZFONDO
     C                   PARM                    ZFESIS
     C                   PARM                    PLANUM
     C                   PARM                    ZCODTX
     C                   PARM                    ZCONCE
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C                   PARM                    ZFI
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Mueve valores de rezagos                                    ==
     C*==                                                              ==
     C*==================================================================
     C     M14066        BEGSR
     C* Número de planilla
     C*MOVER REZNRO PLANU1
     C                   Z-ADD     PLANU1        REZNRO
     C* Página
     C*MOVER REZNR1 DETPAG
     C                   Z-ADD     DETPAG        REZNR1
     C* Secuencia
     C*MOVER REZNR2 DETSEC
     C                   Z-ADD     DETSEC        REZNR2
     C* Tipo de planilla
     C*PASAR REZTI5 PLATIP
     C                   MOVEL     PLATIP        REZTI5
     C* Tipo de rezago
     C*PASAR REZTI3 DETIN4
     C                   MOVEL     DETIN4        REZTI3
     C* Fecha sistema generación
     C*PASAR REZFEC ZFESIS
     C                   MOVEL     ZFESIS        REZFEC
     C* Estado
     C*PASAR REZEST 'GEN'
     C                   MOVEL     'GEN'         REZEST
     C* Período
     C*PASAR REZPER PLAPER
     C                   MOVEL     PLAPER        REZPER
     C* Planilla de tercero
     C*SI PLATIP='07'
     C     PLATIP        IFEQ      '07'
     C* Tipo de identificación
     C*PASAR REZTIP DETTI2
     C                   MOVEL     DETTI2        REZTIP
     C* Identificación empleador
     C*MOVER REZID1 DETNU2
     C                   Z-ADD     DETNU2        REZID1
     C* Identificación depositante
     C*OBTENER (1) REZRAZ = DETPRI || DETPR1
     C                   CLEAR                   REZRAZ
     C     DETPRI        CAT       DETPR1:1      REZRAZ
     C*SINO
     C                   ELSE
     C* Tipo de identificación
     C*PASAR REZTIP PLATI1
     C                   MOVEL     PLATI1        REZTIP
     C* Identificación empleador
     C*MOVER REZID1 PLANU4
     C                   Z-ADD     PLANU4        REZID1
     C* Nombre depósitante
     C*PASAR REZRAZ PLANOM
     C                   MOVEL     PLANOM        REZRAZ
     C*FIN
     C                   END
     C* Independientes
     C*SI PLATIP='02' O PLATIP='03' O PLATIP='07'
     C     PLATIP        IFEQ      '02'
     C     PLATIP        OREQ      '03'
     C     PLATIP        OREQ      '07'
     C* Código del empleador
     C*MOVER REZCO3 *CERO
     C                   MOVE      *ZERO         REZCO3
     C*SINO
     C                   ELSE
     C* Código del empleador
     C*MOVER REZCO3 PLACOD
     C                   Z-ADD     PLACOD        REZCO3
     C*FIN
     C                   END
     C* Tipo identificación afiliado
     C*PASAR REZTI4 DETTI2
     C                   MOVEL     DETTI2        REZTI4
     C* Identificación afiliado
     C*MOVER REZNR3 DETNU2
     C                   Z-ADD     DETNU2        REZNR3
     C* Primer apellido
     C*PASAR REZPRI DETPRI
     C                   MOVEL     DETPRI        REZPRI
     C* Segundo apellido
     C*PASAR REZSEG DETSEG
     C                   MOVEL     DETSEG        REZSEG
     C* Primer nombre
     C*PASAR REZPR1 DETPR1
     C                   MOVEL     DETPR1        REZPR1
     C* Segundo nombre
     C*PASAR REZSE3 DETSE1
     C                   MOVEL     DETSE1        REZSE3
     C* Código interno afiliado
     C*MOVER REZNU1 DETN04
     C                   Z-ADD     DETN04        REZNU1
     C* Novedad
     C*PASAR REZNOV DETNOV
     C                   MOVEL     DETNOV        REZNOV
     C* Días trabajados
     C*MOVER REZDIA DETDIA
     C                   Z-ADD     DETDIA        REZDIA
     C* Días incapacidad
     C*MOVER REZDI1 DETDI1
     C                   Z-ADD     DETDI1        REZDI1
     C* Código actividad alto riesgo
     C*MOVER REZCOD DETCOD
     C                   MOVE      DETCOD        REZCOD
     C* Tarifa alto riesgo
     C*MOVER REZTAR DETTAR
     C                   Z-ADD     DETTAR        REZTAR
     C* Tarifa especial
     C*MOVER REZTA1 DETTA1
     C                   Z-ADD     DETTA1        REZTA1
     C* Código sucursal riesgo
     C*PASAR REZCO9 PLAC11
     C                   MOVEL     PLAC11        REZCO9
     C* Valor retención contingente
     C*MOVER REZVAL DETVA8
     C                   Z-ADD     DETVA8        REZVAL
     C* Salario informado
     C*MOVER REZREM DETSAL
     C                   Z-ADD     DETSAL        REZREM
     C* Salario calculado
     C*MOVER REZSA1 DETVA7
     C                   Z-ADD     DETVA7        REZSA1
     C* Cotización obligatoria
     C*MOVER REZCOT DETCOT
     C                   Z-ADD     DETCOT        REZCOT
     C* Cotiz. voluntaria afiliado
     C*MOVER REZCO1 DETCO1
     C                   Z-ADD     DETCO1        REZCO1
     C* Cotiz. voluntaria empleador
     C*MOVER REZCO2 DETCO2
     C                   Z-ADD     DETCO2        REZCO2
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*CALCULAR REZCO4 = ZZAFSP + ZVZFSP
     C     ZZAFSP        ADD       ZVZFSP        REZCO4
     C*SI REZCO4 < DETCTA
     C     REZCO4        IFLT      DETCTA
     C* Fondo de solidaridad
     C*MOVER REZCO4 DETCTA
     C                   Z-ADD     DETCTA        REZCO4
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Fondo de solidaridad
     C*MOVER REZCO4 DETCTA
     C                   Z-ADD     DETCTA        REZCO4
     C*FIN
     C                   END
     C* Valor rendimientos
     C*MOVER REZVA1 DETV14
     C                   Z-ADD     DETV14        REZVA1
     C* Intereses
     C*MOVER REZINT ZINTRE
     C                   Z-ADD     ZINTRE        REZINT
     C* Intereses fondo solidaridad
     C*MOVER REZIN9 ZIFSRE
     C                   Z-ADD     ZIFSRE        REZIN9
     C* Tipo de pago
     C*MOVER REZTI7 PLAT03
     C                   MOVE      PLAT03        REZTI7
     C* Valor devuelto ISS / campo SIAFP
     C*LIMPIAR REZVA2 REZSIA
     C                   CLEAR                   REZVA2
     C                   CLEAR                   REZSIA
     C* Valida DE req. 13422
     C*EJECUTAR M14068
     C                   EXSR      M14068
     C* Cuotas rezagos
     C*MOVER REZCUO ZCUREZ
     C                   Z-ADD     ZCUREZ        REZCUO
     C* Vlr y cuotas P.E. empleador
     C*LIMPIAR REZVA3 REZCU2
     C                   CLEAR                   REZVA3
     C                   CLEAR                   REZCU2
     C* Valor deuda rezago
     C*CALCULAR REZDEU = ZTODET - ZVRREZ
     C     ZTODET        SUB       ZVRREZ        REZDEU
     C*SI REZDEU = *CEROS Y ZEXFSP = 'S' Y ZFS > DETCTA
     C     REZDEU        IFEQ      *ZEROS
     C     ZEXFSP        ANDEQ     'S'
     C     ZFS           ANDGT     DETCTA
     C*CALCULAR REZDEU = ZFS - DETCTA
     C     ZFS           SUB       DETCTA        REZDEU
     C*CALCULAR ZDEURE = ZDEURE + REZDEU
     C     ZDEURE        ADD       REZDEU        ZDEURE
     C*FIN
     C                   END
     C*SI REZDEU < *CEROS
     C     REZDEU        IFLT      *ZEROS
     C*RESTAR REZDEU REZCOT
     C                   SUB       REZDEU        REZCOT
     C*LIMPIAR REZDEU
     C                   CLEAR                   REZDEU
     C*FIN
     C                   END
     C*LIMPIAR REZDIF REZIND REZDI2 REZIN1 REZDI3 REZIN2 REZDI4 REZIN3 R
     C                   CLEAR                   REZDIF
     C                   CLEAR                   REZIND
     C                   CLEAR                   REZDI2
     C                   CLEAR                   REZIN1
     C                   CLEAR                   REZDI3
     C                   CLEAR                   REZIN2
     C                   CLEAR                   REZDI4
     C                   CLEAR                   REZIN3
     C                   CLEAR                   REZI01
     C* Planilla de traspaso entrada
     C*SI PLATIP = '05'
     C     PLATIP        IFEQ      '05'
     C* Código AFP
     C*MOVER REZCDI AFPCDI
     C                   MOVE      AFPCDI        REZCDI
     C*SINO
     C                   ELSE
     C* Código AFP
     C*LIMPIAR REZCDI
     C                   CLEAR                   REZCDI
     C*FIN
     C                   END
     C* Deuda ISS y rendimientos
     C*LIMPIAR REZDE2 REZDE3
     C                   CLEAR                   REZDE2
     C                   CLEAR                   REZDE3
     C* Usuario
     C*ASIGNAR REZUSU USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        REZUSU
     C* Fecha fondo ultimo estado
     C*ASIGNAR REZFE2 HISFE3
     C                   MOVEL     HISFE3        REZFE2
     C* Fecha fondo generación
     C*ASIGNAR REZFE3 HISFE3
     C                   MOVEL     HISFE3        REZFE3
     C* Cuotas para cubrir compensación
     C*MOVER ZCUCOM REZCUO
     C                   Z-ADD     REZCUO        ZCUCOM
     C* Verifica compensación
     C*EJECUTAR M14062
     C                   EXSR      M14062
     C*SI REZTI3 >= '31' Y REZTI3 <> '35' Y REZTI3 <= '40'
     C     REZTI3        IFGE      '31'
     C     REZTI3        ANDNE     '35'
     C     REZTI3        ANDLE     '40'
     C*CALCULAR ZVAREZ = REZCOT+REZCO1+REZCO2+REZCO4+REZINT+REZIN9+REZVA
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     V$CA1         ADD       REZIN9        V$CA1
     C     V$CA1         ADD       REZVA3        V$CA1
     C     V$CA1         SUB       REZDEU        ZVAREZ
     C*CALCULAR ZCUORE = REZCUO+REZCU2
     C     REZCUO        ADD       REZCU2        ZCUORE
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*CALCULAR ZCUORE = ZCUORE - (ZZUFSP + ZCSFSP + ZCIFSP + ZCISUB)
     C     ZZUFSP        ADD       ZCSFSP        V$CA1           030 9
     C     V$CA1         ADD       ZCIFSP        V$CA1
     C     V$CA1         ADD       ZCISUB        V$CA1
     C     ZCUORE        SUB       V$CA1         ZCUORE
     C*CALCULAR ZVAREZ = ZVAREZ - (ZZAFSP + ZVZFSP + ZVIFSP + ZVISUB)
     C     ZZAFSP        ADD       ZVZFSP        V$CA1           030 9
     C     V$CA1         ADD       ZVIFSP        V$CA1
     C     V$CA1         ADD       ZVISUB        V$CA1
     C     ZVAREZ        SUB       V$CA1         ZVAREZ
     C*FIN
     C                   END
     C* Tx - Reversión movimiento
     C*PASAR ZCODTX '05'
     C                   MOVEL     '05'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '31'
     C                   MOVEL     '31'          ZCONCE
     C* Planilla pago adelantado
     C*LIMPIAR ZPLANA
     C                   CLEAR                   ZPLANA
     C* Genera registro en PAGA04
     C*LLAMAR TRPLAN90 (ZFONDO REZNRO REZNR1 REZNR2 ZCODTX ZCONCE REZFE3
     C                   CALL      'TRPLAN90'
     C                   PARM                    ZFONDO
     C                   PARM                    REZNRO
     C                   PARM                    REZNR1
     C                   PARM                    REZNR2
     C                   PARM                    ZCODTX
     C                   PARM                    ZCONCE
     C                   PARM                    REZFE3
     C                   PARM                    ZVAREZ
     C                   PARM                    ZCUORE
     C                   PARM                    ZPLANA
     C*FIN
     C                   END
     C*AGREGAR REZARC
     C                   WRITE     REZREG                               94
     C                   MOVE      *IN94         I$DUP
     C* Marcar archivos de equivalencias de inconsistencias de acreditac
     C* D.E. fusión PRO
     C*SI Z10592=1 Y PLAPER<ZPEFUS
     C     Z10592        IFEQ      1
     C     PLAPER        ANDLT     ZPEFUS
     C*LIMPIAR ZPLAFU
     C                   CLEAR                   ZPLAFU
     C* Planilla de fusión
     C*LLAMAR TRFEPL56 (PLANUM ZPLAFU)
     C                   CALL      'TRFEPL56'
     C                   PARM                    PLANUM
     C                   PARM                    ZPLAFU
     C* Planilla de fusión
     C*SI ZPLAFU='I' O ZPLAFU='C'
     C     ZPLAFU        IFEQ      'I'
     C     ZPLAFU        OREQ      'C'
     C* Grabar rezago
     C*PASAR ZINDAR 'R'
     C                   MOVEL     'R'           ZINDAR
     C*LLAMAR TRFEQA50(REZNRO REZNR1 REZNR2 REZTI5 REZEST REZID1 REZPER
     C                   CALL      'TRFEQA50'
     C                   PARM                    REZNRO
     C                   PARM                    REZNR1
     C                   PARM                    REZNR2
     C                   PARM                    REZTI5
     C                   PARM                    REZEST
     C                   PARM                    REZID1
     C                   PARM                    REZPER
     C                   PARM                    REZFEC
     C                   PARM                    REZEST
     C                   PARM                    ZINPAA
     C                   PARM                    ZINDAR
     C                   PARM                    ZINDFE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* SAE
     C*SI ZREGCE=1 Y ZENTI1=3
     C     ZREGCE        IFEQ      1
     C     ZENTI1        ANDEQ     3
     C*CALCULAR ZVALRE = (REZCOT+REZCO1+REZCO2+REZCO4+REZINT)+(REZIN9+RE
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     REZIN9        ADD       REZVA1        V$CA2           030 9
     C     V$CA2         SUB       REZDEU        V$CA2
     C     V$CA2         ADD       REZVA3        V$CA2
     C     V$CA1         ADD       V$CA2         ZVALRE
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*CALCULAR ZVALRE = ZVALRE - (ZZAFSP + ZVZFSP + ZVIFSP + ZVISUB)
     C     ZZAFSP        ADD       ZVZFSP        V$CA1           030 9
     C     V$CA1         ADD       ZVIFSP        V$CA1
     C     V$CA1         ADD       ZVISUB        V$CA1
     C     ZVALRE        SUB       V$CA1         ZVALRE
     C*FIN
     C                   END
     C*PASAR ZSIGNO '-'
     C                   MOVEL     '-'           ZSIGNO
     C*LLAMAR TRINCE65(REZNRO REZNR1 REZNR2 REZNR3 ZVALRE ZSIGNO)
     C                   CALL      'TRINCE65'
     C                   PARM                    REZNRO
     C                   PARM                    REZNR1
     C                   PARM                    REZNR2
     C                   PARM                    REZNR3
     C                   PARM                    ZVALRE
     C                   PARM                    ZSIGNO
     C*FIN
     C                   END
     C*
     C* Total valor rezagos
     C*SUMAR ZVRREZ ZTOVRE
     C                   ADD       ZVRREZ        ZTOVRE
     C* Total cuotas rezagos
     C*SUMAR ZCUREZ ZTOCRE
     C                   ADD       ZCUREZ        ZTOCRE
     C* No vinculado
     C*SI REZI01 = '1'
     C     REZI01        IFEQ      '1'
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*CALCULAR ZCUREZ = ZCUREZ - (ZZUFSP + ZCSFSP + ZCIFSP + ZCISUB)
     C     ZZUFSP        ADD       ZCSFSP        V$CA1           030 9
     C     V$CA1         ADD       ZCIFSP        V$CA1
     C     V$CA1         ADD       ZCISUB        V$CA1
     C     ZCUREZ        SUB       V$CA1         ZCUREZ
     C*CALCULAR ZVRREZ = ZVRREZ - (ZZAFSP + ZVZFSP + ZVIFSP + ZVISUB)
     C     ZZAFSP        ADD       ZVZFSP        V$CA1           030 9
     C     V$CA1         ADD       ZVIFSP        V$CA1
     C     V$CA1         ADD       ZVISUB        V$CA1
     C     ZVRREZ        SUB       V$CA1         ZVRREZ
     C*FIN
     C                   END
     C* Acumula Rezagos no vinculados
     C*SUMAR ZVRREZ ZTOVRN
     C                   ADD       ZVRREZ        ZTOVRN
     C* Acumula cuotas rezagos no vinc.
     C*SUMAR ZCUREZ ZTOCRN
     C                   ADD       ZCUREZ        ZTOCRN
     C* Genera registro rezago fecha fondo
     C*EJECUTAR M14061
     C                   EXSR      M14061
     C*FIN
     C                   END
     C* Voluntario con rezago
     C*SI PLATIP='03' Y DETIN4<>*BLANCO
     C     PLATIP        IFEQ      '03'
     C     DETIN4        ANDNE     *BLANK
     C* Imprime reporte detallado
     C*EJECUTAR DET@03
     C                   EXSR      DET@03
     C* Ind. de no generar P.E.
     C*PASAR ZREZEM '1'
     C                   MOVEL     '1'           ZREZEM
     C*SINO
     C                   ELSE
     C* No existe empleador
     C*SI REZTI3|='01' Y REZTI3|='11'
     C     REZTI3        IFNE      '01'
     C     REZTI3        ANDNE     '11'
     C* Imprime reporte detallado
     C*EJECUTAR DET@03
     C                   EXSR      DET@03
     C*SINO
     C                   ELSE
     C* Ind. de no generar P.E.
     C*PASAR ZREZEM '1'
     C                   MOVEL     '1'           ZREZEM
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Desarrollo Especial activo
     C*SI ZR7436='1' Y REZDEU>*CERO
     C     ZR7436        IFEQ      '1'
     C     REZDEU        ANDGT     *ZERO
     C*SI ZSAINT>*CEROS O ZSICVA>*CEROS O ZSICVE>*CEROS O ZSINAR>*CEROS
     C     ZSAINT        IFGT      *ZEROS
     C     ZSICVA        ORGT      *ZEROS
     C     ZSICVE        ORGT      *ZEROS
     C     ZSINAR        ORGT      *ZEROS
     C* Total de intereses distribuido C.O
     C*CALCULAR (R) ZSAIN3 = ZSAIN4 - ZSAINT
     C     ZSAIN4        SUB(H)    ZSAINT        ZSAIN3
     C* Total de intereses distribuido C.V.A
     C*CALCULAR (R) ZSIVA3 = ZSIVA4 - ZSICVA
     C     ZSIVA4        SUB(H)    ZSICVA        ZSIVA3
     C* Total de intereses distribuido C.V.E
     C*CALCULAR (R) ZSIVE3 = ZSIVE4 - ZSICVE
     C     ZSIVE4        SUB(H)    ZSICVE        ZSIVE3
     C* Total de intereses distribuido A.R
     C*CALCULAR (R) ZSINR3 = ZSINR4 - ZSINAR
     C     ZSINR4        SUB(H)    ZSINAR        ZSINR3
     C* Separar intereses simples de efectivos
     C* Int.simple>distribuido
     C*SI ZSAIN2>ZSAIN3
     C     ZSAIN2        IFGT      ZSAIN3
     C* Saldo int. simple C.O
     C*CALCULAR (R) ZSAIN5 = ZSAIN2-ZSAIN3
     C     ZSAIN2        SUB(H)    ZSAIN3        ZSAIN5
     C* El saldo de int. T.E. C.O está en ZSAIN1
     C*SINO
     C                   ELSE
     C* Saldo int. simple C.O
     C*LIMPIAR ZSAIN5
     C                   CLEAR                   ZSAIN5
     C* Saldo Int. T.E. C.O
     C*MOVER ZSAIN1 ZSAINT
     C                   Z-ADD     ZSAINT        ZSAIN1
     C*FIN
     C                   END
     C* Int.simple>distribuido
     C*SI ZSIVA2>ZSIVA3
     C     ZSIVA2        IFGT      ZSIVA3
     C* Saldo int. simple C.V.A
     C*CALCULAR (R) ZSIVA5 = ZSIVA2-ZSIVA3
     C     ZSIVA2        SUB(H)    ZSIVA3        ZSIVA5
     C* El saldo de int. T.E. C.V.A está en ZSIVA1
     C*SINO
     C                   ELSE
     C* Saldo int. simple C.V.A
     C*LIMPIAR ZSIVA5
     C                   CLEAR                   ZSIVA5
     C* Saldo Int. T.E. C.V.A
     C*MOVER ZSIVA1 ZSICVA
     C                   Z-ADD     ZSICVA        ZSIVA1
     C*FIN
     C                   END
     C* Int.simple>distribuido
     C*SI ZSIVE2 > ZSIVE3
     C     ZSIVE2        IFGT      ZSIVE3
     C* Saldo int. simple C.V.E
     C*CALCULAR (R) ZSIVE5 = ZSIVE2-ZSIVE3
     C     ZSIVE2        SUB(H)    ZSIVE3        ZSIVE5
     C* El saldo de int. T.E. C.V.A está en ZSIVE1
     C*SINO
     C                   ELSE
     C* Saldo int. simple C.V.E
     C*LIMPIAR ZSIVE5
     C                   CLEAR                   ZSIVE5
     C* Saldo Int. T.E. C.V.E
     C*MOVER ZSIVE1 ZSICVE
     C                   Z-ADD     ZSICVE        ZSIVE1
     C*FIN
     C                   END
     C* Int.simple>distribuido
     C*SI ZSINR2>ZSINR3
     C     ZSINR2        IFGT      ZSINR3
     C* Saldo int. simple A.R
     C*CALCULAR (R) ZSINR5 = ZSINR2-ZSINR3
     C     ZSINR2        SUB(H)    ZSINR3        ZSINR5
     C* El saldo de int. T.E. A.R está en ZSINR1
     C*SINO
     C                   ELSE
     C* Saldo int. simple A.R
     C*LIMPIAR ZSINR5
     C                   CLEAR                   ZSINR5
     C* Saldo Int. T.E. A.R
     C*MOVER ZSINR1 ZSINAR
     C                   Z-ADD     ZSINAR        ZSINR1
     C*FIN
     C                   END
     C* Distribuir intereses simples
     C* Saldo intereses CO
     C*SI ZSAIN5>*CEROS Y ZCOTOB>*CEROS
     C     ZSAIN5        IFGT      *ZEROS
     C     ZCOTOB        ANDGT     *ZEROS
     C*CALCULAR (R) ZINTCO = (ZCOTOB*(ZSAIN5-ZVSICO))/(ZTOCO-ZVACO)
     C     ZSAIN5        SUB       ZVSICO        V$CA1           030 9
     C     ZCOTOB        MULT      V$CA1         V$CA1
     C     ZTOCO         SUB       ZVACO         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido CO
     C*SUMAR ZINTCO ZVSICO
     C                   ADD       ZINTCO        ZVSICO
     C*FIN
     C                   END
     C* Saldo intereses CVA
     C*SI ZSIVA5>*CEROS Y ZCOTVA>*CEROS
     C     ZSIVA5        IFGT      *ZEROS
     C     ZCOTVA        ANDGT     *ZEROS
     C*CALCULAR (R) ZINTCO = (ZCOTVA*(ZSIVA5-ZVSIVA))/(ZTOCVA-ZVACVA)
     C     ZSIVA5        SUB       ZVSIVA        V$CA1           030 9
     C     ZCOTVA        MULT      V$CA1         V$CA1
     C     ZTOCVA        SUB       ZVACVA        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido CVA
     C*SUMAR ZINTCO ZVSIVA
     C                   ADD       ZINTCO        ZVSIVA
     C*FIN
     C                   END
     C* Saldo intereses CVE
     C*SI ZSIVE5>*CEROS Y ZCOTVE>*CEROS
     C     ZSIVE5        IFGT      *ZEROS
     C     ZCOTVE        ANDGT     *ZEROS
     C*CALCULAR (R) ZINTCO = (ZCOTVE*(ZSIVE5-ZVSIVE))/(ZTOCVE-ZVACVE)
     C     ZSIVE5        SUB       ZVSIVE        V$CA1           030 9
     C     ZCOTVE        MULT      V$CA1         V$CA1
     C     ZTOCVE        SUB       ZVACVE        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido CVE
     C*SUMAR ZINTCO ZVSIVE
     C                   ADD       ZINTCO        ZVSIVE
     C*FIN
     C                   END
     C* Saldo intereses alto riesgo
     C*SI ZSINR5>*CEROS Y ZCOTAR>*CERO
     C     ZSINR5        IFGT      *ZEROS
     C     ZCOTAR        ANDGT     *ZERO
     C*CALCULAR (R) ZINTCO = (ZCOTAR*(ZSINR5-ZVSIAR))/(ZTOAR-ZVAAR)
     C     ZSINR5        SUB       ZVSIAR        V$CA1           030 9
     C     ZCOTAR        MULT      V$CA1         V$CA1
     C     ZTOAR         SUB       ZVAAR         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido A.R
     C*SUMAR ZINTCO ZVSIAR
     C                   ADD       ZINTCO        ZVSIAR
     C*FIN
     C                   END
     C* Intereses efectivos
     C* Saldo intereses CO
     C*SI ZSAIN1>*CEROS Y ZCOTOB>*CEROS
     C     ZSAIN1        IFGT      *ZEROS
     C     ZCOTOB        ANDGT     *ZEROS
     C*CALCULAR (R) ZINTCO = (ZCOTOB*(ZSAIN1-ZVSIC1))/(ZTOCO-ZVACO)
     C     ZSAIN1        SUB       ZVSIC1        V$CA1           030 9
     C     ZCOTOB        MULT      V$CA1         V$CA1
     C     ZTOCO         SUB       ZVACO         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido CO
     C*SUMAR ZINTCO ZVSIC1
     C                   ADD       ZINTCO        ZVSIC1
     C*FIN
     C                   END
     C* Saldo intereses CVA
     C*SI ZSIVA1>*CEROS Y ZCOTVA>*CEROS
     C     ZSIVA1        IFGT      *ZEROS
     C     ZCOTVA        ANDGT     *ZEROS
     C*CALCULAR (R) ZINTCO = (ZCOTVA*(ZSIVA1-ZVSIA1))/(ZTOCVA-ZVACVA)
     C     ZSIVA1        SUB       ZVSIA1        V$CA1           030 9
     C     ZCOTVA        MULT      V$CA1         V$CA1
     C     ZTOCVA        SUB       ZVACVA        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido CVA
     C*SUMAR ZINTCO ZVSIA1
     C                   ADD       ZINTCO        ZVSIA1
     C*FIN
     C                   END
     C* Saldo intereses CVE
     C*SI ZSIVE1>*CEROS Y ZCOTVE>*CEROS
     C     ZSIVE1        IFGT      *ZEROS
     C     ZCOTVE        ANDGT     *ZEROS
     C*CALCULAR (R) ZINTCO = (ZCOTVE*(ZSIVE1-ZVSIE1))/(ZTOCVE-ZVACVE)
     C     ZSIVE1        SUB       ZVSIE1        V$CA1           030 9
     C     ZCOTVE        MULT      V$CA1         V$CA1
     C     ZTOCVE        SUB       ZVACVE        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido CVE
     C*SUMAR ZINTCO ZVSIE1
     C                   ADD       ZINTCO        ZVSIE1
     C*FIN
     C                   END
     C* Saldo intereses alto riesgo
     C*SI ZSINR1>*CEROS Y ZCOTAR>*CERO
     C     ZSINR1        IFGT      *ZEROS
     C     ZCOTAR        ANDGT     *ZERO
     C*CALCULAR (R) ZINTCO = (ZCOTAR*(ZSINR1-ZVSIR1))/(ZTOAR-ZVAAR)
     C     ZSINR1        SUB       ZVSIR1        V$CA1           030 9
     C     ZCOTAR        MULT      V$CA1         V$CA1
     C     ZTOAR         SUB       ZVAAR         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido A.R
     C*SUMAR ZINTCO ZVSIR1
     C                   ADD       ZINTCO        ZVSIR1
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Saldo int. fondo solidaridad
     C*SI ZSAIFS > *CEROS Y ZCOTFS > *CERO
     C     ZSAIFS        IFGT      *ZEROS
     C     ZCOTFS        ANDGT     *ZERO
     C* Total de intereses distribuido F.S
     C*CALCULAR (R) ZSAIF3 = ZSAIF4 - ZSAIFS
     C     ZSAIF4        SUB(H)    ZSAIFS        ZSAIF3
     C* Separar intereses simples de efectivos
     C* Int.simple>distribuido
     C*SI ZSAIF2 > ZSAIF3
     C     ZSAIF2        IFGT      ZSAIF3
     C* Saldo int. simple F.S
     C*CALCULAR (R) ZSAIF5 = ZSAIF2 - ZSAIF3
     C     ZSAIF2        SUB(H)    ZSAIF3        ZSAIF5
     C* El saldo de int. T.E. F.S está en ZSAIF1
     C*SINO
     C                   ELSE
     C* Saldo int. simple F.S
     C*LIMPIAR ZSAIF5
     C                   CLEAR                   ZSAIF5
     C* Saldo Int. T.E. F.S
     C*MOVER ZSAIF1 ZSAIFS
     C                   Z-ADD     ZSAIFS        ZSAIF1
     C*FIN
     C                   END
     C* Distribuir intereses simples
     C*SI ZSAIF5>*CERO
     C     ZSAIF5        IFGT      *ZERO
     C*CALCULAR (R) ZINTCO = (ZCOTFS*(ZSAIF5-ZVSIFS))/(ZTOFS-ZVAFS)
     C     ZSAIF5        SUB       ZVSIFS        V$CA1           030 9
     C     ZCOTFS        MULT      V$CA1         V$CA1
     C     ZTOFS         SUB       ZVAFS         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido FS
     C*SUMAR ZINTCO ZVSIFS
     C                   ADD       ZINTCO        ZVSIFS
     C*FIN
     C                   END
     C* Distribuir intereses efectivos
     C*SI ZSAIF1>*CERO
     C     ZSAIF1        IFGT      *ZERO
     C*CALCULAR (R) ZINTCO = (ZCOTFS*(ZSAIF1-ZVSIF1))/(ZTOFS-ZVAFS)
     C     ZSAIF1        SUB       ZVSIF1        V$CA1           030 9
     C     ZCOTFS        MULT      V$CA1         V$CA1
     C     ZTOFS         SUB       ZVAFS         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido FS
     C*SUMAR ZINTCO ZVSIF1
     C                   ADD       ZINTCO        ZVSIF1
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Saldo intereses FGPM
     C*SI ZSAIFG>*CEROS Y ZCOTFG>*CEROS
     C     ZSAIFG        IFGT      *ZEROS
     C     ZCOTFG        ANDGT     *ZEROS
     C* Total de intereses distribuido F.G.P.M
     C*CALCULAR (R) ZSAIG3 = ZSAIG4 - ZSAIFG
     C     ZSAIG4        SUB(H)    ZSAIFG        ZSAIG3
     C* Separar intereses simples de efectivos
     C* Int.simple>distribuido
     C*SI ZSAIG2>ZSAIG3
     C     ZSAIG2        IFGT      ZSAIG3
     C* Saldo int. simple F.G.P
     C*CALCULAR (R) ZSAIG5 = ZSAIG2-ZSAIG3
     C     ZSAIG2        SUB(H)    ZSAIG3        ZSAIG5
     C* El saldo de int. T.E. F.G.P.M está en ZSAIG1
     C*SINO
     C                   ELSE
     C* Saldo int. simple F.G.P
     C*LIMPIAR ZSAIG5
     C                   CLEAR                   ZSAIG5
     C* Saldo Int. T.E. F.G.P.M
     C*MOVER ZSAIG1 ZSAIFG
     C                   Z-ADD     ZSAIFG        ZSAIG1
     C*FIN
     C                   END
     C* Distribuir intereses simples
     C*SI ZSAIG5>*CERO
     C     ZSAIG5        IFGT      *ZERO
     C*CALCULAR (R) ZINTCO = (ZCOTFG*(ZSAIG5-ZVSIFG))/(ZTOFGP-ZVAFGP)
     C     ZSAIG5        SUB       ZVSIFG        V$CA1           030 9
     C     ZCOTFG        MULT      V$CA1         V$CA1
     C     ZTOFGP        SUB       ZVAFGP        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido FGPM
     C*SUMAR ZINTCO ZVSIFG
     C                   ADD       ZINTCO        ZVSIFG
     C*FIN
     C                   END
     C* Distribuir intereses efectivos
     C*SI ZSAIG1>*CERO
     C     ZSAIG1        IFGT      *ZERO
     C*CALCULAR (R) ZINTCO = (ZCOTFG*(ZSAIG1-ZVSIG1))/(ZTOFGP-ZVAFGP)
     C     ZSAIG1        SUB       ZVSIG1        V$CA1           030 9
     C     ZCOTFG        MULT      V$CA1         V$CA1
     C     ZTOFGP        SUB       ZVAFGP        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido FGPM
     C*SUMAR ZINTCO ZVSIG1
     C                   ADD       ZINTCO        ZVSIG1
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Saldo intereses SFSP
     C*SI ZSAISF>*CEROS Y ZCOTSF>*CEROS
     C     ZSAISF        IFGT      *ZEROS
     C     ZCOTSF        ANDGT     *ZEROS
     C* Total de intereses distribuido S.F.S.P
     C*CALCULAR (R) ZSAIS3 = ZSAIS4-ZSAISF
     C     ZSAIS4        SUB(H)    ZSAISF        ZSAIS3
     C* Separar intereses simples de efectivos
     C* Int.simple>distribuido
     C*SI ZSAIS2>ZSAIS3
     C     ZSAIS2        IFGT      ZSAIS3
     C* Saldo int. simple S.F.S
     C*CALCULAR (R) ZSAIS5 = ZSAIS2-ZSAIS3
     C     ZSAIS2        SUB(H)    ZSAIS3        ZSAIS5
     C* El saldo de int. T.E. S.F.S.P está en ZSAIS1
     C*SINO
     C                   ELSE
     C* Saldo int. simple S.F.S
     C*LIMPIAR ZSAIS5
     C                   CLEAR                   ZSAIS5
     C* Saldo Int. T.E. S.F.S.P
     C*MOVER ZSAIS1 ZSAISF
     C                   Z-ADD     ZSAISF        ZSAIS1
     C*FIN
     C                   END
     C* Distribuir intereses simples
     C*SI ZSAIS5>*CERO
     C     ZSAIS5        IFGT      *ZERO
     C*CALCULAR (R) ZINTCO = (ZCOTSF*(ZSAIS5-ZVSISF))/(ZTOSFS-ZVASFS)
     C     ZSAIS5        SUB       ZVSISF        V$CA1           030 9
     C     ZCOTSF        MULT      V$CA1         V$CA1
     C     ZTOSFS        SUB       ZVASFS        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido SFSP
     C*SUMAR ZINTCO ZVSISF
     C                   ADD       ZINTCO        ZVSISF
     C*FIN
     C                   END
     C* Distribuir intereses efectivos
     C*SI ZSAIS1 > *CERO
     C     ZSAIS1        IFGT      *ZERO
     C*CALCULAR (R) ZINTCO = (ZCOTSF*(ZSAIS1-ZVSIS1))/(ZTOSFS-ZVASFS)
     C     ZSAIS1        SUB       ZVSIS1        V$CA1           030 9
     C     ZCOTSF        MULT      V$CA1         V$CA1
     C     ZTOSFS        SUB       ZVASFS        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido SFSP
     C*SUMAR ZINTCO ZVSIS1
     C                   ADD       ZINTCO        ZVSIS1
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualice saldo compensación                                ==
     C*==                                                              ==
     C*==================================================================
     C     M14067        BEGSR
     C*SI COMCU1 <> *CERO
     C     COMCU1        IFNE      *ZERO
     C*CALCULAR (R) ZVLCOM = (ZCUCOM * COMV01) / COMCU1
     C     ZCUCOM        MULT      COMV01        V$CA1           030 9
     C     V$CA1         DIV(H)    COMCU1        ZVLCOM
     C*FIN
     C                   END
     C*SI COMSA1 > *CERO
     C     COMSA1        IFGT      *ZERO
     C* Diferencia en cuotas entre el rezago
     C*CALCULAR (R) ZDICCR = COMSA1 - ZCUCOM
     C     COMSA1        SUB(H)    ZCUCOM        ZDICCR
     C*SINO
     C                   ELSE
     C* Diferencia en cuotas entre el rezago
     C*CALCULAR (R) ZDICCR = ZCUCOM
     C                   Z-ADD(H)  ZCUCOM        ZDICCR
     C*FIN
     C                   END
     C*CALCULAR (R) COMSA1 = COMSA1 - ZCUCOM
     C     COMSA1        SUB(H)    ZCUCOM        COMSA1
     C*CALCULAR (R) COMSAL = COMSAL - ZVLCOM
     C     COMSAL        SUB(H)    ZVLCOM        COMSAL
     C* Restar al valor histórico de la comp
     C*SI ZICRSF = '0'
     C     ZICRSF        IFEQ      '0'
     C* Actualizar el indicador de generación de compensación en PLAA16.
     C* Se cambió de planilla
     C*SI ZPLAG1 <> REZNRO
     C     ZPLAG1        IFNE      REZNRO
     C* Variables de trabajo
     C*LIMPIAR ZPLAOR ZINDER
     C                   CLEAR                   ZPLAOR
     C                   CLEAR                   ZINDER
     C* Llamado desde la acreditación
     C*PASAR ZPROEJ 'A'
     C                   MOVEL     'A'           ZPROEJ
     C* Planilla del rezago
     C*MOVER ZPLAG1 REZNRO
     C                   Z-ADD     REZNRO        ZPLAG1
     C* Buscar plan. origen
     C*LLAMAR TRPLSF60 (ZPLAOR ZPLAG1 PLAPER ZINDER ZPROEJ)
     C                   CALL      'TRPLSF60'
     C                   PARM                    ZPLAOR
     C                   PARM                    ZPLAG1
     C                   PARM                    PLAPER
     C                   PARM                    ZINDER
     C                   PARM                    ZPROEJ
     C* No se actualizó ind. comp. en PLAA16
     C*SI ZINDER = '2'
     C     ZINDER        IFEQ      '2'
     C* Planilla del rezago
     C*MOVER ZPLARE REZNRO
     C                   MOVE      REZNRO        ZPLARE
     C*OBTENER (1) ZERROR = 'No se actualizó ind. cruce compensación par
     C                   CLEAR                   ZERROR
     C     $HIL(060)     CAT       ZPLARE:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Fecha fondo ult. modif.
     C*PASAR COMF04  HISFE3
     C                   MOVEL     HISFE3        COMF04
     C* Fecha sistema modif.
     C*PASAR COMF05  ZFESIS
     C                   MOVEL     ZFESIS        COMF05
     C* Usuario modificó
     C*PASAR COMUSU  USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        COMUSU
     C*GRABAR COMAR5
     C     *IN84         IFEQ      '0'
     C                   UPDATE    COMRE5                               94
     C                   ELSE
     C                   WRITE     COMRE5                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Devolución a A.F.P.
     C*CASO COMTI5 = '1'
     C                   SELECT
     C     COMTI5        WHENEQ    '1'
     C*PASAR REZEST 'AFP'
     C                   MOVEL     'AFP'         REZEST
     C*LLAMAR TRREZA5D (COMTI6 COMNU8 REZCDI)
     C                   CALL      'TRREZA5D'
     C                   PARM                    COMTI6
     C                   PARM                    COMNU8
     C                   PARM                    REZCDI
     C* Devolución empleador
     C*CASO COMTI5 = '2'
     C     COMTI5        WHENEQ    '2'
     C*PASAR REZEST 'DEV'
     C                   MOVEL     'DEV'         REZEST
     C* Devolución A.F.P. x no Vinc.
     C*CASO COMTI5 = 'B'
     C     COMTI5        WHENEQ    'B'
     C*PASAR REZEST 'AFP'
     C                   MOVEL     'AFP'         REZEST
     C*LLAMAR TRREZA5D (COMTI6 COMNU8 REZCDI)
     C                   CALL      'TRREZA5D'
     C                   PARM                    COMTI6
     C                   PARM                    COMNU8
     C                   PARM                    REZCDI
     C* Marca rezago no vinculado
     C*PASAR REZI01 '1'
     C                   MOVEL     '1'           REZI01
     C* Devolución empleador x no vinc.
     C*CASO COMTI5 = 'C'
     C     COMTI5        WHENEQ    'C'
     C*PASAR REZEST 'DEV'
     C                   MOVEL     'DEV'         REZEST
     C* Marca rezago no vinculado
     C*PASAR REZI01 '1'
     C                   MOVEL     '1'           REZI01
     C*FINCASOS
     C                   ENDSL
     C                   ENDSR
     C*==================================================================
     C*==  Valida desarrollo especial req.13422                        ==
     C*==                                                              ==
     C*==================================================================
     C     M14068        BEGSR
     C*SI ZR3422 = 1
     C     ZR3422        IFEQ      1
     C*SI REZTI3 = '04' O REZTI3 = '14' O REZTI3 = '05' O REZTI3 = '15'
     C     REZTI3        IFEQ      '04'
     C     REZTI3        OREQ      '14'
     C     REZTI3        OREQ      '05'
     C     REZTI3        OREQ      '15'
     C*LIMPIAR $$DRAF
     C                   CLEAR                   $$DRAF
     C* Número de planilla
     C*MOVER ZDRPLA REZNRO
     C                   Z-ADD     REZNRO        ZDRPLA
     C* Pagina de planilla
     C*MOVER ZDRPAG REZNR1
     C                   Z-ADD     REZNR1        ZDRPAG
     C* Secuencia de planilla
     C*MOVER ZDRSEC REZNR2
     C                   Z-ADD     REZNR2        ZDRSEC
     C* Acción Consultar
     C*PASAR ZDRACC 'C'
     C                   MOVEL     'C'           ZDRACC
     C*LLAMAR RPDRAF50($$DRAF)
     C                   CALL      'RPDRAF50'
     C                   PARM                    $$DRAF
     C*SI ZDRERR = '0'
     C     ZDRERR        IFEQ      '0'
     C* Bloqueado para devolución RES o PEN
     C*PASAR REZSIA '4'
     C                   MOVEL     '4'           REZSIA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Genera registro de comisiones                               ==
     C*==                                                              ==
     C*==================================================================
     C     M14070        BEGSR
     C* Tipo de registro
     C*ASIGNAR COMTI2 '2'
     C                   MOVEL     '2'           COMTI2
     C* Solicitud/planilla
     C*MOVER COMSOL PLANU1
     C                   Z-ADD     PLANU1        COMSOL
     C* Fecha soli/planilla
     C*PASAR COMFE1 ZULFDE
     C                   MOVEL     ZULFDE        COMFE1
     C* Valor del salario
     C*MOVER COMVLR DETSAL
     C                   Z-ADD     DETSAL        COMVLR
     C* Fecha de produccion
     C*PASAR COMFE2 ZFESIS
     C                   MOVEL     ZFESIS        COMFE2
     C* Ind. de liquidacion
     C*PASAR COMIND 'N'
     C                   MOVEL     'N'           COMIND
     C*ASIGNAR COMNU3 '000'
     C                   MOVEL     '000'         COMNU3
     C* Nro. periodo de pago
     C*ASIGNARD COMNU3 AFIPE3
     C                   MOVE      AFIPE3        COMNU3
     C*LIMPIAR COMFE3 COMIN2 COMVA3
     C                   CLEAR                   COMFE3
     C                   CLEAR                   COMIN2
     C                   CLEAR                   COMVA3
     C* COMVA8 = Valor recaudado fué calculado en el módulo M14300
     C* Codigo del canal
     C*ASIGNAR COMCO2 AFIC15
     C                   MOVEL     AFIC15        COMCO2
     C* Codigo sucursal
     C*ASIGNAR COMCO3 AFIC03
     C                   MOVEL     AFIC03        COMCO3
     C* Codigo agencia
     C*ASIGNAR COMCO4 AFICO2
     C                   MOVEL     AFICO2        COMCO4
     C* Codigo supervisor
     C*ASIGNAR COMCO5 AFIC04
     C                   MOVEL     AFIC04        COMCO5
     C* Codigo vendedor
     C*ASIGNAR COMCO6 AFICO6
     C                   MOVEL     AFICO6        COMCO6
     C* Código interno afiliado
     C*MOVER   COMNU4 AFINUM
     C                   Z-ADD     AFINUM        COMNU4
     C*AGREGAR COMAR2
     C                   WRITE     COMRE2                               94
     C                   MOVE      *IN94         I$DUP
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza días cotizados                                    ==
     C*==                                                              ==
     C*==================================================================
     C     M14075        BEGSR
     C*SI ZDITRA = 0 Y ZDILIC = 0 Y ZT@002 = '3'
     C     ZDITRA        IFEQ      0
     C     ZDILIC        ANDEQ     0
     C     ZT@002        ANDEQ     '3'
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL
     C+  INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC, PLAARC WHERE
     C+  DETNU3 = PLANUM AND
     C+  PLANU1 = :REZNRO AND
     C+  DETPAG = :REZNR1 AND
     C+  DETSEC = :REZNR2
     C/END-EXEC
     C*FIN
     C                   END
     C*SI ZDITRA = 0 Y ZDILIC = 0 Y ZT@002 = '2'
     C     ZDITRA        IFEQ      0
     C     ZDILIC        ANDEQ     0
     C     ZT@002        ANDEQ     '2'
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC WHERE DETNU3 = :DETNU9 AND
     C+  DETPAG = :DETPA2 AND DETSEC = :DETSE4
     C/END-EXEC
     C*FIN
     C                   END
     C* Verifica período válido
     C*EJECUTAR M00022
     C                   EXSR      M00022
     C* Actualizar días
     C*PASAR ZT@PRO 'S'
     C                   MOVEL     'S'           ZT@PRO
     C*
     C* Relación inválida
     C*SI AFII30 = 'S'
     C     AFII30        IFEQ      'S'
     C* Período no válido
     C*SI ZT@IPV = 'N'
     C     ZT@IPV        IFEQ      'N'
     C* No actualizar DIAAR1
     C*PASAR ZT@PRO 'N'
     C                   MOVEL     'N'           ZT@PRO
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Limpia dias totales cotizados
     C*LIMPIAR ZDIATO
     C                   CLEAR                   ZDIATO
     C* suma dias normales + dias lic
     C*CALCULAR ZDIATO=DETDIA + DETDI1
     C     DETDIA        ADD       DETDI1        ZDIATO
     C* Actualizar DIAAR1
     C*SI ZT@PRO = 'S'
     C     ZT@PRO        IFEQ      'S'
     C*
     C* Código interno afiliado
     C*MOVER DIANUM AFINUM
     C                   Z-ADD     AFINUM        DIANUM
     C* Período de cotización
     C*PASAR DIAPER ZPERCO
     C                   MOVEL     ZPERCO        DIAPER
     C* Cotización al fondo
     C*LIMPIAR ZTIACR
     C                   CLEAR                   ZTIACR
     C* Días acreditador afiliado
     C*RECUPERARD DIAAR1 (DIANUM DIAPER ZTIACR)
     C     LL$102        KLIST
     C                   KFLD                    DIANUM
     C                   KFLD                    DIAPER
     C                   KFLD                    ZTIACR
     C     LL$102        CHAIN     DIAAR1                             5594
     C                   MOVE      *IN94         I$RND
     C     *IN55         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   DIARE1
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SI PLAT03<>'09' Y PLAT03<>'10' Y PLAT03<>'11' Y PLAT03<>'12' O PL
     C     PLAT03        IFNE      '09'
     C     PLAT03        ANDNE     '10'
     C     PLAT03        ANDNE     '11'
     C     PLAT03        ANDNE     '12'
     C     PLAT03        OREQ      '09'
     C     ZMARCA        ANDEQ     'S'
     C     PLAT03        OREQ      '10'
     C     ZMARCA        ANDEQ     'S'
     C     PLAT03        OREQ      '11'
     C     ZMARCA        ANDEQ     'S'
     C* Afiliado con ocupación decreto 2616
     C*SI ZI2616 = 'S'
     C     ZI2616        IFEQ      'S'
     C* Tipo de llamado Acr-Cons.
     C*PASAR ZTIPLL 'B'
     C                   MOVEL     'B'           ZTIPLL
     C* Días de decreto acreditados
     C*MOVER ZDIDEC ZCONVE
     C                   Z-ADD     ZCONVE        ZDIDEC
     C*LLAMAR TRDIAC63 (DIANUM DIAPER ZTIPLL ZDIDEC)
     C                   CALL      'TRDIAC63'
     C                   PARM                    DIANUM
     C                   PARM                    DIAPER
     C                   PARM                    ZTIPLL
     C                   PARM                    ZDIDEC
     C* Días de decreto aux
     C*LIMPIAR ZIADIA
     C                   CLEAR                   ZIADIA
     C* Días de dec. > a días actuales
     C*SI ZDIDEC > DIADIA
     C     ZDIDEC        IFGT      DIADIA
     C* Días acreditados
     C*MOVER ZIADIA ZDIDEC
     C                   Z-ADD     ZDIDEC        ZIADIA
     C*FIN
     C                   END
     C* Días semanas completas
     C*SUMAR ZCONVE DIADI1
     C                   ADD       ZCONVE        DIADI1
     C* Días acreditados > días del mes
     C*SI ZIADIA > ZHPN26
     C     ZIADIA        IFGT      ZHPN26
     C* Días del mes
     C*MOVER DIADIA ZHPN26
     C                   Z-ADD     ZHPN26        DIADIA
     C*SINO
     C                   ELSE
     C* Días de decreto mayores
     C*SI ZIADIA <> 0
     C     ZIADIA        IFNE      0
     C* Días del mes
     C*MOVER DIADIA ZIADIA
     C                   Z-ADD     ZIADIA        DIADIA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Salario
     C*SUMAR DETVA7 DIASAL
     C                   ADD       DETVA7        DIASAL
     C* Salario
     C*SUMAR DETVA7 DIASA2
     C                   ADD       DETVA7        DIASA2
     C*SINO
     C                   ELSE
     C*SI ZES3P=' '
     C     ZES3P         IFEQ      ' '
     C*SI ZT@002 = '2' Y ZRECAL='1' O PLAT03='02' Y ZRECAL='1'
     C     ZT@002        IFEQ      '2'
     C     ZRECAL        ANDEQ     '1'
     C     PLAT03        OREQ      '02'
     C     ZRECAL        ANDEQ     '1'
     C* Total días cotizados
     C*SUMAR ZDIPAG DIADI1
     C                   ADD       ZDIPAG        DIADI1
     C*SUMAR ZDIPAG DIADIA
     C                   ADD       ZDIPAG        DIADIA
     C*SI DIADIA > 30
     C     DIADIA        IFGT      30
     C*MOVER DIADIA 30
     C                   Z-ADD     30            DIADIA
     C*FIN
     C                   END
     C*SI MOVTI5='01' Y MOVT10='03' Y ZINDIA = 0
     C     MOVTI5        IFEQ      '01'
     C     MOVT10        ANDEQ     '03'
     C     ZINDIA        ANDEQ     0
     C* Acumulado de salarios
     C*SUMAR MOVSA2 DIASAL
     C                   ADD       MOVSA2        DIASAL
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT+DETDRL
     C+  INTO :ZDIATO
     C+  FROM SBDETARC, PLAARC WHERE
     C+  DETNU3 = :MOVNU2 AND
     C+  DETPAG = :MOVPAG AND
     C+  DETSEC = :MOVSEC
     C/END-EXEC
     C* Días acred. >= días del per.
     C*SI ZDIATO >= ZDIAPE
     C     ZDIATO        IFGE      ZDIAPE
     C* Salario mensual
     C*CALCULAR DIASA2 = DIASA2 + MOVSA2
     C     DIASA2        ADD       MOVSA2        DIASA2
     C*SINO
     C                   ELSE
     C* Días acreditados no son CERO
     C*SI ZDIATO != *CERO
     C     ZDIATO        IFNE      *ZERO
     C* Acumulado de salarios mensuales
     C*CALCULAR (R) DIASA2 = DIASA2 + ((MOVSA2/(ZDIATO)) * 30)
     C     MOVSA2        DIV       ZDIATO        V$CA1           030 9
     C     V$CA1         MULT      30            V$CA1
     C     DIASA2        ADD(H)    V$CA1         DIASA2
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Total días cotizados
     C*SUMAR ZDIATO DIADI1
     C                   ADD       ZDIATO        DIADI1
     C* Si se tiene más de 1 cotización para el mismo período, en días a
     C* El mayor de los dias reportados
     C*SI ZDIATO > DIADIA
     C     ZDIATO        IFGT      DIADIA
     C* Dias reportados de la planilla
     C*MOVER DIADIA ZDIATO
     C                   Z-ADD     ZDIATO        DIADIA
     C*FIN
     C                   END
     C* Acumulado de salarios
     C*SUMAR DETVA7 DIASAL
     C                   ADD       DETVA7        DIASAL
     C* Días acred. >= días del per.
     C*SI ZDIATO >= ZDIAPE
     C     ZDIATO        IFGE      ZDIAPE
     C* Salario mensual
     C*CALCULAR DIASA2 = DIASA2 + DETVA7
     C     DIASA2        ADD       DETVA7        DIASA2
     C*SINO
     C                   ELSE
     C* Días acreditados no son CERO
     C*SI ZDIATO != *CERO
     C     ZDIATO        IFNE      *ZERO
     C* Acumulado de salarios mensuales
     C*SI MOVTI5='01' Y MOVT10='03'
     C     MOVTI5        IFEQ      '01'
     C     MOVT10        ANDEQ     '03'
     C*MOVER ZDITRA ZDIATO
     C                   Z-ADD     ZDIATO        ZDITRA
     C*LIMPIAR ZDILIC
     C                   CLEAR                   ZDILIC
     C*FIN
     C                   END
     C*CALCULAR (R) DIASA2 = DIASA2 + ((DETVA7/(ZDITRA+ZDILIC)) * 30)
     C     ZDITRA        ADD       ZDILIC        V$CA1           030 9
     C     DETVA7        DIV       V$CA1         V$CA1
     C     V$CA1         MULT      30            V$CA1
     C     DIASA2        ADD(H)    V$CA1         DIASA2
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Acumulado de salarios
     C*SUMAR DETVA7 DIASAL
     C                   ADD       DETVA7        DIASAL
     C* Días acred. >= días del per.
     C*SI ZDIATO >= ZDIAPE
     C     ZDIATO        IFGE      ZDIAPE
     C* Salario mensual
     C*CALCULAR DIASA2 = DIASA2 + DETVA7
     C     DIASA2        ADD       DETVA7        DIASA2
     C*SINO
     C                   ELSE
     C* Días acreditados no son CERO
     C*SI ZDIATO != *CERO
     C     ZDIATO        IFNE      *ZERO
     C* Acumulado de salarios mensuales
     C*SI MOVTI5='01' Y MOVT10='03'
     C     MOVTI5        IFEQ      '01'
     C     MOVT10        ANDEQ     '03'
     C*MOVER ZDITRA ZDIATO
     C                   Z-ADD     ZDIATO        ZDITRA
     C*LIMPIAR ZDILIC
     C                   CLEAR                   ZDILIC
     C*FIN
     C                   END
     C*CALCULAR (R) DIASA2 = DIASA2 + ((DETVA7/(ZDITRA+ZDILIC)) * 30)
     C     ZDITRA        ADD       ZDILIC        V$CA1           030 9
     C     DETVA7        DIV       V$CA1         V$CA1
     C     V$CA1         MULT      30            V$CA1
     C     DIASA2        ADD(H)    V$CA1         DIASA2
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Retroactivos
     C*SINO
     C                   ELSE
     C*SI ZES13P=' '
     C     ZES13P        IFEQ      ' '
     C*SI DETVA7 <> DIASAL
     C     DETVA7        IFNE      DIASAL
     C* Acumulado de salarios
     C*SUMAR DETSAL DIASAL
     C                   ADD       DETSAL        DIASAL
     C* Días acred. >= días del per.
     C*SI ZDIATO >= ZDIAPE
     C     ZDIATO        IFGE      ZDIAPE
     C* Salario mensual
     C*CALCULAR DIASA2 = DIASA2 + DETSAL
     C     DIASA2        ADD       DETSAL        DIASA2
     C*SINO
     C                   ELSE
     C* Días acreditados no son CERO
     C*SI ZDIATO != *CERO
     C     ZDIATO        IFNE      *ZERO
     C* Valida retroac
     C*EJECUTAR M14089
     C                   EXSR      M14089
     C*SI ZDIATO>=ZDIAPE
     C     ZDIATO        IFGE      ZDIAPE
     C* Salario mensual
     C*CALCULAR DIASA2 = DIASA2 + DETSAL
     C     DIASA2        ADD       DETSAL        DIASA2
     C*SINO
     C                   ELSE
     C*CALCULAR (R) DIASA2 = DIASA2 + ((DETSAL/(ZDITRA+ZDILIC)) * 30)
     C     ZDITRA        ADD       ZDILIC        V$CA1           030 9
     C     DETSAL        DIV       V$CA1         V$CA1
     C     V$CA1         MULT      30            V$CA1
     C     DIASA2        ADD(H)    V$CA1         DIASA2
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Fecha sistema modificación
     C*PASAR DIAFE3 ZFESIS
     C                   MOVEL     ZFESIS        DIAFE3
     C* Usuario
     C*PASAR DIAUS1 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        DIAUS1
     C*GRABAR DIAAR1
     C     *IN55         IFEQ      '0'
     C                   UPDATE    DIARE1                               94
     C                   ELSE
     C                   WRITE     DIARE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Actualiza DIAAR1 para dec 376
     C*SI ZES13P='S'
     C     ZES13P        IFEQ      'S'
     C*LLAMAR RPHDEC376A(DETNU3 DETPAG DETSEC ZTIACR ZTARD ZTARPG)
     C                   MOVEL     'RPHDEC37'    H$L10            10
     C                   MOVE      '6A'          H$L10
     C                   CALL      H$L10
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    ZTIACR
     C                   PARM                    ZTARD
     C                   PARM                    ZTARPG
     C*FIN
     C                   END
     C* Actualiza DIAAR1 para dec 376
     C*SI ZES3P='S' Y PLAT03<>'09'
     C     ZES3P         IFEQ      'S'
     C     PLAT03        ANDNE     '09'
     C* Cotización al fondo
     C*PASAR ZTIACR 'D'
     C                   MOVEL     'D'           ZTIACR
     C* Días acreditador afiliado
     C*RECUPERARD DIAAR1 (DIANUM DIAPER ZTIACR)
     C     LL$103        KLIST
     C                   KFLD                    DIANUM
     C                   KFLD                    DIAPER
     C                   KFLD                    ZTIACR
     C     LL$103        CHAIN     DIAAR1                             5594
     C                   MOVE      *IN94         I$RND
     C     *IN55         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   DIARE1
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*PASAR DIATI1 ZTIACR
     C                   MOVEL     ZTIACR        DIATI1
     C* Total días cotizados
     C*SUMAR ZDIATO DIADI1
     C                   ADD       ZDIATO        DIADI1
     C*LIMPIAR DIASAL DIASA2
     C                   CLEAR                   DIASAL
     C                   CLEAR                   DIASA2
     C* Si se tiene más de 1 cotización para el mismo período, en días a
     C* El mayor de los dias reportados
     C*SI ZDIATO > DIADIA
     C     ZDIATO        IFGT      DIADIA
     C* Dias reportados de la planilla
     C*MOVER DIADIA ZDIATO
     C                   Z-ADD     ZDIATO        DIADIA
     C*FIN
     C                   END
     C* Origen
     C*PASAR DIAORI ZTIACR
     C                   MOVEL     ZTIACR        DIAORI
     C* Fecha sistema modificación
     C*PASAR DIAFE3 ZFESIS
     C                   MOVEL     ZFESIS        DIAFE3
     C* Usuario
     C*PASAR DIAUS1 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        DIAUS1
     C*GRABAR DIAAR1
     C     *IN55         IFEQ      '0'
     C                   UPDATE    DIARE1                               94
     C                   ELSE
     C                   WRITE     DIARE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*LIMPIAR DIATI1
     C                   CLEAR                   DIATI1
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DIAAR1 no disponible - M14075'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(061)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Se debe reversar comision
     C*SI ZINDCE = 'S'
     C     ZINDCE        IFEQ      'S'
     C* Indicador de reversion ces
     C*LIMPIAR ZINDCE
     C                   CLEAR                   ZINDCE
     C* Indicador de reversion
     C*PASAR ZINCOM 'R'
     C                   MOVEL     'R'           ZINCOM
     C* Modulo de cobro/reversion
     C*EJECUTAR M74140
     C                   EXSR      M74140
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Verifica si hay deuda para el detalle                       ==
     C*==                                                              ==
     C*==================================================================
     C     M14080        BEGSR
     C* Si el saldo despues de haber distribuido los valores por concept
     C* mayor que el delta genera las deudas de lo contrario no . O se c
     C* deudas anteriores con el monto de la cot. oblig. emplead. no pac
     C*
     C*CALCULAR ZSALDO = ZSACO + ZSAAR + ZSACVE + ZSACVA + ZSAFS + ZSAFG
     C     ZSACO         ADD       ZSAAR         V$CA1           030 9
     C     V$CA1         ADD       ZSACVE        V$CA1
     C     V$CA1         ADD       ZSACVA        V$CA1
     C     V$CA1         ADD       ZSAFS         V$CA1
     C     V$CA1         ADD       ZSAFGP        V$CA1
     C     V$CA1         ADD       ZSASFS        ZSALDO
     C*
     C* Desarrollo especial activo
     C*SI ZR7436 = '1'
     C     ZR7436        IFEQ      '1'
     C*CALCULAR ZSALDI = ZSAINT + ZSICVA + ZSICVE + ZSINAR + ZSAIFS + ZS
     C     ZSAINT        ADD       ZSICVA        V$CA1           030 9
     C     V$CA1         ADD       ZSICVE        V$CA1
     C     V$CA1         ADD       ZSINAR        V$CA1
     C     V$CA1         ADD       ZSAIFS        V$CA1
     C     V$CA1         ADD       ZSAIFG        V$CA1
     C     V$CA1         ADD       ZSAISF        ZSALDI
     C*SUMAR ZSALDI ZSALDO
     C                   ADD       ZSALDI        ZSALDO
     C*FIN
     C                   END
     C*
     C* Entidad a leer AFIAR3
     C*PASAR ZENTID  '3'
     C                   MOVEL     '3'           ZENTID
     C* Código interno afiliado
     C*MOVER ZNUM12 AFINUM
     C                   Z-ADD     AFINUM        ZNUM12
     C* Período de la planilla
     C*PASAR ZALFA8 PLAPER
     C                   CLEAR                   ZALFA8
     C                   MOVEL     PLAPER        ZALFA8
     C* Indicador de error
     C*LIMPIAR ZALFA5 ZINERE ZFITIP
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C                   CLEAR                   ZFITIP
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM21 ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM21
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C* ERE (AFIAR3) Y AFIES3 = 'TRS' Y PLAPER <= AFIF14
     C*SI ZINERE = '0'
     C     ZINERE        IFEQ      '0'
     C* AFIF14 Período incorp./Fecha inactivación
     C*PASAR ZPEINC ZALFA8
     C                   MOVEL     ZALFA8        ZPEINC
     C*SINO
     C                   ELSE
     C* Período fecha incorporación
     C*LIMPIAR ZPEINC
     C                   CLEAR                   ZPEINC
     C*FIN
     C                   END
     C*SI ZSALDO>ZDELTA O ZINCDE='1' O PLATIP='01' Y PLAT03='03' O PLATI
     C     ZSALDO        IFGT      ZDELTA
     C     ZINCDE        OREQ      '1'
     C     PLATIP        OREQ      '01'
     C     PLAT03        ANDEQ     '03'
     C     PLATIP        OREQ      '07'
     C*LIMPIAR DETCO3 DETCO6 DETV10 DETV11 DETV21 DETV15 DETSA1 DETS17 D
     C                   CLEAR                   DETCO3
     C                   CLEAR                   DETCO6
     C                   CLEAR                   DETV10
     C                   CLEAR                   DETV11
     C                   CLEAR                   DETV21
     C                   CLEAR                   DETV15
     C                   CLEAR                   DETSA1
     C                   CLEAR                   DETS17
     C                   CLEAR                   DETSA4
     C*LIMPIAR DETSA3 DETSA7 DETS01 DETS07 DETINT DETSA5 DETSUB DETF03 D
     C                   CLEAR                   DETSA3
     C                   CLEAR                   DETSA7
     C                   CLEAR                   DETS01
     C                   CLEAR                   DETS07
     C                   CLEAR                   DETINT
     C                   CLEAR                   DETSA5
     C                   CLEAR                   DETSUB
     C                   CLEAR                   DETF03
     C                   CLEAR                   DETF05
     C*LIMPIAR DETC20 DETC56
     C                   CLEAR                   DETC20
     C                   CLEAR                   DETC56
     C*LIMPIAR DETV77 DETS95 DETV78 DETS96 DETV79 DETS97 DETI32 DETS98
     C                   CLEAR                   DETV77
     C                   CLEAR                   DETS95
     C                   CLEAR                   DETV78
     C                   CLEAR                   DETS96
     C                   CLEAR                   DETV79
     C                   CLEAR                   DETS97
     C                   CLEAR                   DETI32
     C                   CLEAR                   DETS98
     C*LIMPIAR DETV94 DET120 DETI56 DET125 DETV95 DET126 DETV96 DET127
     C                   CLEAR                   DETV94
     C                   CLEAR                   DET120
     C                   CLEAR                   DETI56
     C                   CLEAR                   DET125
     C                   CLEAR                   DETV95
     C                   CLEAR                   DET126
     C                   CLEAR                   DETV96
     C                   CLEAR                   DET127
     C* Evalúa valor cotizaciones
     C*EJECUTAR M14083
     C                   EXSR      M14083
     C*CALCULAR ZVDETD = DETV10 + DETCO6 + DETCO3 + DETV11 + DETV77 + DE
     C     DETV10        ADD       DETCO6        V$CA1           030 9
     C     V$CA1         ADD       DETCO3        V$CA1
     C     V$CA1         ADD       DETV11        V$CA1
     C     V$CA1         ADD       DETV77        V$CA1
     C     V$CA1         ADD       DETV79        V$CA1
     C     V$CA1         ADD       DETV78        V$CA1
     C     V$CA1         ADD       DETV15        V$CA1
     C     V$CA1         ADD       DETI32        V$CA1
     C     V$CA1         ADD       DETINT        V$CA1
     C     V$CA1         ADD       DETV94        V$CA1
     C     V$CA1         ADD       DETI56        V$CA1
     C     V$CA1         ADD       DETV95        V$CA1
     C     V$CA1         ADD       DETV96        ZVDETD
     C* Algún campo del detalle de deuda es mayor a cero
     C*SI ZVDETD > 0
     C     ZVDETD        IFGT      0
     C* Genera detalle deuda
     C*EJECUTAR M14084
     C                   EXSR      M14084
     C* Si ya existe el detalle de deuda - acred. de rezagos x rev. de m
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C* Recuperar detalle de planilla
     C*EJECUTAR M14082
     C                   EXSR      M14082
     C*SINO
     C                   ELSE
     C* SAE
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C*CALCULAR ZDEUDE = DETSA1+DETSA4+DETSA3+DETSA7+DETS95+DETS97
     C     DETSA1        ADD       DETSA4        V$CA1           030 9
     C     V$CA1         ADD       DETSA3        V$CA1
     C     V$CA1         ADD       DETSA7        V$CA1
     C     V$CA1         ADD       DETS95        V$CA1
     C     V$CA1         ADD       DETS97        ZDEUDE
     C*PASAR ZSIGNO '+'
     C                   MOVEL     '+'           ZSIGNO
     C*SAE
     C*LLAMAR TRINCE64(DETTIP DETNU9 DETPA2 DETSE4 DETNR1 ZDEUDE ZSIGNO
     C                   CALL      'TRINCE64'
     C                   PARM                    DETTIP
     C                   PARM                    DETNU9
     C                   PARM                    DETPA2
     C                   PARM                    DETSE4
     C                   PARM                    DETNR1
     C                   PARM                    ZDEUDE
     C                   PARM                    ZSIGNO
     C                   PARM                    ZERCON
     C* ERROR CONCURRENCIA EN TRDEUD79
     C*SI ZERCON = '1'
     C     ZERCON        IFEQ      '1'
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C* Rollback
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C* Finaliza proceso
     C*LLAMAR TRCTPR51 (FUNCIO ZMODO ZNRTRA)
     C                   CALL      'TRCTPR51'
     C                   PARM                    FUNCIO
     C                   PARM                    ZMODO
     C                   PARM                    ZNRTRA
     C*TERMINAR
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*MOVER MOVVA1 ZVDETD
     C                   Z-ADD     ZVDETD        MOVVA1
     C* Cód. transacción
     C*PASAR ZCODTX '03'
     C                   MOVEL     '03'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '31'
     C                   MOVEL     '31'          ZCONCE
     C* Página
     C*MOVER MOVPA2 DETPA2
     C                   Z-ADD     DETPA2        MOVPA2
     C* Secuencia
     C*MOVER MOVSE2 DETSE4
     C                   Z-ADD     DETSE4        MOVSE2
     C* Tipo de deuda
     C*MOVER DEUTIP DETTIP
     C                   MOVE      DETTIP        DEUTIP
     C* Número de planilla
     C*MOVER DEUNUM DETNU9
     C                   Z-ADD     DETNU9        DEUNUM
     C* Nit del empleador
     C*MOVER DEUNRO DETID2
     C                   Z-ADD     DETID2        DEUNRO
     C* Fecha de inicio de deuda
     C*PASAR DEUFE6 DETF10
     C                   MOVEL     DETF10        DEUFE6
     C* Genera movimiento por detalle
     C*EJECUTAR M14391
     C                   EXSR      M14391
     C* Transacción
     C*MOVER ZTRANS '03'
     C                   MOVE      '03'          ZTRANS
     C* Concepto
     C*MOVER ZCONCE '31'
     C                   MOVE      '31'          ZCONCE
     C* Planilla de cancelación
     C*MOVER ZPLACA *CERO
     C                   MOVE      *ZERO         ZPLACA
     C* Imprime reporte detallado
     C*EJECUTAR DET@02
     C                   EXSR      DET@02
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Recuperar detalle de planilla                               ==
     C*==                                                              ==
     C*==================================================================
     C     M14082        BEGSR
     C* Planilla de afiliaciones anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Tipo de deuda
     C*PASAR DETTIP '05'
     C                   MOVEL     '05'          DETTIP
     C*SINO
     C                   ELSE
     C* No es planilla de terceros
     C*SI PLATIP <> '07'
     C     PLATIP        IFNE      '07'
     C* Tipo de deuda
     C*PASAR DETTIP '01'
     C                   MOVEL     '01'          DETTIP
     C* Planilla de terceros
     C*SINO
     C                   ELSE
     C* Tipo de deuda
     C*PASAR DETTIP '07'
     C                   MOVEL     '07'          DETTIP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Nro. planilla deuda
     C*MOVER DETNU9 PLANU1
     C                   Z-ADD     PLANU1        DETNU9
     C* Página
     C*MOVER DETPA2 DETPAG
     C                   Z-ADD     DETPAG        DETPA2
     C* Secuencia
     C*MOVER DETSE4 DETSEC
     C                   Z-ADD     DETSEC        DETSE4
     C*RECUPERARD DETAR2 (DETTIP DETNU9 DETPA2 DETSE4)
     C     LL$104        KLIST
     C                   KFLD                    DETTIP
     C                   KFLD                    DETNU9
     C                   KFLD                    DETPA2
     C                   KFLD                    DETSE4
     C     LL$104        CHAIN     DETAR2                             4794
     C                   MOVE      *IN94         I$RND
     C     *IN47         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   DETRE1
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Toma datos de SAE
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C*CALCULAR ZDEUDE = DETSA1+DETSA4+DETSA3+DETSA7+DETS95+DETS97
     C     DETSA1        ADD       DETSA4        V$CA1           030 9
     C     V$CA1         ADD       DETSA3        V$CA1
     C     V$CA1         ADD       DETSA7        V$CA1
     C     V$CA1         ADD       DETS95        V$CA1
     C     V$CA1         ADD       DETS97        ZDEUDE
     C*FIN
     C                   END
     C*
     C*LIMPIAR DETCO3 DETCO6 DETV10 DETV11 DETV21 DETV15 DETSA1 DETS17 D
     C                   CLEAR                   DETCO3
     C                   CLEAR                   DETCO6
     C                   CLEAR                   DETV10
     C                   CLEAR                   DETV11
     C                   CLEAR                   DETV21
     C                   CLEAR                   DETV15
     C                   CLEAR                   DETSA1
     C                   CLEAR                   DETS17
     C                   CLEAR                   DETSA4
     C*LIMPIAR DETSA3 DETSA7 DETS01 DETS07 DETINT DETSA5 DETSUB DETF03 D
     C                   CLEAR                   DETSA3
     C                   CLEAR                   DETSA7
     C                   CLEAR                   DETS01
     C                   CLEAR                   DETS07
     C                   CLEAR                   DETINT
     C                   CLEAR                   DETSA5
     C                   CLEAR                   DETSUB
     C                   CLEAR                   DETF03
     C                   CLEAR                   DETF05
     C*LIMPIAR DETC20 DETC56 DETV77 DETS95 DETV78 DETS96 DETV79 DETS97 D
     C                   CLEAR                   DETC20
     C                   CLEAR                   DETC56
     C                   CLEAR                   DETV77
     C                   CLEAR                   DETS95
     C                   CLEAR                   DETV78
     C                   CLEAR                   DETS96
     C                   CLEAR                   DETV79
     C                   CLEAR                   DETS97
     C                   CLEAR                   DETI32
     C                   CLEAR                   DETS98
     C*LIMPIAR DETV94 DET120 DETI56 DET125 DETV95 DET126 DETV96 DET127
     C                   CLEAR                   DETV94
     C                   CLEAR                   DET120
     C                   CLEAR                   DETI56
     C                   CLEAR                   DET125
     C                   CLEAR                   DETV95
     C                   CLEAR                   DET126
     C                   CLEAR                   DETV96
     C                   CLEAR                   DET127
     C* Cot. voluntaria afiliado
     C*SI ZCOTVA > ZTDCVA
     C     ZCOTVA        IFGT      ZTDCVA
     C* Valor deuda c.v.a
     C*CALCULAR DETV10 = ZCOTVA - ZTDCVA
     C     ZCOTVA        SUB       ZTDCVA        DETV10
     C*FIN
     C                   END
     C* Cot. fondo de solidaridad
     C*SI ZCOTFS > ZTDFS
     C     ZCOTFS        IFGT      ZTDFS
     C* Valor deuda f.s.
     C*CALCULAR DETCO6 = ZCOTFS - ZTDFS
     C     ZCOTFS        SUB       ZTDFS         DETCO6
     C*FIN
     C                   END
     C* Cot. Fondo de subsistencia
     C*SI ZCOTSF > ZTDSFS
     C     ZCOTSF        IFGT      ZTDSFS
     C* Valor deuda SFSP
     C*CALCULAR DETV79 = ZCOTSF - ZTDSFS
     C     ZCOTSF        SUB       ZTDSFS        DETV79
     C*FIN
     C                   END
     C* Cot. alto riesgo
     C*SI ZCOTAR > ZTDAR
     C     ZCOTAR        IFGT      ZTDAR
     C* Valor deuda alto riesgo
     C*CALCULAR DETCO3 = ZCOTAR - ZTDAR
     C     ZCOTAR        SUB       ZTDAR         DETCO3
     C* Saldo alto riesgo
     C*CALCULAR DETS17 = ZCOTAR - ZTDAR
     C     ZCOTAR        SUB       ZTDAR         DETS17
     C*FIN
     C                   END
     C* Fondo de garantía
     C*SI ZCOTFG > ZTDFGP
     C     ZCOTFG        IFGT      ZTDFGP
     C* Valor FGPM
     C*CALCULAR DETV77 = ZCOTFG - ZTDFGP
     C     ZCOTFG        SUB       ZTDFGP        DETV77
     C*FIN
     C                   END
     C* Cot. obigatoria
     C*SI ZCOTOB > ZTDCO
     C     ZCOTOB        IFGT      ZTDCO
     C*CALCULAR DETCO3 = DETCO3 + (ZCOTOB - ZTDCO)
     C     ZCOTOB        SUB       ZTDCO         V$CA1           030 9
     C     DETCO3        ADD       V$CA1         DETCO3
     C*FIN
     C                   END
     C* Cot. voluntaria empleador
     C*SI ZCOTVE > ZTDCVE
     C     ZCOTVE        IFGT      ZTDCVE
     C* Valor deuda c.v.e
     C*CALCULAR DETV11 = ZCOTVE - ZTDCVE
     C     ZCOTVE        SUB       ZTDCVE        DETV11
     C*FIN
     C                   END
     C*SI DETV10 > 0 O DETCO6 > 0 O DETCO3 > 0 O DETV11 > 0 O DETV77 > 0
     C     DETV10        IFGT      0
     C     DETCO6        ORGT      0
     C     DETCO3        ORGT      0
     C     DETV11        ORGT      0
     C     DETV77        ORGT      0
     C     DETV79        ORGT      0
     C* Actualizar datos detalle deuda
     C*EJECUTAR M14086
     C                   EXSR      M14086
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DETAR2 no disponible - M14082'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(062)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Evalúa valor de cotizaciones                                ==
     C*==                                                              ==
     C*==================================================================
     C     M14083        BEGSR
     C* Cot. voluntaria afiliado
     C*SI ZCOTVA > ZTDCVA
     C     ZCOTVA        IFGT      ZTDCVA
     C* Valor deuda c.v.a
     C*CALCULAR DETV10 = ZCOTVA - ZTDCVA
     C     ZCOTVA        SUB       ZTDCVA        DETV10
     C* Plan. afiliaciones anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Total deuda 05
     C*SUMAR DETV10 ZTOTD1
     C                   ADD       DETV10        ZTOTD1
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETV10 ZTOTDE
     C                   ADD       DETV10        ZTOTDE
     C*FIN
     C                   END
     C* Reporte total valor C.V.A.
     C*SUMAR DETV10 ZVAVAD
     C                   ADD       DETV10        ZVAVAD
     C*FIN
     C                   END
     C* Cot. fondo de solidaridad
     C*SI ZCOTFS > ZTDFS
     C     ZCOTFS        IFGT      ZTDFS
     C* Valor deuda f.s.
     C*CALCULAR DETCO6 = ZCOTFS - ZTDFS
     C     ZCOTFS        SUB       ZTDFS         DETCO6
     C* Planilla de afil. anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Total deuda 05
     C*SUMAR DETCO6 ZTOTD1
     C                   ADD       DETCO6        ZTOTD1
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETCO6 ZTOTDE
     C                   ADD       DETCO6        ZTOTDE
     C*FIN
     C                   END
     C* Reporte total F.S.
     C*SUMAR DETCO6 ZVAFSD
     C                   ADD       DETCO6        ZVAFSD
     C*FIN
     C                   END
     C* Cot. SFSP
     C*SI ZCOTSF > ZTDSFS
     C     ZCOTSF        IFGT      ZTDSFS
     C* Valor deuda SFSP
     C*CALCULAR DETV79 = ZCOTSF - ZTDSFS
     C     ZCOTSF        SUB       ZTDSFS        DETV79
     C* Planilla de afil. anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Total deuda 05
     C*SUMAR DETV79 ZTOTD1
     C                   ADD       DETV79        ZTOTD1
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETV79 ZTOTDE
     C                   ADD       DETV79        ZTOTDE
     C*FIN
     C                   END
     C* Reporte total SFSP
     C*SUMAR DETV79 ZVASFD
     C                   ADD       DETV79        ZVASFD
     C*FIN
     C                   END
     C* Cot. alto riesgo
     C*SI ZCOTAR > ZTDAR
     C     ZCOTAR        IFGT      ZTDAR
     C* Valor deuda alto riesgo
     C*CALCULAR DETCO3 = ZCOTAR - ZTDAR
     C     ZCOTAR        SUB       ZTDAR         DETCO3
     C* Saldo alto riesgo
     C*CALCULAR DETS17 = ZCOTAR - ZTDAR
     C     ZCOTAR        SUB       ZTDAR         DETS17
     C* Plan. afiliaciones anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Total deuda 05
     C*SUMAR DETCO3 ZTOTD1
     C                   ADD       DETCO3        ZTOTD1
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETCO3 ZTOTDE
     C                   ADD       DETCO3        ZTOTDE
     C*FIN
     C                   END
     C* Reporte totales Valor A.R.
     C*SUMAR DETCO3 ZVAARD
     C                   ADD       DETCO3        ZVAARD
     C*FIN
     C                   END
     C* Fondo de garantía
     C*SI ZCOTFG > ZTDFGP
     C     ZCOTFG        IFGT      ZTDFGP
     C* Valor deuda fondo de garantía
     C*CALCULAR DETV77 = ZCOTFG - ZTDFGP
     C     ZCOTFG        SUB       ZTDFGP        DETV77
     C* Planilla de afil. anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Totasl deuda 05
     C*SUMAR DETV77 ZTOTD1
     C                   ADD       DETV77        ZTOTD1
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETV77 ZTOTDE
     C                   ADD       DETV77        ZTOTDE
     C*FIN
     C                   END
     C* Reporte total fondo de garantía
     C*SUMAR DETV77 ZVAFGD
     C                   ADD       DETV77        ZVAFGD
     C*FIN
     C                   END
     C* Cot. obligatoria
     C*SI ZCOTOB > ZTDCO
     C     ZCOTOB        IFGT      ZTDCO
     C*CALCULAR DETCO3 = DETCO3 + (ZCOTOB - ZTDCO)
     C     ZCOTOB        SUB       ZTDCO         V$CA1           030 9
     C     DETCO3        ADD       V$CA1         DETCO3
     C* Plan. afiliaciones anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C*CALCULAR ZTOTD1 = ZTOTD1 + (ZCOTOB - ZTDCO)
     C     ZCOTOB        SUB       ZTDCO         V$CA1           030 9
     C     ZTOTD1        ADD       V$CA1         ZTOTD1
     C*SINO
     C                   ELSE
     C*CALCULAR ZTOTDE = ZTOTDE + (ZCOTOB - ZTDCO)
     C     ZCOTOB        SUB       ZTDCO         V$CA1           030 9
     C     ZTOTDE        ADD       V$CA1         ZTOTDE
     C*FIN
     C                   END
     C*CALCULAR ZVACOD = ZVACOD + ZCOTOB - ZTDCO
     C     ZVACOD        ADD       ZCOTOB        V$CA1           030 9
     C     V$CA1         SUB       ZTDCO         ZVACOD
     C*FIN
     C                   END
     C* Cot. voluntaria empleador
     C*SI ZCOTVE > ZTDCVE
     C     ZCOTVE        IFGT      ZTDCVE
     C* Valor deuda c.v.e
     C*CALCULAR DETV11 = ZCOTVE - ZTDCVE
     C     ZCOTVE        SUB       ZTDCVE        DETV11
     C* Plan. afiliaciones anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Total deuda 05
     C*SUMAR DETV11 ZTOTD1
     C                   ADD       DETV11        ZTOTD1
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETV11 ZTOTDE
     C                   ADD       DETV11        ZTOTDE
     C*FIN
     C                   END
     C* Reporte totales C.V.E.
     C*SUMAR DETV11 ZVAVED
     C                   ADD       DETV11        ZVAVED
     C*FIN
     C                   END
     C*
     C* Proceso por terceros
     C*SI ZINDTE = 'S' Y PLATIP = '07'
     C     ZINDTE        IFEQ      'S'
     C     PLATIP        ANDEQ     '07'
     C* Valor de interés compuesto
     C*PASAR ZIND '4'
     C                   MOVEL     '4'           ZIND
     C*LLAMAR TRDPIN50 (ZIND ZLOT ZPLA ZPAG ZSEC ZFDE ZID ZPER ZTPLA ZTP
     C                   CALL      'TRDPIN50'
     C                   PARM                    ZIND
     C                   PARM                    ZLOT
     C                   PARM                    ZPLA
     C                   PARM                    ZPAG
     C                   PARM                    ZSEC
     C                   PARM                    ZFDE
     C                   PARM                    ZID
     C                   PARM                    ZPER
     C                   PARM                    ZTPLA
     C                   PARM                    ZTPAG
     C                   PARM                    ZINDLI
     C                   PARM                    ZAMP
     C                   PARM                    ZLIQIN
     C                   PARM                    ZINCFS
     C                   PARM                    ZINCSF
     C                   PARM                    ZINCNT
     C                   PARM                    ZICCVA
     C                   PARM                    ZICCVE
     C                   PARM                    ZINCAR
     C                   PARM                    ZINCFG
     C                   PARM                    ZER
     C                   PARM                    ZFI
     C* Cot. voluntaria empleador
     C*SI ZINIFG >= ZTDIFG
     C     ZINIFG        IFGE      ZTDIFG
     C* Valor int. simple
     C*CALCULAR ZINIFG = ZINIFG - ZINCFG
     C     ZINIFG        SUB       ZINCFG        ZINIFG
     C* No pago total int. simple
     C*SI ZINIFG > ZTDIFG
     C     ZINIFG        IFGT      ZTDIFG
     C* Valor deuda IFGPM
     C*CALCULAR DETV78 = ZINIFG - ZTDIFG
     C     ZINIFG        SUB       ZTDIFG        DETV78
     C* Toda la deuda x int. compuesto
     C*MOVER DETV95 ZINCFG
     C                   Z-ADD     ZINCFG        DETV95
     C* Deuda solo para int. compuesto
     C*SINO
     C                   ELSE
     C*CALCULAR (R) DETV95 = ZINCFG - (ZTDIFG - ZINIFG)
     C     ZTDIFG        SUB       ZINIFG        V$CA1           030 9
     C     ZINCFG        SUB(H)    V$CA1         DETV95
     C*FIN
     C                   END
     C* Plan. afiliaciones anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Total deuda 05
     C*SUMAR DETV78 ZTOTI1
     C                   ADD       DETV78        ZTOTI1
     C* Total deuda 05
     C*SUMAR DETV95 ZTOTI3
     C                   ADD       DETV95        ZTOTI3
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETV78 ZTOTIN
     C                   ADD       DETV78        ZTOTIN
     C* Total deuda 01
     C*SUMAR DETV95 ZTOTI2
     C                   ADD       DETV95        ZTOTI2
     C*FIN
     C                   END
     C* Reporte totales IFGPM
     C*CALCULAR ZVIFGD = DETV78 + DETV95
     C     DETV78        ADD       DETV95        ZVIFGD
     C*FIN
     C                   END
     C*
     C* Int. F.S
     C*SI ZINIFS > ZTDIFS
     C     ZINIFS        IFGT      ZTDIFS
     C* Valor int. simple
     C*CALCULAR ZINIFS = ZINIFS - ZINCFS
     C     ZINIFS        SUB       ZINCFS        ZINIFS
     C* No pago total int. simple
     C*SI ZINIFS > ZTDIFS
     C     ZINIFS        IFGT      ZTDIFS
     C* Valor deuda F.S
     C*CALCULAR DETV15 = ZINIFS - ZTDIFS
     C     ZINIFS        SUB       ZTDIFS        DETV15
     C* Toda la deuda x int. compuesto
     C*MOVER DETV94 ZINCFG
     C                   Z-ADD     ZINCFG        DETV94
     C* Deuda solo para int. compuesto
     C*SINO
     C                   ELSE
     C*CALCULAR (R) DETV94 = ZINCFS - (ZTDIFS - ZINIFS)
     C     ZTDIFS        SUB       ZINIFS        V$CA1           030 9
     C     ZINCFS        SUB(H)    V$CA1         DETV94
     C*FIN
     C                   END
     C* Plan. afiliaciones anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Total deuda 05
     C*SUMAR DETV15 ZTOTI1
     C                   ADD       DETV15        ZTOTI1
     C* Total deuda 05
     C*SUMAR DETV94 ZTOTI3
     C                   ADD       DETV94        ZTOTI3
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETV15 ZTOTIN
     C                   ADD       DETV15        ZTOTIN
     C* Total deuda 01
     C*SUMAR DETV94 ZTOTI2
     C                   ADD       DETV94        ZTOTI2
     C*FIN
     C                   END
     C* Reporte totales F.S
     C*CALCULAR ZVIFSD = DETV15 + DETV94
     C     DETV15        ADD       DETV94        ZVIFSD
     C*FIN
     C                   END
     C*
     C* Int. subsistencia
     C*SI ZINISF > ZTDISF
     C     ZINISF        IFGT      ZTDISF
     C* Valor int. simple
     C*CALCULAR ZINISF = ZINISF - ZINCSF
     C     ZINISF        SUB       ZINCSF        ZINISF
     C* No pago total int. simple
     C*SI ZINISF > ZTDISF
     C     ZINISF        IFGT      ZTDISF
     C* Valor deuda subsistencia
     C*CALCULAR DETI32 = ZINISF - ZTDISF
     C     ZINISF        SUB       ZTDISF        DETI32
     C* Toda la deuda x int. compuesto
     C*MOVER DETV96 ZINCFG
     C                   Z-ADD     ZINCFG        DETV96
     C* Deuda solo para int. compuesto
     C*SINO
     C                   ELSE
     C*CALCULAR (R) DETV96 = ZINCSF - (ZTDISF - ZINISF)
     C     ZTDISF        SUB       ZINISF        V$CA1           030 9
     C     ZINCSF        SUB(H)    V$CA1         DETV96
     C*FIN
     C                   END
     C* Plan. afiliaciones anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Total deuda 05
     C*SUMAR DETI32 ZTOTI1
     C                   ADD       DETI32        ZTOTI1
     C* Total deuda 05
     C*SUMAR DETV96 ZTOTI3
     C                   ADD       DETV96        ZTOTI3
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETI32 ZTOTIN
     C                   ADD       DETI32        ZTOTIN
     C* Total deuda 05
     C*SUMAR DETV96 ZTOTI2
     C                   ADD       DETV96        ZTOTI2
     C*FIN
     C                   END
     C* Reporte totales subsistencia
     C*CALCULAR ZVISFD = DETI32 + DETV96
     C     DETI32        ADD       DETV96        ZVISFD
     C*FIN
     C                   END
     C*
     C* Intereses
     C*SI ZVINTE > ZTDINT
     C     ZVINTE        IFGT      ZTDINT
     C* Valor int. simple
     C*CALCULAR ZVINTE = ZVINTE - ZINCNT - ZICCVA - ZICCVE - ZINCAR
     C     ZVINTE        SUB       ZINCNT        V$CA1           030 9
     C     V$CA1         SUB       ZICCVA        V$CA1
     C     V$CA1         SUB       ZICCVE        V$CA1
     C     V$CA1         SUB       ZINCAR        ZVINTE
     C* No pago total int. simple
     C*SI ZVINTE > ZTDINT
     C     ZVINTE        IFGT      ZTDINT
     C* Valor deuda intereses
     C*CALCULAR DETINT = ZVINTE - ZTDINT
     C     ZVINTE        SUB       ZTDINT        DETINT
     C* Toda la deuda x int. compuesto
     C*CALCULAR DETI56 = ZINCNT + ZICCVA + ZICCVE + ZINCAR
     C     ZINCNT        ADD       ZICCVA        V$CA1           030 9
     C     V$CA1         ADD       ZICCVE        V$CA1
     C     V$CA1         ADD       ZINCAR        DETI56
     C* Deuda solo para int. compuesto
     C*SINO
     C                   ELSE
     C*CALCULAR (R) DETI56 = (ZINCNT + ZICCVA + ZICCVE + ZINCAR) - (ZTDI
     C     ZINCNT        ADD       ZICCVA        V$CA1           030 9
     C     V$CA1         ADD       ZICCVE        V$CA1
     C     V$CA1         ADD       ZINCAR        V$CA1
     C     ZTDINT        SUB       ZVINTE        V$CA2           030 9
     C     V$CA1         SUB(H)    V$CA2         DETI56
     C*FIN
     C                   END
     C* Plan. afiliaciones anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Total deuda 05
     C*SUMAR DETINT ZTOTI1
     C                   ADD       DETINT        ZTOTI1
     C* Total deuda 05
     C*SUMAR DETI56 ZTOTI3
     C                   ADD       DETI56        ZTOTI3
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETINT ZTOTIN
     C                   ADD       DETINT        ZTOTIN
     C* Total deuda 01
     C*SUMAR DETI56 ZTOTI2
     C                   ADD       DETI56        ZTOTI2
     C*FIN
     C                   END
     C* Reporte totales intereses
     C*CALCULAR ZVAIND = DETINT + DETI56
     C     DETINT        ADD       DETI56        ZVAIND
     C*FIN
     C                   END
     C*LIMPIAR ZINCFS ZINCSF ZINCNT ZICCVA ZICCVE ZINCAR ZINCFG
     C                   CLEAR                   ZINCFS
     C                   CLEAR                   ZINCSF
     C                   CLEAR                   ZINCNT
     C                   CLEAR                   ZICCVA
     C                   CLEAR                   ZICCVE
     C                   CLEAR                   ZINCAR
     C                   CLEAR                   ZINCFG
     C*SINO
     C                   ELSE
     C* Desarrollo especial activo
     C*SI ZR7436 = '1'
     C     ZR7436        IFEQ      '1'
     C*LIMPIAR Z@INFS Z@INFG Z@INSF
     C                   CLEAR                   Z@INFS
     C                   CLEAR                   Z@INFG
     C                   CLEAR                   Z@INSF
     C*SI ZSAINT > *CEROS O ZSICVA > *CEROS O ZSICVE > *CEROS O ZSINAR >
     C     ZSAINT        IFGT      *ZEROS
     C     ZSICVA        ORGT      *ZEROS
     C     ZSICVE        ORGT      *ZEROS
     C     ZSINAR        ORGT      *ZEROS
     C* Valor intereses
     C*LIMPIAR DETINT DETI56
     C                   CLEAR                   DETINT
     C                   CLEAR                   DETI56
     C* Total de intereses distribuido C.O
     C*CALCULAR (R) ZSAIN3 = ZSAIN4 - ZSAINT
     C     ZSAIN4        SUB(H)    ZSAINT        ZSAIN3
     C* Total de intereses distribuido C.V.A
     C*CALCULAR (R) ZSIVA3 = ZSIVA4 - ZSICVA
     C     ZSIVA4        SUB(H)    ZSICVA        ZSIVA3
     C* Total de intereses distribuido C.V.E
     C*CALCULAR (R) ZSIVE3 = ZSIVE4 - ZSICVE
     C     ZSIVE4        SUB(H)    ZSICVE        ZSIVE3
     C* Total de intereses distribuido A.R
     C*CALCULAR (R) ZSINR3 = ZSINR4 - ZSINAR
     C     ZSINR4        SUB(H)    ZSINAR        ZSINR3
     C* Separar intereses simples de efectivos
     C* Int.simple>distribuido
     C*SI ZSAIN2 > ZSAIN3
     C     ZSAIN2        IFGT      ZSAIN3
     C* Saldo int. simple C.O
     C*CALCULAR (R) ZSAIN5 = ZSAIN2 - ZSAIN3
     C     ZSAIN2        SUB(H)    ZSAIN3        ZSAIN5
     C* El saldo de int. T.E. C.O está en ZSAIN1
     C*SINO
     C                   ELSE
     C* Saldo int. simple C.O
     C*LIMPIAR ZSAIN5
     C                   CLEAR                   ZSAIN5
     C* Saldo Int. T.E. C.O
     C*MOVER ZSAIN1 ZSAINT
     C                   Z-ADD     ZSAINT        ZSAIN1
     C*FIN
     C                   END
     C* Int.simple>distribuido
     C*SI ZSIVA2 > ZSIVA3
     C     ZSIVA2        IFGT      ZSIVA3
     C* Saldo int. simple C.V.A
     C*CALCULAR (R) ZSIVA5 = ZSIVA2 - ZSIVA3
     C     ZSIVA2        SUB(H)    ZSIVA3        ZSIVA5
     C* El saldo de int. T.E. C.V.A está en ZSIVA1
     C*SINO
     C                   ELSE
     C* Saldo int. simple C.V.A
     C*LIMPIAR ZSIVA5
     C                   CLEAR                   ZSIVA5
     C* Saldo Int. T.E. C.V.A
     C*MOVER ZSIVA1 ZSICVA
     C                   Z-ADD     ZSICVA        ZSIVA1
     C*FIN
     C                   END
     C* Int.simple>distribuido
     C*SI ZSIVE2 > ZSIVE3
     C     ZSIVE2        IFGT      ZSIVE3
     C* Saldo int. simple C.V.E
     C*CALCULAR (R) ZSIVE5 = ZSIVE2 - ZSIVE3
     C     ZSIVE2        SUB(H)    ZSIVE3        ZSIVE5
     C* El saldo de int. T.E. C.V.A está en ZSIVE1
     C*SINO
     C                   ELSE
     C* Saldo int. simple C.V.E
     C*LIMPIAR ZSIVE5
     C                   CLEAR                   ZSIVE5
     C* Saldo Int. T.E. C.V.E
     C*MOVER ZSIVE1 ZSICVE
     C                   Z-ADD     ZSICVE        ZSIVE1
     C*FIN
     C                   END
     C* Int.simple>distribuido
     C*SI ZSINR2 > ZSINR3
     C     ZSINR2        IFGT      ZSINR3
     C* Saldo int. simple A.R
     C*CALCULAR (R) ZSINR5 = ZSINR2 - ZSINR3
     C     ZSINR2        SUB(H)    ZSINR3        ZSINR5
     C* El saldo de int. T.E. A.R está en ZSINR1
     C*SINO
     C                   ELSE
     C* Saldo int. simple A.R
     C*LIMPIAR ZSINR5
     C                   CLEAR                   ZSINR5
     C* Saldo Int. T.E. A.R
     C*MOVER ZSINR1 ZSINAR
     C                   Z-ADD     ZSINAR        ZSINR1
     C*FIN
     C                   END
     C* Distribuir intereses simples
     C* Saldo intereses CO
     C*SI ZSAIN5 > *CEROS Y ZCOTOB > *CEROS
     C     ZSAIN5        IFGT      *ZEROS
     C     ZCOTOB        ANDGT     *ZEROS
     C*CALCULAR (R) ZINTCO = (ZCOTOB * (ZSAIN5 - ZVSICO))/(ZTOCO - ZVACO
     C     ZSAIN5        SUB       ZVSICO        V$CA1           030 9
     C     ZCOTOB        MULT      V$CA1         V$CA1
     C     ZTOCO         SUB       ZVACO         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido CO
     C*SUMAR ZINTCO ZVSICO
     C                   ADD       ZINTCO        ZVSICO
     C* Valor intereses
     C*SUMAR ZINTCO DETINT
     C                   ADD       ZINTCO        DETINT
     C*FIN
     C                   END
     C* Saldo intereses CVA
     C*SI ZSIVA5 > *CEROS Y ZCOTVA > *CEROS
     C     ZSIVA5        IFGT      *ZEROS
     C     ZCOTVA        ANDGT     *ZEROS
     C*CALCULAR (R) ZINTCO = (ZCOTVA * (ZSIVA5 - ZVSIVA))/(ZTOCVA - ZVAC
     C     ZSIVA5        SUB       ZVSIVA        V$CA1           030 9
     C     ZCOTVA        MULT      V$CA1         V$CA1
     C     ZTOCVA        SUB       ZVACVA        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido CVA
     C*SUMAR ZINTCO ZVSIVA
     C                   ADD       ZINTCO        ZVSIVA
     C* Valor intereses
     C*SUMAR ZINTCO DETINT
     C                   ADD       ZINTCO        DETINT
     C*FIN
     C                   END
     C* Saldo intereses CVE
     C*SI ZSIVE5 > *CEROS Y ZCOTVE > *CEROS
     C     ZSIVE5        IFGT      *ZEROS
     C     ZCOTVE        ANDGT     *ZEROS
     C*CALCULAR (R) ZINTCO = (ZCOTVE * (ZSIVE5 - ZVSIVE))/(ZTOCVE - ZVAC
     C     ZSIVE5        SUB       ZVSIVE        V$CA1           030 9
     C     ZCOTVE        MULT      V$CA1         V$CA1
     C     ZTOCVE        SUB       ZVACVE        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido CVE
     C*SUMAR ZINTCO ZVSIVE
     C                   ADD       ZINTCO        ZVSIVE
     C* Valor intereses
     C*SUMAR ZINTCO DETINT
     C                   ADD       ZINTCO        DETINT
     C*FIN
     C                   END
     C* Saldo intereses A.R
     C*SI ZSINR5 > *CEROS Y ZCOTAR > *CERO
     C     ZSINR5        IFGT      *ZEROS
     C     ZCOTAR        ANDGT     *ZERO
     C*CALCULAR (R) ZINTCO = (ZCOTAR * (ZSINR5 - ZVSIAR))/(ZTOAR - ZVAAR
     C     ZSINR5        SUB       ZVSIAR        V$CA1           030 9
     C     ZCOTAR        MULT      V$CA1         V$CA1
     C     ZTOAR         SUB       ZVAAR         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido A.R
     C*SUMAR ZINTCO ZVSIAR
     C                   ADD       ZINTCO        ZVSIAR
     C* Valor intereses
     C*SUMAR ZINTCO DETINT
     C                   ADD       ZINTCO        DETINT
     C*FIN
     C                   END
     C* Intereses efectivos
     C* Saldo intereses CO
     C*SI ZSAIN1 > *CEROS Y ZCOTOB > *CEROS
     C     ZSAIN1        IFGT      *ZEROS
     C     ZCOTOB        ANDGT     *ZEROS
     C*CALCULAR (R) ZINTCO = (ZCOTOB * (ZSAIN1 - ZVSIC1))/(ZTOCO - ZVACO
     C     ZSAIN1        SUB       ZVSIC1        V$CA1           030 9
     C     ZCOTOB        MULT      V$CA1         V$CA1
     C     ZTOCO         SUB       ZVACO         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido CO
     C*SUMAR ZINTCO ZVSIC1
     C                   ADD       ZINTCO        ZVSIC1
     C* Valor intereses
     C*SUMAR ZINTCO DETI56
     C                   ADD       ZINTCO        DETI56
     C*FIN
     C                   END
     C* Saldo intereses CVA
     C*SI ZSIVA1 > *CEROS Y ZCOTVA > *CEROS
     C     ZSIVA1        IFGT      *ZEROS
     C     ZCOTVA        ANDGT     *ZEROS
     C*CALCULAR (R) ZINTCO = (ZCOTVA * (ZSIVA1 - ZVSIA1))/(ZTOCVA - ZVAC
     C     ZSIVA1        SUB       ZVSIA1        V$CA1           030 9
     C     ZCOTVA        MULT      V$CA1         V$CA1
     C     ZTOCVA        SUB       ZVACVA        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido CVA
     C*SUMAR ZINTCO ZVSIA1
     C                   ADD       ZINTCO        ZVSIA1
     C* Valor intereses
     C*SUMAR ZINTCO DETI56
     C                   ADD       ZINTCO        DETI56
     C*FIN
     C                   END
     C* Saldo intereses CVE
     C*SI ZSIVE1 > *CEROS Y ZCOTVE > *CEROS
     C     ZSIVE1        IFGT      *ZEROS
     C     ZCOTVE        ANDGT     *ZEROS
     C*CALCULAR (R) ZINTCO = (ZCOTVE * (ZSIVE1 - ZVSIE1))/(ZTOCVE - ZVAC
     C     ZSIVE1        SUB       ZVSIE1        V$CA1           030 9
     C     ZCOTVE        MULT      V$CA1         V$CA1
     C     ZTOCVE        SUB       ZVACVE        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido CVE
     C*SUMAR ZINTCO ZVSIE1
     C                   ADD       ZINTCO        ZVSIE1
     C* Valor intereses
     C*SUMAR ZINTCO DETI56
     C                   ADD       ZINTCO        DETI56
     C*FIN
     C                   END
     C* Saldo intereses A.R
     C*SI ZSINR1 > *CEROS Y ZCOTAR > *CERO
     C     ZSINR1        IFGT      *ZEROS
     C     ZCOTAR        ANDGT     *ZERO
     C*CALCULAR (R) ZINTCO = (ZCOTAR * (ZSINR1 - ZVSIR1))/(ZTOAR - ZVAAR
     C     ZSINR1        SUB       ZVSIR1        V$CA1           030 9
     C     ZCOTAR        MULT      V$CA1         V$CA1
     C     ZTOAR         SUB       ZVAAR         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZINTCO
     C* Valor distribuido A.R
     C*SUMAR ZINTCO ZVSIR1
     C                   ADD       ZINTCO        ZVSIR1
     C* Valor intereses
     C*SUMAR ZINTCO DETI56
     C                   ADD       ZINTCO        DETI56
     C*FIN
     C                   END
     C* Plan. afiliaciones ant
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Total deuda 05
     C*SUMAR DETINT ZTOTI1
     C                   ADD       DETINT        ZTOTI1
     C* Total deuda 05 T.E
     C*SUMAR DETI56 ZTOTI3
     C                   ADD       DETI56        ZTOTI3
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETINT ZTOTIN
     C                   ADD       DETINT        ZTOTIN
     C* Total deuda 05 T.E
     C*SUMAR DETI56 ZTOTI2
     C                   ADD       DETI56        ZTOTI2
     C*FIN
     C                   END
     C* Reporte totales inter
     C*CALCULAR ZVAIND = DETINT + DETI56
     C     DETINT        ADD       DETI56        ZVAIND
     C*FIN
     C                   END
     C*
     C* Saldo int. F.S.P
     C*SI ZSAIFS > *CEROS Y ZCOTFS > *CERO
     C     ZSAIFS        IFGT      *ZEROS
     C     ZCOTFS        ANDGT     *ZERO
     C* Total de intereses distribuido F.S
     C*CALCULAR (R) ZSAIF3 = ZSAIF4 - ZSAIFS
     C     ZSAIF4        SUB(H)    ZSAIFS        ZSAIF3
     C* Separar intereses simples de efectivos
     C* Int.simple>distribuido
     C*SI ZSAIF2 > ZSAIF3
     C     ZSAIF2        IFGT      ZSAIF3
     C* Saldo int. simple F.S
     C*CALCULAR (R) ZSAIF5 = ZSAIF2 - ZSAIF3
     C     ZSAIF2        SUB(H)    ZSAIF3        ZSAIF5
     C* El saldo de int. T.E. F.S está en ZSAIF1
     C*SINO
     C                   ELSE
     C* Saldo int. simple F.S
     C*LIMPIAR ZSAIF5
     C                   CLEAR                   ZSAIF5
     C* Saldo Int. T.E. F.S
     C*MOVER ZSAIF1 ZSAIFS
     C                   Z-ADD     ZSAIFS        ZSAIF1
     C*FIN
     C                   END
     C* Distribuir intereses simples
     C*SI ZSAIF5 > *CERO
     C     ZSAIF5        IFGT      *ZERO
     C*CALCULAR (R) DETV15 = (ZCOTFS * (ZSAIF5 - ZVSIFS))/(ZTOFS - ZVAFS
     C     ZSAIF5        SUB       ZVSIFS        V$CA1           030 9
     C     ZCOTFS        MULT      V$CA1         V$CA1
     C     ZTOFS         SUB       ZVAFS         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         DETV15
     C* Valor distribuido FS
     C*SUMAR DETV15 ZVSIFS
     C                   ADD       DETV15        ZVSIFS
     C*FIN
     C                   END
     C* Distribuir intereses efectivos
     C*SI ZSAIF1 > *CERO
     C     ZSAIF1        IFGT      *ZERO
     C*CALCULAR (R) Z@INFS = (ZCOTFS * (ZSAIF1 - ZVSIF1))/(ZTOFS - ZVAFS
     C     ZSAIF1        SUB       ZVSIF1        V$CA1           030 9
     C     ZCOTFS        MULT      V$CA1         V$CA1
     C     ZTOFS         SUB       ZVAFS         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         Z@INFS
     C* Variable sin decimales
     C*MOVER DETV94 Z@INFS
     C                   Z-ADD     Z@INFS        DETV94
     C* Valor distribuido FS
     C*SUMAR DETV94 ZVSIF1
     C                   ADD       DETV94        ZVSIF1
     C*FIN
     C                   END
     C* Plan. afil. anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Total deuda 05
     C*SUMAR DETV15 ZTOTI1
     C                   ADD       DETV15        ZTOTI1
     C* Total deuda 05
     C*SUMAR DETV94 ZTOTI3
     C                   ADD       DETV94        ZTOTI3
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETV15 ZTOTIN
     C                   ADD       DETV15        ZTOTIN
     C* Total deuda 05
     C*SUMAR DETV94 ZTOTI2
     C                   ADD       DETV94        ZTOTI2
     C*FIN
     C                   END
     C* Reporte totales F.S
     C*CALCULAR ZVIFSD = DETV15 + DETV94
     C     DETV15        ADD       DETV94        ZVIFSD
     C*FIN
     C                   END
     C*
     C* Saldo intereses FGPM
     C*SI ZSAIFG > *CEROS Y ZCOTFG > *CEROS
     C     ZSAIFG        IFGT      *ZEROS
     C     ZCOTFG        ANDGT     *ZEROS
     C* Total de intereses distribuido F.G.P.M
     C*CALCULAR (R) ZSAIG3 = ZSAIG4 - ZSAIFG
     C     ZSAIG4        SUB(H)    ZSAIFG        ZSAIG3
     C* Separar intereses simples de efectivos
     C* Int.simple>distribuido
     C*SI ZSAIG2 > ZSAIG3
     C     ZSAIG2        IFGT      ZSAIG3
     C* Saldo int. simple F.G.P
     C*CALCULAR (R) ZSAIG5 = ZSAIG2 - ZSAIG3
     C     ZSAIG2        SUB(H)    ZSAIG3        ZSAIG5
     C* El saldo de int. T.E. F.G.P.M está en ZSAIG1
     C*SINO
     C                   ELSE
     C* Saldo int. simple F.G.P
     C*LIMPIAR ZSAIG5
     C                   CLEAR                   ZSAIG5
     C* Saldo Int. T.E. F.G.P.M
     C*MOVER ZSAIG1 ZSAIFG
     C                   Z-ADD     ZSAIFG        ZSAIG1
     C*FIN
     C                   END
     C* Distribuir intereses simples
     C*SI ZSAIG5 > *CERO
     C     ZSAIG5        IFGT      *ZERO
     C*CALCULAR (R) DETV78 = (ZCOTFG * (ZSAIG5 - ZVSIFG))/(ZTOFGP - ZVAF
     C     ZSAIG5        SUB       ZVSIFG        V$CA1           030 9
     C     ZCOTFG        MULT      V$CA1         V$CA1
     C     ZTOFGP        SUB       ZVAFGP        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         DETV78
     C* Valor distribuido FGPM
     C*SUMAR DETV78 ZVSIFG
     C                   ADD       DETV78        ZVSIFG
     C*FIN
     C                   END
     C* Distribuir intereses efectivos
     C*SI ZSAIG1 > *CERO
     C     ZSAIG1        IFGT      *ZERO
     C*CALCULAR (R) Z@INFG = (ZCOTFG * (ZSAIG1 - ZVSIG1))/(ZTOFGP - ZVAF
     C     ZSAIG1        SUB       ZVSIG1        V$CA1           030 9
     C     ZCOTFG        MULT      V$CA1         V$CA1
     C     ZTOFGP        SUB       ZVAFGP        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         Z@INFG
     C* Variable sin decimales
     C*MOVER DETV95 Z@INFG
     C                   Z-ADD     Z@INFG        DETV95
     C* Valor distribuido FGPM
     C*SUMAR DETV95 ZVSIG1
     C                   ADD       DETV95        ZVSIG1
     C*FIN
     C                   END
     C* Plan. afiliaciones ant
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Total deuda 05
     C*SUMAR DETV78 ZTOTI1
     C                   ADD       DETV78        ZTOTI1
     C* Total deuda 05
     C*SUMAR DETV95 ZTOTI3
     C                   ADD       DETV95        ZTOTI3
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETV78 ZTOTIN
     C                   ADD       DETV78        ZTOTIN
     C* Total deuda 01
     C*SUMAR DETV95 ZTOTI2
     C                   ADD       DETV95        ZTOTI2
     C*FIN
     C                   END
     C* Reporte totales IFGPM
     C*CALCULAR ZVIFGD = DETV78 + DETV95
     C     DETV78        ADD       DETV95        ZVIFGD
     C*FIN
     C                   END
     C*
     C* Saldo intereses SFSP
     C*SI ZSAISF > *CEROS Y ZCOTSF > *CEROS
     C     ZSAISF        IFGT      *ZEROS
     C     ZCOTSF        ANDGT     *ZEROS
     C* Total de intereses distribuido S.F.S.P
     C*CALCULAR (R) ZSAIS3 = ZSAIS4 - ZSAISF
     C     ZSAIS4        SUB(H)    ZSAISF        ZSAIS3
     C* Separar intereses simples de efectivos
     C* Int.simple>distribuido
     C*SI ZSAIS2 > ZSAIS3
     C     ZSAIS2        IFGT      ZSAIS3
     C* Saldo int. simple S.F.S
     C*CALCULAR (R) ZSAIS5 = ZSAIS2 - ZSAIS3
     C     ZSAIS2        SUB(H)    ZSAIS3        ZSAIS5
     C* El saldo de int. T.E. S.F.S.P está en ZSAIS1
     C*SINO
     C                   ELSE
     C* Saldo int. simple S.F.S
     C*LIMPIAR ZSAIS5
     C                   CLEAR                   ZSAIS5
     C* Saldo Int. T.E. S.F.S.P
     C*MOVER ZSAIS1 ZSAISF
     C                   Z-ADD     ZSAISF        ZSAIS1
     C*FIN
     C                   END
     C* Distribuir intereses simples
     C*SI ZSAIS5 > *CERO
     C     ZSAIS5        IFGT      *ZERO
     C*CALCULAR (R) DETI32 = (ZCOTSF * (ZSAIS5 - ZVSISF))/(ZTOSFS - ZVAS
     C     ZSAIS5        SUB       ZVSISF        V$CA1           030 9
     C     ZCOTSF        MULT      V$CA1         V$CA1
     C     ZTOSFS        SUB       ZVASFS        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         DETI32
     C* Valor distribuido SFSP
     C*SUMAR DETI32 ZVSISF
     C                   ADD       DETI32        ZVSISF
     C*FIN
     C                   END
     C* Distribuir intereses efectivos
     C*SI ZSAIS1 > *CERO
     C     ZSAIS1        IFGT      *ZERO
     C*CALCULAR (R) Z@INSF = (ZCOTSF * (ZSAIS1 - ZVSIS1))/(ZTOSFS - ZVAS
     C     ZSAIS1        SUB       ZVSIS1        V$CA1           030 9
     C     ZCOTSF        MULT      V$CA1         V$CA1
     C     ZTOSFS        SUB       ZVASFS        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         Z@INSF
     C* Variable sin decimales
     C*MOVER DETV96 Z@INSF
     C                   Z-ADD     Z@INSF        DETV96
     C* Valor distribuido SFSP
     C*SUMAR DETV96 ZVSIS1
     C                   ADD       DETV96        ZVSIS1
     C*FIN
     C                   END
     C* Plan. afiliaciones ant
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Total deuda 05
     C*SUMAR DETI32 ZTOTI1
     C                   ADD       DETI32        ZTOTI1
     C* Total deuda 05
     C*SUMAR DETV96 ZTOTI3
     C                   ADD       DETV96        ZTOTI3
     C*SINO
     C                   ELSE
     C* Total deuda 01
     C*SUMAR DETI32 ZTOTIN
     C                   ADD       DETI32        ZTOTIN
     C* Total deuda 05
     C*SUMAR DETV96 ZTOTI2
     C                   ADD       DETV96        ZTOTI2
     C*FIN
     C                   END
     C* Reporte totales subsist
     C*CALCULAR ZVISFD = DETI32 + DETV96
     C     DETI32        ADD       DETV96        ZVISFD
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Genera detalle de deuda                                     ==
     C*==                                                              ==
     C*==================================================================
     C     M14084        BEGSR
     C* Plan. afiliaciones anteriores
     C*SI PLAPER <= ZPEINC
     C     PLAPER        IFLE      ZPEINC
     C* Tipo de deuda
     C*PASAR DETTIP '05'
     C                   MOVEL     '05'          DETTIP
     C*SINO
     C                   ELSE
     C* No es planilla de tercero
     C*SI PLATIP <> '07'
     C     PLATIP        IFNE      '07'
     C* Tipo de deuda
     C*PASAR DETTIP '01'
     C                   MOVEL     '01'          DETTIP
     C* Planilla de tercero
     C*SINO
     C                   ELSE
     C* Tipo de deuda
     C*PASAR DETTIP '07'
     C                   MOVEL     '07'          DETTIP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Nro. planilla deuda
     C*MOVER DETNU9 PLANU1
     C                   Z-ADD     PLANU1        DETNU9
     C* Página
     C*MOVER DETPA2 DETPAG
     C                   Z-ADD     DETPAG        DETPA2
     C* Secuencia
     C*MOVER DETSE4 DETSEC
     C                   Z-ADD     DETSEC        DETSE4
     C* Tipo de planilla
     C*PASAR DETTI8 PLATIP
     C                   MOVEL     PLATIP        DETTI8
     C* Período
     C*PASAR DETPER PLAPER
     C                   MOVEL     PLAPER        DETPER
     C* Nro. identificación afiliado
     C*MOVER DETNR1 DETNU2
     C                   Z-ADD     DETNU2        DETNR1
     C* Salario informado
     C*MOVER DETRE4 DETSAL
     C                   Z-ADD     DETSAL        DETRE4
     C* Salario calculado
     C*MOVER DETSA2 DETVA7
     C                   Z-ADD     DETVA7        DETSA2
     C* Saldo c.o.
     C*MOVER DETSA1 DETCO3
     C                   Z-ADD     DETCO3        DETSA1
     C* Saldo f.s.
     C*MOVER DETSA4 DETCO6
     C                   Z-ADD     DETCO6        DETSA4
     C* Saldo c.v.a.
     C*MOVER DETSA3 DETV10
     C                   Z-ADD     DETV10        DETSA3
     C* Saldo c.v.e.
     C*MOVER DETSA7 DETV11
     C                   Z-ADD     DETV11        DETSA7
     C* Saldo FGPM
     C*MOVER DETS95 DETV77
     C                   Z-ADD     DETV77        DETS95
     C* Saldo SFSP
     C*MOVER DETS97 DETV79
     C                   Z-ADD     DETV79        DETS97
     C* Saldo SFSP
     C*MOVER DETS96 DETV78
     C                   Z-ADD     DETV78        DETS96
     C* Saldo F.S
     C*MOVER DETS07 DETV15
     C                   Z-ADD     DETV15        DETS07
     C* Saldo FGPM
     C*MOVER DETS98 DETI32
     C                   Z-ADD     DETI32        DETS98
     C* Saldo INT.
     C*MOVER DETSA5 DETINT
     C                   Z-ADD     DETINT        DETSA5
     C* Saldo int. comp. F.S.P
     C*MOVER DET120 DETV94
     C                   Z-ADD     DETV94        DET120
     C* Saldo int. comp. C.O
     C*MOVER DET125 DETI56
     C                   Z-ADD     DETI56        DET125
     C* Saldo int. comp. F.G.P.M
     C*MOVER DET126 DETV95
     C                   Z-ADD     DETV95        DET126
     C* Saldo int. comp. S.F.S.P
     C*MOVER DET127 DETV96
     C                   Z-ADD     DETV96        DET127
     C* Estado
     C*PASAR DETEST 'GEN'
     C                   MOVEL     'GEN'         DETEST
     C* Fecha fondo generación
     C*PASAR DETFE9 HISFE3
     C                   MOVEL     HISFE3        DETFE9
     C* Fecha fondo último estado
     C*PASAR DETFE2 HISFE3
     C                   MOVEL     HISFE3        DETFE2
     C* Fecha sistema ult. modific.
     C*PASAR DETF05 ZFESIS
     C                   MOVEL     ZFESIS        DETF05
     C* Tipo identificación deposit.
     C*PASAR DETTI6 PLATI1
     C                   MOVEL     PLATI1        DETTI6
     C* Nro. identificación deposit.
     C*MOVER DETID2 PLANU4
     C                   Z-ADD     PLANU4        DETID2
     C* Código actividad a.r.
     C*PASAR DETC09 DETCOD
     C                   MOVEL     DETCOD        DETC09
     C* Código sucursal riesgo
     C*PASAR DETC22 PLAC11
     C                   MOVEL     PLAC11        DETC22
     C* Tipo pago declaración
     C*SI PLAT03 = '03' O ZPLOTE = 'PLIC'
     C     PLAT03        IFEQ      '03'
     C     ZPLOTE        OREQ      'PLIC'
     C* Deuda confirmada
     C*PASAR DETI28 'S'
     C                   MOVEL     'S'           DETI28
     C*FIN
     C                   END
     C* Usuario
     C*PASAR DETUS3 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        DETUS3
     C* Fecha inicio de la deuda
     C*PASAR DETF10 ZFEIND
     C                   MOVEL     ZFEIND        DETF10
     C* Tipo de pago planilla
     C*PASAR DETT44 PLAT03
     C                   MOVEL     PLAT03        DETT44
     C* Desarrollo especial activo
     C*SI ZR7436 = '1' Y ZSALDI > *CEROS
     C     ZR7436        IFEQ      '1'
     C     ZSALDI        ANDGT     *ZEROS
     C* Fecha liquidación intereses
     C*PASAR DETFE5 ZFECDE
     C                   MOVEL     ZFECDE        DETFE5
     C*SINO
     C                   ELSE
     C* Si se liquidó ints para la deuda
     C*SI ZLIQIN = '1'
     C     ZLIQIN        IFEQ      '1'
     C* Fecha última liq. intereses
     C*PASAR DETFE5 ZFECHA
     C                   MOVEL     ZFECHA        DETFE5
     C*SINO
     C                   ELSE
     C* Fecha última liq. intereses
     C*LIMPIAR DETFE5
     C                   CLEAR                   DETFE5
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Desarrollo 7046 activo (acu. pago)
     C*SI ZINVAL = '1' Y ZD7046 = 1
     C     ZINVAL        IFEQ      '1'
     C     ZD7046        ANDEQ     1
     C*LIMPIAR ZCUTIP
     C                   CLEAR                   ZCUTIP
     C* Si es una planilla de declaración y no pago para un periodo en
     C* acuerdo de pago, se anulan las deudas presuntas y se genera una
     C* deuda real con sub estado en acuerdo 'ACU'
     C*SQL
     C/EXEC SQL
     C+  SELECT ACUTIP INTO :ZCUTIP
     C+  FROM ACUARC
     C+  WHERE ACUTI1 = :PLATI1 AND ACUNU1 = :PLANU4 AND
     C+  ACUEST = 'ACT'
     C/END-EXEC
     C* Encontró empleador con acuerdo pago
     C*SI SQLCOD = *CERO
     C     SQLCOD        IFEQ      *ZERO
     C* Des. Esp. 9072 ACTIVO
     C*SI ZR9072 = 1
     C     ZR9072        IFEQ      1
     C* Liquidación
     C*SI ZCUTIP = '2'
     C     ZCUTIP        IFEQ      '2'
     C* Sub estado de deuda LIQ
     C*PASAR DETSUB 'LIQ'
     C                   MOVEL     'LIQ'         DETSUB
     C*SINO
     C                   ELSE
     C* Sub estado de deuda ACU
     C*PASAR DETSUB 'ACU'
     C                   MOVEL     'ACU'         DETSUB
     C*FIN
     C                   END
     C*PASAR ZETSUB DETSUB
     C                   MOVEL     DETSUB        ZETSUB
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Empleador no tiene acuerdo de pago
     C*SI DETSUB = *BLANCO
     C     DETSUB        IFEQ      *BLANK
     C* No ha consultado empleador
     C*SI ZEMPAR = 0
     C     ZEMPAR        IFEQ      0
     C* No vuelve a consultar empleador.
     C*MOVER ZEMPAR 1
     C                   Z-ADD     1             ZEMPAR
     C* Aux subestado
     C*LIMPIAR ZETSUB
     C                   CLEAR                   ZETSUB
     C* SQLCOD antes.
     C*MOVER SQLCOZ SQLCOD
     C                   Z-ADD     SQLCOD        SQLCOZ
     C*SQL
     C/EXEC SQL
     C+  SELECT COALESCE(MAX(EMPI20), ' ')  INTO :ZMPI20
     C+  FROM EMPAR2
     C+  WHERE
     C+  EMPNU2 = :DETID2 AND EMPTI1 = :DETTI6
     C/END-EXEC
     C* ILOCALIZADO.
     C*SI ZMPI20 = 'N'
     C     ZMPI20        IFEQ      'N'
     C* SUBESTADO
     C*PASAR ZETSUB 'ILO'
     C                   MOVEL     'ILO'         ZETSUB
     C*SINO
     C                   ELSE
     C* SE DESMARCA SUBESTADO, ES LOCALIZAD
     C*LIMPIAR ZETSUB
     C                   CLEAR                   ZETSUB
     C*FIN
     C                   END
     C* SQLCOD despues.
     C*MOVER SQLCOD SQLCOZ
     C                   Z-ADD     SQLCOZ        SQLCOD
     C*FIN
     C                   END
     C* Subestado actualizado
     C*PASAR DETSUB ZETSUB
     C                   MOVEL     ZETSUB        DETSUB
     C*FIN
     C                   END
     C* Agregar detalle de deuda
     C*AGREGAR DETAR2
     C                   WRITE     DETRE1                               94
     C                   MOVE      *IN94         I$DUP
     C* Llamado desde rezagos ind
     C*SI ZT@002='3' Y ZPAG30 = '1'
     C     ZT@002        IFEQ      '3'
     C     ZPAG30        ANDEQ     '1'
     C* Planilla a validar PE para cruce
     C*MOVER ZPECRU DETNU9
     C                   Z-ADD     DETNU9        ZPECRU
     C* Agrega PE para cruce
     C*EJECUTAR M00401
     C                   EXSR      M00401
     C* Valida PE de fusión
     C*SI Z10592 = 1
     C     Z10592        IFEQ      1
     C* Valida PE planillas fus
     C*EJECUTAR M00400
     C                   EXSR      M00400
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Planilla tercero
     C*SI PLATIP = '07'
     C     PLATIP        IFEQ      '07'
     C* Fecha inicio deuda
     C*SI ZFINDE > DETF10 O ZFINDE = *BLANCO
     C     ZFINDE        IFGT      DETF10
     C     ZFINDE        OREQ      *BLANK
     C* Fecha inicio deuda actual detalle
     C*PASAR ZFINDE DETF10
     C                   MOVEL     DETF10        ZFINDE
     C*FIN
     C                   END
     C* Fecha última liq. intereses
     C*SI ZFLQIN > DETFE5 O ZFLQIN = *BLANCO
     C     ZFLQIN        IFGT      DETFE5
     C     ZFLQIN        OREQ      *BLANK
     C* Fecha última liq. actual detalle
     C*PASAR ZFLQIN DETFE5
     C                   MOVEL     DETFE5        ZFLQIN
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Acumular valores cotizaciones                               ==
     C*==                                                              ==
     C*==================================================================
     C     M14085        BEGSR
     C* Valor acumulado c.v.a.
     C*SUMAR ZCOTVA ZVACVA
     C                   ADD       ZCOTVA        ZVACVA
     C* Valor acumulado f.s.
     C*SUMAR ZCOTFS ZVAFS
     C                   ADD       ZCOTFS        ZVAFS
     C* Valor acumulado cotizaciones
     C*SUMAR ZTOCOT ZVACOT
     C                   ADD       ZTOCOT        ZVACOT
     C* Valor acumulado rendimientos
     C*SUMAR DETV14 ZVAREN
     C                   ADD       DETV14        ZVAREN
     C* Valor acumulado alto riesgo
     C*SUMAR ZCOTAR ZVAAR
     C                   ADD       ZCOTAR        ZVAAR
     C* Valor acumulado c.o.
     C*SUMAR ZCOTOB ZVACO
     C                   ADD       ZCOTOB        ZVACO
     C* Valor acumulado c.v.e.
     C*SUMAR ZCOTVE ZVACVE
     C                   ADD       ZCOTVE        ZVACVE
     C* Valor acumulado FGPM
     C*SUMAR ZCOTFG ZVAFGP
     C                   ADD       ZCOTFG        ZVAFGP
     C* Valor acumulado subsistencia
     C*SUMAR ZCOTSF ZVASFS
     C                   ADD       ZCOTSF        ZVASFS
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza datos del detalle de deuda y valores del SAe      ==
     C*==                                                              ==
     C*==================================================================
     C     M14086        BEGSR
     C* Tipo de planilla
     C*PASAR DETTI8 PLATIP
     C                   MOVEL     PLATIP        DETTI8
     C* Tipo de pago planilla
     C*PASAR DETT44 PLAT03
     C                   MOVEL     PLAT03        DETT44
     C* Período
     C*PASAR DETPER PLAPER
     C                   MOVEL     PLAPER        DETPER
     C* Nro. identificación afiliado
     C*MOVER DETNR1 DETNU2
     C                   Z-ADD     DETNU2        DETNR1
     C* Salario informado
     C*MOVER DETRE4 DETSAL
     C                   Z-ADD     DETSAL        DETRE4
     C* Salario calculado
     C*MOVER DETSA2 DETVA7
     C                   Z-ADD     DETVA7        DETSA2
     C* Saldo c.o.
     C*MOVER DETSA1 DETCO3
     C                   Z-ADD     DETCO3        DETSA1
     C* Saldo f.s.
     C*MOVER DETSA4 DETCO6
     C                   Z-ADD     DETCO6        DETSA4
     C* Saldo c.v.a.
     C*MOVER DETSA3 DETV10
     C                   Z-ADD     DETV10        DETSA3
     C* Saldo c.v.e.
     C*MOVER DETSA7 DETV11
     C                   Z-ADD     DETV11        DETSA7
     C* Saldo FGPM
     C*MOVER DETS95 DETV77
     C                   Z-ADD     DETV77        DETS95
     C* Saldo Subsistencia
     C*MOVER DETS97 DETV79
     C                   Z-ADD     DETV79        DETS97
     C* Saldo int. comp. F.S.P
     C*MOVER DET120 DETV94
     C                   Z-ADD     DETV94        DET120
     C* Saldo int. comp. C.O
     C*MOVER DET125 DETI56
     C                   Z-ADD     DETI56        DET125
     C* Saldo int. comp. F.G.P.M
     C*MOVER DET126 DETV95
     C                   Z-ADD     DETV95        DET126
     C* Saldo int. comp. S.F.S.P
     C*MOVER DET127 DETV96
     C                   Z-ADD     DETV96        DET127
     C* Estado
     C*PASAR DETEST 'GEN'
     C                   MOVEL     'GEN'         DETEST
     C* Fecha fondo generación
     C*PASAR DETFE9 HISFE3
     C                   MOVEL     HISFE3        DETFE9
     C* Fecha fondo último estado
     C*PASAR DETFE2 HISFE3
     C                   MOVEL     HISFE3        DETFE2
     C* Tipo identificación deposit.
     C*PASAR DETTI6 PLATI1
     C                   MOVEL     PLATI1        DETTI6
     C* Nro. identificación deposit.
     C*MOVER DETID2 PLANU4
     C                   Z-ADD     PLANU4        DETID2
     C* Código actividad a.r.
     C*PASAR DETC09 DETCOD
     C                   MOVEL     DETCOD        DETC09
     C* Código sucursal riesgo
     C*PASAR DETC22 PLAC11
     C                   MOVEL     PLAC11        DETC22
     C* Fecha sistema ult. modific.
     C*PASAR DETF05 ZFESIS
     C                   MOVEL     ZFESIS        DETF05
     C* Tipo pago declaración
     C*SI PLAT03 = '03' O ZPLOTE = 'PLIC'
     C     PLAT03        IFEQ      '03'
     C     ZPLOTE        OREQ      'PLIC'
     C* Deuda confirmada
     C*PASAR DETI28 'S'
     C                   MOVEL     'S'           DETI28
     C*FIN
     C                   END
     C* Usuario
     C*PASAR DETUS3 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        DETUS3
     C* Fecha inicio de la deuda
     C*PASAR DETF10 ZFEIND
     C                   MOVEL     ZFEIND        DETF10
     C* Fecha última liq. intereses
     C*PASAR DETFE5 ZFECHA
     C                   MOVEL     ZFECHA        DETFE5
     C* No ha consultado empleador
     C*SI ZEMPAR = 0
     C     ZEMPAR        IFEQ      0
     C* No vuelve a consultar empleador.
     C*MOVER ZEMPAR 1
     C                   Z-ADD     1             ZEMPAR
     C* Aux subestado
     C*LIMPIAR ZETSUB
     C                   CLEAR                   ZETSUB
     C* SQLCOD antes.
     C*MOVER SQLCOZ SQLCOD
     C                   Z-ADD     SQLCOD        SQLCOZ
     C*SQL
     C/EXEC SQL
     C+  SELECT COALESCE(MAX(EMPI20), ' ')  INTO :ZMPI20
     C+  FROM EMPAR2
     C+  WHERE
     C+  EMPNU2 = :DETID2 AND EMPTI1 = :DETTI6
     C/END-EXEC
     C* ILOCALIZADO.
     C*SI ZMPI20 = 'N'
     C     ZMPI20        IFEQ      'N'
     C* SUBESTADO
     C*PASAR ZETSUB 'ILO'
     C                   MOVEL     'ILO'         ZETSUB
     C*SINO
     C                   ELSE
     C* SE DESMARCA SUBESTADO, ES LOCALIZAD
     C*LIMPIAR ZETSUB
     C                   CLEAR                   ZETSUB
     C*FIN
     C                   END
     C* SQLCOD despues.
     C*MOVER SQLCOD SQLCOZ
     C                   Z-ADD     SQLCOZ        SQLCOD
     C*FIN
     C                   END
     C* Subestado ILO.
     C*SI DETSUB=*BLANCO O DETSUB='ILO'
     C     DETSUB        IFEQ      *BLANK
     C     DETSUB        OREQ      'ILO'
     C* Sub estado de deuda
     C*PASAR DETSUB ZETSUB
     C                   MOVEL     ZETSUB        DETSUB
     C*FIN
     C                   END
     C* Genera detalle deuda.
     C*GRABAR DETAR2
     C     *IN47         IFEQ      '0'
     C                   UPDATE    DETRE1                               94
     C                   ELSE
     C                   WRITE     DETRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Llamado desde rezagos ind
     C*SI ZT@002='3' Y ZPAG30 = '1'
     C     ZT@002        IFEQ      '3'
     C     ZPAG30        ANDEQ     '1'
     C* Planilla a validar PE para cruce
     C*MOVER ZPECRU DETNU9
     C                   Z-ADD     DETNU9        ZPECRU
     C* Agrega PE para cruce
     C*EJECUTAR M00401
     C                   EXSR      M00401
     C* Valida PE de fusión
     C*SI Z10592 = 1
     C     Z10592        IFEQ      1
     C* Valida PE planillas fus
     C*EJECUTAR M00400
     C                   EXSR      M00400
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Planilla tercero
     C*SI PLATIP = '07'
     C     PLATIP        IFEQ      '07'
     C* Fecha inicio deuda
     C*SI ZFINDE > DETF10 O ZFINDE = *BLANCO
     C     ZFINDE        IFGT      DETF10
     C     ZFINDE        OREQ      *BLANK
     C* Fecha inicio deuda actual detalle
     C*PASAR ZFINDE DETF10
     C                   MOVEL     DETF10        ZFINDE
     C*FIN
     C                   END
     C* Fecha última liq. intereses
     C*SI ZFLQIN > DETFE5 O ZFLQIN = *BLANCO
     C     ZFLQIN        IFGT      DETFE5
     C     ZFLQIN        OREQ      *BLANK
     C* Fecha última liq. actual detalle
     C*PASAR ZFLQIN DETFE5
     C                   MOVEL     DETFE5        ZFLQIN
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* SAE
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C*CALCULAR ZDEUDE = ZDEUDE - (DETSA1+DETSA4+DETSA3+DETSA7+DETS95+DE
     C     DETSA1        ADD       DETSA4        V$CA1           030 9
     C     V$CA1         ADD       DETSA3        V$CA1
     C     V$CA1         ADD       DETSA7        V$CA1
     C     V$CA1         ADD       DETS95        V$CA1
     C     V$CA1         ADD       DETS97        V$CA1
     C     ZDEUDE        SUB       V$CA1         ZDEUDE
     C*PASAR ZSIGNO '-'
     C                   MOVEL     '-'           ZSIGNO
     C*SAE
     C*LLAMAR TRINCE64(DETTIP DETNU9 DETPA2 DETSE4 DETNR1 ZDEUDE ZSIGNO
     C                   CALL      'TRINCE64'
     C                   PARM                    DETTIP
     C                   PARM                    DETNU9
     C                   PARM                    DETPA2
     C                   PARM                    DETSE4
     C                   PARM                    DETNR1
     C                   PARM                    ZDEUDE
     C                   PARM                    ZSIGNO
     C                   PARM                    ZERCON
     C* Error concurrencia en TRDEUD79
     C*SI ZERCON = '1'
     C     ZERCON        IFEQ      '1'
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C* Rollback
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C* Finaliza proceso
     C*LLAMAR TRCTPR51 (FUNCIO ZMODO ZNRTRA)
     C                   CALL      'TRCTPR51'
     C                   PARM                    FUNCIO
     C                   PARM                    ZMODO
     C                   PARM                    ZNRTRA
     C*TERMINAR
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Valida dias de retroactiva                                  ==
     C*==                                                              ==
     C*==================================================================
     C     M14089        BEGSR
     C*LIMPIAR ZDTNU3 ZDTPAG ZDTSEC
     C                   CLEAR                   ZDTNU3
     C                   CLEAR                   ZDTPAG
     C                   CLEAR                   ZDTSEC
     C* Consulta RETAR2
     C*PASAR ZOPERA 'C'
     C                   MOVEL     'C'           ZOPERA
     C*LLAMAR TRRETO50 (ZOPERA DETNU3 DETPAG DETSEC ZDTNU3 ZDTPAG ZDTSEC
     C                   CALL      'TRRETO50'
     C                   PARM                    ZOPERA
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    ZDTNU3
     C                   PARM                    ZDTPAG
     C                   PARM                    ZDTSEC
     C*SI ZDTNU3<>0
     C     ZDTNU3        IFNE      0
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC WHERE DETNU3 = :ZDTNU3 AND
     C+  DETPAG = :ZDTPAG AND DETSEC = :ZDTSEC
     C/END-EXEC
     C*SI SQLCOD=0
     C     SQLCOD        IFEQ      0
     C*CALCULAR ZDIATO=ZDITRA+ZDILIC
     C     ZDITRA        ADD       ZDILIC        ZDIATO
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Reversa comisión cesantes                                   ==
     C*==                                                              ==
     C*==================================================================
     C     M14090        BEGSR
     C* Valor temporal de CUENUM
     C*MOVER ZCUENU CUENUM
     C                   Z-ADD     CUENUM        ZCUENU
     C* Código fondo moderado
     C*PASAR CUEC17 ZFONDO
     C                   MOVEL     ZFONDO        CUEC17
     C*RECUPERARD CUEARC(CUENUM CUEC17)
     C     LL$105        KLIST
     C                   KFLD                    CUENUM
     C                   KFLD                    CUEC17
     C     LL$105        CHAIN     CUEARC                             4594
     C                   MOVE      *IN94         I$RND
     C     *IN45         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   CUEREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Libera el registro
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Para el cobro de comisión de cesantes'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(063)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*MOVER ZPLAER PLANUM
     C                   MOVE      PLANUM        ZPLAER
     C*MOVER ZAFIIN CUENUM
     C                   CLEAR                   ZAFIIN
     C                   MOVE      CUENUM        ZAFIIN
     C*OBTENER (1) ZERROR = 'CUEARC no disponible - M14090' || ZPLAER ||
     C                   CLEAR                   H$1
     C     $HIL(064)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SI ZININA = '1' Y ZTOCOT |= *CERO
     C     ZININA        IFEQ      '1'
     C     ZTOCOT        ANDNE     *ZERO
     C*ASIGNARD ZINRTN '1'
     C                   MOVE      '1'           ZINRTN
     C* Reevaluar condición de cesante
     C*ASIGNARD ZINVER '1'
     C                   MOVE      '1'           ZINVER
     C* Convertir nro. interno a alfanumérico
     C*ASIGNARD ZAFILI CUENUM
     C                   MOVE      CUENUM        ZAFILI
     C*LIMPIAR ZPERI2 ZCOND
     C                   CLEAR                   ZPERI2
     C                   CLEAR                   ZCOND
     C*PASAR   ZFUNC  '1'
     C                   MOVEL     '1'           ZFUNC
     C*SI ZAFILI <> *BLANCO
     C     ZAFILI        IFNE      *BLANK
     C*LLAMAR TRCEDC63 (ZAFILI PLAPER ZPERI2 ZINVER ZINRTN ZSALIR ZFUNC)
     C                   CALL      'TRCEDC63'
     C                   PARM                    ZAFILI
     C                   PARM                    PLAPER
     C                   PARM                    ZPERI2
     C                   PARM                    ZINVER
     C                   PARM                    ZINRTN
     C                   PARM                    ZSALIR
     C                   PARM                    ZFUNC
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI ZINCES = '1' Y ZTOCOT |= *CERO
     C     ZINCES        IFEQ      '1'
     C     ZTOCOT        ANDNE     *ZERO
     C*ASIGNARD ZINRTN '1'
     C                   MOVE      '1'           ZINRTN
     C* Reevaluar condición de cesante
     C*ASIGNARD ZINVER '1'
     C                   MOVE      '1'           ZINVER
     C* Convertir nro. interno a alfanumérico
     C*ASIGNARD ZAFILI CUENUM
     C                   MOVE      CUENUM        ZAFILI
     C*LIMPIAR ZPERI2 ZCOND
     C                   CLEAR                   ZPERI2
     C                   CLEAR                   ZCOND
     C*PASAR   ZFUNC  '1'
     C                   MOVEL     '1'           ZFUNC
     C*SI ZAFILI <> *BLANCO
     C     ZAFILI        IFNE      *BLANK
     C*LLAMAR TRCEDC61 (ZAFILI PLAPER ZPERI2 ZCOND ZINVER ZINRTN ZSALIR
     C                   CALL      'TRCEDC61'
     C                   PARM                    ZAFILI
     C                   PARM                    PLAPER
     C                   PARM                    ZPERI2
     C                   PARM                    ZCOND
     C                   PARM                    ZINVER
     C                   PARM                    ZINRTN
     C                   PARM                    ZSALIR
     C                   PARM                    ZFUNC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Recupera el registro
     C*RECUPERARD CUEARC(ZCUENU ZFONDO)
     C     LL$106        KLIST
     C                   KFLD                    ZCUENU
     C                   KFLD                    ZFONDO
     C     LL$106        CHAIN     CUEARC                             4594
     C                   MOVE      *IN94         I$RND
     C     *IN45         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   CUEREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SINO
     C                   ELSE
     C*MOVER ZAFIIN ZCUENU
     C                   CLEAR                   ZAFIIN
     C                   MOVE      ZCUENU        ZAFIIN
     C*OBTENER (1) ZERROR = 'CUEARC no disponible - M14090 (2)' || ZPLAE
     C                   CLEAR                   H$1
     C     $HIL(065)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Terminar reversión comisión de cesantes                     ==
     C*==                                                              ==
     C*==================================================================
     C     M14095        BEGSR
     C* DESARROLLO ESPECIAL CESANTES
     C* Si es D.E Cesantes y no hay error
     C*SI ZININA = '1'  Y ZSALIR |= '1'
     C     ZININA        IFEQ      '1'
     C     ZSALIR        ANDNE     '1'
     C* Terminar reversión
     C*ASIGNARD ZINRTN '0'
     C                   MOVE      '0'           ZINRTN
     C*PASAR   ZFUNC  '1'
     C                   MOVEL     '1'           ZFUNC
     C*SI ZAFILI <> *BLANCO
     C     ZAFILI        IFNE      *BLANK
     C*LLAMAR TRCEDC63 (ZAFILI PLAPER ZPERI2 ZINVER ZINRTN ZSALIR ZFUNC)
     C                   CALL      'TRCEDC63'
     C                   PARM                    ZAFILI
     C                   PARM                    PLAPER
     C                   PARM                    ZPERI2
     C                   PARM                    ZINVER
     C                   PARM                    ZINRTN
     C                   PARM                    ZSALIR
     C                   PARM                    ZFUNC
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Si es D.E cesantes y no hay error
     C*SI ZINCES = '1'  Y ZSALIR |= '1'
     C     ZINCES        IFEQ      '1'
     C     ZSALIR        ANDNE     '1'
     C* Terminar reversión
     C*ASIGNARD ZINRTN '0'
     C                   MOVE      '0'           ZINRTN
     C*PASAR   ZFUNC  '1'
     C                   MOVEL     '1'           ZFUNC
     C*SI ZAFILI <> *BLANCO
     C     ZAFILI        IFNE      *BLANK
     C*LLAMAR TRCEDC61 (ZAFILI PLAPER ZPERI2 ZCOND ZINVER ZINRTN ZSALIR
     C                   CALL      'TRCEDC61'
     C                   PARM                    ZAFILI
     C                   PARM                    PLAPER
     C                   PARM                    ZPERI2
     C                   PARM                    ZCOND
     C                   PARM                    ZINVER
     C                   PARM                    ZINRTN
     C                   PARM                    ZSALIR
     C                   PARM                    ZFUNC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza campos adicionales de relación                    ==
     C*==                                                              ==
     C*==================================================================
     C     M14097        BEGSR
     C*SI AFIPR4 = *BLANCO
     C     AFIPR4        IFEQ      *BLANK
     C* El periodo cotizado
     C*PASAR AFIPR4 ZPERCO
     C                   MOVEL     ZPERCO        AFIPR4
     C*FIN
     C                   END
     C*SI AFIME1 = *BLANCO
     C     AFIME1        IFEQ      *BLANK
     C* Mes de la fecha inicio relación
     C*PASAR AFIME1 AFIFE9
     C                   MOVEL     AFIFE9        AFIME1
     C*FIN
     C                   END
     C*OBTENER (0) ZFETRA = AFIME1 || '01'
     C                   CLEAR                   ZFETRA
     C     AFIME1        CAT       '01':0        ZFETRA
     C* Meses a sumar
     C*MOVER ZMESES 1
     C                   Z-ADD     1             ZMESES
     C* Sumar 1 mes a fecha inicio
     C*LLAMAR RPSUMME1(ZFETRA ZMESES ZFECPR)
     C                   CALL      'RPSUMME1'
     C                   PARM                    ZFETRA
     C                   PARM                    ZMESES
     C                   PARM                    ZFECPR
     C* Un mes posterior a mes primer devengue
     C*PASAR AFIME2 ZFECPR
     C                   MOVEL     ZFECPR        AFIME2
     C*
     C* El salario reportado en planilla
     C*MOVER AFIULT DETSAL
     C                   Z-ADD     DETSAL        AFIULT
     C                   ENDSR
     C*==================================================================
     C*==  Control de suma periodos acreditados                        ==
     C*==                                                              ==
     C*==================================================================
     C     M14098        BEGSR
     C*SI ZINPEA=' '
     C     ZINPEA        IFEQ      ' '
     C*SUMAR 1 AFIPE3
     C                   ADD       1             AFIPE3
     C*PASAR ZINPEA '1'
     C                   MOVEL     '1'           ZINPEA
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesa depósitos por detalle                               ==
     C*==                                                              ==
     C*==================================================================
     C     M14100        BEGSR
     C* Posición en el arreglo
     C*MOVER L 1
     C                   Z-ADD     1             L
     C*LIMPIAR ZTDCO ZTDCVA ZTDCVE ZTDAR ZTDINT ZTOREN ZTDFS ZTDIFS
     C                   CLEAR                   ZTDCO
     C                   CLEAR                   ZTDCVA
     C                   CLEAR                   ZTDCVE
     C                   CLEAR                   ZTDAR
     C                   CLEAR                   ZTDINT
     C                   CLEAR                   ZTOREN
     C                   CLEAR                   ZTDFS
     C                   CLEAR                   ZTDIFS
     C*LIMPIAR ZVRREZ ZCUREZ ZINTRE ZIFSRE
     C                   CLEAR                   ZVRREZ
     C                   CLEAR                   ZCUREZ
     C                   CLEAR                   ZINTRE
     C                   CLEAR                   ZIFSRE
     C*LIMPIAR ZINCDE ZGRAMV ZTDSFS ZTDFGP ZTDISF ZTDIFG
     C                   CLEAR                   ZINCDE
     C                   CLEAR                   ZGRAMV
     C                   CLEAR                   ZTDSFS
     C                   CLEAR                   ZTDFGP
     C                   CLEAR                   ZTDISF
     C                   CLEAR                   ZTDIFG
     C*LIMPIAR ZCUERZ ZINSUM
     C                   CLEAR                   ZCUERZ
     C                   CLEAR                   ZINSUM
     C* Número depósitos procesados
     C*MIENTRAS L < K
     C     L             DOWLT     K
     C*LIMPIAR ZVDFS ZVDIFS ZVDINT ZVDCVA ZVDREN ZVDAR ZVDCO ZVDCVE
     C                   CLEAR                   ZVDFS
     C                   CLEAR                   ZVDIFS
     C                   CLEAR                   ZVDINT
     C                   CLEAR                   ZVDCVA
     C                   CLEAR                   ZVDREN
     C                   CLEAR                   ZVDAR
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZVDCVE
     C*LIMPIAR ZCUFS ZCUIFS ZCUINT ZCUCVA ZCUREN ZCUAR ZCUCO ZCUCVE
     C                   CLEAR                   ZCUFS
     C                   CLEAR                   ZCUIFS
     C                   CLEAR                   ZCUINT
     C                   CLEAR                   ZCUCVA
     C                   CLEAR                   ZCUREN
     C                   CLEAR                   ZCUAR
     C                   CLEAR                   ZCUCO
     C                   CLEAR                   ZCUCVE
     C*LIMPIAR ZVDSFS ZVDFGP ZVDISF ZVDIFG ZVDIVA ZVDIVE ZVDIAR
     C                   CLEAR                   ZVDSFS
     C                   CLEAR                   ZVDFGP
     C                   CLEAR                   ZVDISF
     C                   CLEAR                   ZVDIFG
     C                   CLEAR                   ZVDIVA
     C                   CLEAR                   ZVDIVE
     C                   CLEAR                   ZVDIAR
     C*LIMPIAR ZCUSFS ZCUFGP ZCUISF ZCUIFG ZCUIVA ZCUIVE ZCUIAR
     C                   CLEAR                   ZCUSFS
     C                   CLEAR                   ZCUFGP
     C                   CLEAR                   ZCUISF
     C                   CLEAR                   ZCUIFG
     C                   CLEAR                   ZCUIVA
     C                   CLEAR                   ZCUIVE
     C                   CLEAR                   ZCUIAR
     C*LIMPIAR ZVRSFS ZVRFSP ZVRDCO ZVRDFG ZVRCAR ZVINTE
     C                   CLEAR                   ZVRSFS
     C                   CLEAR                   ZVRFSP
     C                   CLEAR                   ZVRDCO
     C                   CLEAR                   ZVRDFG
     C                   CLEAR                   ZVRCAR
     C                   CLEAR                   ZVINTE
     C*LIMPIAR ZOVCO8 ZOVIN2 ZOVV13 ZOVI06 ZOVCOM ZOVVAL ZOVCO7 ZOVC27 Z
     C                   CLEAR                   ZOVCO8
     C                   CLEAR                   ZOVIN2
     C                   CLEAR                   ZOVV13
     C                   CLEAR                   ZOVI06
     C                   CLEAR                   ZOVCOM
     C                   CLEAR                   ZOVVAL
     C                   CLEAR                   ZOVCO7
     C                   CLEAR                   ZOVC27
     C                   CLEAR                   ZOVRET
     C* Distribuir valor
     C*EJECUTAR M14105
     C                   EXSR      M14105
     C* Hay error
     C*SI ZSALIR = '1'
     C     ZSALIR        IFEQ      '1'
     C*SALIR
     C                   GOTO      T$5
     C*FIN
     C                   END
     C* Calcular vlr del mvto
     C*EJECUTAR M14160
     C                   EXSR      M14160
     C* Indicador de rezago
     C*SI DETIN4 |= *BLANCO
     C     DETIN4        IFNE      *BLANK
     C*SI ZFSPAR = '1' Y ZINSUM <> '1'
     C     ZFSPAR        IFEQ      '1'
     C     ZINSUM        ANDNE     '1'
     C* Fondo
     C*MOVER ZFOFSP ZFONDO
     C                   MOVE      ZFONDO        ZFOFSP
     C* Planilla
     C*MOVER ZPLFSP PLANU1
     C                   Z-ADD     PLANU1        ZPLFSP
     C* Pagina
     C*MOVER ZPAFSP DETPAG
     C                   Z-ADD     DETPAG        ZPAFSP
     C* Secuencia
     C*MOVER ZSEFSP DETSEC
     C                   Z-ADD     DETSEC        ZSEFSP
     C* Acción: Consultar detalle
     C*PASAR ZACFSP 'D'
     C                   MOVEL     'D'           ZACFSP
     C*LLAMAR RPFSPR50 ($$FSP)
     C                   CALL      'RPFSPR50'
     C                   PARM                    $$FSP
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C* FSPARC para rezago
     C*PASAR ZFSPRE '1'
     C                   MOVEL     '1'           ZFSPRE
     C*CALCULAR ZVFSRE = ZVFSRE + (ZZAFSP+ZVZFSP+ZVIFSP+ZVISUB)
     C     ZZAFSP        ADD       ZVZFSP        V$CA1           030 9
     C     V$CA1         ADD       ZVIFSP        V$CA1
     C     V$CA1         ADD       ZVISUB        V$CA1
     C     ZVFSRE        ADD       V$CA1         ZVFSRE
     C*CALCULAR ZCFSRE = ZCFSRE + (ZZUFSP+ZCSFSP+ZCIFSP+ZCISUB)
     C     ZZUFSP        ADD       ZCSFSP        V$CA1           030 9
     C     V$CA1         ADD       ZCIFSP        V$CA1
     C     V$CA1         ADD       ZCISUB        V$CA1
     C     ZCFSRE        ADD       V$CA1         ZCFSRE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Distribución rezago
     C*EJECUTAR M14170
     C                   EXSR      M14170
     C*SINO
     C                   ELSE
     C* Generar movimiento
     C*EJECUTAR M14300
     C                   EXSR      M14300
     C* Hay error
     C*SI ZSALIR = '1'
     C     ZSALIR        IFEQ      '1'
     C*SALIR
     C                   GOTO      T$5
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SUMAR 1 L
     C                   ADD       1             L
     C*FIN
     C                   END
     C     T$5           TAG
     C                   ENDSR
     C*==================================================================
     C*==  Distribuir valor                                            ==
     C*==                                                              ==
     C*==================================================================
     C     M14105        BEGSR
     C* Fecha depósito
     C*PASAR ZFECDE AFECDE[L]
     C                   MOVEL     $G(L)         ZFECDE
     C* Plan. terceros
     C*SI PLATIP = '07'
     C     PLATIP        IFEQ      '07'
     C*LIMPIAR ZINIFS ZINISF ZININT ZINCVA ZINCVE ZINNAR ZINIFG
     C                   CLEAR                   ZINIFS
     C                   CLEAR                   ZINISF
     C                   CLEAR                   ZININT
     C                   CLEAR                   ZINCVA
     C                   CLEAR                   ZINCVE
     C                   CLEAR                   ZINNAR
     C                   CLEAR                   ZINIFG
     C* Plan. con deuda por mora
     C*SI PLATIP = '07' Y ZLIQIN = '1'
     C     PLATIP        IFEQ      '07'
     C     ZLIQIN        ANDEQ     '1'
     C* Calcular intereses x detalle
     C*PASAR ZIND '2'
     C                   MOVEL     '2'           ZIND
     C* Identificación del afiliado
     C*MOVER ZID DETNU2
     C                   Z-ADD     DETNU2        ZID
     C* Calcular intereses
     C*EJECUTAR M12207
     C                   EXSR      M12207
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* No es proceso terceros
     C*SI ZINDTE <> 'S' O PLATIP <> '07'
     C     ZINDTE        IFNE      'S'
     C     PLATIP        ORNE      '07'
     C* Distribuir C.V.A.
     C*EJECUTAR M14110
     C                   EXSR      M14110
     C* Distribuir F.S.
     C*EJECUTAR M14115
     C                   EXSR      M14115
     C* Distribuir F. Subsistencia
     C*EJECUTAR M14116
     C                   EXSR      M14116
     C* Distribuir I.F.S.
     C*EJECUTAR M14120
     C                   EXSR      M14120
     C* Distribuir int. subsistencia
     C*EJECUTAR M14121
     C                   EXSR      M14121
     C* Distribuir FGPM
     C*EJECUTAR M14150
     C                   EXSR      M14150
     C* Distribuir int. FGPM
     C*EJECUTAR M14155
     C                   EXSR      M14155
     C* Distribuir Intereses
     C*EJECUTAR M14125
     C                   EXSR      M14125
     C* Distribuir Rendimientos
     C*EJECUTAR M14130
     C                   EXSR      M14130
     C* Distribuir A.R.
     C*EJECUTAR M14135
     C                   EXSR      M14135
     C* Distribuir C.O.
     C*EJECUTAR M14140
     C                   EXSR      M14140
     C* Distribuir C.V.E.
     C*EJECUTAR M14145
     C                   EXSR      M14145
     C*SINO
     C                   ELSE
     C* Procesa planilla de terceros
     C*EJECUTAR M14550
     C                   EXSR      M14550
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Distribuir C.V.A.                                           ==
     C*==                                                              ==
     C*==================================================================
     C     M14110        BEGSR
     C* Valor pagado C.V.A.
     C*MOVER ZVALOR A$CVA[L]
     C                   Z-ADD     $2(L)         ZVALOR
     C* Cuotas pagadas C.V.A.
     C*MOVER ZCUOTA ACUCVA[L]
     C                   Z-ADD     $A(L)         ZCUOTA
     C*SI ZCOTVA > 0 Y ZVALOR > 0
     C     ZCOTVA        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total C.V.A.> Valor acumulado
     C*SI ZTOCVA |= ZVACVA
     C     ZTOCVA        IFNE      ZVACVA
     C*CALCULAR (R) ZVDCVA = (ZCOTVA * (ZVALOR - VDICVA[L]))/(ZTOCVA - Z
     C     ZVALOR        SUB       $R(L)         V$CA1           030 9
     C     ZCOTVA        MULT      V$CA1         V$CA1
     C     ZTOCVA        SUB       ZVACVA        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDCVA
     C* Si se distribuye en pesos
     C*SI ZVDCVA != *CERO
     C     ZVDCVA        IFNE      *ZERO
     C*CALCULAR (R) ZCUCVA = (ZVDCVA * (ZCUOTA - CDICVA[L]))/(ZVALOR - V
     C     ZCUOTA        SUB       $J(L)         V$CA1           030 9
     C     ZVDCVA        MULT      V$CA1         V$CA1
     C     ZVALOR        SUB       $R(L)         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUCVA
     C*SINO
     C                   ELSE
     C*LIMPIAR ZCUCVA
     C                   CLEAR                   ZCUCVA
     C*FIN
     C                   END
     C* Valor distribuido C.V.A.
     C*SUMAR ZVDCVA VDICVA[L]
     C                   ADD       ZVDCVA        $R(L)
     C* Cuotas distribuidas C.V.A.
     C*SUMAR ZCUCVA CDICVA[L]
     C                   ADD       ZCUCVA        $J(L)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución de C.V.A.'
     C                   MOVEL     $HIL(066)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Dritribuir fondo de solidaridad                             ==
     C*==                                                              ==
     C*==================================================================
     C     M14115        BEGSR
     C*
     C* En este módulo se obtiene el valor distribuido para el detalle p
     C* fondo de solidaridad, sin incluir la parte de subsitencia
     C*
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado F.S.
     C*MOVER ZVALOR A$FS[1,L]
     C                   Z-ADD     $4(L)         ZVALOR
     C* Cuotas pagadas F.S.
     C*MOVER ZCUOTA ACUFS[1,L]
     C                   Z-ADD     $C(L)         ZCUOTA
     C*SI ZCOTFS > 0 Y ZVALOR > 0
     C     ZCOTFS        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total F.S. > Valor acumulado
     C*SI ZTOFS |= ZVAFS
     C     ZTOFS         IFNE      ZVAFS
     C*CALCULAR (R) ZVDFS = (ZCOTFS * (ZVALOR - VDIFS[1,L]))/(ZTOFS - ZV
     C     ZVALOR        SUB       $T(L)         V$CA1           030 9
     C     ZCOTFS        MULT      V$CA1         V$CA1
     C     ZTOFS         SUB       ZVAFS         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDFS
     C* Si se distribuye en pesos
     C*SI ZVDFS != *CERO
     C     ZVDFS         IFNE      *ZERO
     C*CALCULAR (R) ZCUFS = (ZVDFS * (ZCUOTA - CDIFS[1,L]))/(ZVALOR - VD
     C     ZCUOTA        SUB       $L(L)         V$CA1           030 9
     C     ZVDFS         MULT      V$CA1         V$CA1
     C     ZVALOR        SUB       $T(L)         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUFS
     C*SINO
     C                   ELSE
     C*LIMPIAR ZCUFS
     C                   CLEAR                   ZCUFS
     C*FIN
     C                   END
     C* Valor distribuido F.S.
     C*SUMAR ZVDFS VDIFS[1,L]
     C                   ADD       ZVDFS         $T(L)
     C* Cuotas distribuidas F.S.
     C*SUMAR ZCUFS CDIFS[1,L]
     C                   ADD       ZCUFS         $L(L)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución de F.S.'
     C                   MOVEL     $HIL(067)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Distribuir fondo de subsistencia                            ==
     C*==                                                              ==
     C*==================================================================
     C     M14116        BEGSR
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado Subsistencia
     C*MOVER ZVALOR A$FS[2,L]
     C     100           ADD       L             V$2               4 0
     C                   Z-ADD     $4(V$2)       ZVALOR
     C* Cuotas pagadas Subsistencia
     C*MOVER ZCUOTA ACUFS[2,L]
     C     100           ADD       L             V$2               4 0
     C                   Z-ADD     $C(V$2)       ZCUOTA
     C*SI ZCOTSF > 0 Y ZVALOR > 0
     C     ZCOTSF        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total Subs > Valor acumulado
     C*SI ZTOSFS |= ZVASFS
     C     ZTOSFS        IFNE      ZVASFS
     C*CALCULAR (R) ZVDSFS = (ZCOTSF * (ZVALOR - VDIFS[2,L]))/(ZTOSFS -
     C     100           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $T(V$2)       V$CA1           030 9
     C     ZCOTSF        MULT      V$CA1         V$CA1
     C     ZTOSFS        SUB       ZVASFS        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDSFS
     C* Si se distribuye en pesos
     C*SI ZVDSFS != *CERO
     C     ZVDSFS        IFNE      *ZERO
     C*CALCULAR (R) ZCUSFS = (ZVDSFS * (ZCUOTA - CDIFS[2,L]))/(ZVALOR -
     C     99            ADD       L             V$2               4 0
     C     ZCUOTA        SUB       $L(V$2)       V$CA1           030 9
     C     ZVDSFS        MULT      V$CA1         V$CA1
     C     100           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $T(V$2)       V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUSFS
     C*SINO
     C                   ELSE
     C*LIMPIAR ZCUSFS
     C                   CLEAR                   ZCUSFS
     C*FIN
     C                   END
     C* Vlr distribuido Subsistencia
     C*SUMAR ZVDSFS VDIFS[2,L]
     C     100           ADD       L             V$3               4 0
     C                   ADD       ZVDSFS        $T(V$3)
     C* Cuo. distribuida Subsistencia
     C*SUMAR ZCUSFS CDIFS[2,L]
     C     99            ADD       L             V$3               4 0
     C                   ADD       ZCUSFS        $L(V$3)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución de F.Subsistenc
     C                   MOVEL     $HIL(068)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Distribuir intereses fondo de solidaridad                   ==
     C*==                                                              ==
     C*==================================================================
     C     M14120        BEGSR
     C*
     C* En este módulo se obtiene el valor distribuido para el detalle p
     C* intereses fondo de solidaridad, sin incluir la parte de subsiten
     C*
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado I.F.S.
     C*MOVER ZVALOR A$IFS[1,L]
     C                   Z-ADD     $5(L)         ZVALOR
     C* Cuotas pagadas I.F.S.
     C*MOVER ZCUOTA ACUIFS[1,L]
     C                   Z-ADD     $D(L)         ZCUOTA
     C*SI ZCOTFS > 0 Y ZVALOR > 0
     C     ZCOTFS        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total I.F.S.> Valor acumulado
     C*SI ZTOFS |= ZVAFS
     C     ZTOFS         IFNE      ZVAFS
     C* Planilla tercero
     C*SI PLATIP = '07'
     C     PLATIP        IFEQ      '07'
     C* Valor intereses F.S
     C*MOVER ZVDIFS ZINIFS
     C                   Z-ADD     ZINIFS        ZVDIFS
     C*SINO
     C                   ELSE
     C*CALCULAR (R) ZVDIFS = (ZCOTFS * (ZVALOR - VDIIFS[1,L]))/(ZTOFS -
     C     ZVALOR        SUB       $U(L)         V$CA1           030 9
     C     ZCOTFS        MULT      V$CA1         V$CA1
     C     ZTOFS         SUB       ZVAFS         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDIFS
     C*FIN
     C                   END
     C* Si se distribuye en pesos
     C*SI ZVDIFS != *CERO
     C     ZVDIFS        IFNE      *ZERO
     C*CALCULAR (R) ZCUIFS = (ZVDIFS * (ZCUOTA - CDIIFS[1,L]))/(ZVALOR -
     C     ZCUOTA        SUB       $M(L)         V$CA1           030 9
     C     ZVDIFS        MULT      V$CA1         V$CA1
     C     ZVALOR        SUB       $U(L)         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUIFS
     C*SINO
     C                   ELSE
     C*LIMPIAR ZCUIFS
     C                   CLEAR                   ZCUIFS
     C*FIN
     C                   END
     C* Valor distribuido I.F.S.
     C*SUMAR ZVDIFS VDIIFS[1,L]
     C                   ADD       ZVDIFS        $U(L)
     C* Cuotas distribuidas I.F.S.
     C*SUMAR ZCUIFS CDIIFS[1,L]
     C                   ADD       ZCUIFS        $M(L)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución de Intereses F.
     C                   MOVEL     $HIL(069)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Distribuir int. de subsistencia                             ==
     C*==                                                              ==
     C*==================================================================
     C     M14121        BEGSR
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado int. subsitencia
     C*MOVER ZVALOR A$IFS[2,L]
     C     100           ADD       L             V$2               4 0
     C                   Z-ADD     $5(V$2)       ZVALOR
     C* Cuotas pagadas Int. subsistencia
     C*MOVER ZCUOTA ACUIFS[2,L]
     C     100           ADD       L             V$2               4 0
     C                   Z-ADD     $D(V$2)       ZCUOTA
     C*SI ZCOTSF > 0 Y ZVALOR > 0
     C     ZCOTSF        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total int. Sub.> Valor acumulado
     C*SI ZTOSFS |= ZVASFS
     C     ZTOSFS        IFNE      ZVASFS
     C* Planilla tercero
     C*SI PLATIP = '07'
     C     PLATIP        IFEQ      '07'
     C* Int. Subsistencia
     C*MOVER ZVDISF ZINISF
     C                   Z-ADD     ZINISF        ZVDISF
     C*SINO
     C                   ELSE
     C*CALCULAR (R) ZVDISF = (ZCOTSF * (ZVALOR - VDIIFS[2,L]))/(ZTOSFS -
     C     100           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $U(V$2)       V$CA1           030 9
     C     ZCOTSF        MULT      V$CA1         V$CA1
     C     ZTOSFS        SUB       ZVASFS        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDISF
     C*FIN
     C                   END
     C* Si se distribuye en pesos
     C*SI ZVDISF != *CERO
     C     ZVDISF        IFNE      *ZERO
     C*CALCULAR (R) ZCUISF = (ZVDISF * (ZCUOTA - CDIIFS[2,L]))/(ZVALOR -
     C     100           ADD       L             V$2               4 0
     C     ZCUOTA        SUB       $M(V$2)       V$CA1           030 9
     C     ZVDISF        MULT      V$CA1         V$CA1
     C     100           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $U(V$2)       V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUISF
     C*SINO
     C                   ELSE
     C*LIMPIAR ZCUISF
     C                   CLEAR                   ZCUISF
     C*FIN
     C                   END
     C* Vlr distribuido Int. Subsist.
     C*SUMAR ZVDISF VDIIFS[2,L]
     C     100           ADD       L             V$3               4 0
     C                   ADD       ZVDISF        $U(V$3)
     C* Cuo. distribuidas Int. Subs.
     C*SUMAR ZCUISF CDIIFS[2,L]
     C     100           ADD       L             V$3               4 0
     C                   ADD       ZCUISF        $M(V$3)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribuir Int. de subsisten
     C                   MOVEL     $HIL(070)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Distribuir intereses                                        ==
     C*==                                                              ==
     C*==================================================================
     C     M14125        BEGSR
     C* Se distribuyen los interese por concepto pero al final se acumul
     C* en los intereses C.O porque se generan acumulados en el movimien
     C*
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado Int. C.O
     C*MOVER ZVALOR A$INT[1,L]
     C                   Z-ADD     $6(L)         ZVALOR
     C* Cuotas pagadas Int. C.O
     C*MOVER ZCUOTA ACUINT[1,L]
     C                   Z-ADD     $E(L)         ZCUOTA
     C*SI ZCOTOB > 0 Y ZVALOR > 0
     C     ZCOTOB        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total Cotizaciones > Vl acum.
     C*SI ZTOCO  |= ZVACO
     C     ZTOCO         IFNE      ZVACO
     C* Planilla tercero
     C*SI PLATIP = '07'
     C     PLATIP        IFEQ      '07'
     C* Intereses
     C*MOVER ZVDINT ZININT
     C                   Z-ADD     ZININT        ZVDINT
     C*SINO
     C                   ELSE
     C*CALCULAR (R) ZVDINT=(ZCOTOB*(ZVALOR-VDIINT[1,L]))/(ZTOCO-ZVACO)
     C     ZVALOR        SUB       $V(L)         V$CA1           030 9
     C     ZCOTOB        MULT      V$CA1         V$CA1
     C     ZTOCO         SUB       ZVACO         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDINT
     C*FIN
     C                   END
     C* Si se distribuye en pesos
     C*SI ZVDINT != *CERO
     C     ZVDINT        IFNE      *ZERO
     C*CALCULAR (R) ZCUINT=(ZVDINT*(ZCUOTA-CDIINT[1,L]))/(ZVALOR-VDIINT[
     C     ZCUOTA        SUB       $N(L)         V$CA1           030 9
     C     ZVDINT        MULT      V$CA1         V$CA1
     C     ZVALOR        SUB       $V(L)         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUINT
     C*SINO
     C                   ELSE
     C* Cuotas Intereses C.O
     C*LIMPIAR ZCUINT
     C                   CLEAR                   ZCUINT
     C*FIN
     C                   END
     C* Valor distribuido Int. C.O
     C*SUMAR ZVDINT VDIINT[1,L]
     C                   ADD       ZVDINT        $V(L)
     C* Cuotas distribuidas Int. CO
     C*SUMAR ZCUINT CDIINT[1,L]
     C                   ADD       ZCUINT        $N(L)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución Int. C.O.'
     C                   MOVEL     $HIL(071)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado Int. C.V.A
     C*MOVER ZVALOR A$INT[2,L]
     C     100           ADD       L             V$2               4 0
     C                   Z-ADD     $6(V$2)       ZVALOR
     C* Cuotas Pagadas Int. C.V.A
     C*MOVER ZCUOTA ACUINT[2,L]
     C     100           ADD       L             V$2               4 0
     C                   Z-ADD     $E(V$2)       ZCUOTA
     C*SI ZCOTVA > 0 Y ZVALOR > 0
     C     ZCOTVA        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total C.V.A > Vl Acum.
     C*SI ZTOCVA |= ZVACVA
     C     ZTOCVA        IFNE      ZVACVA
     C* Planilla tercero
     C*SI PLATIP = '07'
     C     PLATIP        IFEQ      '07'
     C* Intereses CVA
     C*MOVER ZVDIVA ZINCVA
     C                   Z-ADD     ZINCVA        ZVDIVA
     C*SINO
     C                   ELSE
     C*CALCULAR (R) ZVDIVA=(ZCOTVA*(ZVALOR-VDIINT[2,L]))/(ZTOCVA-ZVACVA)
     C     100           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $V(V$2)       V$CA1           030 9
     C     ZCOTVA        MULT      V$CA1         V$CA1
     C     ZTOCVA        SUB       ZVACVA        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDIVA
     C*FIN
     C                   END
     C* Si se distribuye en pesos
     C*SI ZVDIVA != *CERO
     C     ZVDIVA        IFNE      *ZERO
     C*CALCULAR (R) ZCUIVA=(ZVDIVA*(ZCUOTA-CDIINT[2,L]))/(ZVALOR-VDIINT[
     C     100           ADD       L             V$2               4 0
     C     ZCUOTA        SUB       $N(V$2)       V$CA1           030 9
     C     ZVDIVA        MULT      V$CA1         V$CA1
     C     100           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $V(V$2)       V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUIVA
     C*SINO
     C                   ELSE
     C* Cuotas intereses C.V.A
     C*LIMPIAR ZCUIVA
     C                   CLEAR                   ZCUIVA
     C*FIN
     C                   END
     C* Valor distribuido Int. C.V.A
     C*SUMAR ZVDIVA VDIINT[2,L]
     C     100           ADD       L             V$3               4 0
     C                   ADD       ZVDIVA        $V(V$3)
     C* Cuotas distribuidas Int. CVA
     C*SUMAR ZCUIVA CDIINT[2,L]
     C     100           ADD       L             V$3               4 0
     C                   ADD       ZCUIVA        $N(V$3)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución Int. C.V.A.'
     C                   MOVEL     $HIL(072)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado Int. C.V.E
     C*MOVER ZVALOR A$INT[3,L]
     C     200           ADD       L             V$2               4 0
     C                   Z-ADD     $6(V$2)       ZVALOR
     C* Cuotas Pagadas Int. C.V.E
     C*MOVER ZCUOTA ACUINT[3,L]
     C     200           ADD       L             V$2               4 0
     C                   Z-ADD     $E(V$2)       ZCUOTA
     C*SI ZCOTVE > 0 Y ZVALOR > 0
     C     ZCOTVE        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total C.V.E > Vl Acum.
     C*SI ZTOCVE |= ZVACVE
     C     ZTOCVE        IFNE      ZVACVE
     C* Planilla tercero
     C*SI PLATIP = '07'
     C     PLATIP        IFEQ      '07'
     C* Intereses C.V.E
     C*MOVER ZVDIVE ZINCVE
     C                   Z-ADD     ZINCVE        ZVDIVE
     C*SINO
     C                   ELSE
     C*CALCULAR (R) ZVDIVE=(ZCOTVE*(ZVALOR-VDIINT[3,L]))/(ZTOCVE-ZVACVE)
     C     200           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $V(V$2)       V$CA1           030 9
     C     ZCOTVE        MULT      V$CA1         V$CA1
     C     ZTOCVE        SUB       ZVACVE        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDIVE
     C*FIN
     C                   END
     C* Si se distribuye en pesos
     C*SI ZVDIVE != *CERO
     C     ZVDIVE        IFNE      *ZERO
     C*CALCULAR (R) ZCUIVE=(ZVDIVE*(ZCUOTA-CDIINT[3,L]))/(ZVALOR-VDIINT[
     C     200           ADD       L             V$2               4 0
     C     ZCUOTA        SUB       $N(V$2)       V$CA1           030 9
     C     ZVDIVE        MULT      V$CA1         V$CA1
     C     200           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $V(V$2)       V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUIVE
     C*SINO
     C                   ELSE
     C* Cuotas intereses C.V.E
     C*LIMPIAR ZCUIVE
     C                   CLEAR                   ZCUIVE
     C*FIN
     C                   END
     C* Valor distribuido Int. C.V.E
     C*SUMAR ZVDIVE VDIINT[3,L]
     C     200           ADD       L             V$3               4 0
     C                   ADD       ZVDIVE        $V(V$3)
     C* Cuotas distribuidas Int. CVE
     C*SUMAR ZCUIVE CDIINT[3,L]
     C     200           ADD       L             V$3               4 0
     C                   ADD       ZCUIVE        $N(V$3)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución Int. C.V.E.'
     C                   MOVEL     $HIL(073)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado Int. A.R.
     C*MOVER ZVALOR A$INT[4,L]
     C     300           ADD       L             V$2               4 0
     C                   Z-ADD     $6(V$2)       ZVALOR
     C* Cuotas Pagadas Int. A.R.
     C*MOVER ZCUOTA ACUINT[4,L]
     C     300           ADD       L             V$2               4 0
     C                   Z-ADD     $E(V$2)       ZCUOTA
     C*SI ZCOTAR > 0 Y ZVALOR > 0
     C     ZCOTAR        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total A.R. > Vl Acum.
     C*SI ZTOAR |= ZVAAR
     C     ZTOAR         IFNE      ZVAAR
     C* Planilla tercero
     C*SI PLATIP = '07'
     C     PLATIP        IFEQ      '07'
     C* Int. alto riesgo
     C*MOVER ZVDIAR ZINNAR
     C                   Z-ADD     ZINNAR        ZVDIAR
     C*SINO
     C                   ELSE
     C*CALCULAR (R) ZVDIAR=(ZCOTAR*(ZVALOR-VDIINT[4,L]))/(ZTOAR-ZVAAR)
     C     300           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $V(V$2)       V$CA1           030 9
     C     ZCOTAR        MULT      V$CA1         V$CA1
     C     ZTOAR         SUB       ZVAAR         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDIAR
     C*FIN
     C                   END
     C* Si se distribuye en pesos
     C*SI ZVDIAR != *CERO
     C     ZVDIAR        IFNE      *ZERO
     C*CALCULAR (R) ZCUIAR=(ZVDIAR*(ZCUOTA-CDIINT[4,L]))/(ZVALOR-VDIINT[
     C     300           ADD       L             V$2               4 0
     C     ZCUOTA        SUB       $N(V$2)       V$CA1           030 9
     C     ZVDIAR        MULT      V$CA1         V$CA1
     C     300           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $V(V$2)       V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUIAR
     C*SINO
     C                   ELSE
     C* Cuotas intereses A.R.
     C*LIMPIAR ZCUIAR
     C                   CLEAR                   ZCUIAR
     C*FIN
     C                   END
     C* Valor distribuido Int. A.R.
     C*SUMAR ZVDIAR VDIINT[4,L]
     C     300           ADD       L             V$3               4 0
     C                   ADD       ZVDIAR        $V(V$3)
     C* Cuotas distribuidas Int. A.R.
     C*SUMAR ZCUIAR CDIINT[4,L]
     C     300           ADD       L             V$3               4 0
     C                   ADD       ZCUIAR        $N(V$3)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución Int. A.R.'
     C                   MOVEL     $HIL(074)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Total intereses
     C*CALCULAR ZVDINT = ZVDINT + ZVDIVA + ZVDIVE + ZVDIAR
     C     ZVDINT        ADD       ZVDIVA        V$CA1           030 9
     C     V$CA1         ADD       ZVDIVE        V$CA1
     C     V$CA1         ADD       ZVDIAR        ZVDINT
     C* Cuotas int.
     C*CALCULAR ZCUINT = ZCUINT + ZCUIVA + ZCUIVE + ZCUIAR
     C     ZCUINT        ADD       ZCUIVA        V$CA1           030 9
     C     V$CA1         ADD       ZCUIVE        V$CA1
     C     V$CA1         ADD       ZCUIAR        ZCUINT
     C*
     C                   ENDSR
     C*==================================================================
     C*==  Distribuir rendimientos                                     ==
     C*==                                                              ==
     C*==================================================================
     C     M14130        BEGSR
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado rendimientos
     C*MOVER ZVALOR A$REN[L]
     C                   Z-ADD     $7(L)         ZVALOR
     C* Cuotas pagadas rendimientos
     C*MOVER ZCUOTA ACUREN[L]
     C                   Z-ADD     $F(L)         ZCUOTA
     C*SI ZRENDI > 0 Y ZVALOR > 0
     C     ZRENDI        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total rendi.> Valor acumulado
     C*SI ZTOREN |= ZVAREN
     C     ZTOREN        IFNE      ZVAREN
     C*CALCULAR (R) ZVDREN = (ZRENDI*(ZVALOR - VDIREN[L]))/(ZTOREN - ZVA
     C     ZVALOR        SUB       $W(L)         V$CA1           030 9
     C     ZRENDI        MULT      V$CA1         V$CA1
     C     ZTOREN        SUB       ZVAREN        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDREN
     C* Si se ditribuye en pesos
     C*SI ZVDREN != *CERO
     C     ZVDREN        IFNE      *ZERO
     C*CALCULAR (R) ZCUREN = (ZVDREN*(ZCUOTA - CDIREN[L]))/(ZVALOR - VDI
     C     ZCUOTA        SUB       $O(L)         V$CA1           030 9
     C     ZVDREN        MULT      V$CA1         V$CA1
     C     ZVALOR        SUB       $W(L)         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUREN
     C*SINO
     C                   ELSE
     C*LIMPIAR ZCUREN
     C                   CLEAR                   ZCUREN
     C*FIN
     C                   END
     C* Valor distribuido rendimien.
     C*SUMAR ZVDREN VDIREN[L]
     C                   ADD       ZVDREN        $W(L)
     C* Cuotas distribuidas rendimie.
     C*SUMAR ZCUREN CDIREN[L]
     C                   ADD       ZCUREN        $O(L)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución de rendimientos
     C                   MOVEL     $HIL(075)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Distribuir alto riesgo                                      ==
     C*==                                                              ==
     C*==================================================================
     C     M14135        BEGSR
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado A.R.
     C*MOVER ZVALOR A$AR[L]
     C                   Z-ADD     $0(L)         ZVALOR
     C* Cuotas pagadas A.R.
     C*MOVER ZCUOTA ACUAR[L]
     C                   Z-ADD     $8(L)         ZCUOTA
     C*SI ZCOTAR > 0 Y ZVALOR > 0
     C     ZCOTAR        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total A.R.  > Valor acumulado
     C*SI ZTOAR |= ZVAAR
     C     ZTOAR         IFNE      ZVAAR
     C*CALCULAR (R) ZVDAR = (ZCOTAR * (ZVALOR - VDIAR[L]))/(ZTOAR - ZVAA
     C     ZVALOR        SUB       $P(L)         V$CA1           030 9
     C     ZCOTAR        MULT      V$CA1         V$CA1
     C     ZTOAR         SUB       ZVAAR         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDAR
     C* Si se distribuye en pesos
     C*SI ZVDAR != *CERO
     C     ZVDAR         IFNE      *ZERO
     C*CALCULAR (R) ZCUAR = (ZVDAR * (ZCUOTA - CDIAR[L]))/(ZVALOR - VDIA
     C     ZCUOTA        SUB       $H(L)         V$CA1           030 9
     C     ZVDAR         MULT      V$CA1         V$CA1
     C     ZVALOR        SUB       $P(L)         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUAR
     C*SINO
     C                   ELSE
     C*LIMPIAR ZCUAR
     C                   CLEAR                   ZCUAR
     C*FIN
     C                   END
     C* Valor distribuido A.R.
     C*SUMAR ZVDAR VDIAR[L]
     C                   ADD       ZVDAR         $P(L)
     C* Cuotas distribuidas A.R.
     C*SUMAR ZCUAR CDIAR[L]
     C                   ADD       ZCUAR         $H(L)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución de alto riesgo'
     C                   MOVEL     $HIL(076)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Distribuir cotización obligatoria                           ==
     C*==                                                              ==
     C*==================================================================
     C     M14140        BEGSR
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado C.O.
     C*MOVER ZVALOR A$CO[1,L]
     C                   Z-ADD     $1(L)         ZVALOR
     C* Cuotas pagadas C.O.
     C*MOVER ZCUOTA ACUCO[1,L]
     C                   Z-ADD     $9(L)         ZCUOTA
     C*SI ZCOTOB > 0 Y ZVALOR > 0
     C     ZCOTOB        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total C.O.  > Valor acumulado
     C*SI ZTOCO |= ZVACO
     C     ZTOCO         IFNE      ZVACO
     C*CALCULAR (R) ZVDCO=(ZCOTOB*(ZVALOR-VDICO[1,L]))/(ZTOCO-ZVACO)
     C     ZVALOR        SUB       $Q(L)         V$CA1           030 9
     C     ZCOTOB        MULT      V$CA1         V$CA1
     C     ZTOCO         SUB       ZVACO         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDCO
     C* Si se distribuye en pesos
     C*SI ZVDCO != *CERO
     C     ZVDCO         IFNE      *ZERO
     C*CALCULAR (R) ZCUCO=(ZVDCO*(ZCUOTA-CDICO[1,L]))/(ZVALOR-VDICO[1,L]
     C     ZCUOTA        SUB       $I(L)         V$CA1           030 9
     C     ZVDCO         MULT      V$CA1         V$CA1
     C     ZVALOR        SUB       $Q(L)         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUCO
     C*SINO
     C                   ELSE
     C*LIMPIAR ZCUCO
     C                   CLEAR                   ZCUCO
     C*FIN
     C                   END
     C* Valor distribuido C.O.
     C*SUMAR ZVDCO VDICO[1,L]
     C                   ADD       ZVDCO         $Q(L)
     C* Cuotas distribuidas C.O.
     C*SUMAR ZCUCO CDICO[1,L]
     C                   ADD       ZCUCO         $I(L)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución de cot. oblig.'
     C                   MOVEL     $HIL(077)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Distribuir cotización voluntaria empleador                  ==
     C*==                                                              ==
     C*==================================================================
     C     M14145        BEGSR
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado C.V.E.
     C*MOVER ZVALOR A$CVE[L]
     C                   Z-ADD     $3(L)         ZVALOR
     C* Cuotas pagadas C.V.E.
     C*MOVER ZCUOTA ACUCVE[L]
     C                   Z-ADD     $B(L)         ZCUOTA
     C*SI ZCOTVE > 0 Y ZVALOR > 0
     C     ZCOTVE        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total C.V.E.> Valor acumulado
     C*SI ZTOCVE |= ZVACVE
     C     ZTOCVE        IFNE      ZVACVE
     C*CALCULAR (R) ZVDCVE = (ZCOTVE * (ZVALOR - VDICVE[L]))/(ZTOCVE - Z
     C     ZVALOR        SUB       $S(L)         V$CA1           030 9
     C     ZCOTVE        MULT      V$CA1         V$CA1
     C     ZTOCVE        SUB       ZVACVE        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDCVE
     C* Si se distribuye en pesos
     C*SI ZVDCVE != *CERO
     C     ZVDCVE        IFNE      *ZERO
     C*CALCULAR (R) ZCUCVE = (ZVDCVE * (ZCUOTA - CDICVE[L]))/(ZVALOR - V
     C     ZCUOTA        SUB       $K(L)         V$CA1           030 9
     C     ZVDCVE        MULT      V$CA1         V$CA1
     C     ZVALOR        SUB       $S(L)         V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUCVE
     C*SINO
     C                   ELSE
     C*LIMPIAR ZCUCVE
     C                   CLEAR                   ZCUCVE
     C*FIN
     C                   END
     C* Valor distribuido C.V.E.
     C*SUMAR ZVDCVE VDICVE[L]
     C                   ADD       ZVDCVE        $S(L)
     C* Cuotas distribuidas C.V.E.
     C*SUMAR ZCUCVE CDICVE[L]
     C                   ADD       ZCUCVE        $K(L)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución de C.V.E.'
     C                   MOVEL     $HIL(078)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Distribuir fondo de garantia de pensión mínima              ==
     C*==                                                              ==
     C*==================================================================
     C     M14150        BEGSR
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado G.P.M.
     C*MOVER ZVALOR A$CO[2,L]
     C     100           ADD       L             V$2               4 0
     C                   Z-ADD     $1(V$2)       ZVALOR
     C* Cuotas pagadas G.P.M.
     C*MOVER ZCUOTA ACUCO[2,L]
     C     100           ADD       L             V$2               4 0
     C                   Z-ADD     $9(V$2)       ZCUOTA
     C*SI ZCOTFG > 0 Y ZVALOR > 0
     C     ZCOTFG        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total C.O.  > Valor acumulado
     C*SI ZTOFGP |= ZVAFGP
     C     ZTOFGP        IFNE      ZVAFGP
     C*CALCULAR (R) ZVDFGP=(ZCOTFG*(ZVALOR-VDICO[2,L]))/(ZTOFGP-ZVAFGP)
     C     100           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $Q(V$2)       V$CA1           030 9
     C     ZCOTFG        MULT      V$CA1         V$CA1
     C     ZTOFGP        SUB       ZVAFGP        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDFGP
     C* Si se distribuye en pesos
     C*SI ZVDFGP |= *CERO
     C     ZVDFGP        IFNE      *ZERO
     C*CALCULAR (R) ZCUFGP=(ZVDFGP*(ZCUOTA-CDICO[2,L]))/(ZVALOR-VDICO[2,
     C     99            ADD       L             V$2               4 0
     C     ZCUOTA        SUB       $I(V$2)       V$CA1           030 9
     C     ZVDFGP        MULT      V$CA1         V$CA1
     C     100           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $Q(V$2)       V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUFGP
     C*SINO
     C                   ELSE
     C*LIMPIAR ZCUFGP
     C                   CLEAR                   ZCUFGP
     C*FIN
     C                   END
     C* Valor distribuido F.G.P
     C*SUMAR ZVDFGP VDICO[2,L]
     C     100           ADD       L             V$3               4 0
     C                   ADD       ZVDFGP        $Q(V$3)
     C* Cuotas distribuidas F.G.P
     C*SUMAR ZCUFGP CDICO[2,L]
     C     99            ADD       L             V$3               4 0
     C                   ADD       ZCUFGP        $I(V$3)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución garantía pens.'
     C                   MOVEL     $HIL(079)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Distribuir intereses del FGPM                               ==
     C*==                                                              ==
     C*==================================================================
     C     M14155        BEGSR
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valor pagado Int.F.G.P
     C*MOVER ZVALOR A$INT[5,L]
     C     400           ADD       L             V$2               4 0
     C                   Z-ADD     $6(V$2)       ZVALOR
     C* Cuotas pagadas Int.F.G.P
     C*MOVER ZCUOTA ACUINT[5,L]
     C     400           ADD       L             V$2               4 0
     C                   Z-ADD     $E(V$2)       ZCUOTA
     C*SI ZCOTFG > 0 Y ZVALOR > 0
     C     ZCOTFG        IFGT      0
     C     ZVALOR        ANDGT     0
     C* Total Cotizaciones > Vl acum.
     C*SI ZTOFGP |= ZVAFGP
     C     ZTOFGP        IFNE      ZVAFGP
     C* Planilla tercero
     C*SI PLATIP = '07'
     C     PLATIP        IFEQ      '07'
     C* I.F.G.P.M
     C*MOVER ZVDIFG ZINIFG
     C                   Z-ADD     ZINIFG        ZVDIFG
     C*SINO
     C                   ELSE
     C*CALCULAR (R) ZVDIFG=(ZCOTFG*(ZVALOR-VDIINT[5,L]))/(ZTOFGP-ZVAFGP)
     C     400           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $V(V$2)       V$CA1           030 9
     C     ZCOTFG        MULT      V$CA1         V$CA1
     C     ZTOFGP        SUB       ZVAFGP        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDIFG
     C*FIN
     C                   END
     C* Si se distribuye en pesos
     C*SI ZVDIFG != *CERO
     C     ZVDIFG        IFNE      *ZERO
     C*CALCULAR (R) ZCUIFG=(ZVDIFG*(ZCUOTA-CDIINT[5,L]))/(ZVALOR-VDIINT[
     C     400           ADD       L             V$2               4 0
     C     ZCUOTA        SUB       $N(V$2)       V$CA1           030 9
     C     ZVDIFG        MULT      V$CA1         V$CA1
     C     400           ADD       L             V$2               4 0
     C     ZVALOR        SUB       $V(V$2)       V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUIFG
     C*SINO
     C                   ELSE
     C* Cuotas Intereses F.G.P.
     C*LIMPIAR ZCUIFG
     C                   CLEAR                   ZCUIFG
     C*FIN
     C                   END
     C* Valor distribuido Int.F.G.P
     C*SUMAR ZVDIFG VDIINT[5,L]
     C     400           ADD       L             V$3               4 0
     C                   ADD       ZVDIFG        $V(V$3)
     C* Cuotas distribuidas Int.F.G
     C*SUMAR ZCUIFG CDIINT[5,L]
     C     400           ADD       L             V$3               4 0
     C                   ADD       ZCUIFG        $N(V$3)
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución Int.Garantía'
     C                   MOVEL     $HIL(080)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular valor pagado en planilla de tercero                ==
     C*==                                                              ==
     C*==================================================================
     C     M14160        BEGSR
     C*
     C*LIMPIAR ZDIFVA ZDIFFS ZDISFS ZDIISF ZDIFGP ZDIIFG ZDIINT ZDIIVA Z
     C                   CLEAR                   ZDIFVA
     C                   CLEAR                   ZDIFFS
     C                   CLEAR                   ZDISFS
     C                   CLEAR                   ZDIISF
     C                   CLEAR                   ZDIFGP
     C                   CLEAR                   ZDIIFG
     C                   CLEAR                   ZDIINT
     C                   CLEAR                   ZDIIVA
     C                   CLEAR                   ZDIIVE
     C*LIMPIAR ZDIIAR ZDIREN ZDIFAR ZDIFCO ZDIFVE ZCDIFC ZDIFPA ZCUDIF
     C                   CLEAR                   ZDIIAR
     C                   CLEAR                   ZDIREN
     C                   CLEAR                   ZDIFAR
     C                   CLEAR                   ZDIFCO
     C                   CLEAR                   ZDIFVE
     C                   CLEAR                   ZCDIFC
     C                   CLEAR                   ZDIFPA
     C                   CLEAR                   ZCUDIF
     C*
     C* Es proceso por terceros
     C*SI ZINDTE = 'S' Y PLATIP = '07'
     C     ZINDTE        IFEQ      'S'
     C     PLATIP        ANDEQ     '07'
     C* Vlr calculado < vlr pagado
     C*SI ZCOTVA < ZVDCVA Y ZVDCVA <> 0
     C     ZCOTVA        IFLT      ZVDCVA
     C     ZVDCVA        ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIFVA = ZVDCVA - ZCOTVA
     C     ZVDCVA        SUB(H)    ZCOTVA        ZDIFVA
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIFVA * ZCUCVA) / ZVDCVA
     C     ZDIFVA        MULT      ZCUCVA        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCVA        ZCDIFC
     C* Vlr pagado por C.V.A.
     C*CALCULAR (R) ZVDCVA = ZVDCVA - ZDICVA
     C     ZVDCVA        SUB(H)    ZDICVA        ZVDCVA
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUCVA = ZCUCVA - ZCDIFC
     C     ZCUCVA        SUB(H)    ZCDIFC        ZCUCVA
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZCOTFS < ZVDFS Y ZVDFS <> 0
     C     ZCOTFS        IFLT      ZVDFS
     C     ZVDFS         ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIFFS = ZVDFS - ZCOTFS
     C     ZVDFS         SUB(H)    ZCOTFS        ZDIFFS
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIFFS * ZCUFS) / ZVDFS
     C     ZDIFFS        MULT      ZCUFS         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDFS         ZCDIFC
     C* Vlr pagado por F.S
     C*CALCULAR (R) ZVDFS = ZVDFS - ZDIFFS
     C     ZVDFS         SUB(H)    ZDIFFS        ZVDFS
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUFS = ZCUFS - ZCDIFC
     C     ZCUFS         SUB(H)    ZCDIFC        ZCUFS
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZCOTSF < ZVDSFS Y ZVDSFS <> 0
     C     ZCOTSF        IFLT      ZVDSFS
     C     ZVDSFS        ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDISFS = ZVDSFS - ZCOTFS
     C     ZVDSFS        SUB(H)    ZCOTFS        ZDISFS
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDISFS * ZCUSFS) / ZVDSFS
     C     ZDISFS        MULT      ZCUSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDSFS        ZCDIFC
     C* Vlr pagado por Subsistencia
     C*CALCULAR (R) ZVDSFS = ZVDSFS - ZDISFS
     C     ZVDSFS        SUB(H)    ZDISFS        ZVDSFS
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUSFS = ZCUSFS - ZCDIFC
     C     ZCUSFS        SUB(H)    ZCDIFC        ZCUSFS
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZINIFS < ZVDIFS Y ZVDIFS <> 0
     C     ZINIFS        IFLT      ZVDIFS
     C     ZVDIFS        ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIIFS = ZVDIFS - ZINIFS
     C     ZVDIFS        SUB(H)    ZINIFS        ZDIIFS
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIIFS * ZCUIFS) / ZVDIFS
     C     ZDIIFS        MULT      ZCUIFS        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDIFS        ZCDIFC
     C* Vlr pagado I.F.S
     C*CALCULAR (R) ZVDIFS = ZVDIFS - ZDIIFS
     C     ZVDIFS        SUB(H)    ZDIIFS        ZVDIFS
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUIFS = ZCUIFS - ZCDIFC
     C     ZCUIFS        SUB(H)    ZCDIFC        ZCUIFS
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZINISF < ZVDISF Y ZVDISF <> 0
     C     ZINISF        IFLT      ZVDISF
     C     ZVDISF        ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIISF = ZVDISF - ZINISF
     C     ZVDISF        SUB(H)    ZINISF        ZDIISF
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIISF * ZCUISF) / ZVDISF
     C     ZDIISF        MULT      ZCUISF        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDISF        ZCDIFC
     C* Vlr pagado por int. subsis
     C*CALCULAR (R) ZVDISF = ZVDISF - ZDIISF
     C     ZVDISF        SUB(H)    ZDIISF        ZVDISF
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUISF = ZCUISF - ZCDIFC
     C     ZCUISF        SUB(H)    ZCDIFC        ZCUISF
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZCOTFG < ZVDFGP Y ZVDFGP <> 0
     C     ZCOTFG        IFLT      ZVDFGP
     C     ZVDFGP        ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIFGP = ZVDFGP - ZCOTFG
     C     ZVDFGP        SUB(H)    ZCOTFG        ZDIFGP
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIFGP * ZCUFGP) / ZVDFGP
     C     ZDIFGP        MULT      ZCUFGP        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDFGP        ZCDIFC
     C* Vlr pagado por F.G.P.M
     C*CALCULAR (R) ZVDFGP = ZVDFGP - ZDIFGP
     C     ZVDFGP        SUB(H)    ZDIFGP        ZVDFGP
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUFGP = ZCUFGP - ZCDIFC
     C     ZCUFGP        SUB(H)    ZCDIFC        ZCUFGP
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZINIFG < ZVDIFG Y ZVDIFG <> 0
     C     ZINIFG        IFLT      ZVDIFG
     C     ZVDIFG        ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIIFG = ZVDIFG - ZINIFG
     C     ZVDIFG        SUB(H)    ZINIFG        ZDIIFG
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIIFG * ZCUIFG) / ZVDIFG
     C     ZDIIFG        MULT      ZCUIFG        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDIFG        ZCDIFC
     C* Vlr pagado por I.F.G.P.M
     C*CALCULAR (R) ZVDIFG = ZVDIFG - ZDIIFG
     C     ZVDIFG        SUB(H)    ZDIIFG        ZVDIFG
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUIFG = ZCUIFG - ZCDIFC
     C     ZCUIFG        SUB(H)    ZCDIFC        ZCUIFG
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZININT < ZVDINT Y ZVDINT <> 0
     C     ZININT        IFLT      ZVDINT
     C     ZVDINT        ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIINT = ZVDINT - ZININT
     C     ZVDINT        SUB(H)    ZININT        ZDIINT
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIINT * ZCUINT) / ZVDINT
     C     ZDIINT        MULT      ZCUINT        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDINT        ZCDIFC
     C* Vlr pagado por intereses
     C*CALCULAR (R) ZVDINT = ZVDINT - ZDIINT
     C     ZVDINT        SUB(H)    ZDIINT        ZVDINT
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUINT = ZCUINT - ZCDIFC
     C     ZCUINT        SUB(H)    ZCDIFC        ZCUINT
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZINCVA < ZVDIVA Y ZVDIVA <> 0
     C     ZINCVA        IFLT      ZVDIVA
     C     ZVDIVA        ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIIVA = ZVDIVA - ZINCVA
     C     ZVDIVA        SUB(H)    ZINCVA        ZDIIVA
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIIVA * ZCUIVA) / ZVDIVA
     C     ZDIIVA        MULT      ZCUIVA        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDIVA        ZCDIFC
     C* Vlr pagado por I.C.V.A
     C*CALCULAR (R) ZVDIVA = ZVDIVA - ZDIIVA
     C     ZVDIVA        SUB(H)    ZDIIVA        ZVDIVA
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUIVA = ZCUIVA - ZCDIFC
     C     ZCUIVA        SUB(H)    ZCDIFC        ZCUIVA
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZINCVE < ZVDIVE Y ZVDIVE <> 0
     C     ZINCVE        IFLT      ZVDIVE
     C     ZVDIVE        ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIIVE = ZVDIVE - ZINCVE
     C     ZVDIVE        SUB(H)    ZINCVE        ZDIIVE
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIIVE * ZCUIVE) / ZVDIVE
     C     ZDIIVE        MULT      ZCUIVE        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDIVE        ZCDIFC
     C* Vlr pagado por I.C.V.E
     C*CALCULAR (R) ZVDIVE = ZVDIVE - ZDIIVE
     C     ZVDIVE        SUB(H)    ZDIIVE        ZVDIVE
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUIVE = ZCUIVE - ZCDIFC
     C     ZCUIVE        SUB(H)    ZCDIFC        ZCUIVE
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZINNAR < ZVDIAR Y ZVDIAR <> 0
     C     ZINNAR        IFLT      ZVDIAR
     C     ZVDIAR        ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIIAR = ZVDIAR - ZINNAR
     C     ZVDIAR        SUB(H)    ZINNAR        ZDIIAR
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIIAR * ZCUIAR) / ZVDIAR
     C     ZDIIAR        MULT      ZCUIAR        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDIAR        ZCDIFC
     C* Vlr pagado por int. A.R
     C*CALCULAR (R) ZVDIAR = ZVDIAR - ZDIIAR
     C     ZVDIAR        SUB(H)    ZDIIAR        ZVDIAR
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUIAR = ZCUIAR - ZCDIFC
     C     ZCUIAR        SUB(H)    ZCDIFC        ZCUIAR
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZRENDI < ZVDREN Y ZVDREN <> 0
     C     ZRENDI        IFLT      ZVDREN
     C     ZVDREN        ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIREN = ZVDREN - ZRENDI
     C     ZVDREN        SUB(H)    ZRENDI        ZDIREN
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIREN * ZCUREN) / ZVDREN
     C     ZDIREN        MULT      ZCUREN        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDREN        ZCDIFC
     C* Vlr pagado por rdmientos
     C*CALCULAR (R) ZVDREN = ZVDREN - ZDIREN
     C     ZVDREN        SUB(H)    ZDIREN        ZVDREN
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUREN = ZCUREN - ZCDIFC
     C     ZCUREN        SUB(H)    ZCDIFC        ZCUREN
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZCOTAR < ZVDAR Y ZVDAR <> 0
     C     ZCOTAR        IFLT      ZVDAR
     C     ZVDAR         ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIFAR = ZVDAR - ZCOTAR
     C     ZVDAR         SUB(H)    ZCOTAR        ZDIFAR
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIFAR * ZCUAR) / ZVDAR
     C     ZDIFAR        MULT      ZCUAR         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDAR         ZCDIFC
     C* Vlr pagado por alto riesgo
     C*CALCULAR (R) ZVDAR  = ZVDAR - ZDIFAR
     C     ZVDAR         SUB(H)    ZDIFAR        ZVDAR
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUAR  = ZCUAR - ZCDIFC
     C     ZCUAR         SUB(H)    ZCDIFC        ZCUAR
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZCOTOB < ZVDCO Y ZVDCO <> 0
     C     ZCOTOB        IFLT      ZVDCO
     C     ZVDCO         ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIFCO = ZVDCO - ZCOTOB
     C     ZVDCO         SUB(H)    ZCOTOB        ZDIFCO
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIFCO * ZCUCO) / ZVDCO
     C     ZDIFCO        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZCDIFC
     C* Vlr pagado por C.O
     C*CALCULAR (R) ZVDCO  = ZVDCO - ZDIFCO
     C     ZVDCO         SUB(H)    ZDIFCO        ZVDCO
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUCO  = ZCUCO - ZCDIFC
     C     ZCUCO         SUB(H)    ZCDIFC        ZCUCO
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Vlr calculado < vlr pagado
     C*SI ZCOTVE < ZVDCVE Y ZVDCVE <> 0
     C     ZCOTVE        IFLT      ZVDCVE
     C     ZVDCVE        ANDNE     0
     C* P.E x cotización
     C*CALCULAR (R) ZDIFVE = ZVDCVE - ZCOTVE
     C     ZVDCVE        SUB(H)    ZCOTVE        ZDIFVE
     C* Cuotas diferenc
     C*CALCULAR (R) ZCDIFC = (ZDIFVE * ZCUCVE) / ZVDCVE
     C     ZDIFVE        MULT      ZCUCVE        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCVE        ZCDIFC
     C* Vlr pagado por C.V.E
     C*CALCULAR (R) ZVDCVE = ZVDCVE - ZDIFVE
     C     ZVDCVE        SUB(H)    ZDIFVE        ZVDCVE
     C* Cuotas pagadas
     C*CALCULAR (R) ZCUCVE = ZCUCVE - ZCDIFC
     C     ZCUCVE        SUB(H)    ZCDIFC        ZCUCVE
     C* Cuotas diferencia
     C*SUMAR ZCDIFC ZCUDIF
     C                   ADD       ZCDIFC        ZCUDIF
     C*LIMPIAR ZCDIFC
     C                   CLEAR                   ZCDIFC
     C*FIN
     C                   END
     C*
     C* Total interes
     C*CALCULAR ZVDINT = ZVDINT + ZVDIVA + ZVDIVE + ZVDIAR
     C     ZVDINT        ADD       ZVDIVA        V$CA1           030 9
     C     V$CA1         ADD       ZVDIVE        V$CA1
     C     V$CA1         ADD       ZVDIAR        ZVDINT
     C* Cuotas int.
     C*CALCULAR ZCUINT = ZCUINT + ZCUIVA + ZCUIVE + ZCUIAR
     C     ZCUINT        ADD       ZCUIVA        V$CA1           030 9
     C     V$CA1         ADD       ZCUIVE        V$CA1
     C     V$CA1         ADD       ZCUIAR        ZCUINT
     C*
     C*CALCULAR (R) ZDIFPA = ZDIFVA+ZDIFFS+ZDISFS+ZDIISF+ZDIFGP+ZDIIFG+Z
     C     ZDIFVA        ADD       ZDIFFS        V$CA1           030 9
     C     V$CA1         ADD       ZDISFS        V$CA1
     C     V$CA1         ADD       ZDIISF        V$CA1
     C     V$CA1         ADD       ZDIFGP        V$CA1
     C     V$CA1         ADD       ZDIIFG        V$CA1
     C     V$CA1         ADD       ZDIINT        V$CA1
     C     V$CA1         ADD       ZDIIVA        V$CA1
     C     V$CA1         ADD       ZDIIVE        V$CA1
     C     V$CA1         ADD       ZDIIAR        V$CA1
     C     V$CA1         ADD       ZDIREN        V$CA1
     C     V$CA1         ADD       ZDIFAR        V$CA1
     C     V$CA1         ADD       ZDIFCO        V$CA1
     C     V$CA1         ADD(H)    ZDIFVE        ZDIFPA
     C* El valor de las diferencias pagadas en las cotizaciones se suma
     C* valor del depósito disponible para el pago
     C* Valor depósito
     C*SUMAR ZDIFPA ZVRDEP
     C                   ADD       ZDIFPA        ZVRDEP
     C* Cuotas depósito
     C*SUMAR ZCUDIF ZCUDEP
     C                   ADD       ZCUDIF        ZCUDEP
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Distribución rezagos                                        ==
     C*==                                                              ==
     C*==================================================================
     C     M14170        BEGSR
     C*CALCULAR ZVALOR = ZVDFS+ZVDIFS+ZVDINT+ZVDCVA+ZVDREN+ZVDAR+ZVDCO+Z
     C     ZVDFS         ADD       ZVDIFS        V$CA1           030 9
     C     V$CA1         ADD       ZVDINT        V$CA1
     C     V$CA1         ADD       ZVDCVA        V$CA1
     C     V$CA1         ADD       ZVDREN        V$CA1
     C     V$CA1         ADD       ZVDAR         V$CA1
     C     V$CA1         ADD       ZVDCO         V$CA1
     C     V$CA1         ADD       ZVDCVE        V$CA1
     C     V$CA1         ADD       ZVDSFS        V$CA1
     C     V$CA1         ADD       ZVDISF        V$CA1
     C     V$CA1         ADD       ZVDFGP        V$CA1
     C     V$CA1         ADD       ZVDIFG        ZVALOR
     C*CALCULAR ZCUOTA = ZCUFS+ZCUIFS+ZCUINT+ZCUCVA+ZCUREN+ZCUAR+ZCUCO+Z
     C     ZCUFS         ADD       ZCUIFS        V$CA1           030 9
     C     V$CA1         ADD       ZCUINT        V$CA1
     C     V$CA1         ADD       ZCUCVA        V$CA1
     C     V$CA1         ADD       ZCUREN        V$CA1
     C     V$CA1         ADD       ZCUAR         V$CA1
     C     V$CA1         ADD       ZCUCO         V$CA1
     C     V$CA1         ADD       ZCUCVE        V$CA1
     C     V$CA1         ADD       ZCUSFS        V$CA1
     C     V$CA1         ADD       ZCUISF        V$CA1
     C     V$CA1         ADD       ZCUFGP        V$CA1
     C     V$CA1         ADD       ZCUIFG        ZCUOTA
     C* Existe en FSPARC
     C*SI ZEXFSP = 'S' Y ZINSUM <> '1'
     C     ZEXFSP        IFEQ      'S'
     C     ZINSUM        ANDNE     '1'
     C*CALCULAR ZVALOR = ZVALOR + ZZAFSP + ZVZFSP + ZVIFSP + ZVISUB
     C     ZVALOR        ADD       ZZAFSP        V$CA1           030 9
     C     V$CA1         ADD       ZVZFSP        V$CA1
     C     V$CA1         ADD       ZVIFSP        V$CA1
     C     V$CA1         ADD       ZVISUB        ZVALOR
     C*CALCULAR ZCUOTA = ZCUOTA + ZZUFSP + ZCSFSP + ZCIFSP + ZCISUB
     C     ZCUOTA        ADD       ZZUFSP        V$CA1           030 9
     C     V$CA1         ADD       ZCSFSP        V$CA1
     C     V$CA1         ADD       ZCIFSP        V$CA1
     C     V$CA1         ADD       ZCISUB        ZCUOTA
     C*CALCULAR ZFS = ZZAFSP + ZVZFSP
     C     ZZAFSP        ADD       ZVZFSP        ZFS
     C*SI DETCTA < ZFS Y ZVDFS > *CERO O DETCTA < ZFS Y ZVDSFS > *CERO
     C     DETCTA        IFLT      ZFS
     C     ZVDFS         ANDGT     *ZERO
     C     DETCTA        ORLT      ZFS
     C     ZVDSFS        ANDGT     *ZERO
     C*CALCULAR ZCUOPR = ZVALOR / ZCUOTA
     C     ZVALOR        DIV       ZCUOTA        ZCUOPR
     C*CALCULAR ZDIF = ZFS - DETCTA
     C     ZFS           SUB       DETCTA        ZDIF
     C*CALCULAR ZCUODI = ZDIF / ZCUOPR
     C     ZDIF          DIV       ZCUOPR        ZCUODI
     C*CALCULAR ZVALOR = ZVALOR - ZDIF
     C     ZVALOR        SUB       ZDIF          ZVALOR
     C*CALCULAR ZCUOTA = ZCUOTA - ZCUODI
     C     ZCUOTA        SUB       ZCUODI        ZCUOTA
     C*FIN
     C                   END
     C*SI PLANU8=*CERO O ZINAPA = '1'
     C     PLANU8        IFEQ      *ZERO
     C     ZINAPA        OREQ      '1'
     C*PASAR ZINSUM '1'
     C                   MOVEL     '1'           ZINSUM
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Valor total rezago
     C*SUMAR ZVALOR ZVRREZ
     C                   ADD       ZVALOR        ZVRREZ
     C* Cuotas rezago
     C*SUMAR ZCUOTA ZCUREZ
     C                   ADD       ZCUOTA        ZCUREZ
     C* Intereses rezagos
     C*CALCULAR ZINTRE = ZINTRE+ZVDINT+ZVDIFG
     C     ZINTRE        ADD       ZVDINT        V$CA1           030 9
     C     V$CA1         ADD       ZVDIFG        ZINTRE
     C* Intereses fondo de solidarid.
     C*CALCULAR ZIFSRE = ZIFSRE+ZVDIFS+ZVDISF
     C     ZIFSRE        ADD       ZVDIFS        V$CA1           030 9
     C     V$CA1         ADD       ZVDISF        ZIFSRE
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*CALCULAR ZIFSRE = ZIFSRE+ZVIFSP+ZVISUB
     C     ZIFSRE        ADD       ZVIFSP        V$CA1           030 9
     C     V$CA1         ADD       ZVISUB        ZIFSRE
     C*FIN
     C                   END
     C* Distribuyó valor
     C*SI ZVALOR |= *CERO
     C     ZVALOR        IFNE      *ZERO
     C* Concilió + de 1 dep. o P.A.
     C*SI PLANU8=*CERO O ZINAPA = '1'
     C     PLANU8        IFEQ      *ZERO
     C     ZINAPA        OREQ      '1'
     C* Planilla
     C*MOVER DISNRO PLANU1
     C                   Z-ADD     PLANU1        DISNRO
     C* Página
     C*MOVER DISNR1 DETPAG
     C                   Z-ADD     DETPAG        DISNR1
     C* Secuencia
     C*MOVER DISNR2 DETSEC
     C                   Z-ADD     DETSEC        DISNR2
     C* Tipo de registro
     C*PASAR DISTIP '1'
     C                   MOVEL     '1'           DISTIP
     C* Consecutivo de distribución
     C*MOVER DISCON L
     C                   Z-ADD     L             DISCON
     C* Fecha depósito
     C*MOVER DISFEC AFECDE[L]
     C                   MOVE      $G(L)         DISFEC
     C* Cuotas distribuidas
     C*MOVER DISCUO ZCUOTA
     C                   Z-ADD     ZCUOTA        DISCUO
     C* Valor distribuido
     C*MOVER DISVAL ZVALOR
     C                   Z-ADD     ZVALOR        DISVAL
     C*AGREGAR DISAR1
     C                   WRITE     DISRE1                               94
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Acumula valores reporte
     C*EJECUTAR M14173
     C                   EXSR      M14173
     C                   ENDSR
     C*==================================================================
     C*==  Acumula valores para el reporte de totales                  ==
     C*==                                                              ==
     C*==================================================================
     C     M14173        BEGSR
     C* Valor c.o. rezagos
     C*CALCULAR ZVACOR = ZVACOR+ZVDCO+ZVDFGP
     C     ZVACOR        ADD       ZVDCO         V$CA1           030 9
     C     V$CA1         ADD       ZVDFGP        ZVACOR
     C* Valor alto riesgo rezagos
     C*SUMAR ZVDAR  ZVAARR
     C                   ADD       ZVDAR         ZVAARR
     C* Valor c.v.a. rezagos
     C*SUMAR ZVDCVA ZVAVAR
     C                   ADD       ZVDCVA        ZVAVAR
     C* Valor c.v.e. rezagos
     C*SUMAR ZVDCVE ZVAVER
     C                   ADD       ZVDCVE        ZVAVER
     C* Valor rendimientos rezagos
     C*SUMAR ZVDREN ZVARER
     C                   ADD       ZVDREN        ZVARER
     C* Valor intereses rezagos
     C*CALCULAR ZVAINR = ZVAINR+ZVDINT+ZVDIFG
     C     ZVAINR        ADD       ZVDINT        V$CA1           030 9
     C     V$CA1         ADD       ZVDIFG        ZVAINR
     C* Valor fondo de solid. Rezagos
     C*CALCULAR ZVAFSR = ZVAFSR+ZVDFS+ZVDSFS
     C     ZVAFSR        ADD       ZVDFS         V$CA1           030 9
     C     V$CA1         ADD       ZVDSFS        ZVAFSR
     C* Intereses F.S. rezagos
     C*CALCULAR ZVAISR = ZVAISR+ZVDIFS+ZVDISF
     C     ZVAISR        ADD       ZVDIFS        V$CA1           030 9
     C     V$CA1         ADD       ZVDISF        ZVAISR
     C* Cuotas C.O. rezagos
     C*CALCULAR ZCUCOR = ZCUCOR+ZCUCO+ZCUFGP
     C     ZCUCOR        ADD       ZCUCO         V$CA1           030 9
     C     V$CA1         ADD       ZCUFGP        ZCUCOR
     C* Cuotas alto riesgo rezagos
     C*SUMAR ZCUAR  ZCUARR
     C                   ADD       ZCUAR         ZCUARR
     C* Cuotas c.v.a. rezagos
     C*SUMAR ZCUCVA ZCUVAR
     C                   ADD       ZCUCVA        ZCUVAR
     C* Cuotas c.v.e. rezagos
     C*SUMAR ZCUCVE ZCUVER
     C                   ADD       ZCUCVE        ZCUVER
     C* Cuotas rendimientos rezagos
     C*SUMAR ZCUREN ZCURER
     C                   ADD       ZCUREN        ZCURER
     C* Cuotas interese rezagos
     C*CALCULAR ZCUINR = ZCUINR+ZCUINT+ZCUIFG
     C     ZCUINR        ADD       ZCUINT        V$CA1           030 9
     C     V$CA1         ADD       ZCUIFG        ZCUINR
     C* Cuotas fondo de soli. rezagos
     C*CALCULAR ZCUFSR = ZCUFSR+ZCUFS+ZCUSFS
     C     ZCUFSR        ADD       ZCUFS         V$CA1           030 9
     C     V$CA1         ADD       ZCUSFS        ZCUFSR
     C* Cuotas int. F.S.P rezagos
     C*CALCULAR ZCUISR = ZCUISR+ZCUIFS+ZCUISF
     C     ZCUISR        ADD       ZCUIFS        V$CA1           030 9
     C     V$CA1         ADD       ZCUISF        ZCUISR
     C* Existe en FSPARC
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C* Valor fondo de solid. Rezagos
     C*CALCULAR ZVAFSR = ZVAFSR+ZZAFSP+ZVZFSP
     C     ZVAFSR        ADD       ZZAFSP        V$CA1           030 9
     C     V$CA1         ADD       ZVZFSP        ZVAFSR
     C* Intereses F.S. rezagos
     C*CALCULAR ZVAISR = ZVAISR+ZVIFSP+ZVISUB
     C     ZVAISR        ADD       ZVIFSP        V$CA1           030 9
     C     V$CA1         ADD       ZVISUB        ZVAISR
     C* Cuotas fondo de soli. rezagos
     C*CALCULAR ZCUFSR = ZCUFSR+ZZUFSP+ZCSFSP
     C     ZCUFSR        ADD       ZZUFSP        V$CA1           030 9
     C     V$CA1         ADD       ZCSFSP        ZCUFSR
     C* Cuotas int. F.S.P rezagos
     C*CALCULAR ZCUISR = ZCUISR+ZCIFSP+ZCISUB
     C     ZCUISR        ADD       ZCIFSP        V$CA1           030 9
     C     V$CA1         ADD       ZCISUB        ZCUISR
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Generar movimiento                                          ==
     C*==                                                              ==
     C*==================================================================
     C     M14300        BEGSR
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Mover datos movimiento acred.
     C*EJECUTAR M14395
     C                   EXSR      M14395
     C*SI PLATIP |= '05'
     C     PLATIP        IFNE      '05'
     C* Calcular comisiones y prima
     C*EJECUTAR M14370
     C                   EXSR      M14370
     C*FIN
     C                   END
     C* Evalua si genera registro mvto
     C*EJECUTAR M14302
     C                   EXSR      M14302
     C* Valor retención contingente
     C*LIMPIAR ZVRECO
     C                   CLEAR                   ZVRECO
     C* Genera mvto si hay valores enMOVARC
     C*SI ZGENMV = '1'
     C     ZGENMV        IFEQ      '1'
     C* Actualiza transa,concepto
     C*EJECUTAR M14303
     C                   EXSR      M14303
     C* Si es el primer reg. de movarc
     C*SI ZGRAMV ]= '1'
     C     ZGRAMV        IFNE      '1'
     C* Salario calculado retroactivo
     C*MOVER MOVSA2 DETSAL
     C                   Z-ADD     DETSAL        MOVSA2
     C*SI PLAT03<>'09' Y PLAT03<>'10' Y PLAT03<>'11' Y PLAT03<>'12' O PL
     C     PLAT03        IFNE      '09'
     C     PLAT03        ANDNE     '10'
     C     PLAT03        ANDNE     '11'
     C     PLAT03        ANDNE     '12'
     C     PLAT03        OREQ      '09'
     C     ZMARCA        ANDEQ     'S'
     C     PLAT03        OREQ      '10'
     C     ZMARCA        ANDEQ     'S'
     C     PLAT03        OREQ      '11'
     C     ZMARCA        ANDEQ     'S'
     C* Días trabajados
     C*MOVER MOVNUM ZDITRA
     C                   Z-ADD     ZDITRA        MOVNUM
     C* Salario calculado
     C*MOVER MOVSA2 DETVA7
     C                   Z-ADD     DETVA7        MOVSA2
     C*FIN
     C                   END
     C* Salario informado
     C*MOVER MOVSAL DETSAL
     C                   Z-ADD     DETSAL        MOVSAL
     C* Primer consecutivo
     C*MOVER ZCONMI MOVCON
     C                   Z-ADD     MOVCON        ZCONMI
     C* Prende indicador de gener. mvto
     C*PASAR ZGRAMV '1'
     C                   MOVEL     '1'           ZGRAMV
     C*FIN
     C                   END
     C* No se calcula retención contingente si es rezago de planilla 05
     C*SI ZT@002='3' Y PLATIP='05'
     C     ZT@002        IFEQ      '3'
     C     PLATIP        ANDEQ     '05'
     C*SINO
     C                   ELSE
     C* Calcular retención conting
     C*EJECUTAR M14330
     C                   EXSR      M14330
     C*FIN
     C                   END
     C* Agregar registro a movarc
     C*EJECUTAR M00009
     C                   EXSR      M00009
     C* Planilla de traspasos
     C*SI PLATIP |= '05'
     C     PLATIP        IFNE      '05'
     C* Si el valor de C.V.A o C.V.E es mayor a 0
     C*SI MOVCO5 |= 0 O MOVCU3 |= 0 O MOVCO6 |= 0 O MOVCU4 |= 0
     C     MOVCO5        IFNE      0
     C     MOVCU3        ORNE      0
     C     MOVCO6        ORNE      0
     C     MOVCU4        ORNE      0
     C* Indicador de acreditación
     C*PASAR ZINACR '1'
     C                   MOVEL     '1'           ZINACR
     C* Crear registro de aporte vol
     C*EJECUTAR M09000
     C                   EXSR      M09000
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Si el valor de C.V.A o C.V.E es mayor a 0
     C*SI MOVCO5 |= 0 O MOVCU3 |= 0 O MOVCO6 |= 0 O MOVCU4 |= 0
     C     MOVCO5        IFNE      0
     C     MOVCU3        ORNE      0
     C     MOVCO6        ORNE      0
     C     MOVCU4        ORNE      0
     C* Limpia var. de trabajo
     C*LIMPIAR ZALFA8 ZALFA5 ZINERE
     C                   CLEAR                   ZALFA8
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUM12 ZNUME9 ZNUMI9
     C                   CLEAR                   ZNUM12
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUMR9 ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* ARCA11
     C*PASAR ZENTID '7'
     C                   MOVEL     '7'           ZENTID
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZFITIP
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZFITIP
     C* Planilla
     C*MOVER ZNUM12 PLANUM
     C                   Z-ADD     PLANUM        ZNUM12
     C* Página
     C*MOVER ZNUME3 DETPAG
     C                   Z-ADD     DETPAG        ZNUME3
     C* Secuencia
     C*MOVER ZNUMI3 DETSEC
     C                   Z-ADD     DETSEC        ZNUMI3
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C* Actualizar detalle a.v trs
     C*EJECUTAR M51110
     C                   EXSR      M51110
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Imprime reporte detallado
     C*EJECUTAR DET@01
     C                   EXSR      DET@01
     C* Acumular valores por concepto
     C*EJECUTAR M14380
     C                   EXSR      M14380
     C* Actualizar cuenta afiliado
     C*EJECUTAR M14385
     C                   EXSR      M14385
     C*CALCULAR COMVA8 = COMVA8 + MOVCOT + MOVCOM + MOVVAL + MOVC24 + MO
     C     COMVA8        ADD       MOVCOT        V$CA1           030 9
     C     V$CA1         ADD       MOVCOM        V$CA1
     C     V$CA1         ADD       MOVVAL        V$CA1
     C     V$CA1         ADD       MOVC24        V$CA1
     C     V$CA1         ADD       MOVCO5        V$CA1
     C     V$CA1         ADD       MOVCO7        V$CA1
     C     V$CA1         ADD       MOVCO6        V$CA1
     C     V$CA1         ADD       MOVC27        V$CA1
     C     V$CA1         ADD       MOVINT        V$CA1
     C     V$CA1         ADD       MOVVA4        V$CA1
     C     V$CA1         ADD       MOVCO8        V$CA1
     C     V$CA1         ADD       MOVIN2        COMVA8
     C* Calcular total distrib. det.
     C*EJECUTAR M14400
     C                   EXSR      M14400
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Evalua si genera registro de movimiento                     ==
     C*==                                                              ==
     C*==================================================================
     C     M14302        BEGSR
     C*PASAR ZGENMV '0'
     C                   MOVEL     '0'           ZGENMV
     C*SI MOVCOT ]= *CERO O MOVC24 ]= *CERO O MOVCO5 ]= *CERO O MOVCO6 ]
     C     MOVCOT        IFNE      *ZERO
     C     MOVC24        ORNE      *ZERO
     C     MOVCO5        ORNE      *ZERO
     C     MOVCO6        ORNE      *ZERO
     C     MOVINT        ORNE      *ZERO
     C     MOVVA4        ORNE      *ZERO
     C     MOVCO8        ORNE      *ZERO
     C*PASAR ZGENMV '1'
     C                   MOVEL     '1'           ZGENMV
     C*FIN
     C                   END
     C*SI MOVIN2 ]= *CERO O MOVCUO ]= *CERO O MOVC25 ]= *CERO O MOVCU3 ]
     C     MOVIN2        IFNE      *ZERO
     C     MOVCUO        ORNE      *ZERO
     C     MOVC25        ORNE      *ZERO
     C     MOVCU3        ORNE      *ZERO
     C     MOVCU4        ORNE      *ZERO
     C     MOVCU6        ORNE      *ZERO
     C     MOVC19        ORNE      *ZERO
     C*PASAR ZGENMV '1'
     C                   MOVEL     '1'           ZGENMV
     C*FIN
     C                   END
     C*SI MOVCU8 ]= *CERO O MOVC16 ]= *CERO O MOVCOM ]= *CERO O MOVVAL ]
     C     MOVCU8        IFNE      *ZERO
     C     MOVC16        ORNE      *ZERO
     C     MOVCOM        ORNE      *ZERO
     C     MOVVAL        ORNE      *ZERO
     C     MOVCO7        ORNE      *ZERO
     C     MOVC27        ORNE      *ZERO
     C     MOVCU2        ORNE      *ZERO
     C*PASAR ZGENMV '1'
     C                   MOVEL     '1'           ZGENMV
     C*FIN
     C                   END
     C*SI MOVCU7 ]= *CERO O MOVCU5 ]= *CERO O MOVC28 ]= *CERO
     C     MOVCU7        IFNE      *ZERO
     C     MOVCU5        ORNE      *ZERO
     C     MOVC28        ORNE      *ZERO
     C*PASAR ZGENMV '1'
     C                   MOVEL     '1'           ZGENMV
     C*FIN
     C                   END
     C*SI MOVV12 ]= *CERO O MOV056 ]= *CERO O MOVI05 ]= *CERO O MOV057 <
     C     MOVV12        IFNE      *ZERO
     C     MOV056        ORNE      *ZERO
     C     MOVI05        ORNE      *ZERO
     C     MOV057        ORNE      *ZERO
     C*PASAR ZGENMV '1'
     C                   MOVEL     '1'           ZGENMV
     C*FIN
     C                   END
     C*SI MOVV13 ]= *CERO O MOV058 ]= *CERO O MOVI06 ]= *CERO O MOV059 <
     C     MOVV13        IFNE      *ZERO
     C     MOV058        ORNE      *ZERO
     C     MOVI06        ORNE      *ZERO
     C     MOV059        ORNE      *ZERO
     C*PASAR ZGENMV '1'
     C                   MOVEL     '1'           ZGENMV
     C*FIN
     C                   END
     C* No genera movimiento
     C*SI ZGENMV <> '1'
     C     ZGENMV        IFNE      '1'
     C* Acreditación de rezagos
     C*SI ZT@002='3'
     C     ZT@002        IFEQ      '3'
     C* Actualiza variables para calculo de PE
     C*CALCULAR ZVLRRZ = REZCOT+REZCO1+REZCO2+REZCO4+REZVA1+REZINT+REZIN
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZVA1        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     V$CA1         ADD       REZIN9        V$CA1
     C     V$CA1         SUB       REZDEU        V$CA1
     C     V$CA1         ADD       REZVA3        ZVLRRZ
     C*CALCULAR ZCUORZ = REZCUO+REZCU2
     C     REZCUO        ADD       REZCU2        ZCUORZ
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*CALCULAR ZVLRRZ = ZVLRRZ - (ZZAFSP+ZVZFSP+ZVIFSP+ZVISUB)
     C     ZZAFSP        ADD       ZVZFSP        V$CA1           030 9
     C     V$CA1         ADD       ZVIFSP        V$CA1
     C     V$CA1         ADD       ZVISUB        V$CA1
     C     ZVLRRZ        SUB       V$CA1         ZVLRRZ
     C*CALCULAR ZCUORZ = ZCUORZ - (ZZUFSP+ZCSFSP+ZCIFSP+ZCISUB)
     C     ZZUFSP        ADD       ZCSFSP        V$CA1           030 9
     C     V$CA1         ADD       ZCIFSP        V$CA1
     C     V$CA1         ADD       ZCISUB        V$CA1
     C     ZCUORZ        SUB       V$CA1         ZCUORZ
     C*FIN
     C                   END
     C* Si se acredita más de un rezago
     C*SI ZCAREZ > 1
     C     ZCAREZ        IFGT      1
     C* Acumulado valor rezagos
     C*SUMAR ZVLRRZ ZVLRRA
     C                   ADD       ZVLRRZ        ZVLRRA
     C* Acumulado cuotas rezagos
     C*SUMAR ZCUORZ ZCUORA
     C                   ADD       ZCUORZ        ZCUORA
     C*FIN
     C                   END
     C*CALCULAR ZVLRMV=(MOVCOT+MOVCOM+MOVVAL+MOVC24+MOVCO5+MOVCO6+MOVINT
     C     MOVCOT        ADD       MOVCOM        V$CA1           030 9
     C     V$CA1         ADD       MOVVAL        V$CA1
     C     V$CA1         ADD       MOVC24        V$CA1
     C     V$CA1         ADD       MOVCO5        V$CA1
     C     V$CA1         ADD       MOVCO6        V$CA1
     C     V$CA1         ADD       MOVINT        V$CA1
     C     V$CA1         ADD       MOVVA4        V$CA1
     C     V$CA1         ADD       MOVCO8        V$CA1
     C     V$CA1         ADD       MOVIN2        V$CA1
     C     V$CA1         ADD       MOVV12        V$CA1
     C     V$CA1         ADD       MOVI05        V$CA1
     C     V$CA1         ADD       MOVV13        V$CA1
     C     V$CA1         ADD       MOVI06        V$CA1
     C                   Z-ADD     V$CA1         ZVLRMV
     C*CALCULAR ZCUOMV=(MOVCUO+MOVCU2+MOVCU7+MOVC25+MOVCU3+MOVCU4+MOVCU6
     C     MOVCUO        ADD       MOVCU2        V$CA1           030 9
     C     V$CA1         ADD       MOVCU7        V$CA1
     C     V$CA1         ADD       MOVC25        V$CA1
     C     V$CA1         ADD       MOVCU3        V$CA1
     C     V$CA1         ADD       MOVCU4        V$CA1
     C     V$CA1         ADD       MOVCU6        V$CA1
     C     V$CA1         ADD       MOVC19        V$CA1
     C     V$CA1         ADD       MOVCU8        V$CA1
     C     V$CA1         ADD       MOVC16        V$CA1
     C     V$CA1         ADD       MOV056        V$CA1
     C     V$CA1         ADD       MOV057        V$CA1
     C     V$CA1         ADD       MOV058        V$CA1
     C     V$CA1         ADD       MOV059        V$CA1
     C                   Z-ADD     V$CA1         ZCUOMV
     C* Si se acredita más de un rezago
     C*SI ZCAREZ > 1 O K > 2
     C     ZCAREZ        IFGT      1
     C     K             ORGT      2
     C* Valor movimiento acumulado
     C*SUMAR ZVLRMV ZVLRMA
     C                   ADD       ZVLRMV        ZVLRMA
     C* Cuotas acumuladas movimientos
     C*SUMAR ZCUOMV ZCUOMA
     C                   ADD       ZCUOMV        ZCUOMA
     C*SINO
     C                   ELSE
     C* Valor movimiento acumulado
     C*MOVER ZVLRMA ZVLRMV
     C                   Z-ADD     ZVLRMV        ZVLRMA
     C* Cuotas acumuladas movimientos
     C*MOVER ZCUOMA ZCUOMV
     C                   Z-ADD     ZCUOMV        ZCUOMA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza el código de transacción y concepto en movimient  ==
     C*==                                                              ==
     C*==================================================================
     C     M14303        BEGSR
     C* Acreditación por recaudo
     C*SI ZT@002 = '1'
     C     ZT@002        IFEQ      '1'
     C* Ind. vigencia Siafp
     C*PASAR MOVI11 '1'
     C                   MOVEL     '1'           MOVI11
     C* Transacción
     C*PASAR MOVCO1 '02'
     C                   MOVEL     '02'          MOVCO1
     C* Sector salud
     C*SI PLATIP = '04'
     C     PLATIP        IFEQ      '04'
     C* Situado
     C*SI PLAT03 = '04' O PLAT03 = '11'
     C     PLAT03        IFEQ      '04'
     C     PLAT03        OREQ      '11'
     C* Concepto
     C*PASAR MOVTIP '71'
     C                   MOVEL     '71'          MOVTIP
     C*SINO
     C                   ELSE
     C* Concepto
     C*PASAR MOVTIP '91'
     C                   MOVEL     '91'          MOVTIP
     C*FIN
     C                   END
     C* No es sector salud
     C*SINO
     C                   ELSE
     C* Concepto
     C*MOVER MOVTIP '31'
     C                   MOVE      '31'          MOVTIP
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Acreditación de rezagos
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C* Transacción
     C*MOVER MOVCO1 '02'
     C                   MOVE      '02'          MOVCO1
     C* Sector salud
     C*CASO PLATIP = '04'
     C                   SELECT
     C     PLATIP        WHENEQ    '04'
     C* Situado
     C*SI PLAT03 = '04' O PLAT03 = '11'
     C     PLAT03        IFEQ      '04'
     C     PLAT03        OREQ      '11'
     C* Ind. vigencia Siafp
     C*PASAR MOVI11 '1'
     C                   MOVEL     '1'           MOVI11
     C* Concepto
     C*PASAR MOVTIP '72'
     C                   MOVEL     '72'          MOVTIP
     C*SINO
     C                   ELSE
     C* Ind. vigencia Siafp
     C*PASAR MOVI11 '1'
     C                   MOVEL     '1'           MOVI11
     C* Concepto
     C*PASAR MOVTIP '92'
     C                   MOVEL     '92'          MOVTIP
     C*FIN
     C                   END
     C* Sector salud
     C*CASO PLATIP = '05'
     C     PLATIP        WHENEQ    '05'
     C* Concepto
     C*PASAR MOVTIP '44'
     C                   MOVEL     '44'          MOVTIP
     C* No es sector salud
     C*SINO
     C                   OTHER
     C* Ind. vigencia Siafp
     C*PASAR MOVI11 '1'
     C                   MOVEL     '1'           MOVI11
     C* Concepto
     C*MOVER MOVTIP '32'
     C                   MOVE      '32'          MOVTIP
     C*FINCASOS
     C                   ENDSL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Tipo transaccion
     C*PASAR ZOVTIP MOVTIP
     C                   MOVEL     MOVTIP        ZOVTIP
     C* tipo concepto
     C*PASAR ZOVCO1 MOVCO1
     C                   MOVEL     MOVCO1        ZOVCO1
     C* periodo
     C*PASAR ZOVPER MOVPER
     C                   MOVEL     MOVPER        ZOVPER
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar detalle de deuda                                   ==
     C*==                                                              ==
     C*==================================================================
     C     M14308        BEGSR
     C*INICIARUI MOVARC06 (ZFONDO DETNU9 DETPA2 DETSE4)
     C     LL$107        KLIST
     C                   KFLD                    ZFONDO
     C                   KFLD                    DETNU9
     C                   KFLD                    DETPA2
     C                   KFLD                    DETSE4
     C     LL$107        SETLL     MOVARC06                               68
     C     *IN68         IFEQ      '1'
     C     LL$107        SETGT     MOVARC06                           68
     C                   MOVE      '0'           *IN68
     C                   ELSE
     C                   MOVE      '1'           *IN68
     C                   END
     C* Calcula último consecutivo
     C*EJECUTAR M14035
     C                   EXSR      M14035
     C* SAE
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C*CALCULAR ZDEUDE = DETSA1+DETSA4+DETSA3+DETSA7+DETS95+DETS97
     C     DETSA1        ADD       DETSA4        V$CA1           030 9
     C     V$CA1         ADD       DETSA3        V$CA1
     C     V$CA1         ADD       DETSA7        V$CA1
     C     V$CA1         ADD       DETS95        V$CA1
     C     V$CA1         ADD       DETS97        ZDEUDE
     C*FIN
     C                   END
     C* Mover datos detalle de deuda
     C*EJECUTAR M14309
     C                   EXSR      M14309
     C* Cancelar C.V.A.
     C*EJECUTAR M14310
     C                   EXSR      M14310
     C* Cancelar intereses F.S.
     C*EJECUTAR M14315
     C                   EXSR      M14315
     C* Cancelar intereses S.F.S.
     C*EJECUTAR M14316
     C                   EXSR      M14316
     C* Cancelar F.S.
     C*EJECUTAR M14320
     C                   EXSR      M14320
     C* Cancelar S.F.S.
     C*EJECUTAR M14321
     C                   EXSR      M14321
     C* Cancelar intereses
     C*EJECUTAR M14325
     C                   EXSR      M14325
     C* Cancelar intereses FGPM
     C*EJECUTAR M14326
     C                   EXSR      M14326
     C* Cancelar FGPM
     C*EJECUTAR M14327
     C                   EXSR      M14327
     C* Cancelar alto riesgo
     C*EJECUTAR M14335
     C                   EXSR      M14335
     C* Cancelar C.O.
     C*EJECUTAR M14340
     C                   EXSR      M14340
     C* Cancelar C.V.E.
     C*EJECUTAR M14345
     C                   EXSR      M14345
     C* Calcular comisiones y prima
     C*EJECUTAR M14370
     C                   EXSR      M14370
     C* Evalua si genera movarc
     C*EJECUTAR M14302
     C                   EXSR      M14302
     C* Retención contingente
     C*LIMPIAR ZVRECO
     C                   CLEAR                   ZVRECO
     C* Genera mvto si hay valores enMOVARC
     C*SI ZGENMV = '1'
     C     ZGENMV        IFEQ      '1'
     C* Calcular retconting deuda
     C*EJECUTAR M14350
     C                   EXSR      M14350
     C* Planilla cancelación deuda
     C*MOVER MOVPLA PLANU1
     C                   Z-ADD     PLANU1        MOVPLA
     C* Actualizar detalle deuda
     C*EJECUTAR M14375
     C                   EXSR      M14375
     C* Ind. canc. deud. anterior. no pacto canc. deudas
     C*PASAR ZINCDE '1'
     C                   MOVEL     '1'           ZINCDE
     C* Ind. vigencia Siafp
     C*PASAR MOVI11 '1'
     C                   MOVEL     '1'           MOVI11
     C* Transacción
     C*MOVER MOVCO1 '02'
     C                   MOVE      '02'          MOVCO1
     C* Planilla sector salud
     C*SI ZTIPLA = '04'
     C     ZTIPLA        IFEQ      '04'
     C* Pago del situado
     C*SI DEUT01 = '04' O DEUT01 = '11'
     C     DEUT01        IFEQ      '04'
     C     DEUT01        OREQ      '11'
     C* Concepto
     C*MOVER MOVTIP '74'
     C                   MOVE      '74'          MOVTIP
     C* Pago Hospital
     C*SINO
     C                   ELSE
     C* Concepto
     C*MOVER MOVTIP '94'
     C                   MOVE      '94'          MOVTIP
     C*FIN
     C                   END
     C* Planillas normales
     C*SINO
     C                   ELSE
     C* Concepto
     C*MOVER MOVTIP '34'
     C                   MOVE      '34'          MOVTIP
     C*FIN
     C                   END
     C* Agregar registro a movarc
     C*EJECUTAR M00009
     C                   EXSR      M00009
     C*
     C* Si el valor de C.V.A o C.V.E es mayor a 0
     C*SI MOVCO5 |= 0 O MOVCU3 |= 0 O MOVCO6 |= 0 O MOVCU4 |= 0
     C     MOVCO5        IFNE      0
     C     MOVCU3        ORNE      0
     C     MOVCO6        ORNE      0
     C     MOVCU4        ORNE      0
     C* Indicador de acreditación
     C*PASAR ZINACR '1'
     C                   MOVEL     '1'           ZINACR
     C* Crear registro de aporte vol
     C*EJECUTAR M09000
     C                   EXSR      M09000
     C*FIN
     C                   END
     C*
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*MOVER DETNU2 DETNR1
     C                   Z-ADD     DETNR1        DETNU2
     C* Imprime reporte detallado
     C*EJECUTAR DET@01
     C                   EXSR      DET@01
     C* Acumular valores por concepto
     C*EJECUTAR M14380
     C                   EXSR      M14380
     C* Actualizar cuenta afiliado
     C*EJECUTAR M14385
     C                   EXSR      M14385
     C* Para permitir la reversión de los intereses compuestos se debe
     C* un movar2 por cada movarc de la cancelación.
     C* No hay error
     C*SI ZVRPAD <> *CERO
     C     ZVRPAD        IFNE      *ZERO
     C* Cód. transacción
     C*PASAR ZCODTX '03'
     C                   MOVEL     '03'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '22'
     C                   MOVEL     '22'          ZCONCE
     C* Página
     C*MOVER MOVPA2 MOVPAG
     C                   Z-ADD     MOVPAG        MOVPA2
     C* Secuencia
     C*MOVER MOVSE2 MOVSEC
     C                   Z-ADD     MOVSEC        MOVSE2
     C* Consecutivo
     C*MOVER MOV076 MOVCON
     C                   Z-ADD     MOVCON        MOV076
     C*CALCULAR MOVVA1 = MOVCOT + MOVCOM + MOVVAL + MOVC24 + MOVCO5 + MO
     C     MOVCOT        ADD       MOVCOM        V$CA1           030 9
     C     V$CA1         ADD       MOVVAL        V$CA1
     C     V$CA1         ADD       MOVC24        V$CA1
     C     V$CA1         ADD       MOVCO5        V$CA1
     C     V$CA1         ADD       MOVCO7        V$CA1
     C     V$CA1         ADD       MOVCO6        V$CA1
     C     V$CA1         ADD       MOVC27        V$CA1
     C     V$CA1         ADD       MOVCO8        V$CA1
     C     V$CA1         ADD       MOVV12        V$CA1
     C     V$CA1         ADD       MOVV13        V$CA1
     C     V$CA1         ADD       MOVINT        V$CA1
     C     V$CA1         ADD       MOVIN2        V$CA1
     C     V$CA1         ADD       MOVI05        V$CA1
     C     V$CA1         ADD       MOVI06        MOVVA1
     C* Movimiento de deuda
     C*EJECUTAR M14391
     C                   EXSR      M14391
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Mueve datos detalle de deuda                                ==
     C*==                                                              ==
     C*==================================================================
     C     M14309        BEGSR
     C* Código interno
     C*MOVER MOVCO4 CUENUM
     C                   Z-ADD     CUENUM        MOVCO4
     C* Período cotización
     C*PASAR MOVPER DEUPER
     C                   MOVEL     DEUPER        MOVPER
     C* Fecha de depósito
     C*PASAR MOVFEC ZFECDE
     C                   MOVEL     ZFECDE        MOVFEC
     C* Recaudo normal
     C*SI ZINOAF |= '1'
     C     ZINOAF        IFNE      '1'
     C* Tipo de planilla
     C*PASAR MOVTI5 PLATIP
     C                   MOVEL     PLATIP        MOVTI5
     C* Planilla indep./vol./tercero
     C*SI PLATIP = '02' O PLATIP = '03' O PLATIP = '07'
     C     PLATIP        IFEQ      '02'
     C     PLATIP        OREQ      '03'
     C     PLATIP        OREQ      '07'
     C* Código interno empleador
     C*MOVER MOVCOD *CERO
     C                   MOVE      *ZERO         MOVCOD
     C*SINO
     C                   ELSE
     C* Código empleador
     C*MOVER MOVCOD PLACOD
     C                   Z-ADD     PLACOD        MOVCOD
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Tipo de planilla
     C*PASAR MOVTI5 ZTIPLN
     C                   MOVEL     ZTIPLN        MOVTI5
     C* Afiliado indep./voluntario
     C*SI AFITIP = '2' O AFITIP = '4'
     C     AFITIP        IFEQ      '2'
     C     AFITIP        OREQ      '4'
     C* Código interno empleador
     C*MOVER MOVCOD *CERO
     C                   MOVE      *ZERO         MOVCOD
     C*SINO
     C                   ELSE
     C* Código interno empleador - envío
     C*MOVER MOVCOD ZCIEMP
     C                   Z-ADD     ZCIEMP        MOVCOD
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI MOVTI5 = *BLANCO
     C     MOVTI5        IFEQ      *BLANK
     C* Tipo de planilla
     C*PASAR MOVTI5 DETTI8
     C                   MOVEL     DETTI8        MOVTI5
     C*FIN
     C                   END
     C* Número de planilla
     C*MOVER MOVNU2 DETNU9
     C                   Z-ADD     DETNU9        MOVNU2
     C* Página
     C*MOVER MOVPAG DETPA2
     C                   Z-ADD     DETPA2        MOVPAG
     C* Secuencia
     C*MOVER MOVSEC DETSE4
     C                   Z-ADD     DETSE4        MOVSEC
     C* Salario informado
     C*MOVER MOVSAL DETRE4
     C                   Z-ADD     DETRE4        MOVSAL
     C* Salario calculado
     C*MOVER MOVSA2 DETSA2
     C                   Z-ADD     DETSA2        MOVSA2
     C*  Plan. declaración y no pago
     C*SI DETTI8 = '01' Y DETT44 = '03' Y DETI28 = 'S'
     C     DETTI8        IFEQ      '01'
     C     DETT44        ANDEQ     '03'
     C     DETI28        ANDEQ     'S'
     C* Valida los dias
     C*EJECUTAR M21005
     C                   EXSR      M21005
     C*SI ZT@002='2'
     C     ZT@002        IFEQ      '2'
     C* DETARC05
     C*PASAR ZENTID '2'
     C                   MOVEL     '2'           ZENTID
     C* Campo númerico de 12
     C*MOVER ZNUM12 DETNU9
     C                   Z-ADD     DETNU9        ZNUM12
     C* Campo númerico de 12
     C*MOVER ZNUME3 DETPA2
     C                   Z-ADD     DETPA2        ZNUME3
     C* Campo númerico de 12
     C*MOVER ZNUMI3 DETSE4
     C                   Z-ADD     DETSE4        ZNUMI3
     C* Limpia variables
     C*LIMPIAR ZALFA8 ZALFA5 ZINERE ZNUME2 ZALFE1 ZNUME5 ZFITIP
     C                   CLEAR                   ZALFA8
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C                   CLEAR                   ZNUME2
     C                   CLEAR                   ZALFE1
     C                   CLEAR                   ZNUME5
     C                   CLEAR                   ZFITIP
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM21 ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM21
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC WHERE DETNU3 = :DETNU9 AND
     C+  DETPAG = :DETPA2 AND DETSEC = :DETSE4
     C/END-EXEC
     C* Período de la deuda (Planilla)
     C*PASAR ZPERCO DEUPER
     C                   MOVEL     DEUPER        ZPERCO
     C* Ident. del afiliado
     C*MOVER DETNU2 ZNUM12
     C                   Z-ADD     ZNUM12        DETNU2
     C* Días acreditados afiliado
     C*MOVER DETDIA ZDITRA
     C                   Z-ADD     ZDITRA        DETDIA
     C* Días de incapacidad
     C*MOVER DETDI1 ZDILIC
     C                   Z-ADD     ZDILIC        DETDI1
     C* Salario base de cotización
     C*MOVER DETSAL ZNUME9
     C                   Z-ADD     ZNUME9        DETSAL
     C* Salario básico
     C*MOVER DETS12 ZNUMI9
     C                   Z-ADD     ZNUMI9        DETS12
     C* Salario calculado
     C*MOVER DETVA7 ZNUMR9
     C                   Z-ADD     ZNUMR9        DETVA7
     C* Novedad
     C*PASAR DETNOV ZALFA1
     C                   MOVEL     ZALFA1        DETNOV
     C* Indicador de novedad no aplica
     C*PASAR DETIN1 ZALFE1
     C                   MOVEL     ZALFE1        DETIN1
     C* vecntor de Novedades
     C*PASAR ZVECNO ZALF15
     C                   MOVEL     ZALF15        ZVECNO
     C* Tarifa alto riesgo
     C*MOVER DETTAR ZNUME5
     C                   Z-ADD     ZNUME5        DETTAR
     C* Tipo de planilla
     C*PASAR ZTIPLA '01'
     C                   MOVEL     '01'          ZTIPLA
     C*FIN
     C                   END
     C* No hay mov can 01-03 con dias
     C*SI ZINDIA=0
     C     ZINDIA        IFEQ      0
     C* Días trabajados
     C*MOVER MOVNUM DETDIA
     C                   Z-ADD     DETDIA        MOVNUM
     C* Días licencia
     C*MOVER MOVDIA DETDI1
     C                   Z-ADD     DETDI1        MOVDIA
     C*SINO
     C                   ELSE
     C* Días trabajados
     C*MOVER MOVNUM *CERO
     C                   MOVE      *ZERO         MOVNUM
     C* Dias licencia
     C*MOVER MOVDIA *CERO
     C                   MOVE      *ZERO         MOVDIA
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*MOVER MOVDIA *CERO
     C                   MOVE      *ZERO         MOVDIA
     C* Días trabajados
     C*MOVER MOVNUM *CERO
     C                   MOVE      *ZERO         MOVNUM
     C*FIN
     C                   END
     C* Fecha fondo acreditación
     C*PASAR MOVFE7 HISFE3
     C                   MOVEL     HISFE3        MOVFE7
     C* Fecha sistema acreditación
     C*FUNCION QFECH1 (MOVFE1)
     C                   CALL      'RPRECFEC'                                   QFECH1
     C     MOVFE1        PARM      MOVFE1        F$2P1             8
     C*LIMPIAR ZRENTR
     C                   CLEAR                   ZRENTR
     C*FUNCION QHORA (MOVHOR)
     C                   CALL      'F012SNAP'                                   QHORA
     C     MOVHOR        PARM      MOVHOR        F$301             6
     C* Código actividad alto riesgo
     C*MOVER MOVC18 DETC09
     C                   MOVE      DETC09        MOVC18
     C* Tipo de pago de planilla
     C*PASAR MOVT10 DETT44
     C                   MOVEL     DETT44        MOVT10
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar cotización voluntaria afiliado                     ==
     C*==                                                              ==
     C*==================================================================
     C     M14310        BEGSR
     C*SI ZVDCO > *CERO Y DETSA3 > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     DETSA3        ANDGT     *ZERO
     C* Saldo C.V.A. > Valor distrib.
     C*SI DETSA3 >= ZVDCO
     C     DETSA3        IFGE      ZVDCO
     C* Saldo C.V.A.
     C*RESTAR ZVDCO DETSA3
     C                   SUB       ZVDCO         DETSA3
     C* Valor movimiento C.V.A.
     C*MOVER MOVCO5 ZVDCO
     C                   Z-ADD     ZVDCO         MOVCO5
     C* Cuotas movimiento C.V.A.
     C*MOVER MOVCU3 ZCUCO
     C                   Z-ADD     ZCUCO         MOVCU3
     C* Valor y cuotas distrib. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*SINO
     C                   ELSE
     C* Valor movimiento C.V.A.
     C*MOVER MOVCO5 DETSA3
     C                   Z-ADD     DETSA3        MOVCO5
     C*CALCULAR (R) MOVCU3 = (DETSA3 * ZCUCO)/ ZVDCO
     C     DETSA3        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         MOVCU3
     C* Valor distribuido C.O.
     C*RESTAR MOVCO5 ZVDCO
     C                   SUB       MOVCO5        ZVDCO
     C* Cuotas distribuidas C.O.
     C*RESTAR MOVCU3 ZCUCO
     C                   SUB       MOVCU3        ZCUCO
     C* Saldo C.V.A.
     C*LIMPIAR DETSA3
     C                   CLEAR                   DETSA3
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Suma saldo a cancelar acuerdo
     C*SUMAR MOVCO5 ZTOPAG
     C                   ADD       MOVCO5        ZTOPAG
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar intereses F.S.                                     ==
     C*==                                                              ==
     C*==================================================================
     C     M14315        BEGSR
     C* SALDO MOVAR2
     C*LIMPIAR MOVS02
     C                   CLEAR                   MOVS02
     C* VALOR ORIGINAL INT. F.S
     C*MOVER ZETS07 DETS07
     C                   Z-ADD     DETS07        ZETS07
     C*SI ZVDCO > *CERO Y DETS07 > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     DETS07        ANDGT     *ZERO
     C* SALDO I.F.S. > VALOR DISTRIB
     C*SI DETS07 >= ZVDCO
     C     DETS07        IFGE      ZVDCO
     C* % DISTRIBUIR INT SUBS.
     C*SI ZPDSFS <> *CERO
     C     ZPDSFS        IFNE      *ZERO
     C*CALCULAR (R) ZOVIN2 =(DETS07*ZPDSFS)/100
     C     DETS07        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVIN2
     C*SI ZOVIN2 >= ZVDCO
     C     ZOVIN2        IFGE      ZVDCO
     C* SALDO I.F.S.
     C*RESTAR ZVDCO DETS07
     C                   SUB       ZVDCO         DETS07
     C* VALOR MOVIMIENTO IFS
     C*MOVER MOVIN2 ZVDCO
     C                   Z-ADD     ZVDCO         MOVIN2
     C* CUOTAS MOVIMIENTO IFS
     C*MOVER MOVC16 ZCUCO
     C                   Z-ADD     ZCUCO         MOVC16
     C* VALOR Y CUOTAS DISTRIB. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*SINO
     C                   ELSE
     C* VALOR MOVIMIENTO INT F.S.P.
     C*MOVER MOVIN2 ZOVIN2
     C                   Z-ADD     ZOVIN2        MOVIN2
     C*CALCULAR (R) MOVC16 = (ZOVIN2 * ZCUCO)/ ZVDCO
     C     ZOVIN2        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         MOVC16
     C* VALOR DISTRIBUIDO C.O.
     C*RESTAR MOVIN2 ZVDCO
     C                   SUB       MOVIN2        ZVDCO
     C* CUOTAS DISTRIBUIDAS C.O.
     C*RESTAR MOVC16 ZCUCO
     C                   SUB       MOVC16        ZCUCO
     C* SALDO I.F.S.
     C*RESTAR MOVIN2 DETS07
     C                   SUB       MOVIN2        DETS07
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* SALDO I.F.S.
     C*RESTAR ZVDCO DETS07
     C                   SUB       ZVDCO         DETS07
     C* VALOR MOVIMIENTO IFS
     C*MOVER MOVIN2 ZVDCO
     C                   Z-ADD     ZVDCO         MOVIN2
     C* CUOTAS MOVIMIENTO IFS
     C*MOVER MOVC16 ZCUCO
     C                   Z-ADD     ZCUCO         MOVC16
     C* VALOR Y CUOTAS DISTRIB. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI ZPDSFS <> *CERO
     C     ZPDSFS        IFNE      *ZERO
     C*CALCULAR (R) ZOVIN2 =(DETS07*ZPDSFS)/100
     C     DETS07        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVIN2
     C* VALOR MOVIMIENTO I.F.S.P.
     C*MOVER MOVIN2 ZOVIN2
     C                   Z-ADD     ZOVIN2        MOVIN2
     C*CALCULAR (R) ZOVC16 = (DETS07 * ZCUCO)/ ZVDCO
     C     DETS07        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZOVC16
     C* CUOTAS I.F.S.P
     C*CALCULAR (R) MOVC16 =(ZOVC16*ZPDSFS)/100
     C     ZOVC16        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           MOVC16
     C*SINO
     C                   ELSE
     C* VALOR MOVIMIENTO I.F.S
     C*MOVER MOVIN2 DETS07
     C                   Z-ADD     DETS07        MOVIN2
     C*CALCULAR (R) MOVC16 = (DETS07 * ZCUCO)/ ZVDCO
     C     DETS07        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         MOVC16
     C*FIN
     C                   END
     C* VALOR DISTRIBUIDO C.O.
     C*RESTAR MOVIN2 ZVDCO
     C                   SUB       MOVIN2        ZVDCO
     C* CUOTAS DISTRIBUIDAS C.O.
     C*RESTAR MOVC16 ZCUCO
     C                   SUB       MOVC16        ZCUCO
     C* SALDO I.F.S.
     C*RESTAR MOVIN2 DETS07
     C                   SUB       MOVIN2        DETS07
     C*FIN
     C                   END
     C* INTERESES F.S.
     C*MOVER MOVS02 MOVIN2
     C                   Z-ADD     MOVIN2        MOVS02
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar intereses subsistencia                             ==
     C*==                                                              ==
     C*==================================================================
     C     M14316        BEGSR
     C* INTERESES MOVAR2
     C*LIMPIAR MOVS16
     C                   CLEAR                   MOVS16
     C* INTERESES DE SUBSISTENCIA
     C*CALCULAR ZINSFS = DETS07 + DETS98
     C     DETS07        ADD       DETS98        ZINSFS
     C*SI ZVDCO > *CERO Y ZINSFS > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     ZINSFS        ANDGT     *ZERO
     C* SALDO ISFSP> VLR DISTRIBUIDO
     C*SI ZINSFS >= ZVDCO
     C     ZINSFS        IFGE      ZVDCO
     C* VALOR MOVIMIENTO ISFSP
     C*MOVER MOVI06 ZVDCO
     C                   Z-ADD     ZVDCO         MOVI06
     C* CUOTAS ISFSP
     C*MOVER MOV059 ZCUCO
     C                   Z-ADD     ZCUCO         MOV059
     C* SALDO ISFSP
     C*RESTAR ZVDCO DETS98
     C                   SUB       ZVDCO         DETS98
     C* VALOR Y CUOTAS DISTR. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C* SE CANCELO PARTE DE FSP
     C*SI DETS98 < 0
     C     DETS98        IFLT      0
     C*CALCULAR ZPAIFS = DETS98*-1
     C                   Z-SUB     1             V$CA1           030 9
     C     DETS98        MULT      V$CA1         ZPAIFS
     C*CALCULAR (R) ZCUS07 = (ZPAIFS * MOV059)/ MOVI06
     C     ZPAIFS        MULT      MOV059        V$CA1           030 9
     C     V$CA1         DIV(H)    MOVI06        ZCUS07
     C* VALOR MOVIMIENTO IFS
     C*SUMAR ZPAIFS MOVIN2
     C                   ADD       ZPAIFS        MOVIN2
     C* CUOTAS MOVIMIENTO IFS
     C*SUMAR ZCUS07 MOVC16
     C                   ADD       ZCUS07        MOVC16
     C* VALOR MOVIMIENTO ISFSP
     C*RESTAR ZPAIFS MOVI06
     C                   SUB       ZPAIFS        MOVI06
     C* CUOTAS MOVIMIENTO ISFSP
     C*RESTAR ZCUS07 MOV059
     C                   SUB       ZCUS07        MOV059
     C* VALOR DEUDA ISFSP
     C*LIMPIAR DETS98
     C                   CLEAR                   DETS98
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* VALOR INTERESES SFSP
     C*CALCULAR ZOVI06 = DETS98+(ZETS07-MOVIN2)
     C     ZETS07        SUB       MOVIN2        V$CA1           030 9
     C     DETS98        ADD       V$CA1         ZOVI06
     C* VALOR MVTO INTERESES SFS
     C*MOVER MOVI06 ZOVI06
     C                   Z-ADD     ZOVI06        MOVI06
     C*CALCULAR (R) ZCUS98 = (DETS98 * ZCUCO)/ ZVDCO
     C     DETS98        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZCUS98
     C*CALCULAR (R) ZCUS07 = (ZETS07 * ZCUCO)/ ZVDCO
     C     ZETS07        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZCUS07
     C* CUOTAS INTERESES SFSP
     C*CALCULAR MOV059 = ZCUS98+(ZCUS07-MOVC16)
     C     ZCUS07        SUB       MOVC16        V$CA1           030 9
     C     ZCUS98        ADD       V$CA1         MOV059
     C* VALOR DISTRIBUIDO C.O.
     C*RESTAR MOVI06 ZVDCO
     C                   SUB       MOVI06        ZVDCO
     C* CUOTAS DISTRIBUIDAS C.O.
     C*RESTAR MOV059 ZCUCO
     C                   SUB       MOV059        ZCUCO
     C* SALDO ISFS.
     C*LIMPIAR DETS07 DETS98
     C                   CLEAR                   DETS07
     C                   CLEAR                   DETS98
     C*FIN
     C                   END
     C* INTERESES S.F.S.
     C*MOVER MOVS16 MOVI06
     C                   Z-ADD     MOVI06        MOVS16
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar fondo de solidaridad                               ==
     C*==                                                              ==
     C*==================================================================
     C     M14320        BEGSR
     C* SALDO MOVAR2
     C*LIMPIAR MOVSA6
     C                   CLEAR                   MOVSA6
     C* VALOR ORIGINAL FS
     C*MOVER ZETSA4 DETSA4
     C                   Z-ADD     DETSA4        ZETSA4
     C*SI ZVDCO > *CERO Y DETSA4 > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     DETSA4        ANDGT     *ZERO
     C* SALDO F.S. > VALOR DISTRIB.
     C*SI DETSA4 >= ZVDCO
     C     DETSA4        IFGE      ZVDCO
     C* % SUBSISTENCIA
     C*SI ZPDSFS <> *CERO
     C     ZPDSFS        IFNE      *ZERO
     C*CALCULAR (R) ZOVCO8 =(DETSA4*ZPDSFS)/100
     C     DETSA4        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVCO8
     C*SI ZOVCO8 >= ZVDCO
     C     ZOVCO8        IFGE      ZVDCO
     C*MOVER MOVCO8 ZVDCO
     C                   Z-ADD     ZVDCO         MOVCO8
     C*MOVER MOVCU8 ZCUCO
     C                   Z-ADD     ZCUCO         MOVCU8
     C* SALDO F.S.
     C*RESTAR ZVDCO DETSA4
     C                   SUB       ZVDCO         DETSA4
     C* VALOR Y CUOTAS DISTRIB.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C* VR DISTRIB > SALDO DIVIDIDO
     C*SINO
     C                   ELSE
     C* VALOR MOVIMIENTO F.S.P.
     C*MOVER MOVCO8 ZOVCO8
     C                   Z-ADD     ZOVCO8        MOVCO8
     C*CALCULAR (R) MOVCU8 = (ZOVCO8 * ZCUCO)/ ZVDCO
     C     ZOVCO8        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         MOVCU8
     C* VALOR DISTRIBUIDO C.O.
     C*RESTAR MOVCO8 ZVDCO
     C                   SUB       MOVCO8        ZVDCO
     C* CUOTAS DISTRIBUIDAS C.O.
     C*RESTAR MOVCU8 ZCUCO
     C                   SUB       MOVCU8        ZCUCO
     C* SALDO I.F.S.
     C*RESTAR MOVCO8 DETSA4
     C                   SUB       MOVCO8        DETSA4
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* SALDO F.S.
     C*RESTAR ZVDCO DETSA4
     C                   SUB       ZVDCO         DETSA4
     C*MOVER MOVCO8 ZVDCO
     C                   Z-ADD     ZVDCO         MOVCO8
     C*MOVER MOVCU8 ZCUCO
     C                   Z-ADD     ZCUCO         MOVCU8
     C* VALOR Y CUOTAS DISTRIB.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI ZPDSFS <> *CERO
     C     ZPDSFS        IFNE      *ZERO
     C*CALCULAR (R) ZOVCO8 =(DETSA4*ZPDSFS)/100
     C     DETSA4        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVCO8
     C* VALOR MOVIMIENTO F.S.P.
     C*MOVER MOVCO8 ZOVCO8
     C                   Z-ADD     ZOVCO8        MOVCO8
     C*CALCULAR (R) ZOVCU8 = (DETSA4 * ZCUCO)/ ZVDCO
     C     DETSA4        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZOVCU8
     C* CUOTAS  F.S.P
     C*CALCULAR (R) MOVCU8 =(ZOVCU8*ZPDSFS)/100
     C     ZOVCU8        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           MOVCU8
     C*SINO
     C                   ELSE
     C* VALOR MOVIMIENTO F.S
     C*MOVER MOVCO8 DETSA4
     C                   Z-ADD     DETSA4        MOVCO8
     C*CALCULAR (R) MOVCU8 = (DETSA4 * ZCUCO)/ ZVDCO
     C     DETSA4        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         MOVCU8
     C*FIN
     C                   END
     C* VALOR DISTRIBUIDO C.O.
     C*RESTAR MOVCO8 ZVDCO
     C                   SUB       MOVCO8        ZVDCO
     C* CUOTAS DISTRIBUIDAS C.O.
     C*RESTAR MOVCU8 ZCUCO
     C                   SUB       MOVCU8        ZCUCO
     C* SALDO F.S.
     C*RESTAR MOVCO8 DETSA4
     C                   SUB       MOVCO8        DETSA4
     C*FIN
     C                   END
     C* SALDO MOVAR2
     C*MOVER MOVSA6 MOVCO8
     C                   Z-ADD     MOVCO8        MOVSA6
     C*FIN
     C                   END
     C* Suma saldo a cancelar acuerdo
     C*SUMAR MOVCO8 ZTOPAG
     C                   ADD       MOVCO8        ZTOPAG
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar fondo de subsistencia                              ==
     C*==                                                              ==
     C*==================================================================
     C     M14321        BEGSR
     C* SALDO MOVAR2
     C*LIMPIAR MOVS15
     C                   CLEAR                   MOVS15
     C* TOTAL SUBSISTENCIA
     C*CALCULAR ZSUBSI = DETSA4 + DETS97
     C     DETSA4        ADD       DETS97        ZSUBSI
     C*SI ZVDCO > *CERO Y ZSUBSI > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     ZSUBSI        ANDGT     *ZERO
     C* SALDO SFS > VALOR DISTRIB.
     C*SI ZSUBSI >= ZVDCO
     C     ZSUBSI        IFGE      ZVDCO
     C* VALOR MOVIMIENTO SFSP
     C*MOVER MOVV13 ZVDCO
     C                   Z-ADD     ZVDCO         MOVV13
     C* CUOTAS SFSP
     C*MOVER MOV058 ZCUCO
     C                   Z-ADD     ZCUCO         MOV058
     C* SALDO SFSP
     C*RESTAR ZVDCO DETS97
     C                   SUB       ZVDCO         DETS97
     C* VALOR Y CUOTAS DISTR. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C* SE CANCELO PARTE DE FSP
     C*SI DETS97 < 0
     C     DETS97        IFLT      0
     C*CALCULAR ZPAIFS = DETS97*-1
     C                   Z-SUB     1             V$CA1           030 9
     C     DETS97        MULT      V$CA1         ZPAIFS
     C*CALCULAR (R) ZCUSA4 = (ZPAIFS * MOV058)/ MOVV13
     C     ZPAIFS        MULT      MOV058        V$CA1           030 9
     C     V$CA1         DIV(H)    MOVV13        ZCUSA4
     C* VALOR MOVIMIENTO FS
     C*SUMAR ZPAIFS MOVCO8
     C                   ADD       ZPAIFS        MOVCO8
     C* CUOTAS MOVIMIENTO FS
     C*SUMAR ZCUSA4 MOVCU8
     C                   ADD       ZCUSA4        MOVCU8
     C* VALOR MOVIMIENTO SFSP
     C*RESTAR ZPAIFS MOVV13
     C                   SUB       ZPAIFS        MOVV13
     C* CUOTAS MOVIMIENTO SFSP
     C*RESTAR ZCUSA4 MOV058
     C                   SUB       ZCUSA4        MOV058
     C* VALOR DEUDA SFSP
     C*LIMPIAR DETS97
     C                   CLEAR                   DETS97
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* VALOR SFSP
     C*CALCULAR ZOVV13 = DETS97+(ZETSA4-MOVCO8)
     C     ZETSA4        SUB       MOVCO8        V$CA1           030 9
     C     DETS97        ADD       V$CA1         ZOVV13
     C* VALOR MVTO SFS
     C*MOVER MOVV13 ZOVV13
     C                   Z-ADD     ZOVV13        MOVV13
     C*CALCULAR (R) ZCUS97 = (DETS97 * ZCUCO)/ ZVDCO
     C     DETS97        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZCUS97
     C*CALCULAR (R) ZCUSA4 = (ZETSA4 * ZCUCO)/ ZVDCO
     C     ZETSA4        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZCUSA4
     C* CUOTAS SFSP
     C*CALCULAR MOV058 = ZCUS97+(ZCUSA4-MOVCU8)
     C     ZCUSA4        SUB       MOVCU8        V$CA1           030 9
     C     ZCUS97        ADD       V$CA1         MOV058
     C* VALOR DISTRIBUIDO C.O.
     C*RESTAR MOVV13 ZVDCO
     C                   SUB       MOVV13        ZVDCO
     C* CUOTAS DISTRIBUIDAS C.O.
     C*RESTAR MOV058 ZCUCO
     C                   SUB       MOV058        ZCUCO
     C* SALDO SFS
     C*LIMPIAR DETS97 DETSA4
     C                   CLEAR                   DETS97
     C                   CLEAR                   DETSA4
     C*FIN
     C                   END
     C* SALDO MOVAR2
     C*MOVER MOVS15 MOVV13
     C                   Z-ADD     MOVV13        MOVS15
     C*FIN
     C                   END
     C* Suma saldo a cancelar acuerdo
     C*SUMAR MOVV13 ZTOPAG
     C                   ADD       MOVV13        ZTOPAG
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar intereses                                          ==
     C*==                                                              ==
     C*==================================================================
     C     M14325        BEGSR
     C* INTERESES MOVAR2
     C*LIMPIAR MOVSA9
     C                   CLEAR                   MOVSA9
     C*SI ZVDCO > *CERO Y DETSA5 > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     DETSA5        ANDGT     *ZERO
     C* Saldo Int. > Valor distrib.
     C*SI DETSA5 >= ZVDCO
     C     DETSA5        IFGE      ZVDCO
     C* Saldo Int.
     C*RESTAR ZVDCO DETSA5
     C                   SUB       ZVDCO         DETSA5
     C* Valor movimiento Int.
     C*MOVER MOVINT ZVDCO
     C                   Z-ADD     ZVDCO         MOVINT
     C* Cuotas movimiento Int.
     C*MOVER MOVCU6 ZCUCO
     C                   Z-ADD     ZCUCO         MOVCU6
     C* Valor y cuotas distrib. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*SINO
     C                   ELSE
     C* Valor movimiento Int.
     C*MOVER MOVINT DETSA5
     C                   Z-ADD     DETSA5        MOVINT
     C*CALCULAR (R) MOVCU6 = (DETSA5 * ZCUCO)/ ZVDCO
     C     DETSA5        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         MOVCU6
     C* Valor distribuido C.O.
     C*RESTAR MOVINT ZVDCO
     C                   SUB       MOVINT        ZVDCO
     C* Cuotas distribuidas C.O.
     C*RESTAR MOVCU6 ZCUCO
     C                   SUB       MOVCU6        ZCUCO
     C* Saldo Int.
     C*LIMPIAR DETSA5
     C                   CLEAR                   DETSA5
     C*FIN
     C                   END
     C* Intereses
     C*MOVER MOVSA9 MOVINT
     C                   Z-ADD     MOVINT        MOVSA9
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar intereses FGPM                                     ==
     C*==                                                              ==
     C*==================================================================
     C     M14326        BEGSR
     C* INTERESES MOVAR2
     C*LIMPIAR ZMICOM MOVS14 MOVS17 MOVS18 MOVS19 MOVS20
     C                   CLEAR                   ZMICOM
     C                   CLEAR                   MOVS14
     C                   CLEAR                   MOVS17
     C                   CLEAR                   MOVS18
     C                   CLEAR                   MOVS19
     C                   CLEAR                   MOVS20
     C*LIMPIAR ZTVC16 ZTV059 ZTVCU6 ZTV057 ZOVIN2 ZOVC16 ZINSFS
     C                   CLEAR                   ZTVC16
     C                   CLEAR                   ZTV059
     C                   CLEAR                   ZTVCU6
     C                   CLEAR                   ZTV057
     C                   CLEAR                   ZOVIN2
     C                   CLEAR                   ZOVC16
     C                   CLEAR                   ZINSFS
     C* INT. FGPM
     C*SI ZVDCO > *CERO Y DETS96 > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     DETS96        ANDGT     *ZERO
     C* SALDO INT. FGPM > VALOR DISTR
     C*SI DETS96 >= ZVDCO
     C     DETS96        IFGE      ZVDCO
     C* SALDO INT FGPM
     C*RESTAR ZVDCO DETS96
     C                   SUB       ZVDCO         DETS96
     C* VALOR MVTO. INT. FGPM
     C*MOVER MOVI05 ZVDCO
     C                   Z-ADD     ZVDCO         MOVI05
     C* CUOTAS MVTO. INT. FGPM
     C*MOVER MOV057 ZCUCO
     C                   Z-ADD     ZCUCO         MOV057
     C* VALOR Y CUOTAS DISTRI. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*SINO
     C                   ELSE
     C* VALOR MVTO. INT. FGPM
     C*MOVER MOVI05 DETS96
     C                   Z-ADD     DETS96        MOVI05
     C*CALCULAR (R) MOV057 = (DETS96 * ZCUCO)/ ZVDCO
     C     DETS96        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         MOV057
     C* VALOR DISTRIBUIDO C.O.
     C*RESTAR MOVI05 ZVDCO
     C                   SUB       MOVI05        ZVDCO
     C* CUOTAS DISTRIBUIDAS C.O.
     C*RESTAR MOV057 ZCUCO
     C                   SUB       MOV057        ZCUCO
     C* SALDO INT. FGPM
     C*LIMPIAR DETS96
     C                   CLEAR                   DETS96
     C*FIN
     C                   END
     C* INTERESES F.G.P.M.
     C*MOVER MOVS14 MOVI05
     C                   Z-ADD     MOVI05        MOVS14
     C*FIN
     C                   END
     C* CANCELAR SALDO DE INTERESES F.S. COMPUESTOS
     C* INT. F.S. TE ORIGINALES
     C*MOVER ZET120 DET120
     C                   Z-ADD     DET120        ZET120
     C*SI ZVDCO > *CERO Y DET120 > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     DET120        ANDGT     *ZERO
     C* SALDO I.F.S. > VALOR DISTRIB.
     C*SI DET120 >= ZVDCO
     C     DET120        IFGE      ZVDCO
     C* % DISTRIBUIR INT SUBS.
     C*SI ZPDSFS <> *CERO
     C     ZPDSFS        IFNE      *ZERO
     C*CALCULAR (R) ZOVIN2 =(DET120*ZPDSFS)/100
     C     DET120        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVIN2
     C*SI ZOVIN2 >= ZVDCO
     C     ZOVIN2        IFGE      ZVDCO
     C* SALDO I.F.S.
     C*RESTAR ZVDCO DET120
     C                   SUB       ZVDCO         DET120
     C* VALOR MOVIMIENTO IFS
     C*SUMAR ZVDCO MOVIN2
     C                   ADD       ZVDCO         MOVIN2
     C* CUOTAS MOVIMIENTO IFS
     C*SUMAR ZCUCO MOVC16
     C                   ADD       ZCUCO         MOVC16
     C* VALOR Y CUOTAS DISTRIB. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*MOVER MOVS20 ZVDCO
     C                   Z-ADD     ZVDCO         MOVS20
     C* VLR DISTRIB > SALDO DIVIDIDO
     C*SINO
     C                   ELSE
     C* VALOR MOVIMIENTO INT F.S.P.
     C*SUMAR ZOVIN2 MOVIN2
     C                   ADD       ZOVIN2        MOVIN2
     C*CALCULAR (R) ZOVC16 = (ZOVIN2 * ZCUCO)/ ZVDCO
     C     ZOVIN2        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZOVC16
     C*SUMAR ZOVC16 MOVC16
     C                   ADD       ZOVC16        MOVC16
     C* VALOR DE INTERESES
     C*SUMAR ZOVIN2 ZMICOM
     C                   ADD       ZOVIN2        ZMICOM
     C* VALOR DISTRIBUIDO C.O.
     C*RESTAR ZOVIN2 ZVDCO
     C                   SUB       ZOVIN2        ZVDCO
     C* CUOTAS DISTRIBUIDAS C.O.
     C*RESTAR ZOVC16 ZCUCO
     C                   SUB       ZOVC16        ZCUCO
     C* SALDO I.F.S.
     C*RESTAR ZOVIN2 DET120
     C                   SUB       ZOVIN2        DET120
     C*MOVER MOVS20 ZOVIN2
     C                   Z-ADD     ZOVIN2        MOVS20
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* SALDO I.F.S.
     C*RESTAR ZVDCO DET120
     C                   SUB       ZVDCO         DET120
     C* VALOR MOVIMIENTO I.F.S.
     C*SUMAR ZVDCO MOVIN2
     C                   ADD       ZVDCO         MOVIN2
     C* CUOTAS MOVIMIENTO I.F.S.
     C*SUMAR ZCUCO MOVC16
     C                   ADD       ZCUCO         MOVC16
     C* VALOR DE INTERESES
     C*SUMAR ZVDCO ZMICOM
     C                   ADD       ZVDCO         ZMICOM
     C* INTERESES F.S
     C*MOVER MOVS20 ZVDCO
     C                   Z-ADD     ZVDCO         MOVS20
     C* VALOR Y CUOTAS DISTRIB. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI ZPDSFS <> *CERO
     C     ZPDSFS        IFNE      *ZERO
     C*CALCULAR (R) ZOVIN2 =(DET120*ZPDSFS)/100
     C     DET120        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVIN2
     C* VALOR MOVIMIENTO I.F.S.P.
     C*SUMAR ZOVIN2 MOVIN2
     C                   ADD       ZOVIN2        MOVIN2
     C*CALCULAR (R) ZCU120 = (DET120 * ZCUCO)/ ZVDCO
     C     DET120        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZCU120
     C* CUOTAS I.F.S.P
     C*CALCULAR (R) ZOVC16 =(ZCU120*ZPDSFS)/100
     C     ZCU120        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVC16
     C*SUMAR ZOVC16 MOVC16
     C                   ADD       ZOVC16        MOVC16
     C* VALOR DE INTERESES
     C*SUMAR ZOVIN2 ZMICOM
     C                   ADD       ZOVIN2        ZMICOM
     C* VALOR DISTRIBUIDO C.O.
     C*RESTAR ZOVIN2 ZVDCO
     C                   SUB       ZOVIN2        ZVDCO
     C* CUOTAS DISTRIBUIDAS C.O.
     C*RESTAR ZOVC16 ZCUCO
     C                   SUB       ZOVC16        ZCUCO
     C* SALDO I.F.S.
     C*RESTAR ZOVIN2 DET120
     C                   SUB       ZOVIN2        DET120
     C*MOVER MOVS20 ZOVIN2
     C                   Z-ADD     ZOVIN2        MOVS20
     C*SINO
     C                   ELSE
     C* VALOR MOVIMIENTO I.F.S
     C*SUMAR DET120 MOVIN2
     C                   ADD       DET120        MOVIN2
     C*CALCULAR (R) ZTVC16 = (DET120 * ZCUCO)/ ZVDCO
     C     DET120        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZTVC16
     C*SUMAR ZTVC16 MOVC16
     C                   ADD       ZTVC16        MOVC16
     C*MOVER MOVS20 DET120
     C                   Z-ADD     DET120        MOVS20
     C* VALOR DE INTERESES
     C*SUMAR DET120 ZMICOM
     C                   ADD       DET120        ZMICOM
     C* VALOR DISTRIBUIDO C.O.
     C*RESTAR DET120 ZVDCO
     C                   SUB       DET120        ZVDCO
     C* CUOTAS DISTRIBUIDAS C.O.
     C*RESTAR ZTVC16 ZCUCO
     C                   SUB       ZTVC16        ZCUCO
     C*LIMPIAR DET120
     C                   CLEAR                   DET120
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* CANCELAR SALDO DE INTERESES SUBSISTENCIA COMPUESTOS
     C* INTERESES SUBS. TE
     C*CALCULAR ZINSFS = DET120 + DET127
     C     DET120        ADD       DET127        ZINSFS
     C*SI ZVDCO > *CERO Y ZINSFS > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     ZINSFS        ANDGT     *ZERO
     C* SALDO ISFSP> VLR DISTRIBUIDO
     C*SI ZINSFS >= ZVDCO
     C     ZINSFS        IFGE      ZVDCO
     C* VALOR ISFSP
     C*CALCULAR ZOVI06 = DET127+ZVDCO
     C     DET127        ADD       ZVDCO         ZOVI06
     C* VALOR MOVIMIENTO
     C*SUMAR ZOVI06 MOVI06
     C                   ADD       ZOVI06        MOVI06
     C*CALCULAR (R) ZOV059 = (DET127 * ZCUCO)/ ZVDCO
     C     DET127        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZOV059
     C* CUOTAS ISFSP
     C*CALCULAR ZOV059 = ZOV059+ZCUCO
     C     ZOV059        ADD       ZCUCO         ZOV059
     C*SUMAR ZOV059 MOV059
     C                   ADD       ZOV059        MOV059
     C* SALDO ISFSP
     C*RESTAR ZVDCO DET120
     C                   SUB       ZVDCO         DET120
     C* VALOR DE INTERESES
     C*SUMAR ZVDCO ZMICOM
     C                   ADD       ZVDCO         ZMICOM
     C* VALOR Y CUOTAS DISTR. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C* INTERESES S.F.S.
     C*MOVER MOVS19 ZOVI06
     C                   Z-ADD     ZOVI06        MOVS19
     C*SINO
     C                   ELSE
     C* VALOR INTERESES SFSP
     C*CALCULAR ZOVI06 = DET127+(ZET120-ZOVIN2)
     C     ZET120        SUB       ZOVIN2        V$CA1           030 9
     C     DET127        ADD       V$CA1         ZOVI06
     C* VALOR MVTO INTERESES SFS
     C*SUMAR ZOVI06 MOVI06
     C                   ADD       ZOVI06        MOVI06
     C*CALCULAR (R) ZCU127 = (DET127 * ZCUCO)/ ZVDCO
     C     DET127        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZCU127
     C*CALCULAR (R) ZCU120 = (ZET120 * ZCUCO)/ ZVDCO
     C     ZET120        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZCU120
     C* CUOTAS INTERESES SFSP
     C*CALCULAR ZOV059 = ZCU127+(ZCU120-ZOVC16)
     C     ZCU120        SUB       ZOVC16        V$CA1           030 9
     C     ZCU127        ADD       V$CA1         ZOV059
     C* TOTAL CUOTAS DISTRIBUIDAS
     C*SUMAR ZOV059 MOV059
     C                   ADD       ZOV059        MOV059
     C* VALOR DISTRIBUIDO C.O.
     C*RESTAR ZOVI06 ZVDCO
     C                   SUB       ZOVI06        ZVDCO
     C* CUOTAS DISTRIBUIDAS C.O.
     C*RESTAR ZOV059 ZCUCO
     C                   SUB       ZOV059        ZCUCO
     C* VALOR DE INTERESES PAGADOS
     C*SUMAR ZOVI06 ZMICOM
     C                   ADD       ZOVI06        ZMICOM
     C* INTERESES S.F.S.
     C*MOVER MOVS19 ZOVI06
     C                   Z-ADD     ZOVI06        MOVS19
     C* SALDO ISFS.
     C*LIMPIAR DET120 DET127
     C                   CLEAR                   DET120
     C                   CLEAR                   DET127
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C*SI ZVDCO > *CERO Y DET125 > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     DET125        ANDGT     *ZERO
     C* SALDO INT. > VALOR DISTRIB.
     C*SI DET125 >= ZVDCO
     C     DET125        IFGE      ZVDCO
     C* SALDO INT.
     C*RESTAR ZVDCO DET125
     C                   SUB       ZVDCO         DET125
     C* VALOR MOVIMIENTO INT.
     C*SUMAR ZVDCO MOVINT
     C                   ADD       ZVDCO         MOVINT
     C* CUOTAS MOVIMIENTO INT.
     C*SUMAR ZCUCO MOVCU6
     C                   ADD       ZCUCO         MOVCU6
     C* VALOR DE INTERESES PAGADOS
     C*SUMAR ZVDCO ZMICOM
     C                   ADD       ZVDCO         ZMICOM
     C* INTERESES
     C*MOVER MOVS17 ZVDCO
     C                   Z-ADD     ZVDCO         MOVS17
     C* VALOR Y CUOTAS DISTRIB. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*SINO
     C                   ELSE
     C* VALOR MOVIMIENTO INT.
     C*SUMAR DET125 MOVINT
     C                   ADD       DET125        MOVINT
     C*CALCULAR (R) ZTVCU6 = (DET125 * ZCUCO)/ ZVDCO
     C     DET125        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZTVCU6
     C* VALOR DISTRIBUIDO C.O.
     C*RESTAR DET125 ZVDCO
     C                   SUB       DET125        ZVDCO
     C* CUOTAS DISTRIBUIDAS C.O.
     C*RESTAR ZTVCU6 ZCUCO
     C                   SUB       ZTVCU6        ZCUCO
     C* TOTAL CUOTAS DISTRIBUIDAS
     C*SUMAR ZTVCU6 MOVCU6
     C                   ADD       ZTVCU6        MOVCU6
     C* VALOR DE INTERESES PAGADOS
     C*SUMAR DET125 ZMICOM
     C                   ADD       DET125        ZMICOM
     C* INTERESES
     C*MOVER MOVS17 DET125
     C                   Z-ADD     DET125        MOVS17
     C* SALDO INT.
     C*LIMPIAR DET125
     C                   CLEAR                   DET125
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C*SI ZVDCO > *CERO Y DET126 > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     DET126        ANDGT     *ZERO
     C* SALDO INT. FGPM > VALOR DISTR
     C*SI DET126 >= ZVDCO
     C     DET126        IFGE      ZVDCO
     C* SALDO INT FGPM
     C*RESTAR ZVDCO DET126
     C                   SUB       ZVDCO         DET126
     C* VALOR MVTO. INT. FGPM
     C*SUMAR ZVDCO MOVI05
     C                   ADD       ZVDCO         MOVI05
     C* CUOTAS MVTO. INT. FGPM
     C*SUMAR ZCUCO MOV057
     C                   ADD       ZCUCO         MOV057
     C* VALOR DE INTERESES PAGADOS
     C*SUMAR ZVDCO ZMICOM
     C                   ADD       ZVDCO         ZMICOM
     C* INTERESES F.G.P.M
     C*MOVER MOVS18 ZVDCO
     C                   Z-ADD     ZVDCO         MOVS18
     C* VALOR Y CUOTAS DISTRI. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*SINO
     C                   ELSE
     C* VALOR MVTO. INT. FGPM
     C*SUMAR DET126 MOVI05
     C                   ADD       DET126        MOVI05
     C*CALCULAR (R) ZTV057 = (DET126 * ZCUCO)/ ZVDCO
     C     DET126        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         ZTV057
     C* VALOR DISTRIBUIDO C.O.
     C*RESTAR DET126 ZVDCO
     C                   SUB       DET126        ZVDCO
     C* CUOTAS DISTRIBUIDAS C.O.
     C*RESTAR ZTV057 ZCUCO
     C                   SUB       ZTV057        ZCUCO
     C* TOTAL CUOTAS DISTRIBUIDAS
     C*SUMAR ZTV057 MOV057
     C                   ADD       ZTV057        MOV057
     C* VALOR DE INTERESES PAGADOS
     C*SUMAR DET126 ZMICOM
     C                   ADD       DET126        ZMICOM
     C* INTERESES F.G.P.M
     C*MOVER MOVS18 DET126
     C                   Z-ADD     DET126        MOVS18
     C* SALDO INT. FGPM
     C*LIMPIAR DET126
     C                   CLEAR                   DET126
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar fondo de garantía de pensión mínima                ==
     C*==                                                              ==
     C*==================================================================
     C     M14327        BEGSR
     C*SI ZVDCO > *CERO Y DETS95 > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     DETS95        ANDGT     *ZERO
     C* Saldo FGPM > Valor distrib.
     C*SI DETS95 >= ZVDCO
     C     DETS95        IFGE      ZVDCO
     C* Saldo FGPM
     C*RESTAR ZVDCO DETS95
     C                   SUB       ZVDCO         DETS95
     C* Valor mvto FGPM
     C*MOVER MOVV12 ZVDCO
     C                   Z-ADD     ZVDCO         MOVV12
     C* Cuotas mvto. FGPM
     C*MOVER MOV056 ZCUCO
     C                   Z-ADD     ZCUCO         MOV056
     C* Valor y cuotas distrib C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*SINO
     C                   ELSE
     C* Valor mvto FGPM
     C*MOVER MOVV12 DETS95
     C                   Z-ADD     DETS95        MOVV12
     C*CALCULAR (R) MOV056 = (DETS95 * ZCUCO)/ ZVDCO
     C     DETS95        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         MOV056
     C* Valor distribuido C.O.
     C*RESTAR MOVV12 ZVDCO
     C                   SUB       MOVV12        ZVDCO
     C* Cuotas distribuidas C.O.
     C*RESTAR MOV056 ZCUCO
     C                   SUB       MOV056        ZCUCO
     C* Saldo FGPM
     C*LIMPIAR DETS95
     C                   CLEAR                   DETS95
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Suma saldo a cancelar acuerdo
     C*SUMAR MOVV12 ZTOPAG
     C                   ADD       MOVV12        ZTOPAG
     C                   ENDSR
     C*==================================================================
     C*==  Calcular retención contingente                              ==
     C*==                                                              ==
     C*==================================================================
     C     M14330        BEGSR
     C* Valor retención contingente
     C*LIMPIAR ZVRECO MOVRET ZOVRET
     C                   CLEAR                   ZVRECO
     C                   CLEAR                   MOVRET
     C                   CLEAR                   ZOVRET
     C*SI MOVCO5 |= 0 O MOVCU3 |= 0 O MOVCO6 |= 0 O MOVCU4 |= 0
     C     MOVCO5        IFNE      0
     C     MOVCU3        ORNE      0
     C     MOVCO6        ORNE      0
     C     MOVCU4        ORNE      0
     C*  Si C.V.A > 0 y  retcotg > 0 ó C.V.E > 0 Y retcotg > 0
     C*SI DETCO1 |= 0 Y DETVA8 |= 0 O DETCO2 |= 0  Y DETVA8 |= 0
     C     DETCO1        IFNE      0
     C     DETVA8        ANDNE     0
     C     DETCO2        ORNE      0
     C     DETVA8        ANDNE     0
     C*
     C* Retención contingente proporcional al valor acreditado
     C*
     C*CALCULAR (R) ZVRECO = ZDTVA8 * (MOVCO5+MOVCO7+MOVCO6+MOVC27)/(DET
     C     MOVCO5        ADD       MOVCO7        V$CA1           030 9
     C     V$CA1         ADD       MOVCO6        V$CA1
     C     V$CA1         ADD       MOVC27        V$CA1
     C     ZDTVA8        MULT      V$CA1         V$CA1
     C     DETCO1        ADD       DETCO2        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVRECO
     C*
     C* Saldo de la retención contingente sin comisión
     C*CALCULAR (R) ZOVRET = ZVRECO * (MOVCO5+MOVCO6) / ( MOVCO5 + MOVCO
     C     MOVCO5        ADD       MOVCO6        V$CA1           030 9
     C     ZVRECO        MULT      V$CA1         V$CA1
     C     MOVCO5        ADD       MOVCO7        V$CA2           030 9
     C     V$CA2         ADD       MOVCO6        V$CA2
     C     V$CA2         ADD       MOVC27        V$CA2
     C     V$CA1         DIV(H)    V$CA2         ZOVRET
     C* Retención cont. sin decimal
     C*MOVER MOVRET ZOVRET
     C                   Z-ADD     ZOVRET        MOVRET
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar alto riesgo                                        ==
     C*==                                                              ==
     C*==================================================================
     C     M14335        BEGSR
     C*SI ZVDCO > *CERO Y DETS17 > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     DETS17        ANDGT     *ZERO
     C* Saldo A.R. > Valor distrib.
     C*SI DETS17 >= ZVDCO
     C     DETS17        IFGE      ZVDCO
     C* Saldo A.R.
     C*RESTAR ZVDCO DETS17
     C                   SUB       ZVDCO         DETS17
     C* Saldo C.O.
     C*RESTAR ZVDCO DETSA1
     C                   SUB       ZVDCO         DETSA1
     C* Valor movimiento A.R.
     C*MOVER MOVC24 ZVDCO
     C                   Z-ADD     ZVDCO         MOVC24
     C* Cuotas movimiento A.R.
     C*MOVER MOVC25 ZCUCO
     C                   Z-ADD     ZCUCO         MOVC25
     C* Valor y cuotas distrib. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*SINO
     C                   ELSE
     C* Saldo C.O.
     C*RESTAR DETS17 DETSA1
     C                   SUB       DETS17        DETSA1
     C* Valor movimiento A.R.
     C*MOVER MOVC24 DETS17
     C                   Z-ADD     DETS17        MOVC24
     C*CALCULAR (R) MOVC25 = (DETS17 * ZCUCO)/ ZVDCO
     C     DETS17        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         MOVC25
     C* Valor distribuido C.O.
     C*RESTAR MOVC24 ZVDCO
     C                   SUB       MOVC24        ZVDCO
     C* Cuotas distribuidas C.O.
     C*RESTAR MOVC25 ZCUCO
     C                   SUB       MOVC25        ZCUCO
     C* Saldo A.R.
     C*LIMPIAR DETS17
     C                   CLEAR                   DETS17
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Suma saldo a cancelar acuerdo
     C*SUMAR MOVC24 ZTOPAG
     C                   ADD       MOVC24        ZTOPAG
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar cotización obligatoria                             ==
     C*==                                                              ==
     C*==================================================================
     C     M14340        BEGSR
     C*SI ZVDCO > *CERO Y DETSA1 > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     DETSA1        ANDGT     *ZERO
     C* Saldo C.O. > Valor distrib.
     C*SI DETSA1 >= ZVDCO
     C     DETSA1        IFGE      ZVDCO
     C* Saldo C.O.
     C*RESTAR ZVDCO DETSA1
     C                   SUB       ZVDCO         DETSA1
     C* Valor movimiento C.O.
     C*MOVER MOVCOT ZVDCO
     C                   Z-ADD     ZVDCO         MOVCOT
     C* Cuotas movimiento C.O.
     C*MOVER MOVCUO ZCUCO
     C                   Z-ADD     ZCUCO         MOVCUO
     C* Valor y cuotas distrib. C.O.
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*SINO
     C                   ELSE
     C* Valor movimiento C.O.
     C*MOVER MOVCOT DETSA1
     C                   Z-ADD     DETSA1        MOVCOT
     C*CALCULAR (R) MOVCUO = (DETSA1 * ZCUCO)/ ZVDCO
     C     DETSA1        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         MOVCUO
     C* Valor distribuido C.O.
     C*RESTAR MOVCOT ZVDCO
     C                   SUB       MOVCOT        ZVDCO
     C* Cuotas distribuidas C.O.
     C*RESTAR MOVCUO ZCUCO
     C                   SUB       MOVCUO        ZCUCO
     C* Saldo C.O.
     C*LIMPIAR DETSA1
     C                   CLEAR                   DETSA1
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Suma saldo a cancelar acuerdo
     C*SUMAR MOVCOT ZTOPAG
     C                   ADD       MOVCOT        ZTOPAG
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar cotización voluntaria empleador                    ==
     C*==                                                              ==
     C*==================================================================
     C     M14345        BEGSR
     C*SI ZVDCO > *CERO Y DETSA7 > *CERO
     C     ZVDCO         IFGT      *ZERO
     C     DETSA7        ANDGT     *ZERO
     C* Saldo C.V.E.> Valor distrib.
     C*SI DETSA7 >= ZVDCO
     C     DETSA7        IFGE      ZVDCO
     C* Saldo C.V.E.
     C*RESTAR ZVDCO DETSA7
     C                   SUB       ZVDCO         DETSA7
     C* Valor movimiento C.V.E.
     C*MOVER MOVCO6 ZVDCO
     C                   Z-ADD     ZVDCO         MOVCO6
     C* Cuotas movimiento C.V.E.
     C*MOVER MOVCU4 ZCUCO
     C                   Z-ADD     ZCUCO         MOVCU4
     C* Valor y cuotas distrib. C.V.E
     C*LIMPIAR ZVDCO ZCUCO
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZCUCO
     C*SINO
     C                   ELSE
     C* Valor movimiento C.V.E.
     C*MOVER MOVCO6 DETSA7
     C                   Z-ADD     DETSA7        MOVCO6
     C*CALCULAR (R) MOVCU4 = (DETSA7 * ZCUCO)/ ZVDCO
     C     DETSA7        MULT      ZCUCO         V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDCO         MOVCU4
     C* Valor distribuido C.O.
     C*RESTAR MOVCO6 ZVDCO
     C                   SUB       MOVCO6        ZVDCO
     C* Cuotas distribuidas C.O.
     C*RESTAR MOVCU4 ZCUCO
     C                   SUB       MOVCU4        ZCUCO
     C* Saldo C.V.E.
     C*LIMPIAR DETSA7
     C                   CLEAR                   DETSA7
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Suma saldo a cancelar acuerdo
     C*SUMAR MOVCO6 ZTOPAG
     C                   ADD       MOVCO6        ZTOPAG
     C                   ENDSR
     C*==================================================================
     C*==  Calcular retención contingente para la deuda                ==
     C*==                                                              ==
     C*==================================================================
     C     M14350        BEGSR
     C* Valor retención contingente
     C*LIMPIAR ZVRECO MOVRET ZOVRET
     C                   CLEAR                   ZVRECO
     C                   CLEAR                   MOVRET
     C                   CLEAR                   ZOVRET
     C*SI MOVCO5 > 0 O MOVCU3 > 0 O MOVCO6 > 0 O MOVCU4 > 0
     C     MOVCO5        IFGT      0
     C     MOVCU3        ORGT      0
     C     MOVCO6        ORGT      0
     C     MOVCU4        ORGT      0
     C* Limpia var. de trabajo
     C*LIMPIAR ZALFA8 ZALFA5 ZINERE ZFITIP
     C                   CLEAR                   ZALFA8
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C                   CLEAR                   ZFITIP
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME2 ZNUME9 ZNUMI9
     C                   CLEAR                   ZNUME2
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUMR9 ZNUM21 ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM21
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* DETAR302
     C*PASAR ZENTID  '6'
     C                   MOVEL     '6'           ZENTID
     C* Planilla
     C*MOVER ZNUM12 DETNU9
     C                   Z-ADD     DETNU9        ZNUM12
     C* Página
     C*MOVER ZNUME3 DETPA2
     C                   Z-ADD     DETPA2        ZNUME3
     C* Secuencia
     C*MOVER ZNUMI3 DETSE4
     C                   Z-ADD     DETSE4        ZNUMI3
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C*SI ZINERE <> '1'
     C     ZINERE        IFNE      '1'
     C*
     C*  Si C.V.A > 0 y  retcotg > 0 ó C.V.E > 0 Y retcotg > 0
     C*SI ZNUME9 |= 0 Y ZNUMR9 |= 0 O ZNUMI9 |= 0  Y ZNUMR9 |= 0
     C     ZNUME9        IFNE      0
     C     ZNUMR9        ANDNE     0
     C     ZNUMI9        ORNE      0
     C     ZNUMR9        ANDNE     0
     C*
     C* Retención contingente proporcional al valor acreditado
     C*
     C*CALCULAR (R) ZVRECO = ZNUMR9 * (MOVCO5+MOVCO7+MOVCO6+MOVC27)/(ZNU
     C     MOVCO5        ADD       MOVCO7        V$CA1           030 9
     C     V$CA1         ADD       MOVCO6        V$CA1
     C     V$CA1         ADD       MOVC27        V$CA1
     C     ZNUMR9        MULT      V$CA1         V$CA1
     C     ZNUME9        ADD       ZNUMI9        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVRECO
     C*
     C* Saldo de la retención contingente sin comisión
     C*CALCULAR (R) ZOVRET = ZVRECO * (MOVCO5+MOVCO6) / ( MOVCO5 + MOVCO
     C     MOVCO5        ADD       MOVCO6        V$CA1           030 9
     C     ZVRECO        MULT      V$CA1         V$CA1
     C     MOVCO5        ADD       MOVCO7        V$CA2           030 9
     C     V$CA2         ADD       MOVCO6        V$CA2
     C     V$CA2         ADD       MOVC27        V$CA2
     C     V$CA1         DIV(H)    V$CA2         ZOVRET
     C* Retención cont. sin decimal
     C*MOVER MOVRET ZOVRET
     C                   Z-ADD     ZOVRET        MOVRET
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular comisiones y prima de seguros                      ==
     C*==                                                              ==
     C*==================================================================
     C     M14370        BEGSR
     C* Valor C.O.
     C*SI MOVCOT > *CERO
     C     MOVCOT        IFGT      *ZERO
     C*SI ZES13P=' '
     C     ZES13P        IFEQ      ' '
     C* Porcentaje comisión C.O.
     C*SI ZPCOCO > *CERO
     C     ZPCOCO        IFGT      *ZERO
     C* Planilla Z tomar porcentaje comision Z
     C*SI ZTIPLP = 'Z'
     C     ZTIPLP        IFEQ      'Z'
     C*CALCULAR (R) ZOVCOM = ( MOVCOT * ZPCOCO ) / 100
     C     MOVCOT        MULT      ZPCOCO        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVCOM
     C*SINO
     C                   ELSE
     C*CALCULAR (R) ZOVCOM = MOVCOT * ZPCOCO/(ZPCTCO-ZPFGPM)
     C     MOVCOT        MULT      ZPCOCO        V$CA1           030 9
     C     ZPCTCO        SUB       ZPFGPM        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZOVCOM
     C*FIN
     C                   END
     C* Comisión sin decimales
     C*MOVER MOVCOM ZOVCOM
     C                   Z-ADD     ZOVCOM        MOVCOM
     C*CALCULAR (R) MOVCU2 = MOVCOM * MOVCUO / MOVCOT
     C     MOVCOM        MULT      MOVCUO        V$CA1           030 9
     C     V$CA1         DIV(H)    MOVCOT        MOVCU2
     C*FIN
     C                   END
     C* Porcentaje prima seguros
     C*SI ZPORPS > *CERO
     C     ZPORPS        IFGT      *ZERO
     C*CALCULAR (R) ZOVVAL = MOVCOT * ZPORPS / (ZPCTCO-ZPFGPM)
     C     MOVCOT        MULT      ZPORPS        V$CA1           030 9
     C     ZPCTCO        SUB       ZPFGPM        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZOVVAL
     C* Prima seg. sin decimales
     C*MOVER MOVVAL ZOVVAL
     C                   Z-ADD     ZOVVAL        MOVVAL
     C*CALCULAR (R) MOVCU7 = MOVVAL * MOVCUO / MOVCOT
     C     MOVVAL        MULT      MOVCUO        V$CA1           030 9
     C     V$CA1         DIV(H)    MOVCOT        MOVCU7
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Valor C.O.
     C*CALCULAR MOVCOT = MOVCOT - MOVCOM - MOVVAL
     C     MOVCOT        SUB       MOVCOM        V$CA1           030 9
     C     V$CA1         SUB       MOVVAL        MOVCOT
     C* Cuotas C.O.
     C*CALCULAR MOVCUO = MOVCUO - MOVCU2 - MOVCU7
     C     MOVCUO        SUB       MOVCU2        V$CA1           030 9
     C     V$CA1         SUB       MOVCU7        MOVCUO
     C* Ajuste por redondeos en calculos
     C*SI MOVCUO<0 Y ZAPLDE='S'
     C     MOVCUO        IFLT      0
     C     ZAPLDE        ANDEQ     'S'
     C*CALCULAR MOVCU2=MOVCU2+MOVCUO
     C     MOVCU2        ADD       MOVCUO        MOVCU2
     C*LIMPIAR MOVCUO
     C                   CLEAR                   MOVCUO
     C*CALCULAR MOVCOM=MOVCOM+MOVCOT
     C     MOVCOM        ADD       MOVCOT        MOVCOM
     C*LIMPIAR MOVCOT
     C                   CLEAR                   MOVCOT
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI MOVCO5 > *CERO Y ZPORCV > *CERO
     C     MOVCO5        IFGT      *ZERO
     C     ZPORCV        ANDGT     *ZERO
     C* Valor comisión C.V.A.
     C*CALCULAR (R) ZOVCO7 = MOVCO5 * ZPORCV / 100
     C     MOVCO5        MULT      ZPORCV        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVCO7
     C* Comisión cva. sin decimal
     C*MOVER MOVCO7 ZOVCO7
     C                   Z-ADD     ZOVCO7        MOVCO7
     C*CALCULAR (R) MOVCU5 = MOVCO7 * MOVCU3 / MOVCO5
     C     MOVCO7        MULT      MOVCU3        V$CA1           030 9
     C     V$CA1         DIV(H)    MOVCO5        MOVCU5
     C* Valor C.V.A
     C*RESTAR MOVCO7 MOVCO5
     C                   SUB       MOVCO7        MOVCO5
     C* Cuotas C.V.A
     C*RESTAR MOVCU5 MOVCU3
     C                   SUB       MOVCU5        MOVCU3
     C*FIN
     C                   END
     C*SI MOVCO6 > *CERO Y ZPORCV > *CERO
     C     MOVCO6        IFGT      *ZERO
     C     ZPORCV        ANDGT     *ZERO
     C* Valor comisión C.V.E.
     C*CALCULAR (R) ZOVC27 = MOVCO6 * ZPORCV / 100
     C     MOVCO6        MULT      ZPORCV        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVC27
     C* Comisión cve. sin decimal
     C*MOVER MOVC27 ZOVC27
     C                   Z-ADD     ZOVC27        MOVC27
     C*CALCULAR (R) MOVC28 = MOVC27 * MOVCU4 / MOVCO6
     C     MOVC27        MULT      MOVCU4        V$CA1           030 9
     C     V$CA1         DIV(H)    MOVCO6        MOVC28
     C* Valor C.V.E.
     C*RESTAR MOVC27 MOVCO6
     C                   SUB       MOVC27        MOVCO6
     C* Cuotas C.VE.
     C*RESTAR MOVC28 MOVCU4
     C                   SUB       MOVC28        MOVCU4
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza detalle de deuda y deuda                          ==
     C*==                                                              ==
     C*==================================================================
     C     M14375        BEGSR
     C*
     C* SAE
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C*CALCULAR ZDEUDE = ZDEUDE-(DETSA1+DETSA4+DETSA3+DETSA7+DETS95+DETS
     C     DETSA1        ADD       DETSA4        V$CA1           030 9
     C     V$CA1         ADD       DETSA3        V$CA1
     C     V$CA1         ADD       DETSA7        V$CA1
     C     V$CA1         ADD       DETS95        V$CA1
     C     V$CA1         ADD       DETS97        V$CA1
     C     ZDEUDE        SUB       V$CA1         ZDEUDE
     C*PASAR ZSIGNO '-'
     C                   MOVEL     '-'           ZSIGNO
     C*SAE
     C*LLAMAR TRINCE64(DETTIP DETNU9 DETPA2 DETSE4 DETNR1 ZDEUDE ZSIGNO
     C                   CALL      'TRINCE64'
     C                   PARM                    DETTIP
     C                   PARM                    DETNU9
     C                   PARM                    DETPA2
     C                   PARM                    DETSE4
     C                   PARM                    DETNR1
     C                   PARM                    ZDEUDE
     C                   PARM                    ZSIGNO
     C                   PARM                    ZERCON
     C* ERROR CONCURRENCIA EN TRINCE64
     C*SI ZERCON = '1'
     C     ZERCON        IFEQ      '1'
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C* Rollback
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C* Finaliza proceso
     C*LLAMAR TRCTPR51 (FUNCIO ZMODO ZNRTRA)
     C                   CALL      'TRCTPR51'
     C                   PARM                    FUNCIO
     C                   PARM                    ZMODO
     C                   PARM                    ZNRTRA
     C*TERMINAR
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C*CALCULAR ZSALDD = DETSA1 + DETSA4 + DETSA3 + DETSA7 + DETS07 + DE
     C     DETSA1        ADD       DETSA4        V$CA1           030 9
     C     V$CA1         ADD       DETSA3        V$CA1
     C     V$CA1         ADD       DETSA7        V$CA1
     C     V$CA1         ADD       DETS07        V$CA1
     C     V$CA1         ADD       DETSA5        V$CA1
     C     V$CA1         ADD       DETS95        V$CA1
     C     V$CA1         ADD       DETS96        V$CA1
     C     V$CA1         ADD       DETS97        V$CA1
     C     V$CA1         ADD       DETS98        V$CA1
     C     V$CA1         ADD       DET120        V$CA1
     C     V$CA1         ADD       DET125        V$CA1
     C     V$CA1         ADD       DET126        V$CA1
     C     V$CA1         ADD       DET127        ZSALDD
     C* Saldo del detalle
     C*SI ZSALDD = *CERO
     C     ZSALDD        IFEQ      *ZERO
     C* Estado cancelado
     C*PASAR DETEST 'CAN'
     C                   MOVEL     'CAN'         DETEST
     C*SINO
     C                   ELSE
     C* Estado pagado
     C*PASAR DETEST 'PAG'
     C                   MOVEL     'PAG'         DETEST
     C*FIN
     C                   END
     C* es acuerdo no liquida intereses y variable encendida.
     C*SI ZCUTIP='1' Y  ZINDMS='S' Y ZINDE2 = ' '
     C     ZCUTIP        IFEQ      '1'
     C     ZINDMS        ANDEQ     'S'
     C     ZINDE2        ANDEQ     ' '
     C*LIMPIAR ZNROFP
     C                   CLEAR                   ZNROFP
     C*SQL
     C/EXEC SQL
     C+  SELECT COUNT(*) INTO :ZNROFP FROM FECAR4
     C+  WHERE FECCOD =:ZCUCOD AND  FECIDE=:ZCUIDE
     C/END-EXEC
     C* Fechas de acuerdo es 1
     C*SI ZNROFP = 1
     C     ZNROFP        IFEQ      1
     C*  Restringido
     C*PASAR DETSUB 'RES'
     C                   MOVEL     'RES'         DETSUB
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* si ACU es liq o liq definitiva y marcar deudas
     C*SI ZINDMS ='S' Y ZINDE2='1'
     C     ZINDMS        IFEQ      'S'
     C     ZINDE2        ANDEQ     '1'
     C*  Restringido
     C*PASAR DETSUB 'RES'
     C                   MOVEL     'RES'         DETSUB
     C*FIN
     C                   END
     C* Causal anulación deuda
     C*PASAR DETC56 'A23'
     C                   MOVEL     'A23'         DETC56
     C* Fecha sistema ult. modif.
     C*PASAR DETF05 ZFESIS
     C                   MOVEL     ZFESIS        DETF05
     C* Fecha fondo último estado
     C*PASAR DETFE2 HISFE3
     C                   MOVEL     HISFE3        DETFE2
     C* Usuario
     C*PASAR DETUS3 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        DETUS3
     C* No ha consultado empleador
     C*SI ZEMPAR = 0
     C     ZEMPAR        IFEQ      0
     C* No vuelve a consultar empleador.
     C*MOVER ZEMPAR 1
     C                   Z-ADD     1             ZEMPAR
     C* Aux subestado
     C*LIMPIAR ZETSUB
     C                   CLEAR                   ZETSUB
     C* SQLCOD antes.
     C*MOVER SQLCOZ SQLCOD
     C                   Z-ADD     SQLCOD        SQLCOZ
     C* Ind apertura de cursor
     C*PASAR ZINSQC ' '
     C                   MOVEL     ' '           ZINSQC
     C*SQL
     C/EXEC SQL
     C+  SELECT COALESCE(MAX(EMPI20), ' ')  INTO :ZMPI20
     C+  FROM EMPAR2
     C+  WHERE
     C+  EMPNU2 = :DETID2 AND EMPTI1 = :DETTI6
     C/END-EXEC
     C* ILOCALIZADO.
     C*SI ZMPI20 = 'N'
     C     ZMPI20        IFEQ      'N'
     C* SUBESTADO
     C*PASAR ZETSUB 'ILO'
     C                   MOVEL     'ILO'         ZETSUB
     C*SINO
     C                   ELSE
     C* SE DESMARCA SUBESTADO, ES LOCALIZAD
     C*LIMPIAR ZETSUB
     C                   CLEAR                   ZETSUB
     C*FIN
     C                   END
     C* SQLCOD despues.
     C*MOVER SQLCOD SQLCOZ
     C                   Z-ADD     SQLCOZ        SQLCOD
     C*FIN
     C                   END
     C* Ilocalizado
     C*CASO DETSUB = *BLANCO O DETSUB = 'ILO'
     C                   SELECT
     C     DETSUB        WHENEQ    *BLANK
     C     DETSUB        OREQ      'ILO'
     C* Sub estado de deuda
     C*PASAR DETSUB ZETSUB
     C                   MOVEL     ZETSUB        DETSUB
     C*FINCASOS
     C                   ENDSL
     C* Desarrollo esp activo
     C*SI ZR9072 = 1
     C     ZR9072        IFEQ      1
     C* Actualizar arc  acuerdo de pago
     C*EJECUTAR M00021
     C                   EXSR      M00021
     C*FIN
     C                   END
     C* Validar sentencia judicial
     C*LLAMAR TRSENT51 (PLACOD AFINUM DETPER ZNROSE ZINDAS)
     C                   CALL      'TRSENT51'
     C                   PARM                    PLACOD
     C                   PARM                    AFINUM
     C                   PARM                    DETPER
     C                   PARM                    ZNROSE
     C                   PARM                    ZINDAS
     C* Si esta en sentencia
     C*SI ZINDAS='S'
     C     ZINDAS        IFEQ      'S'
     C* Acreditación
     C*PASAR ZTILLA '1'
     C                   MOVEL     '1'           ZTILLA
     C*LLAMAR TRSENT54(ZTILLA MOVPLA MOVNU2 PLACOD AFINUM ZNROSE ZFECDE
     C                   CALL      'TRSENT54'
     C                   PARM                    ZTILLA
     C                   PARM                    MOVPLA
     C                   PARM                    MOVNU2
     C                   PARM                    PLACOD
     C                   PARM                    AFINUM
     C                   PARM                    ZNROSE
     C                   PARM                    ZFECDE
     C                   PARM                    ZTOPAG
     C*FIN
     C                   END
     C*SI ZT@002 ]= '2' O ZT@002 = '2' Y ZT@004 = *BLANCO
     C     ZT@002        IFNE      '2'
     C     ZT@002        OREQ      '2'
     C     ZT@004        ANDEQ     *BLANK
     C*GRABAR DETAR201
     C     *IN48         IFEQ      '0'
     C                   UPDATE    DETRE101                             94
     C                   ELSE
     C                   WRITE     DETRE101                             94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SINO
     C                   ELSE
     C*GRABAR DETAR2
     C     *IN47         IFEQ      '0'
     C                   UPDATE    DETRE1                               94
     C                   ELSE
     C                   WRITE     DETRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C*
     C*CALCULAR ZVALOR = MOVCOT + MOVCOM + MOVVAL + MOVC24 + MOVCO5 + MO
     C     MOVCOT        ADD       MOVCOM        V$CA1           030 9
     C     V$CA1         ADD       MOVVAL        V$CA1
     C     V$CA1         ADD       MOVC24        V$CA1
     C     V$CA1         ADD       MOVCO5        V$CA1
     C     V$CA1         ADD       MOVCO7        V$CA1
     C     V$CA1         ADD       MOVCO6        V$CA1
     C     V$CA1         ADD       MOVC27        V$CA1
     C     V$CA1         ADD       MOVCO8        V$CA1
     C     V$CA1         ADD       MOVV12        V$CA1
     C     V$CA1         ADD       MOVV13        ZVALOR
     C* Saldo deuda
     C*RESTAR ZVALOR DEUSAL
     C                   SUB       ZVALOR        DEUSAL
     C* Saldo intereses
     C*CALCULAR DEUSA1 = DEUSA1 - MOVINT - MOVIN2 - MOVI05 - MOVI06 + ZM
     C     DEUSA1        SUB       MOVINT        V$CA1           030 9
     C     V$CA1         SUB       MOVIN2        V$CA1
     C     V$CA1         SUB       MOVI05        V$CA1
     C     V$CA1         SUB       MOVI06        V$CA1
     C     V$CA1         ADD       ZMICOM        DEUSA1
     C* Saldo intereses compuestos
     C*CALCULAR DEUS03 = DEUS03 - ZMICOM
     C     DEUS03        SUB       ZMICOM        DEUS03
     C*CALCULAR ZVRPAD = ZVRPAD + ZVALOR + MOVINT + MOVIN2 + MOVI05 + MO
     C     ZVRPAD        ADD       ZVALOR        V$CA1           030 9
     C     V$CA1         ADD       MOVINT        V$CA1
     C     V$CA1         ADD       MOVIN2        V$CA1
     C     V$CA1         ADD       MOVI05        V$CA1
     C     V$CA1         ADD       MOVI06        ZVRPAD
     C*CALCULAR ZCUPAD = ZCUPAD+MOVCUO+MOVCU2+MOVCU7+MOVC25+MOVCU3+MOVCU
     C     ZCUPAD        ADD       MOVCUO        V$CA1           030 9
     C     V$CA1         ADD       MOVCU2        V$CA1
     C     V$CA1         ADD       MOVCU7        V$CA1
     C     V$CA1         ADD       MOVC25        V$CA1
     C     V$CA1         ADD       MOVCU3        V$CA1
     C     V$CA1         ADD       MOVCU5        V$CA1
     C     V$CA1         ADD       MOVCU4        V$CA1
     C     V$CA1         ADD       MOVC28        V$CA1
     C     V$CA1         ADD       MOVCU8        V$CA1
     C     V$CA1         ADD       MOVCU6        V$CA1
     C     V$CA1         ADD       MOVC16        V$CA1
     C     V$CA1         ADD       MOV056        V$CA1
     C     V$CA1         ADD       MOV057        V$CA1
     C     V$CA1         ADD       MOV058        V$CA1
     C     V$CA1         ADD       MOV059        ZCUPAD
     C                   ENDSR
     C*==================================================================
     C*==  Acumula valores por concepto del movimiento                 ==
     C*==                                                              ==
     C*==================================================================
     C     M14380        BEGSR
     C* Valor movimiento C.O.
     C*SUMAR MOVCOT ZVMCO
     C                   ADD       MOVCOT        ZVMCO
     C* Valor movimineto comis. C.O.
     C*SUMAR MOVCOM ZVMCCO
     C                   ADD       MOVCOM        ZVMCCO
     C* Valor movimiento prima seg.
     C*SUMAR MOVVAL ZVMPS
     C                   ADD       MOVVAL        ZVMPS
     C* Valor movimiento A.R.
     C*SUMAR MOVC24 ZVMAR
     C                   ADD       MOVC24        ZVMAR
     C* valor movimiento C.V.A.
     C*SUMAR MOVCO5 ZVMCVA
     C                   ADD       MOVCO5        ZVMCVA
     C* Valor movimiento comis. CVA
     C*SUMAR MOVCO7 ZVMCCA
     C                   ADD       MOVCO7        ZVMCCA
     C* Valor movimiento C.V.E.
     C*SUMAR MOVCO6 ZVMCVE
     C                   ADD       MOVCO6        ZVMCVE
     C* Valor movimiento comis. CVE
     C*SUMAR MOVC27 ZVMCCE
     C                   ADD       MOVC27        ZVMCCE
     C* Valor movimiento intereses
     C*SUMAR MOVINT ZVMINT
     C                   ADD       MOVINT        ZVMINT
     C* Valor movimiento rendimientos
     C*SUMAR MOVVA4 ZVMREN
     C                   ADD       MOVVA4        ZVMREN
     C* Si no existe en FSPARC
     C*SI ZEXFSP <> 'S'
     C     ZEXFSP        IFNE      'S'
     C* Valor movimiento F.S.
     C*SUMAR MOVCO8 ZVMFS
     C                   ADD       MOVCO8        ZVMFS
     C* Valor movimiento I.F.S.
     C*SUMAR MOVIN2 ZVMIFS
     C                   ADD       MOVIN2        ZVMIFS
     C* Valor movimiento SFSP
     C*SUMAR MOVV13 ZVMSFS
     C                   ADD       MOVV13        ZVMSFS
     C* Valor movimiento int SFSP
     C*SUMAR MOVI06 ZVMISF
     C                   ADD       MOVI06        ZVMISF
     C* Cuotas movimiento F.S.
     C*SUMAR MOVCU8 ZCMFS
     C                   ADD       MOVCU8        ZCMFS
     C* Cuotas movimineto I.F.S.
     C*SUMAR MOVC16 ZCMIFS
     C                   ADD       MOVC16        ZCMIFS
     C* Valor cuotas SFSP
     C*SUMAR MOV058 ZCMSFS
     C                   ADD       MOV058        ZCMSFS
     C* Valor cuotas int SFSP
     C*SUMAR MOV059 ZCMISF
     C                   ADD       MOV059        ZCMISF
     C*SINO
     C                   ELSE
     C* Si existe en FSPARC la transaccionalidad será la diferencia
     C* entre el MOVARC y FSPARC en caso de que haya aumentado el IBC
     C*SI MOVCO8 > ZZAFSP
     C     MOVCO8        IFGT      ZZAFSP
     C*CALCULAR ZVMFS  = ZVMFS  + (MOVCO8 - ZZAFSP)
     C     MOVCO8        SUB       ZZAFSP        V$CA1           030 9
     C     ZVMFS         ADD       V$CA1         ZVMFS
     C*FIN
     C                   END
     C*SI MOVIN2 > ZVIFSP
     C     MOVIN2        IFGT      ZVIFSP
     C*CALCULAR ZVMIFS = ZVMIFS + (MOVIN2 - ZVIFSP)
     C     MOVIN2        SUB       ZVIFSP        V$CA1           030 9
     C     ZVMIFS        ADD       V$CA1         ZVMIFS
     C*FIN
     C                   END
     C*SI MOVV13 > ZVZFSP
     C     MOVV13        IFGT      ZVZFSP
     C*CALCULAR ZVMSFS = ZVMSFS + (MOVV13 - ZVZFSP)
     C     MOVV13        SUB       ZVZFSP        V$CA1           030 9
     C     ZVMSFS        ADD       V$CA1         ZVMSFS
     C*FIN
     C                   END
     C*SI MOVI06 > ZVISUB
     C     MOVI06        IFGT      ZVISUB
     C*CALCULAR ZVMISF = ZVMISF + (MOVI06 - ZVISUB)
     C     MOVI06        SUB       ZVISUB        V$CA1           030 9
     C     ZVMISF        ADD       V$CA1         ZVMISF
     C*FIN
     C                   END
     C*SI MOVCU8 > ZZUFSP
     C     MOVCU8        IFGT      ZZUFSP
     C*CALCULAR ZCMFS  = ZCMFS  + (MOVCU8 - ZZUFSP)
     C     MOVCU8        SUB       ZZUFSP        V$CA1           030 9
     C     ZCMFS         ADD       V$CA1         ZCMFS
     C*FIN
     C                   END
     C*SI MOVC16 > ZCIFSP
     C     MOVC16        IFGT      ZCIFSP
     C*CALCULAR ZCMIFS = ZCMIFS + (MOVC16 - ZCIFSP)
     C     MOVC16        SUB       ZCIFSP        V$CA1           030 9
     C     ZCMIFS        ADD       V$CA1         ZCMIFS
     C*FIN
     C                   END
     C*SI MOV058 > ZCSFSP
     C     MOV058        IFGT      ZCSFSP
     C*CALCULAR ZCMSFS = ZCMSFS + (MOV058 - ZCSFSP)
     C     MOV058        SUB       ZCSFSP        V$CA1           030 9
     C     ZCMSFS        ADD       V$CA1         ZCMSFS
     C*FIN
     C                   END
     C*SI MOV059 > ZCISUB
     C     MOV059        IFGT      ZCISUB
     C*CALCULAR ZCMISF = ZCMISF + (MOV059 - ZCISUB)
     C     MOV059        SUB       ZCISUB        V$CA1           030 9
     C     ZCMISF        ADD       V$CA1         ZCMISF
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Cuotas movimineto C.O.
     C*SUMAR MOVCUO ZCMCO
     C                   ADD       MOVCUO        ZCMCO
     C* Cuotas movimiento comis. C.O.
     C*SUMAR MOVCU2 ZCMCCO
     C                   ADD       MOVCU2        ZCMCCO
     C* Cuotas movimiento prima SEG.
     C*SUMAR MOVCU7 ZCMPS
     C                   ADD       MOVCU7        ZCMPS
     C* Cuotas movimiento A.R.
     C*SUMAR MOVC25 ZCMAR
     C                   ADD       MOVC25        ZCMAR
     C* Cuotas movimiento C.V.A.
     C*SUMAR MOVCU3 ZCMCVA
     C                   ADD       MOVCU3        ZCMCVA
     C* Cuotas movimiento comis. CVA
     C*SUMAR MOVCU5 ZCMCCA
     C                   ADD       MOVCU5        ZCMCCA
     C* Cuotas movimiento C.V.E.
     C*SUMAR MOVCU4 ZCMCVE
     C                   ADD       MOVCU4        ZCMCVE
     C* Cuotas movimiento comis. CVE
     C*SUMAR MOVC28 ZCMCCE
     C                   ADD       MOVC28        ZCMCCE
     C* Cuotas movimiento intereses
     C*SUMAR MOVCU6 ZCMINT
     C                   ADD       MOVCU6        ZCMINT
     C* Cuotas movimiento rendimiento
     C*SUMAR MOVC19 ZCMREN
     C                   ADD       MOVC19        ZCMREN
     C* Retención contingente
     C*SUMAR MOVRET ZVRRET
     C                   ADD       MOVRET        ZVRRET
     C* Valor movimiento FGPM
     C*SUMAR MOVV12 ZVMFGP
     C                   ADD       MOVV12        ZVMFGP
     C* Valor movimiento int FGPM
     C*SUMAR MOVI05 ZVMIFG
     C                   ADD       MOVI05        ZVMIFG
     C* Cuotas movimiento FGPM
     C*SUMAR MOV056 ZCMFGP
     C                   ADD       MOV056        ZCMFGP
     C* Int movimiento cuotas FGPM
     C*SUMAR MOV057 ZCMIFG
     C                   ADD       MOV057        ZCMIFG
     C                   ENDSR
     C*==================================================================
     C*==  Actualizar cuenta del afiliado                              ==
     C*==                                                              ==
     C*==================================================================
     C     M14385        BEGSR
     C*SI ZT@001<>*BLANCO Y ZT@003<>*BLANCO Y ZT@004=*BLANCO Y ZT@002='3
     C     ZT@001        IFNE      *BLANK
     C     ZT@003        ANDNE     *BLANK
     C     ZT@004        ANDEQ     *BLANK
     C     ZT@002        ANDEQ     '3'
     C* Solo recupera cta para 1er depósito
     C*SI L=1
     C     L             IFEQ      1
     C* Código interno afil
     C*MOVER CUENUM AFINUM
     C                   Z-ADD     AFINUM        CUENUM
     C* Código fondo moderado
     C*PASAR CUEC17 ZFONDO
     C                   MOVEL     ZFONDO        CUEC17
     C*RECUPERARD CUEARC (CUENUM CUEC17)
     C     LL$108        KLIST
     C                   KFLD                    CUENUM
     C                   KFLD                    CUEC17
     C     LL$108        CHAIN     CUEARC                             4594
     C                   MOVE      *IN94         I$RND
     C     *IN45         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   CUEREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Ya leyó CUEARC por rezagos 1er vez
     C*MOVER ZCUERZ 1
     C                   Z-ADD     1             ZCUERZ
     C*SINO
     C                   ELSE
     C*MOVER ZPLAER PLANUM
     C                   MOVE      PLANUM        ZPLAER
     C*MOVER ZAFIIN CUENUM
     C                   CLEAR                   ZAFIIN
     C                   MOVE      CUENUM        ZAFIIN
     C*OBTENER (1) ZERROR = 'CUEARC no disponible - M14385' || ZPLAER ||
     C                   CLEAR                   H$1
     C     $HIL(081)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR<>'1'
     C     ZSALIR        IFNE      '1'
     C* Valor C.O.
     C*CALCULAR CUEVAL = CUEVAL + MOVCOT + MOVC24
     C     CUEVAL        ADD       MOVCOT        V$CA1           030 9
     C     V$CA1         ADD       MOVC24        CUEVAL
     C* Cuotas C.O.
     C*CALCULAR CUECUO = CUECUO + MOVCUO + MOVC25
     C     CUECUO        ADD       MOVCUO        V$CA1           030 9
     C     V$CA1         ADD       MOVC25        CUECUO
     C* Cuotas C.V.A.
     C*SUMAR MOVCU3 CUECU1
     C                   ADD       MOVCU3        CUECU1
     C* Valor C.V.E.
     C*SUMAR MOVCO6 CUEVA1
     C                   ADD       MOVCO6        CUEVA1
     C* Cuotas C.V.E.
     C*SUMAR MOVCU4 CUECU2
     C                   ADD       MOVCU4        CUECU2
     C* Valor Intereses
     C*CALCULAR CUEVA2 = CUEVA2 + MOVINT
     C     CUEVA2        ADD       MOVINT        CUEVA2
     C* Cuotas intereses
     C*CALCULAR CUECU3 = CUECU3 + MOVCU6
     C     CUECU3        ADD       MOVCU6        CUECU3
     C* Valor C.V.A.
     C*SUMAR MOVCO5 CUESA2
     C                   ADD       MOVCO5        CUESA2
     C* Valor comisión C.V.A.
     C*SUMAR MOVCO7 CUETOT
     C                   ADD       MOVCO7        CUETOT
     C* Valor rendimientos
     C*SUMAR MOVVA4 CUEVA7
     C                   ADD       MOVVA4        CUEVA7
     C* Cuotas rendimientos
     C*SUMAR MOVC19 CUECU9
     C                   ADD       MOVC19        CUECU9
     C* Saldo retención conting
     C*SUMAR MOVRET CUESAL
     C                   ADD       MOVRET        CUESAL
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Generar movimiento de deuda                                 ==
     C*==                                                              ==
     C*==================================================================
     C     M14391        BEGSR
     C* Fecha del fondo
     C*MOVER MOVF03 HISFE3
     C                   MOVE      HISFE3        MOVF03
     C* Transacción
     C*MOVER MOVC13 ZCODTX
     C                   MOVE      ZCODTX        MOVC13
     C* Concepto
     C*MOVER MOVTI3 ZCONCE
     C                   MOVE      ZCONCE        MOVTI3
     C* Tipo de deuda
     C*MOVER MOVTI2 DEUTIP
     C                   MOVE      DEUTIP        MOVTI2
     C* Número de planilla
     C*MOVER MOVNU4 DEUNUM
     C                   Z-ADD     DEUNUM        MOVNU4
     C* Nit del empleador
     C*MOVER MOVNIT DEUNRO
     C                   Z-ADD     DEUNRO        MOVNIT
     C* Fecha de inicio de deuda
     C*PASAR MOVF04 DEUFE6
     C                   MOVEL     DEUFE6        MOVF04
     C* Proceso que generó el registro
     C*MOVER MOVC26 28
     C                   Z-ADD     28            MOVC26
     C*AGREGAR MOVAR2
     C                   WRITE     MOVRE3                               94
     C                   MOVE      *IN94         I$DUP
     C                   ENDSR
     C*==================================================================
     C*==  Graba deuda cancelada                                       ==
     C*==                                                              ==
     C*==================================================================
     C     M14392        BEGSR
     C* Estado
     C*SI DEUSAL = *CERO Y DEUSA1 = *CERO Y DEUS03 = *CERO
     C     DEUSAL        IFEQ      *ZERO
     C     DEUSA1        ANDEQ     *ZERO
     C     DEUS03        ANDEQ     *ZERO
     C* Deuda por liquidación erronea
     C*SI DEUTIP = '01' O DEUTIP = '05' O DEUTIP = '07'
     C     DEUTIP        IFEQ      '01'
     C     DEUTIP        OREQ      '05'
     C     DEUTIP        OREQ      '07'
     C* Estado cancelada
     C*ASIGNAR DEUEST 'CAN'
     C                   MOVEL     'CAN'         DEUEST
     C*SINO
     C                   ELSE
     C* Estado anulada
     C*ASIGNAR DEUEST 'AND'
     C                   MOVEL     'AND'         DEUEST
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Estado pagada
     C*ASIGNAR DEUEST 'PAG'
     C                   MOVEL     'PAG'         DEUEST
     C*FIN
     C                   END
     C* Fecha sistema
     C*ASIGNAR DEUFE1 ZFESIS
     C                   MOVEL     ZFESIS        DEUFE1
     C* Fecha sistema
     C*ASIGNAR DEUFE3 ZFESIS
     C                   MOVEL     ZFESIS        DEUFE3
     C* Usuario
     C*ASIGNAR DEUUSU USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        DEUUSU
     C* Fecha fondo
     C*ASIGNAR DEUFE5 HISFE3
     C                   MOVEL     HISFE3        DEUFE5
     C* No ha consultado empleador
     C*SI ZEMPAR = 0
     C     ZEMPAR        IFEQ      0
     C* No vuelve a consultar empleador.
     C*MOVER ZEMPAR 1
     C                   Z-ADD     1             ZEMPAR
     C* aux subestado
     C*LIMPIAR ZETSUB
     C                   CLEAR                   ZETSUB
     C* SQLCOD antes.
     C*MOVER SQLCOZ SQLCOD
     C                   Z-ADD     SQLCOD        SQLCOZ
     C*SQL
     C/EXEC SQL
     C+  SELECT COALESCE(MAX(EMPI20), ' ')  INTO :ZMPI20
     C+  FROM EMPAR2
     C+  WHERE
     C+  EMPNU2 = :DETID2 AND EMPTI1 = :DETTI6
     C/END-EXEC
     C* ILOCALIZADO.
     C*SI ZMPI20 = 'N'
     C     ZMPI20        IFEQ      'N'
     C* SUBESTADO
     C*PASAR ZETSUB 'ILO'
     C                   MOVEL     'ILO'         ZETSUB
     C*SINO
     C                   ELSE
     C* SE DESMARCA SUBESTADO, ES LOCALIZAD
     C*LIMPIAR ZETSUB
     C                   CLEAR                   ZETSUB
     C*FIN
     C                   END
     C* SQLCOD despues.
     C*MOVER SQLCOD SQLCOZ
     C                   Z-ADD     SQLCOZ        SQLCOD
     C*FIN
     C                   END
     C*Subest ILO para PAG
     C*SI DEUSUB='ILO' Y DEUEST='PAG' O DEUSUB=*BLANCOS Y DEUEST='PAG'
     C     DEUSUB        IFEQ      'ILO'
     C     DEUEST        ANDEQ     'PAG'
     C     DEUSUB        OREQ      *BLANKS
     C     DEUEST        ANDEQ     'PAG'
     C* Sub estado ENCABEZADO
     C*PASAR DEUSUB ZETSUB
     C                   MOVEL     ZETSUB        DEUSUB
     C*FIN
     C                   END
     C*SI ZT@002 ]= '2'
     C     ZT@002        IFNE      '2'
     C* Planilla canc. de deuda con planilla a corregir
     C*SI PLAT03 = '02' Y PLAN05 ]= *CERO O PLAT03 = '10' Y PLAN05 ]= *C
     C     PLAT03        IFEQ      '02'
     C     PLAN05        ANDNE     *ZERO
     C     PLAT03        OREQ      '10'
     C     PLAN05        ANDNE     *ZERO
     C*GRABAR DEUARC
     C     *IN50         IFEQ      '0'
     C                   UPDATE    DEUREG                               94
     C                   ELSE
     C                   WRITE     DEUREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SINO
     C                   ELSE
     C* Situado o hospital
     C*SI ZTIPAG = '04' O ZTIPAG = '05' Y ZGRDSF = '0'
     C     ZTIPAG        IFEQ      '04'
     C     ZTIPAG        OREQ      '05'
     C     ZGRDSF        ANDEQ     '0'
     C*GRABAR DEUARC10
     C     *IN83         IFEQ      '0'
     C                   UPDATE    DEUREG10                             94
     C                   ELSE
     C                   WRITE     DEUREG10                             94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Planilla normal
     C*SINO
     C                   ELSE
     C* Si esta leyendo otras AFPS
     C*SI ZACRCD = '2' Y ZFDARC = 'N'
     C     ZACRCD        IFEQ      '2'
     C     ZFDARC        ANDEQ     'N'
     C* Cancela deudas otras AFPS
     C*GRABAR DEUARC
     C     *IN50         IFEQ      '0'
     C                   UPDATE    DEUREG                               94
     C                   ELSE
     C                   WRITE     DEUREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SINO
     C                   ELSE
     C*GRABAR DEUARC08
     C     *IN53         IFEQ      '0'
     C                   UPDATE    DEUREG08                             94
     C                   ELSE
     C                   WRITE     DEUREG08                             94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*GRABAR DEUARC
     C     *IN50         IFEQ      '0'
     C                   UPDATE    DEUREG                               94
     C                   ELSE
     C                   WRITE     DEUREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C* Ind. grabar DEUARC10
     C*LIMPIAR ZGRDSF ZTIPAG
     C                   CLEAR                   ZGRDSF
     C                   CLEAR                   ZTIPAG
     C                   ENDSR
     C*==================================================================
     C*==  Mover datos movimiento de acreditación                      ==
     C*==                                                              ==
     C*==================================================================
     C     M14395        BEGSR
     C*INICIARUI MOVARC06 (ZFONDO PLANU1 DETPAG DETSEC)
     C     LL$109        KLIST
     C                   KFLD                    ZFONDO
     C                   KFLD                    PLANU1
     C                   KFLD                    DETPAG
     C                   KFLD                    DETSEC
     C     LL$109        SETLL     MOVARC06                               68
     C     *IN68         IFEQ      '1'
     C     LL$109        SETGT     MOVARC06                           68
     C                   MOVE      '0'           *IN68
     C                   ELSE
     C                   MOVE      '1'           *IN68
     C                   END
     C* Calcula último consecutivo
     C*EJECUTAR M14035
     C                   EXSR      M14035
     C* Valida DETA68
     C*EJECUTAR M81000
     C                   EXSR      M81000
     C* Mover datos detalle de plan.
     C*EJECUTAR M14038
     C                   EXSR      M14038
     C* Valor movimiento C.O
     C*MOVER MOVCOT ZVDCO
     C                   Z-ADD     ZVDCO         MOVCOT
     C* Valor movimiento A.R.
     C*MOVER MOVC24 ZVDAR
     C                   Z-ADD     ZVDAR         MOVC24
     C* Valor movimiento C.V.A.
     C*MOVER MOVCO5 ZVDCVA
     C                   Z-ADD     ZVDCVA        MOVCO5
     C* Valor movimiento C.V.E.
     C*MOVER MOVCO6 ZVDCVE
     C                   Z-ADD     ZVDCVE        MOVCO6
     C* Vlr mvto int.
     C*MOVER MOVINT ZVDINT
     C                   Z-ADD     ZVDINT        MOVINT
     C* Valor movimiento Rendimientos
     C*MOVER MOVVA4 ZVDREN
     C                   Z-ADD     ZVDREN        MOVVA4
     C*SI ZPDSFS <> *CERO
     C     ZPDSFS        IFNE      *ZERO
     C* Valor movimiento F.S
     C*CALCULAR (R) ZOVCO8 =(ZVDFS*ZPDSFS)/100
     C     ZVDFS         MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVCO8
     C* Valor movimiento int.F.S.P
     C*CALCULAR (R) ZOVIN2 =(ZVDIFS*ZPDSFS)/100
     C     ZVDIFS        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZOVIN2
     C* Valor movimiento F.S.P.
     C*MOVER MOVCO8 ZOVCO8
     C                   Z-ADD     ZOVCO8        MOVCO8
     C* Valor movimiento int. F.S.P
     C*MOVER MOVIN2 ZOVIN2
     C                   Z-ADD     ZOVIN2        MOVIN2
     C* Cuotas movimiento F.S.P
     C*CALCULAR (R) MOVCU8 =(ZCUFS*ZPDSFS)/100
     C     ZCUFS         MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           MOVCU8
     C* Cuotas movimiento int F.S.P
     C*CALCULAR (R) MOVC16=(ZCUIFS*ZPDSFS)/100
     C     ZCUIFS        MULT      ZPDSFS        V$CA1           030 9
     C     V$CA1         DIV(H)    100           MOVC16
     C*SINO
     C                   ELSE
     C* Valor movimiento F.S
     C*CALCULAR MOVCO8 = ZVDFS
     C                   Z-ADD     ZVDFS         MOVCO8
     C* Valor movimiento int. F.S.P
     C*CALCULAR MOVIN2 = ZVDIFS
     C                   Z-ADD     ZVDIFS        MOVIN2
     C* Cuotas movimiento F.S.P
     C*CALCULAR MOVCU8 = ZCUFS
     C                   Z-ADD     ZCUFS         MOVCU8
     C* Cuotas movimiento int F.S.P
     C*CALCULAR MOVC16 = ZCUIFS
     C                   Z-ADD     ZCUIFS        MOVC16
     C*FIN
     C                   END
     C* Cuotas movimiento C.O.
     C*MOVER MOVCUO ZCUCO
     C                   Z-ADD     ZCUCO         MOVCUO
     C* Cuotas movimiento A.R.
     C*MOVER MOVC25 ZCUAR
     C                   Z-ADD     ZCUAR         MOVC25
     C* Cuotas movimiento C.V.A.
     C*MOVER MOVCU3 ZCUCVA
     C                   Z-ADD     ZCUCVA        MOVCU3
     C* Cuotas movimiento C.V.E.
     C*MOVER MOVCU4 ZCUCVE
     C                   Z-ADD     ZCUCVE        MOVCU4
     C* Cuotas mvto int.
     C*MOVER MOVCU6 ZCUINT
     C                   Z-ADD     ZCUINT        MOVCU6
     C* Cuotas movimiento Rendimient.
     C*MOVER MOVC19 ZCUREN
     C                   Z-ADD     ZCUREN        MOVC19
     C*FGPM
     C* Valor FGPM
     C*MOVER MOVV12 ZVDFGP
     C                   Z-ADD     ZVDFGP        MOVV12
     C* Cuotas FGPM
     C*MOVER MOV056 ZCUFGP
     C                   Z-ADD     ZCUFGP        MOV056
     C* Intereses FGPM
     C*MOVER MOVI05 ZVDIFG
     C                   Z-ADD     ZVDIFG        MOVI05
     C* Int. cuotas FGPM
     C*MOVER MOV057 ZCUIFG
     C                   Z-ADD     ZCUIFG        MOV057
     C*SFSP
     C* Valor SFSP
     C*CALCULAR ZOVV13 = ZVDSFS+(ZVDFS-MOVCO8)
     C     ZVDFS         SUB       MOVCO8        V$CA1           030 9
     C     ZVDSFS        ADD       V$CA1         ZOVV13
     C* Valor mov. SFSP sin decimal
     C*MOVER MOVV13 ZOVV13
     C                   Z-ADD     ZOVV13        MOVV13
     C* Cuotas SFSP
     C*CALCULAR MOV058 = ZCUSFS+(ZCUFS-MOVCU8)
     C     ZCUFS         SUB       MOVCU8        V$CA1           030 9
     C     ZCUSFS        ADD       V$CA1         MOV058
     C* Intereses SFSP
     C*CALCULAR ZOVI06 = ZVDISF+(ZVDIFS-MOVIN2)
     C     ZVDIFS        SUB       MOVIN2        V$CA1           030 9
     C     ZVDISF        ADD       V$CA1         ZOVI06
     C* Valor int. SFSP sin decimal
     C*MOVER MOVI06 ZOVI06
     C                   Z-ADD     ZOVI06        MOVI06
     C* Int. cuotas SFSP
     C*CALCULAR MOV059 = ZCUISF+(ZCUIFS-MOVC16)
     C     ZCUIFS        SUB       MOVC16        V$CA1           030 9
     C     ZCUISF        ADD       V$CA1         MOV059
     C* Si está marcado en DETA68
     C*SI ZMARCA = 'S'
     C     ZMARCA        IFEQ      'S'
     C* Tipo de pago '01'
     C*PASAR MOVT10 '01'
     C                   MOVEL     '01'          MOVT10
     C*SINO
     C                   ELSE
     C* Tipo de pago de planilla
     C*PASAR MOVT10 PLAT03
     C                   MOVEL     PLAT03        MOVT10
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcula total distribuido detalle                           ==
     C*==                                                              ==
     C*==================================================================
     C     M14400        BEGSR
     C* Total distr. C.O.
     C*CALCULAR ZTDCO = ZTDCO+MOVCOT+MOVCOM+MOVVAL
     C     ZTDCO         ADD       MOVCOT        V$CA1           030 9
     C     V$CA1         ADD       MOVCOM        V$CA1
     C     V$CA1         ADD       MOVVAL        ZTDCO
     C* total distribuido C.V.A.
     C*CALCULAR ZTDCVA = ZTDCVA + MOVCO5 + MOVCO7
     C     ZTDCVA        ADD       MOVCO5        V$CA1           030 9
     C     V$CA1         ADD       MOVCO7        ZTDCVA
     C* Total distribuido C.V.E.
     C*CALCULAR ZTDCVE = ZTDCVE + MOVCO6 + MOVC27
     C     ZTDCVE        ADD       MOVCO6        V$CA1           030 9
     C     V$CA1         ADD       MOVC27        ZTDCVE
     C* Total distribuido A.R.
     C*SUMAR MOVC24 ZTDAR
     C                   ADD       MOVC24        ZTDAR
     C* Totas distr. F.S.
     C*SUMAR ZVDFS  ZTDFS
     C                   ADD       ZVDFS         ZTDFS
     C* Total distribuido FGPM
     C*SUMAR MOVV12 ZTDFGP
     C                   ADD       MOVV12        ZTDFGP
     C* Total distribuido SFSP
     C*SUMAR ZVDSFS ZTDSFS
     C                   ADD       ZVDSFS        ZTDSFS
     C*
     C* Total distribuido FG
     C*SUMAR ZVDIFG ZTDIFG
     C                   ADD       ZVDIFG        ZTDIFG
     C* Total distribuido FSP
     C*SUMAR ZVDIFS ZTDIFS
     C                   ADD       ZVDIFS        ZTDIFS
     C* Total distribuido SFSP
     C*SUMAR ZVDISF ZTDISF
     C                   ADD       ZVDISF        ZTDISF
     C* Total distribuido int.
     C*SUMAR ZVDINT ZTDINT
     C                   ADD       ZVDINT        ZTDINT
     C                   ENDSR
     C*==================================================================
     C*==  Procesa planilla de terceros bien pagada                    ==
     C*==                                                              ==
     C*==================================================================
     C     M14550        BEGSR
     C* Valor C.V.A.
     C*SI DETCO1 <> *CERO
     C     DETCO1        IFNE      *ZERO
     C* Valor C.V.A.
     C*MOVER ZVDCVA DETCO1
     C                   Z-ADD     DETCO1        ZVDCVA
     C*CALCULAR (R) ZCUCVA = (ZVDCVA * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOT
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDCVA        MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUCVA
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUCVA ZCUDIT
     C                   ADD       ZCUCVA        ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDCVA ZTOTER
     C                   ADD       ZVDCVA        ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUCVA ZCTDIS
     C                   SUB       ZCUCVA        ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDCVA ZVTDIS
     C                   SUB       ZVDCVA        ZVTDIS
     C*FIN
     C                   END
     C*
     C* Existe saldo en el depósito
     C*SI ZVTDIS > *CERO Y DETCTA <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     DETCTA        ANDNE     *ZERO
     C* Alcanza para cubrir subsist.
     C*SI DETCTA > ZCOTSF
     C     DETCTA        IFGT      ZCOTSF
     C* Cot. fondo solidaridad
     C*CALCULAR (R) ZVRFSP =DETCTA - ZCOTSF
     C     DETCTA        SUB(H)    ZCOTSF        ZVRFSP
     C* Cotización subistencia
     C*MOVER ZVRSFS ZCOTSF
     C                   Z-ADD     ZCOTSF        ZVRSFS
     C*SINO
     C                   ELSE
     C* Si existe deuda
     C*SI DETIN3='2' Y ZCOTSF>DETCTA
     C     DETIN3        IFEQ      '2'
     C     ZCOTSF        ANDGT     DETCTA
     C* Pasa todo a subistencia
     C*MOVER ZVRFSP DETCTA
     C                   Z-ADD     DETCTA        ZVRFSP
     C* Cero para F.S
     C*LIMPIAR ZVRSFS
     C                   CLEAR                   ZVRSFS
     C*SINO
     C                   ELSE
     C* Pasa todo a subistencia
     C*MOVER ZVRSFS DETCTA
     C                   Z-ADD     DETCTA        ZVRSFS
     C* Cero para F.S
     C*LIMPIAR ZVRFSP
     C                   CLEAR                   ZVRFSP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZVRFSP < ZVTDIS Y ZVRFSP <> *CERO
     C     ZVRFSP        IFLT      ZVTDIS
     C     ZVRFSP        ANDNE     *ZERO
     C* Valor distribuido F.S
     C*MOVER ZVDFS ZVRFSP
     C                   Z-ADD     ZVRFSP        ZVDFS
     C*CALCULAR (R) ZCUFS = (ZVDFS * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOTER
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDFS         MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUFS
     C*SINO
     C                   ELSE
     C* Valor distribuido F.S
     C*MOVER ZVDFS ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDFS
     C* Cuotas distruidas F.S
     C*MOVER ZCUFS ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUFS
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUFS ZCUDIT
     C                   ADD       ZCUFS         ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDFS ZTOTER
     C                   ADD       ZVDFS         ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUFS ZCTDIS
     C                   SUB       ZCUFS         ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDFS ZVTDIS
     C                   SUB       ZVDFS         ZVTDIS
     C*
     C* Existe saldo en depósito
     C*SI ZVTDIS > *CERO Y ZVRSFS <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     ZVRSFS        ANDNE     *ZERO
     C* Valor Subsistencia
     C*SI ZVRSFS < ZVTDIS
     C     ZVRSFS        IFLT      ZVTDIS
     C* Valor Subsistencia
     C*MOVER ZVDSFS ZVRSFS
     C                   Z-ADD     ZVRSFS        ZVDSFS
     C*CALCULAR (R) ZCUSFS = (ZVDSFS * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOT
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDSFS        MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUSFS
     C*SINO
     C                   ELSE
     C* Valor Subsistencia
     C*MOVER ZVDSFS ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDSFS
     C* Cuotas subsistencia
     C*MOVER ZCUSFS ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUSFS
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUSFS ZCUDIT
     C                   ADD       ZCUSFS        ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDSFS ZTOTER
     C                   ADD       ZVDSFS        ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUSFS ZCTDIS
     C                   SUB       ZCUSFS        ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDSFS ZVTDIS
     C                   SUB       ZVDSFS        ZVTDIS
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Si reportó C.O
     C*SI DETCOT <> *CERO
     C     DETCOT        IFNE      *ZERO
     C* Reportado por C.O
     C*MOVER ZVRDCO DETCOT
     C                   Z-ADD     DETCOT        ZVRDCO
     C* Existe saldo en el depósito
     C*SI ZVTDIS > *CERO Y ZCOTFG <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     ZCOTFG        ANDNE     *ZERO
     C* Alcanza para cubrir F.G.P.M
     C*SI ZVRDCO > ZCOTFG
     C     ZVRDCO        IFGT      ZCOTFG
     C* Valor FGPM
     C*MOVER ZVRDFG ZCOTFG
     C                   Z-ADD     ZCOTFG        ZVRDFG
     C* Cotización obligatoria
     C*CALCULAR (R) ZVRDCO=ZVRDCO-ZCOTFG
     C     ZVRDCO        SUB(H)    ZCOTFG        ZVRDCO
     C*SINO
     C                   ELSE
     C* Toda la cotización para FGP
     C*MOVER ZVRDFG ZVRDCO
     C                   Z-ADD     ZVRDCO        ZVRDFG
     C*LIMPIAR ZVRDCO
     C                   CLEAR                   ZVRDCO
     C*FIN
     C                   END
     C* Valor F.G.P.M
     C*SI ZVRDFG < ZVTDIS Y ZVRDFG <> *CERO
     C     ZVRDFG        IFLT      ZVTDIS
     C     ZVRDFG        ANDNE     *ZERO
     C* Valor F.G.P.M
     C*MOVER ZVDFGP ZVRDFG
     C                   Z-ADD     ZVRDFG        ZVDFGP
     C*CALCULAR (R) ZCUFGP = (ZVDFGP * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOT
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDFGP        MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUFGP
     C*SINO
     C                   ELSE
     C* Valor F.G.P.M
     C*MOVER ZVDFGP ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDFGP
     C* Cuotas F.G.P.M
     C*MOVER ZCUFGP ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUFGP
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUFGP ZCUDIT
     C                   ADD       ZCUFGP        ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDFGP ZTOTER
     C                   ADD       ZVDFGP        ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUFGP ZCTDIS
     C                   SUB       ZCUFGP        ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDFGP ZVTDIS
     C                   SUB       ZVDFGP        ZVTDIS
     C*FIN
     C                   END
     C*
     C* Existe saldo en el depósito
     C*SI ZVTDIS > *CERO Y ZCOTAR <> *CERO Y ZVRDCO <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     ZCOTAR        ANDNE     *ZERO
     C     ZVRDCO        ANDNE     *ZERO
     C* Alcanza para cubrir A.R
     C*SI ZVRDCO > ZCOTAR
     C     ZVRDCO        IFGT      ZCOTAR
     C* Valor A.R
     C*MOVER ZVRCAR ZCOTAR
     C                   Z-ADD     ZCOTAR        ZVRCAR
     C* Cotización obligatoria
     C*CALCULAR (R) ZVRDCO=ZVRDCO-ZVRCAR
     C     ZVRDCO        SUB(H)    ZVRCAR        ZVRDCO
     C*SINO
     C                   ELSE
     C* Toda la cotización para A.R
     C*MOVER ZVRCAR ZVRDCO
     C                   Z-ADD     ZVRDCO        ZVRCAR
     C*LIMPIAR ZVRDCO
     C                   CLEAR                   ZVRDCO
     C*FIN
     C                   END
     C* Valor alto riesgo
     C*SI ZVRCAR < ZVTDIS Y ZVRCAR <> *CERO
     C     ZVRCAR        IFLT      ZVTDIS
     C     ZVRCAR        ANDNE     *ZERO
     C* Valor alto riesgo
     C*MOVER ZVDAR ZVRCAR
     C                   Z-ADD     ZVRCAR        ZVDAR
     C*CALCULAR (R) ZCUAR = (ZVDAR * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOTER
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDAR         MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUAR
     C*SINO
     C                   ELSE
     C* Valor alto riesgo
     C*MOVER ZVDAR ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDAR
     C* Cuotas alto riesgo
     C*MOVER ZCUAR ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUAR
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUAR  ZCUDIT
     C                   ADD       ZCUAR         ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDAR  ZTOTER
     C                   ADD       ZVDAR         ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUAR ZCTDIS
     C                   SUB       ZCUAR         ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDAR ZVTDIS
     C                   SUB       ZVDAR         ZVTDIS
     C*FIN
     C                   END
     C*
     C* Existe saldo en el depósito
     C*SI ZVTDIS > *CERO Y ZVRDCO <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     ZVRDCO        ANDNE     *ZERO
     C* Valor C.O
     C*SI ZVRDCO < ZVTDIS
     C     ZVRDCO        IFLT      ZVTDIS
     C* Valor C.O
     C*MOVER ZVDCO ZVRDCO
     C                   Z-ADD     ZVRDCO        ZVDCO
     C*CALCULAR (R) ZCUCO = (ZVDCO * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOTER
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDCO         MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUCO
     C*SINO
     C                   ELSE
     C* Vlor C.O
     C*MOVER ZVDCO ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDCO
     C* Cuotas C.O
     C*MOVER ZCUCO ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUCO
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUCO  ZCUDIT
     C                   ADD       ZCUCO         ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDCO  ZTOTER
     C                   ADD       ZVDCO         ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUCO ZCTDIS
     C                   SUB       ZCUCO         ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDCO ZVTDIS
     C                   SUB       ZVDCO         ZVTDIS
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Total reportado cubre int.
     C*SI ZINPIN <> 'N'
     C     ZINPIN        IFNE      'N'
     C* Existe saldo en el depósito
     C*SI ZVTDIS > *CERO Y ZINIFG <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     ZINIFG        ANDNE     *ZERO
     C* Valor I.F.G.P.M
     C*SI ZINIFG < ZVTDIS
     C     ZINIFG        IFLT      ZVTDIS
     C* Valor I.F.G.P.M
     C*MOVER ZVDIFG ZINIFG
     C                   Z-ADD     ZINIFG        ZVDIFG
     C*CALCULAR (R) ZCUIFG = (ZVDIFG * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOT
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDIFG        MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUIFG
     C*SINO
     C                   ELSE
     C* Valor I.F.G.P.M
     C*MOVER ZVDIFG ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDIFG
     C* Cuotas I.F.G.P.M
     C*MOVER ZCUIFG ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUIFG
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUIFG ZCUDIT
     C                   ADD       ZCUIFG        ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDIFG ZTOTER
     C                   ADD       ZVDIFG        ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUIFG ZCTDIS
     C                   SUB       ZCUIFG        ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDIFG ZVTDIS
     C                   SUB       ZVDIFG        ZVTDIS
     C*FIN
     C                   END
     C*
     C* Existe saldo en el depósito
     C*SI ZVTDIS > *CERO Y ZINIFS <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     ZINIFS        ANDNE     *ZERO
     C* Valor I.F.S
     C*SI ZINIFS < ZVTDIS
     C     ZINIFS        IFLT      ZVTDIS
     C* Valor I.F.S
     C*MOVER ZVDIFS ZINIFS
     C                   Z-ADD     ZINIFS        ZVDIFS
     C*CALCULAR (R) ZCUIFS = (ZVDIFS * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOT
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDIFS        MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUIFS
     C*SINO
     C                   ELSE
     C* Valor I.F.S
     C*MOVER ZVDIFS ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDIFS
     C* Cuotas I.F.S
     C*MOVER ZCUIFS ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUIFS
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUIFS ZCUDIT
     C                   ADD       ZCUIFS        ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDIFS ZTOTER
     C                   ADD       ZVDIFS        ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUIFS ZCTDIS
     C                   SUB       ZCUIFS        ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDIFS ZVTDIS
     C                   SUB       ZVDIFS        ZVTDIS
     C*FIN
     C                   END
     C*
     C* Existe saldo en el depósito
     C*SI ZVTDIS > *CERO Y ZINISF <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     ZINISF        ANDNE     *ZERO
     C* Valor I. Subsistencia
     C*SI ZINISF < ZVTDIS
     C     ZINISF        IFLT      ZVTDIS
     C* Valor Int. subsistencia
     C*MOVER ZVDISF ZINISF
     C                   Z-ADD     ZINISF        ZVDISF
     C*CALCULAR (R) ZCUISF = (ZVDISF * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOT
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDISF        MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUISF
     C*SINO
     C                   ELSE
     C* Valor Int. subsistencia
     C*MOVER ZVDISF ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDISF
     C* Cuotas Int. subsistencia
     C*MOVER ZCUISF ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUISF
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUISF ZCUDIT
     C                   ADD       ZCUISF        ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDISF ZTOTER
     C                   ADD       ZVDISF        ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUISF ZCTDIS
     C                   SUB       ZCUISF        ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDISF ZVTDIS
     C                   SUB       ZVDISF        ZVTDIS
     C*FIN
     C                   END
     C*
     C* Existe saldo en el depósito
     C*SI ZVTDIS > *CERO Y ZININT <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     ZININT        ANDNE     *ZERO
     C* Valor intereses
     C*SI ZININT < ZVTDIS
     C     ZININT        IFLT      ZVTDIS
     C* Valor F.G.P.M
     C*MOVER ZVDINT ZININT
     C                   Z-ADD     ZININT        ZVDINT
     C*CALCULAR (R) ZCUINT = (ZVDINT * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOT
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDINT        MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUINT
     C*SINO
     C                   ELSE
     C* Valor F.G.P.M
     C*MOVER ZVDINT ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDINT
     C* Cuotas F.G.P.M
     C*MOVER ZCUINT ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUINT
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUINT ZCUDIT
     C                   ADD       ZCUINT        ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDINT ZTOTER
     C                   ADD       ZVDINT        ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUINT ZCTDIS
     C                   SUB       ZCUINT        ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDINT ZVTDIS
     C                   SUB       ZVDINT        ZVTDIS
     C*FIN
     C                   END
     C*
     C* Existe saldo en el depósito
     C*SI ZVTDIS > *CERO Y ZINCVA <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     ZINCVA        ANDNE     *ZERO
     C* Valor intereses C.V.A
     C*SI ZINCVA < ZVTDIS
     C     ZINCVA        IFLT      ZVTDIS
     C* Valor intereses C.V.A
     C*MOVER ZVDIVA ZINCVA
     C                   Z-ADD     ZINCVA        ZVDIVA
     C*CALCULAR (R) ZCUIVA = (ZVDIVA * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOT
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDIVA        MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUIVA
     C*SINO
     C                   ELSE
     C* Valor intereses C.V.A
     C*MOVER ZVDIVA ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDIVA
     C* Cuotas intereses C.V.A
     C*MOVER ZCUIVA ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUIVA
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUIVA ZCUDIT
     C                   ADD       ZCUIVA        ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDIVA ZTOTER
     C                   ADD       ZVDIVA        ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUIVA ZCTDIS
     C                   SUB       ZCUIVA        ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDIVA ZVTDIS
     C                   SUB       ZVDIVA        ZVTDIS
     C*FIN
     C                   END
     C*
     C* Existe saldo en el depósito
     C*SI ZVTDIS > *CERO Y ZINCVE <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     ZINCVE        ANDNE     *ZERO
     C* Valor intereses C.V.E
     C*SI ZINCVE < ZVTDIS
     C     ZINCVE        IFLT      ZVTDIS
     C* Valor intereses C.V.E
     C*MOVER ZVDIVE ZINCVE
     C                   Z-ADD     ZINCVE        ZVDIVE
     C*CALCULAR (R) ZCUIVE = (ZVDIVE * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOT
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDIVE        MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUIVE
     C*SINO
     C                   ELSE
     C* Valor intereses C.V.E
     C*MOVER ZVDIVE ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDIVE
     C* Cuotas intereses C.V.E
     C*MOVER ZCUIVE ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUIVE
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUIVE ZCUDIT
     C                   ADD       ZCUIVE        ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDIVE ZTOTER
     C                   ADD       ZVDIVE        ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUIVE ZCTDIS
     C                   SUB       ZCUIVE        ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDIVE ZVTDIS
     C                   SUB       ZVDIVE        ZVTDIS
     C*FIN
     C                   END
     C*
     C* Existe saldo en el depósito
     C*SI ZVTDIS > *CERO Y ZINNAR <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     ZINNAR        ANDNE     *ZERO
     C* Valor intereses A.R
     C*SI ZINNAR < ZVTDIS
     C     ZINNAR        IFLT      ZVTDIS
     C* Valor intereses A.R
     C*MOVER ZVDIAR ZINNAR
     C                   Z-ADD     ZINNAR        ZVDIAR
     C*CALCULAR (R) ZCUIAR = (ZVDIAR * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOT
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDIAR        MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUIAR
     C*SINO
     C                   ELSE
     C* Valor intereses A.R
     C*MOVER ZVDIAR ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDIAR
     C* Cuotas intereses A.R.
     C*MOVER ZCUIAR ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUIAR
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUIAR ZCUDIT
     C                   ADD       ZCUIAR        ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDIAR ZTOTER
     C                   ADD       ZVDIAR        ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUIAR ZCTDIS
     C                   SUB       ZCUIAR        ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDIAR ZVTDIS
     C                   SUB       ZVDIAR        ZVTDIS
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C* Existe saldo en el depósito
     C*SI ZVTDIS > *CERO Y DETV14 <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     DETV14        ANDNE     *ZERO
     C* Valor Rendimientos
     C*SI DETV14 < ZVTDIS
     C     DETV14        IFLT      ZVTDIS
     C* Valor Rendimientos
     C*MOVER ZVDREN DETV14
     C                   Z-ADD     DETV14        ZVDREN
     C*CALCULAR (R) ZCUREN = (ZVDREN * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOT
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDREN        MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUREN
     C*SINO
     C                   ELSE
     C* Valor Rendimientos
     C*MOVER ZVDREN ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDREN
     C* Cuotas rendimientos
     C*MOVER ZCUREN ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUREN
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUREN ZCUDIT
     C                   ADD       ZCUREN        ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDREN ZTOTER
     C                   ADD       ZVDREN        ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUREN ZCTDIS
     C                   SUB       ZCUREN        ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDREN ZVTDIS
     C                   SUB       ZVDREN        ZVTDIS
     C*FIN
     C                   END
     C*
     C* Existe saldo en el depósito
     C*SI ZVTDIS > *CERO Y DETCO2 <> *CERO
     C     ZVTDIS        IFGT      *ZERO
     C     DETCO2        ANDNE     *ZERO
     C* Valor C.V.E
     C*SI DETCO2 < ZVTDIS
     C     DETCO2        IFLT      ZVTDIS
     C* Valor C.V.E
     C*MOVER ZVDCVE DETCO2
     C                   Z-ADD     DETCO2        ZVDCVE
     C*CALCULAR (R) ZCUCVE= (ZVDCVE * (ZCUTER - ZCUDIT))/(ZTOSUM - ZTOTE
     C     ZCUTER        SUB       ZCUDIT        V$CA1           030 9
     C     ZVDCVE        MULT      V$CA1         V$CA1
     C     ZTOSUM        SUB       ZTOTER        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUCVE
     C*SINO
     C                   ELSE
     C* Valor C.V.E
     C*MOVER ZVDCVE ZVTDIS
     C                   Z-ADD     ZVTDIS        ZVDCVE
     C* Cuotas C.V.E
     C*MOVER ZCUCVE ZCTDIS
     C                   Z-ADD     ZCTDIS        ZCUCVE
     C*FIN
     C                   END
     C* Cuotas distribuidas terceros
     C*SUMAR ZCUCVE ZCUDIT
     C                   ADD       ZCUCVE        ZCUDIT
     C* Total procesado terceros
     C*SUMAR ZVDCVE ZTOTER
     C                   ADD       ZVDCVE        ZTOTER
     C* Cuotas disp. distr.
     C*RESTAR ZCUCVE ZCTDIS
     C                   SUB       ZCUCVE        ZCTDIS
     C* Vlr disp. distrib.
     C*RESTAR ZVDCVE ZVTDIS
     C                   SUB       ZVDCVE        ZVTDIS
     C*FIN
     C                   END
     C*
     C* Total intereses
     C*CALCULAR ZVINTE = ZININT + ZINCVA + ZINCVE + ZINNAR
     C     ZININT        ADD       ZINCVA        V$CA1           030 9
     C     V$CA1         ADD       ZINCVE        V$CA1
     C     V$CA1         ADD       ZINNAR        ZVINTE
     C                   ENDSR
     C*==================================================================
     C*==  Valida novedad simulada - SIMAR1                            ==
     C*==                                                              ==
     C*==================================================================
     C     M14900        BEGSR
     C*SI ZR3422 = 1
     C     ZR3422        IFEQ      1
     C*LIMPIAR $$SIMR
     C                   CLEAR                   $$SIMR
     C* Número lote planilla
     C*PASAR ZSMLOT DETNUM
     C                   MOVEL     DETNUM        ZSMLOT
     C* Número de planilla
     C*MOVER ZSMPLA DETNU3
     C                   Z-ADD     DETNU3        ZSMPLA
     C* Pagina de planilla
     C*MOVER ZSMPAG DETPAG
     C                   Z-ADD     DETPAG        ZSMPAG
     C* Secuencia de planilla
     C*MOVER ZSMSEC DETSEC
     C                   Z-ADD     DETSEC        ZSMSEC
     C* Acción Consultar
     C*PASAR ZSMACC 'C'
     C                   MOVEL     'C'           ZSMACC
     C*LLAMAR RPSIMX50($$SIMR)
     C                   CALL      'RPSIMX50'
     C                   PARM                    $$SIMR
     C*SI ZSMERR = '0' Y ZSMNOV <> *BLANCO
     C     ZSMERR        IFEQ      '0'
     C     ZSMNOV        ANDNE     *BLANK
     C*CASO ZNORET = 'X' Y ZSMNOV = 'I'
     C                   SELECT
     C     ZNORET        WHENEQ    'X'
     C     ZSMNOV        ANDEQ     'I'
     C* Novedad Ingreso
     C*PASAR ZNOING 'X'
     C                   MOVEL     'X'           ZNOING
     C* Novedad Retiro
     C*PASAR ZNORET 'X'
     C                   MOVEL     'X'           ZNORET
     C*CASO ZSMNOV = 'I'
     C     ZSMNOV        WHENEQ    'I'
     C* Novedad Ingreso
     C*PASAR ZNOING 'X'
     C                   MOVEL     'X'           ZNOING
     C*SINO
     C                   OTHER
     C* Novedad Ingreso
     C*PASAR ZNOING 'X'
     C                   MOVEL     'X'           ZNOING
     C* Novedad Retiro
     C*PASAR ZNORET 'X'
     C                   MOVEL     'X'           ZNORET
     C*FINCASOS
     C                   ENDSL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Generar encabezados e históricos                            ==
     C*==                                                              ==
     C*==================================================================
     C     M15000        BEGSR
     C* Evaluar si hay deuda o P.E.
     C*SI ZEVALU <> 'N'
     C     ZEVALU        IFNE      'N'
     C* Generar encabezado de deuda
     C*EJECUTAR M15010
     C                   EXSR      M15010
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Generar encabezado P.E.
     C*EJECUTAR M15020
     C                   EXSR      M15020
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Evaluar tipo de transacción
     C*EJECUTAR M15005
     C                   EXSR      M15005
     C* Genera histórico acred.C.V.A.
     C*SI ZVMCVA > *CERO O ZCMCVA > *CERO
     C     ZVMCVA        IFGT      *ZERO
     C     ZCMCVA        ORGT      *ZERO
     C* Concepto
     C*PASAR ZCONCE '02'
     C                   MOVEL     '02'          ZCONCE
     C* Valor valor movimiento C.V.A.
     C*MOVER ZVALHI ZVMCVA
     C                   Z-ADD     ZVMCVA        ZVALHI
     C* Cuotas movimiento C.V.A.
     C*MOVER ZCUOHI ZCMCVA
     C                   Z-ADD     ZCMCVA        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C* Acumulado valor rep. totales
     C*SUMAR ZVMCVA ZVAVAA
     C                   ADD       ZVMCVA        ZVAVAA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCMCVA ZCUVAA
     C                   ADD       ZCMCVA        ZCUVAA
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico acred.X FSP
     C*SI ZVMFS > *CERO O ZCMFS > *CERO
     C     ZVMFS         IFGT      *ZERO
     C     ZCMFS         ORGT      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '05'
     C                   MOVEL     '05'          ZCONCE
     C* FSP valor
     C*MOVER ZVALHI ZVMFS
     C                   Z-ADD     ZVMFS         ZVALHI
     C* FSP cuotas
     C*MOVER ZCUOHI ZCMFS
     C                   Z-ADD     ZCMFS         ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C* Acumulado valor rep. totales
     C*SUMAR ZVALHI ZVAFSA
     C                   ADD       ZVALHI        ZVAFSA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCUOHI ZCUFSA
     C                   ADD       ZCUOHI        ZCUFSA
     C* Ind de PAGAR1
     C*PASAR ZINPAG 'FS'
     C                   MOVEL     'FS'          ZINPAG
     C* Actualiza PAGAR1
     C*EJECUTAR M15040
     C                   EXSR      M15040
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico acred.X INT FSP
     C*SI ZVMIFS |= *CERO O ZCMIFS |= *CERO
     C     ZVMIFS        IFNE      *ZERO
     C     ZCMIFS        ORNE      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '10'
     C                   MOVEL     '10'          ZCONCE
     C* Int FSP valor
     C*MOVER ZVALHI ZVMIFS
     C                   Z-ADD     ZVMIFS        ZVALHI
     C* Int. FSP cuotas
     C*MOVER ZCUOHI ZCMIFS
     C                   Z-ADD     ZCMIFS        ZCUOHI
     C* Genera histórico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Acumulado valor rep. totales
     C*SUMAR ZVALHI ZVAISA
     C                   ADD       ZVALHI        ZVAISA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCUOHI ZCUISA
     C                   ADD       ZCUOHI        ZCUISA
     C* Ind de PAGAR1
     C*PASAR ZINPAG 'IF'
     C                   MOVEL     'IF'          ZINPAG
     C* Actualiza PAGAR1
     C*EJECUTAR M15040
     C                   EXSR      M15040
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico II
     C*EJECUTAR M15050
     C                   EXSR      M15050
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico III
     C*EJECUTAR M15060
     C                   EXSR      M15060
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico IV
     C*EJECUTAR M15070
     C                   EXSR      M15070
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*SI ZT@002<>'3'
     C     ZT@002        IFNE      '3'
     C* Verificacion redondeo 0.00000001
     C*EJECUTAR M15169
     C                   EXSR      M15169
     C*SINO
     C                   ELSE
     C* Verificacion redondeo 0.00000001
     C*EJECUTAR M15169
     C                   EXSR      M15169
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Evaluar tipo de transacción                                 ==
     C*==                                                              ==
     C*==================================================================
     C     M15005        BEGSR
     C* Acreditación por recaudo
     C*SI ZT@002 = '1'
     C     ZT@002        IFEQ      '1'
     C*MOVER ZCODTX '02'
     C                   MOVE      '02'          ZCODTX
     C*SINO
     C                   ELSE
     C*SI ZT@002 = '2'
     C     ZT@002        IFEQ      '2'
     C* Acreditación canc. deuda
     C*MOVER ZCODTX '04'
     C                   MOVE      '04'          ZCODTX
     C*SINO
     C                   ELSE
     C* Acreditación rezago
     C*MOVER ZCODTX '05'
     C                   MOVE      '05'          ZCODTX
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Genera històrico                                            ==
     C*==                                                              ==
     C*==================================================================
     C     M15008        BEGSR
     C* Llama a programa que genera hisar4
     C* Actualizar HISAR4
     C*EJECUTAR M00055
     C                   EXSR      M00055
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*SI ZCODTX = '02' O ZCODTX = '05' O ZCODTX = '04' Y ZCONCE ='34' O
     C     ZCODTX        IFEQ      '02'
     C     ZCODTX        OREQ      '05'
     C     ZCODTX        OREQ      '04'
     C     ZCONCE        ANDEQ     '34'
     C     ZCODTX        OREQ      '04'
     C     ZCONCE        ANDEQ     '35'
     C*SI ZCONCE <> '97' Y ZCONCE <> '60'
     C     ZCONCE        IFNE      '97'
     C     ZCONCE        ANDNE     '60'
     C* Acumula valor para control
     C*SUMAR ZVALHI ZTVHIS
     C                   ADD       ZVALHI        ZTVHIS
     C* de Gesar8 vrs Hisar4
     C*SUMAR ZCUOHI ZTCHIS
     C                   ADD       ZCUOHI        ZTCHIS
     C*SI ZCODTX = '05' Y ZCONCE = '31' Y ZDEURE > 0
     C     ZCODTX        IFEQ      '05'
     C     ZCONCE        ANDEQ     '31'
     C     ZDEURE        ANDGT     0
     C* Acumula valor para control
     C*SUMAR ZDEURE ZTVHIS
     C                   ADD       ZDEURE        ZTVHIS
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Genera encabezados de deuda                                 ==
     C*==                                                              ==
     C*==================================================================
     C     M15010        BEGSR
     C* Total deuda
     C*SI ZTOTDE > *CERO O ZTOTIN > *CERO Y PLATIP = '07' O ZTOTI2 > *CE
     C     ZTOTDE        IFGT      *ZERO
     C     ZTOTIN        ORGT      *ZERO
     C     PLATIP        ANDEQ     '07'
     C     ZTOTI2        ORGT      *ZERO
     C     PLATIP        ANDEQ     '07'
     C* No es planilla de tercero
     C*SI PLATIP <> '07'
     C     PLATIP        IFNE      '07'
     C* Tipo de deuda
     C*ASIGNAR DEUTIP '01'
     C                   MOVEL     '01'          DEUTIP
     C* Planilla de tercero
     C*SINO
     C                   ELSE
     C*SI PLAT03='08' O PLAT03='13' O PLAT03='14' O ZTPGRT='08' O ZTPGRT
     C     PLAT03        IFEQ      '08'
     C     PLAT03        OREQ      '13'
     C     PLAT03        OREQ      '14'
     C     ZTPGRT        OREQ      '08'
     C     ZTPGRT        OREQ      '13'
     C     ZTPGRT        OREQ      '14'
     C*PASAR ZERROR 'Pl de agrem/Pensión temp/Vol T. no puede generar de
     C                   MOVEL     $HIL(082)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*SINO
     C                   ELSE
     C* Tipo deuda liq. errónea ind.
     C*ASIGNAR DEUTIP '07'
     C                   MOVEL     '07'          DEUTIP
     C* Fecha inicio deuda
     C*PASAR ZFEIND ZFINDE
     C                   MOVEL     ZFINDE        ZFEIND
     C* Fecha última liq. intereses
     C*PASAR ZFECHA ZFLQIN
     C                   MOVEL     ZFLQIN        ZFECHA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR <> '1'
     C     ZSALIR        IFNE      '1'
     C* Valor de la deuda
     C*MOVER ZVRDEU ZTOTDE
     C                   Z-ADD     ZTOTDE        ZVRDEU
     C* Valor intereses deuda
     C*MOVER ZVRINT ZTOTIN
     C                   Z-ADD     ZTOTIN        ZVRINT
     C* Valor intereses comp. deuda
     C*MOVER ZVRINC ZTOTI2
     C                   Z-ADD     ZTOTI2        ZVRINC
     C* Actualiza deuda
     C*EJECUTAR M15015
     C                   EXSR      M15015
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR <> '1'
     C     ZSALIR        IFNE      '1'
     C*SI ZTOTD1 > *CERO O ZTOTI1 > *CERO Y PLATIP = '07' O ZTOTI3 > *CE
     C     ZTOTD1        IFGT      *ZERO
     C     ZTOTI1        ORGT      *ZERO
     C     PLATIP        ANDEQ     '07'
     C     ZTOTI3        ORGT      *ZERO
     C     PLATIP        ANDEQ     '07'
     C* Tipo de deuda
     C*ASIGNAR DEUTIP '05'
     C                   MOVEL     '05'          DEUTIP
     C* Valor de la deuda
     C*MOVER ZVRDEU ZTOTD1
     C                   Z-ADD     ZTOTD1        ZVRDEU
     C* Valor intereses deuda
     C*MOVER ZVRINT ZTOTI1
     C                   Z-ADD     ZTOTI1        ZVRINT
     C* Valor intereses comp. deuda
     C*MOVER ZVRINC ZTOTI3
     C                   Z-ADD     ZTOTI3        ZVRINC
     C* Actualiza deuda
     C*EJECUTAR M15015
     C                   EXSR      M15015
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza deuda                                             ==
     C*==                                                              ==
     C*==================================================================
     C     M15015        BEGSR
     C* Numero de planilla
     C*MOVER DEUNUM PLANU1
     C                   Z-ADD     PLANU1        DEUNUM
     C* Recupera deuda
     C*RECUPERAR DEUARC (DEUTIP DEUNUM)
     C     LL$110        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C     LL$110        CHAIN     DEUARC                             50
     C     *IN50         IFEQ      '1'
     C     *NOKEY        CLEAR                   DEUREG
     C                   END
     C*
     C*SI NER(DEUARC)
     C     *IN50         IFEQ      '1'
     C* Planilla independiente
     C*CASO PLATIP = '02'
     C                   SELECT
     C     PLATIP        WHENEQ    '02'
     C* Identificación afiliado
     C*MOVER DEUNRO AFIC01
     C                   Z-ADD     AFIC01        DEUNRO
     C* Tipo identificacion afiliado
     C*MOVER DEUTI1 AFITI1
     C                   MOVE      AFITI1        DEUTI1
     C* Planilla terceros
     C*CASO PLATIP = '07'
     C     PLATIP        WHENEQ    '07'
     C* Identificacion empleador
     C*LIMPIAR DEUNRO DEUTI1
     C                   CLEAR                   DEUNRO
     C                   CLEAR                   DEUTI1
     C* Planilla dependientes
     C*SINO
     C                   OTHER
     C* Identificacion empleador
     C*MOVER DEUNRO PLANU4
     C                   Z-ADD     PLANU4        DEUNRO
     C* Tipo identificacion empleador
     C*MOVER DEUTI1 PLATI1
     C                   MOVE      PLATI1        DEUTI1
     C*FINCASOS
     C                   ENDSL
     C* Fecha de generacion
     C*PASAR DEUFEC ZFESIS
     C                   MOVEL     ZFESIS        DEUFEC
     C* Fecha último estado
     C*PASAR DEUFE1 ZFESIS
     C                   MOVEL     ZFESIS        DEUFE1
     C* Fecha última modificación
     C*PASAR DEUFE3 ZFESIS
     C                   MOVEL     ZFESIS        DEUFE3
     C* Periodo
     C*PASAR DEUPER PLAPER
     C                   MOVEL     PLAPER        DEUPER
     C* Tipo de pago planilla
     C*PASAR DEUT01 PLAT03
     C                   MOVEL     PLAT03        DEUT01
     C* Desarrollo especial activo
     C*SI ZR7436 = '1' Y ZSALDI > *CEROS
     C     ZR7436        IFEQ      '1'
     C     ZSALDI        ANDGT     *ZEROS
     C* Fecha liquidación intereses
     C*PASAR DEUFE4 ZFECDE
     C                   MOVEL     ZFECDE        DEUFE4
     C*SINO
     C                   ELSE
     C* Si se liquidó ints
     C*SI ZLIQIN = '1'
     C     ZLIQIN        IFEQ      '1'
     C* Fecha última liq. intereses
     C*PASAR DEUFE4 ZFECHA
     C                   MOVEL     ZFECHA        DEUFE4
     C*SINO
     C                   ELSE
     C*LIMPIAR DEUFE4
     C                   CLEAR                   DEUFE4
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Fecha inicio de la deuda
     C*PASAR DEUFE6 ZFEIND
     C                   MOVEL     ZFEIND        DEUFE6
     C* Estado de la deuda
     C*ASIGNAR DEUEST 'GEN'
     C                   MOVEL     'GEN'         DEUEST
     C* Marcar archivos de equivalencias de inconsistencias de acreditac
     C* D.E. fusión PRO
     C*SI Z10592 = 1 Y PLAPER < ZPEFUS
     C     Z10592        IFEQ      1
     C     PLAPER        ANDLT     ZPEFUS
     C*LIMPIAR ZPLAFU
     C                   CLEAR                   ZPLAFU
     C* Planilla de fusión
     C*LLAMAR TRFEPL56 (PLANUM ZPLAFU)
     C                   CALL      'TRFEPL56'
     C                   PARM                    PLANUM
     C                   PARM                    ZPLAFU
     C* Planilla de fusión
     C*SI ZPLAFU = 'I' O ZPLAFU = 'C'
     C     ZPLAFU        IFEQ      'I'
     C     ZPLAFU        OREQ      'C'
     C* Grabar Deuda
     C*PASAR ZINDAR 'D'
     C                   MOVEL     'D'           ZINDAR
     C*LLAMAR TRFEQA50(DEUNUM DEUNUM DEUNUM DEUTIP DEUEST DEUNRO DEUPER
     C                   CALL      'TRFEQA50'
     C                   PARM                    DEUNUM
     C                   PARM                    DEUNUM
     C                   PARM                    DEUNUM
     C                   PARM                    DEUTIP
     C                   PARM                    DEUEST
     C                   PARM                    DEUNRO
     C                   PARM                    DEUPER
     C                   PARM                    DEUFEC
     C                   PARM                    DEUEST
     C                   PARM                    ZINPAA
     C                   PARM                    ZINDAR
     C                   PARM                    ZINDFE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI DEUEST = 'AND' O DEUEST = 'CAN'
     C     DEUEST        IFEQ      'AND'
     C     DEUEST        OREQ      'CAN'
     C* Estado de la deuda
     C*ASIGNAR DEUEST 'PAG'
     C                   MOVEL     'PAG'         DEUEST
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Valor de la deuda
     C*SUMAR ZVRDEU DEUVAL
     C                   ADD       ZVRDEU        DEUVAL
     C* Saldo de la deuda
     C*SUMAR ZVRDEU DEUSAL
     C                   ADD       ZVRDEU        DEUSAL
     C* Valor intereses de deuda
     C*SUMAR ZVRINT DEUVA1
     C                   ADD       ZVRINT        DEUVA1
     C* Saldo intereses de deuda
     C*SUMAR ZVRINT DEUSA1
     C                   ADD       ZVRINT        DEUSA1
     C* Valor intereses comp. de deuda
     C*SUMAR ZVRINC DEUV04
     C                   ADD       ZVRINC        DEUV04
     C* Saldo intereses comp. de deuda
     C*SUMAR ZVRINC DEUS03
     C                   ADD       ZVRINC        DEUS03
     C* Valor de la deuda
     C*CALCULAR ZVRDEU = ZVRDEU + ZVRINT + ZVRINC
     C     ZVRDEU        ADD       ZVRINT        V$CA1           030 9
     C     V$CA1         ADD       ZVRINC        ZVRDEU
     C* Usuario
     C*ASIGNAR DEUUSU USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        DEUUSU
     C* Fecha fondo ultimo estado
     C*ASIGNAR DEUFE5 HISFE3
     C                   MOVEL     HISFE3        DEUFE5
     C* Fecha fondo generación
     C*ASIGNAR DEUFE7 HISFE3
     C                   MOVEL     HISFE3        DEUFE7
     C* No ha consultado empleador
     C*SI ZEMPAR = 0
     C     ZEMPAR        IFEQ      0
     C* No vuelve a consultar empleador.
     C*MOVER ZEMPAR 1
     C                   Z-ADD     1             ZEMPAR
     C* aux subestado
     C*LIMPIAR ZETSUB
     C                   CLEAR                   ZETSUB
     C* SQLCOD antes.
     C*MOVER SQLCOZ SQLCOD
     C                   Z-ADD     SQLCOD        SQLCOZ
     C*SQL
     C/EXEC SQL
     C+  SELECT COALESCE(MAX(EMPI20), ' ')  INTO :ZMPI20
     C+  FROM EMPAR2
     C+  WHERE
     C+  EMPNU2 = :DETID2 AND EMPTI1 = :DETTI6
     C/END-EXEC
     C* ILOCALIZADO.
     C*SI ZMPI20 = 'N'
     C     ZMPI20        IFEQ      'N'
     C* SUBESTADO
     C*PASAR ZETSUB 'ILO'
     C                   MOVEL     'ILO'         ZETSUB
     C*SINO
     C                   ELSE
     C* SE DESMARCA SUBESTADO, ES LOCALIZAD
     C*LIMPIAR ZETSUB
     C                   CLEAR                   ZETSUB
     C*FIN
     C                   END
     C* SQLCOD despues.
     C*MOVER SQLCOD SQLCOZ
     C                   Z-ADD     SQLCOZ        SQLCOD
     C*FIN
     C                   END
     C* Subestado ILO.
     C*SI DETSUB = 'ILO' O DEUSUB = *BLANCOS
     C     DETSUB        IFEQ      'ILO'
     C     DEUSUB        OREQ      *BLANKS
     C* Sub estado ENCABEZADO
     C*PASAR DEUSUB ZETSUB
     C                   MOVEL     ZETSUB        DEUSUB
     C*FIN
     C                   END
     C*GRABAR DEUARC
     C     *IN50         IFEQ      '0'
     C                   UPDATE    DEUREG                               94
     C                   ELSE
     C                   WRITE     DEUREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*
     C* Historico de conceptos por deuda generada
     C*
     C* Cód. transacción
     C*PASAR ZCODTX '03'
     C                   MOVEL     '03'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '31'
     C                   MOVEL     '31'          ZCONCE
     C* Valor histórico
     C*MOVER ZVALHI ZVRDEU
     C                   Z-ADD     ZVRDEU        ZVALHI
     C* Cuotas
     C*LIMPIAR ZCUOHI
     C                   CLEAR                   ZCUOHI
     C* Actualizar HISAR4
     C*EJECUTAR M00055
     C                   EXSR      M00055
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Buscar causal de generación de la deuda
     C* Planillas normales
     C*SI PLAT03 <> '02' Y PLAT03 <> '10' Y PLAT03 <> '03' Y PLAT03 <> '
     C     PLAT03        IFNE      '02'
     C     PLAT03        ANDNE     '10'
     C     PLAT03        ANDNE     '03'
     C     PLAT03        ANDNE     '06'
     C     PLATIP        ANDNE     '05'
     C* Mensaje de error
     C*LIMPIAR ZERROR
     C                   CLEAR                   ZERROR
     C* Ind. deuda
     C*PASAR ZINDCA '2'
     C                   MOVEL     '2'           ZINDCA
     C* Si no ha borrado para la plan.
     C*SI ZINDBO = *BLANCOS
     C     ZINDBO        IFEQ      *BLANKS
     C* Enciende indicador de borrado
     C*PASAR ZINDBO '1'
     C                   MOVEL     '1'           ZINDBO
     C* Enciende indicador de borrado
     C*PASAR ZINACC 'E'
     C                   MOVEL     'E'           ZINACC
     C*LLAMAR TRHCAU52(ZINACC ZCADPE ZINDCA PLANU1 PLATI1 PLANU4 PLANOM
     C                   CALL      'TRHCAU52'
     C                   PARM                    ZINACC
     C                   PARM                    ZCADPE
     C                   PARM                    ZINDCA
     C                   PARM                    PLANU1
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    PLANOM
     C                   PARM                    PLAPER
     C                   PARM                    ZVRDEU
     C                   PARM                    ZERROR
     C*FIN
     C                   END
     C* Agregar registro
     C*PASAR ZINACC 'A'
     C                   MOVEL     'A'           ZINACC
     C* Valor acred. < total planilla
     C*SI ZTVDEP < PLATO8
     C     ZTVDEP        IFLT      PLATO8
     C* Valor para delta de gen. deuda
     C*CALCULAR ZDIFED = PLATO8 - ZTVDEP
     C     PLATO8        SUB       ZTVDEP        ZDIFED
     C* Si es mayor al delta
     C*SI ZDIFED > ZDELTA
     C     ZDIFED        IFGT      ZDELTA
     C* Causal
     C*PASAR ZCADPE '10'
     C                   MOVEL     '10'          ZCADPE
     C*LLAMAR TRHCAU52(ZINACC ZCADPE ZINDCA PLANU1 PLATI1 PLANU4 PLANOM
     C                   CALL      'TRHCAU52'
     C                   PARM                    ZINACC
     C                   PARM                    ZCADPE
     C                   PARM                    ZINDCA
     C                   PARM                    PLANU1
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    PLANOM
     C                   PARM                    PLAPER
     C                   PARM                    ZVRDEU
     C                   PARM                    ZERROR
     C* Variable de trabajo
     C*LIMPIAR ZDIFED
     C                   CLEAR                   ZDIFED
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Valor acred. < total calculado
     C*SI ZTVDEP < ZTOCAL
     C     ZTVDEP        IFLT      ZTOCAL
     C* Valor para delta de gen. deuda
     C*CALCULAR ZDIFED = ZTOCAL - ZTVDEP
     C     ZTOCAL        SUB       ZTVDEP        ZDIFED
     C* Si es mayor al delta
     C*SI ZDIFED > ZDELTA
     C     ZDIFED        IFGT      ZDELTA
     C* Causal
     C*PASAR ZCADPE '11'
     C                   MOVEL     '11'          ZCADPE
     C*LLAMAR TRHCAU52(ZINACC ZCADPE ZINDCA PLANU1 PLATI1 PLANU4 PLANOM
     C                   CALL      'TRHCAU52'
     C                   PARM                    ZINACC
     C                   PARM                    ZCADPE
     C                   PARM                    ZINDCA
     C                   PARM                    PLANU1
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    PLANOM
     C                   PARM                    PLAPER
     C                   PARM                    ZVRDEU
     C                   PARM                    ZERROR
     C* Variable de trabajo
     C*LIMPIAR ZDIFED
     C                   CLEAR                   ZDIFED
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Fecha dep. > fecha pago plan.
     C*SI ZLIQIN = '1'
     C     ZLIQIN        IFEQ      '1'
     C* Causal
     C*PASAR ZCADPE '12'
     C                   MOVEL     '12'          ZCADPE
     C*LLAMAR TRHCAU52(ZINACC ZCADPE ZINDCA PLANU1 PLATI1 PLANU4 PLANOM
     C                   CALL      'TRHCAU52'
     C                   PARM                    ZINACC
     C                   PARM                    ZCADPE
     C                   PARM                    ZINDCA
     C                   PARM                    PLANU1
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    PLANOM
     C                   PARM                    PLAPER
     C                   PARM                    ZVRDEU
     C                   PARM                    ZERROR
     C*FIN
     C                   END
     C* Error al actualizar HISA88
     C*SI ZERROR <> *BLANCO
     C     ZERROR        IFNE      *BLANK
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Genera pago en exceso                                       ==
     C*==                                                              ==
     C*==================================================================
     C     M15020        BEGSR
     C*LIMPIAR ZAJUPE ZAJCPE
     C                   CLEAR                   ZAJUPE
     C                   CLEAR                   ZAJCPE
     C* P.E. plan.dif. a canc x sol.ajuste
     C*EJECUTAR M15023
     C                   EXSR      M15023
     C*SI ZVRPE>*CERO O ZT@002='3' Y ZCUPE<>0 Y ZVRPE>=-1 Y ZVRPE<=1
     C     ZVRPE         IFGT      *ZERO
     C     ZT@002        OREQ      '3'
     C     ZCUPE         ANDNE     0
     C     ZVRPE         ANDGE     -1
     C     ZVRPE         ANDLE     1
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Rezago no existe empleador
     C*SI ZREZEM = '1'
     C     ZREZEM        IFEQ      '1'
     C* Distribuye P.E. entre rezagos
     C*EJECUTAR M15028
     C                   EXSR      M15028
     C*SINO
     C                   ELSE
     C* Numero de planilla
     C*MOVER PAGNUM PLANU1
     C                   Z-ADD     PLANU1        PAGNUM
     C*RECUPERAR PAGARC (PAGNUM)
     C     PAGNUM        CHAIN     PAGARC                             70
     C     *IN70         IFEQ      '1'
     C     *NOKEY        CLEAR                   PAGREG
     C                   END
     C* Tipo de planilla
     C*PASAR PAGTI6 PLATIP
     C                   MOVEL     PLATIP        PAGTI6
     C*SI NER(PAGARC)
     C     *IN70         IFEQ      '1'
     C* Tipo identificacion empleador
     C*PASAR PAGTIP PLATI1
     C                   MOVEL     PLATI1        PAGTIP
     C* Nro identificacion empleador
     C*MOVER PAGNU4 PLANU4
     C                   Z-ADD     PLANU4        PAGNU4
     C* Fecha de generacion
     C*ASIGNAR PAGFEC HISFE3
     C                   MOVEL     HISFE3        PAGFEC
     C* Fecha fondo generación
     C*ASIGNAR PAGFE8 HISFE3
     C                   MOVEL     HISFE3        PAGFE8
     C* Marcar archivos de equivalencias de inconsistencias de acreditac
     C* Grabar pago en exceso
     C*PASAR ZINDAR 'E'
     C                   MOVEL     'E'           ZINDAR
     C*FIN
     C                   END
     C* Desarrollo especial activo
     C*SI ZR8305 = 1
     C     ZR8305        IFEQ      1
     C*LLAMAR TRPAGE5B (PAGNUM PAGSU3)
     C                   CALL      'TRPAGE5B'
     C                   PARM                    PAGNUM
     C                   PARM                    PAGSU3
     C*FIN
     C                   END
     C* Fecha último estado
     C*PASAR PAGFE1 ZFESIS
     C                   MOVEL     ZFESIS        PAGFE1
     C* Valor total P.E. empleador
     C*SUMAR ZVRPE  PAGVA4
     C                   ADD       ZVRPE         PAGVA4
     C* Cuotas P.E. empleador
     C*SUMAR ZCUPE  PAGCU2
     C                   ADD       ZCUPE         PAGCU2
     C* Cuota saldo p.e.
     C*CALCULAR PAGSA4 = PAGSA4 + (ZCUPE - ZAJCPE)
     C     ZCUPE         SUB       ZAJCPE        V$CA1           030 9
     C     PAGSA4        ADD       V$CA1         PAGSA4
     C* Saldo p.e.
     C*CALCULAR PAGSA3 = PAGSA3 + (ZVRPE - ZAJUPE)
     C     ZVRPE         SUB       ZAJUPE        V$CA1           030 9
     C     PAGSA3        ADD       V$CA1         PAGSA3
     C* Saldo en cuota = 0
     C*SI PAGSA4 = *CERO
     C     PAGSA4        IFEQ      *ZERO
     C* P.E. Resuelto
     C*PASAR PAGEST 'RES'
     C                   MOVEL     'RES'         PAGEST
     C*SINO
     C                   ELSE
     C* P.E. Generado
     C*PASAR PAGEST 'GEN'
     C                   MOVEL     'GEN'         PAGEST
     C*FIN
     C                   END
     C*SI ZAJUPE |= *CERO
     C     ZAJUPE        IFNE      *ZERO
     C* Actualiza vlr. dev. p.e.
     C*CALCULAR PAGVA5 = PAGVA5 + ZAJUPE
     C     PAGVA5        ADD       ZAJUPE        PAGVA5
     C*FIN
     C                   END
     C* Usuario
     C*PASAR PAGUSU USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        PAGUSU
     C* Fecha fondo ultimo estado
     C*PASAR PAGFE2 HISFE3
     C                   MOVEL     HISFE3        PAGFE2
     C*SI PAGEST = 'RES'
     C     PAGEST        IFEQ      'RES'
     C*
     C* Agregar modificaciones a planillas en MODAR3
     C* Tipo registro : Pagos en exceso
     C*MOVER ZTMOPL 2
     C                   Z-ADD     2             ZTMOPL
     C* Adicionar modificaciones planillas
     C*EJECUTAR M00200
     C                   EXSR      M00200
     C*
     C*FIN
     C                   END
     C*SI ZT@002='3' Y PAGVA4=*CERO Y PAGSA4=*CERO
     C     ZT@002        IFEQ      '3'
     C     PAGVA4        ANDEQ     *ZERO
     C     PAGSA4        ANDEQ     *ZERO
     C*SI ERE (PAGARC)
     C     *IN70         IFEQ      '0'
     C*BORRAR PAGARC
     C                   DELETE    PAGARC
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*GRABAR PAGARC
     C     *IN70         IFEQ      '0'
     C                   UPDATE    PAGREG                               94
     C                   ELSE
     C                   WRITE     PAGREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Llamado desde rezagos ind
     C*SI ZT@002='3' Y ZPAG30 = '1'
     C     ZT@002        IFEQ      '3'
     C     ZPAG30        ANDEQ     '1'
     C* Agregar a PAGA30
     C*PASAR ZACC50 'A'
     C                   MOVEL     'A'           ZACC50
     C*LLAMAR RPPEXR50 (PAGNUM ZACC50)
     C                   CALL      'RPPEXR50'
     C                   PARM                    PAGNUM
     C                   PARM                    ZACC50
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Marcar archivos de equivalencias de inconsistencias de acreditac
     C* D.E. fusión PRO
     C*SI Z10592 = 1 Y PLAPER < ZPEFUS Y ZINDAR = 'E'
     C     Z10592        IFEQ      1
     C     PLAPER        ANDLT     ZPEFUS
     C     ZINDAR        ANDEQ     'E'
     C*LIMPIAR ZPLAFU
     C                   CLEAR                   ZPLAFU
     C* Planilla de fusión
     C*LLAMAR TRFEPL56 (PLANUM ZPLAFU)
     C                   CALL      'TRFEPL56'
     C                   PARM                    PLANUM
     C                   PARM                    ZPLAFU
     C* Planilla de fusión
     C*SI ZPLAFU = 'I' O ZPLAFU = 'C'
     C     ZPLAFU        IFEQ      'I'
     C     ZPLAFU        OREQ      'C'
     C*LLAMAR TRFEQA50(PAGNUM DETPAG DETSEC PAGTI6 PAGEST PLANU4 PLAPER
     C                   CALL      'TRFEQA50'
     C                   PARM                    PAGNUM
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    PAGTI6
     C                   PARM                    PAGEST
     C                   PARM                    PLANU4
     C                   PARM                    PLAPER
     C                   PARM                    PLAFEC
     C                   PARM                    PAGEST
     C                   PARM                    ZINPAA
     C                   PARM                    ZINDAR
     C                   PARM                    ZINDFE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*  Ajuste de SAE
     C*SI ZREGCE = 1 Y ZENTI1 = 3
     C     ZREGCE        IFEQ      1
     C     ZENTI1        ANDEQ     3
     C*MOVER ZPATEM PAGSA3
     C                   Z-ADD     PAGSA3        ZPATEM
     C*PASAR ZSIGNO '-'
     C                   MOVEL     '-'           ZSIGNO
     C*LLAMAR TRINCE62(PAGNUM ZPATEM ZSIGNO)
     C                   CALL      'TRINCE62'
     C                   PARM                    PAGNUM
     C                   PARM                    ZPATEM
     C                   PARM                    ZSIGNO
     C*FIN
     C                   END
     C* Ind. P.A. volun.
     C*SI ZINPAA = 1 Y PLATIP = '03' Y PLAT03 = '01' O ZINPAA = 1 Y PLAT
     C     ZINPAA        IFEQ      1
     C     PLATIP        ANDEQ     '03'
     C     PLAT03        ANDEQ     '01'
     C     ZINPAA        OREQ      1
     C     PLATIP        ANDEQ     '02'
     C     PLAT03        ANDEQ     '01'
     C     PLAPER        ANDLT     ZPEREF
     C* Genera P.A. independientes
     C*EJECUTAR M74120
     C                   EXSR      M74120
     C*FIN
     C                   END
     C* Imprime reporte detallado
     C*EJECUTAR DET@04
     C                   EXSR      DET@04
     C*
     C* Historico de conceptos por pago en exceso empleador
     C*
     C* Cód. transacción
     C*PASAR ZCODTX '04'
     C                   MOVEL     '04'          ZCODTX
     C* Si no se está acred. rezagos
     C*SI ZT@002 ]= '3'
     C     ZT@002        IFNE      '3'
     C* Tipo de concepto
     C*PASAR ZCONCE '34'
     C                   MOVEL     '34'          ZCONCE
     C*SINO
     C                   ELSE
     C* Tipo de concepto
     C*PASAR ZCONCE '35'
     C                   MOVEL     '35'          ZCONCE
     C*FIN
     C                   END
     C* Valor pago en exceso
     C*MOVER ZVALHI ZVRPE
     C                   Z-ADD     ZVRPE         ZVALHI
     C* Cuotas pago en exceso
     C*MOVER ZCUOHI ZCUPE
     C                   Z-ADD     ZCUPE         ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C* Genera registro P.E. fecha fondo
     C*EJECUTAR M15021
     C                   EXSR      M15021
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Genera registro en P.E. por fecha fondo                     ==
     C*==                                                              ==
     C*==================================================================
     C     M15021        BEGSR
     C* Limpiamos pagina,secuencia,Pln. P.A
     C*LIMPIAR ZT@011 ZT@012 ZT@018
     C                   CLEAR                   ZT@011
     C                   CLEAR                   ZT@012
     C                   CLEAR                   ZT@018
     C*SI ZT@002='3'
     C     ZT@002        IFEQ      '3'
     C* Página
     C*MOVER ZT@011 REZNR1
     C                   Z-ADD     REZNR1        ZT@011
     C* Secuencia
     C*MOVER ZT@012 REZNR2
     C                   Z-ADD     REZNR2        ZT@012
     C*FIN
     C                   END
     C* Carga N. planilla para PAGA04
     C*MOVER ZT@010 PAGNUM
     C                   Z-ADD     PAGNUM        ZT@010
     C* Carga transacción para PAGA04
     C*PASAR ZT@013 '04'
     C                   MOVEL     '04'          ZT@013
     C* Carga concepto para PAGA04
     C*PASAR ZT@014 ZCONCE
     C                   MOVEL     ZCONCE        ZT@014
     C* Carga fecha fondo para PAGA04
     C*ASIGNAR ZT@015 HISFE3
     C                   MOVEL     HISFE3        ZT@015
     C* Carga valor para PAGA04
     C*MOVER ZT@016 ZVRPE
     C                   Z-ADD     ZVRPE         ZT@016
     C* Carga cuotas para PAGA04
     C*MOVER ZT@017 ZCUPE
     C                   Z-ADD     ZCUPE         ZT@017
     C*LLAMAR TRPLAN90 (ZFONDO ZT@010 ZT@011 ZT@012 ZT@013 ZT@014 ZT@015
     C                   CALL      'TRPLAN90'
     C                   PARM                    ZFONDO
     C                   PARM                    ZT@010
     C                   PARM                    ZT@011
     C                   PARM                    ZT@012
     C                   PARM                    ZT@013
     C                   PARM                    ZT@014
     C                   PARM                    ZT@015
     C                   PARM                    ZT@016
     C                   PARM                    ZT@017
     C                   PARM                    ZT@018
     C*
     C* Buscar causal de generación del pago en exceso
     C*
     C* Planillas normales
     C*SI PLAT03 <> '02' Y PLAT03 <> '03' Y PLAT03 <> '06' Y PLATIP <> '
     C     PLAT03        IFNE      '02'
     C     PLAT03        ANDNE     '03'
     C     PLAT03        ANDNE     '06'
     C     PLATIP        ANDNE     '05'
     C* Mensaje de error
     C*LIMPIAR ZERROR
     C                   CLEAR                   ZERROR
     C* Ind. P.E.
     C*PASAR ZINDCA '3'
     C                   MOVEL     '3'           ZINDCA
     C* Si no ha borrado para la planilla
     C*SI ZINDBO = *BLANCOS
     C     ZINDBO        IFEQ      *BLANKS
     C* Enciende indicador de borrado
     C*PASAR ZINDBO '1'
     C                   MOVEL     '1'           ZINDBO
     C* Enciende indicador de borrado
     C*PASAR ZINACC 'E'
     C                   MOVEL     'E'           ZINACC
     C*LLAMAR TRHCAU52(ZINACC ZCADPE ZINDCA PLANU1 PLATI1 PLANU4 PLANOM
     C                   CALL      'TRHCAU52'
     C                   PARM                    ZINACC
     C                   PARM                    ZCADPE
     C                   PARM                    ZINDCA
     C                   PARM                    PLANU1
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    PLANOM
     C                   PARM                    PLAPER
     C                   PARM                    ZVRPE
     C                   PARM                    ZERROR
     C*FIN
     C                   END
     C* Agregar registro
     C*PASAR ZINACC 'A'
     C                   MOVEL     'A'           ZINACC
     C* Valor acred. > total planilla
     C*SI ZTVDEP > PLATO8
     C     ZTVDEP        IFGT      PLATO8
     C* Causal
     C*PASAR ZCADPE '13'
     C                   MOVEL     '13'          ZCADPE
     C*LLAMAR TRHCAU52(ZINACC ZCADPE ZINDCA PLANU1 PLATI1 PLANU4 PLANOM
     C                   CALL      'TRHCAU52'
     C                   PARM                    ZINACC
     C                   PARM                    ZCADPE
     C                   PARM                    ZINDCA
     C                   PARM                    PLANU1
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    PLANOM
     C                   PARM                    PLAPER
     C                   PARM                    ZVRPE
     C                   PARM                    ZERROR
     C*FIN
     C                   END
     C* Valor acred. > total calculado
     C*SI ZTVDEP > ZTOCAL
     C     ZTVDEP        IFGT      ZTOCAL
     C* Causal
     C*PASAR ZCADPE '14'
     C                   MOVEL     '14'          ZCADPE
     C*LLAMAR TRHCAU52(ZINACC ZCADPE ZINDCA PLANU1 PLATI1 PLANU4 PLANOM
     C                   CALL      'TRHCAU52'
     C                   PARM                    ZINACC
     C                   PARM                    ZCADPE
     C                   PARM                    ZINDCA
     C                   PARM                    PLANU1
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    PLANOM
     C                   PARM                    PLAPER
     C                   PARM                    ZVRPE
     C                   PARM                    ZERROR
     C*FIN
     C                   END
     C* Error al actualizar HISA88
     C*SI ZERROR <> *BLANCO
     C     ZERROR        IFNE      *BLANK
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  P.E. plan. dif. a canc. por sol. ajuste                     ==
     C*==                                                              ==
     C*==================================================================
     C     M15023        BEGSR
     C*SI ZT@002<>'3'
     C     ZT@002        IFNE      '3'
     C* Valor pago en exceso
     C*MOVER ZVRPE ZVRDEP
     C                   Z-ADD     ZVRDEP        ZVRPE
     C* Cuotas pago en exceso
     C*MOVER ZCUPE ZCUDEP
     C                   Z-ADD     ZCUDEP        ZCUPE
     C* Concilió con + de 1 depós. y no rez
     C*SI PLANU8 = *CERO Y ZT@002 ]= '3'
     C     PLANU8        IFEQ      *ZERO
     C     ZT@002        ANDNE     '3'
     C* Acumula como p.e.e. los depósitos conciliados que no se acredita
     C* Leer depósitos
     C*EJECUTAR M15025
     C                   EXSR      M15025
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI ZCAREZ > 1 Y ZTOTDE > *CEROS
     C     ZCAREZ        IFGT      1
     C     ZTOTDE        ANDGT     *ZEROS
     C* Si se está acreditando más de un rezago para la misma planilla
     C* y ya se generó deuda para uno de los detalles, no debe generarse
     C* pago en exceso.
     C*SINO
     C                   ELSE
     C*SI ZCAREZ > 1
     C     ZCAREZ        IFGT      1
     C*SI ZCAREZ = ZREZPR
     C     ZCAREZ        IFEQ      ZREZPR
     C* Hay valor de pago adelantado
     C*SI ZVLPAC>0
     C     ZVLPAC        IFGT      0
     C* Acumula pagos adelantados si los hay
     C*CALCULAR ZVLRRA=ZVLRRA+ZVLPAC
     C     ZVLRRA        ADD       ZVLPAC        ZVLRRA
     C* Acumula pagos adelantados si los hay
     C*CALCULAR ZCUORA=ZCUORA+ZCTPAC
     C     ZCUORA        ADD       ZCTPAC        ZCUORA
     C*FIN
     C                   END
     C* Valor PEE x rezago (VlrRez-VlrMov)
     C*CALCULAR ZVPXRZ = ZVLRRA-ZVLRMA
     C     ZVLRRA        SUB       ZVLRMA        ZVPXRZ
     C* Cuotas PE x rezago (CuoRez-CuoMov)
     C*CALCULAR ZCPXRZ = ZCUORA-ZCUOMA
     C     ZCUORA        SUB       ZCUOMA        ZCPXRZ
     C* Valor pago en exceso
     C*MOVER ZVRPE ZVPXRZ
     C                   Z-ADD     ZVPXRZ        ZVRPE
     C* Cuotas pago en exceso
     C*MOVER ZCUPE ZCPXRZ
     C                   Z-ADD     ZCPXRZ        ZCUPE
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Hay valor de pago adelantado
     C*SI ZVLPA>0
     C     ZVLPA         IFGT      0
     C* Acumula pagos adelantados si los hay
     C*CALCULAR ZVLRRZ=ZVLRRZ+ZVLPA
     C     ZVLRRZ        ADD       ZVLPA         ZVLRRZ
     C* Acumula pagos adelantados si los hay
     C*CALCULAR ZCUORZ=ZCUORZ+ZCTPAD
     C     ZCUORZ        ADD       ZCTPAD        ZCUORZ
     C*FIN
     C                   END
     C* Valor PEE x rezago (VlrRez-VlrMov)
     C*CALCULAR ZVPXRZ = ZVLRRZ-ZVLRMA
     C     ZVLRRZ        SUB       ZVLRMA        ZVPXRZ
     C* Cuotas PE x rezago (CuoRez-CuoMov)
     C*CALCULAR ZCPXRZ = ZCUORZ-ZCUOMA
     C     ZCUORZ        SUB       ZCUOMA        ZCPXRZ
     C* Valor pago en exceso
     C*MOVER ZVRPE ZVPXRZ
     C                   Z-ADD     ZVPXRZ        ZVRPE
     C* Cuotas pago en exceso
     C*MOVER ZCUPE ZCPXRZ
     C                   Z-ADD     ZCPXRZ        ZCUPE
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZVRPE >= *CERO Y ZCUPE >= *CERO
     C     ZVRPE         IFGE      *ZERO
     C     ZCUPE         ANDGE     *ZERO
     C* Buscar compensaciones p.e.
     C*EJECUTAR M15027
     C                   EXSR      M15027
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Leer depósitos por pago en exceso                           ==
     C*==                                                              ==
     C*==================================================================
     C     M15025        BEGSR
     C* Acumula a partir del último depósito procesado en el módulo M120
     C* Planilla de recaudo normal
     C*CASO ZINPLA = '1'
     C                   SELECT
     C     ZINPLA        WHENEQ    '1'
     C*LIMPIAR ZTVPA ZTCPA
     C                   CLEAR                   ZTVPA
     C                   CLEAR                   ZTCPA
     C*MIENTRAS NFA(CONAR205) Y PLANUM = CONNU5 Y ZINAPA = '0'
     C     *IN43         DOWEQ     '0'
     C     PLANUM        ANDEQ     CONNU5
     C     ZINAPA        ANDEQ     '0'
     C*SI CONTI3 = ' '
     C     CONTI3        IFEQ      ' '
     C* Lote de depósitos
     C*MOVER ZLOTE  CONNU2
     C                   Z-ADD     CONNU2        ZLOTE
     C* Número de depósito
     C*MOVER ZDEPO  CONNU3
     C                   Z-ADD     CONNU3        ZDEPO
     C* Consecutivo depósito
     C*MOVER ZCONSE CONCO4
     C                   Z-ADD     CONCO4        ZCONSE
     C* ES CONC. CON P.A.
     C*SINO
     C                   ELSE
     C* Valor histórico pagos adelantados
     C*SUMAR CONVLR ZTVPA
     C                   ADD       CONVLR        ZTVPA
     C* Cuotas pagos adelantados
     C*SUMAR CONCUO ZTCPA
     C                   ADD       CONCUO        ZTCPA
     C* Marca reg. conc. tipo 5 como acreditado para el cuadre
     C* Marca reg. conc. como ACR
     C*MOVER CONCO4 1
     C                   Z-ADD     1             CONCO4
     C* Genera registro P.E. por fecha fondo
     C*EJECUTAR M10005
     C                   EXSR      M10005
     C*FIN
     C                   END
     C* Recuperar depósito
     C*EJECUTAR M12010
     C                   EXSR      M12010
     C* Si hubo error
     C*SI ZSALIR = '1'
     C     ZSALIR        IFEQ      '1'
     C*SALIR
     C                   GOTO      T$6
     C*FIN
     C                   END
     C* Valor pago en exceso
     C*SUMAR ZVRDEP ZVRPE
     C                   ADD       ZVRDEP        ZVRPE
     C* Cuotas pago en exceso
     C*SUMAR ZCUDEP ZCUPE
     C                   ADD       ZCUDEP        ZCUPE
     C*GRABAR CONAR205
     C     *IN43         IFEQ      '0'
     C                   UPDATE    CONRE205                             94
     C                   ELSE
     C                   WRITE     CONRE205                             94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*LEER CONAR205
     C                   READ      CONAR205                               43
     C*FIN
     C                   END
     C     T$6           TAG
     C*SI ZTVPA |= *CERO O ZTCPA |= *CERO
     C     ZTVPA         IFNE      *ZERO
     C     ZTCPA         ORNE      *ZERO
     C* Cód. transacción
     C*PASAR ZCODTX '04'
     C                   MOVEL     '04'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '43'
     C                   MOVEL     '43'          ZCONCE
     C*MOVER ZVALHI ZTVPA
     C                   Z-ADD     ZTVPA         ZVALHI
     C*MOVER ZCUOHI ZTCPA
     C                   Z-ADD     ZTCPA         ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C* Valor pago adelantado
     C*MOVER ZVRPEX ZVALHI
     C                   Z-ADD     ZVALHI        ZVRPEX
     C* Cuotas del pago adelantado
     C*MOVER ZCUPEX ZCUOHI
     C                   Z-ADD     ZCUOHI        ZCUPEX
     C* Actuliza GESAR8 Tx 04-43
     C*EJECUTAR M79000
     C                   EXSR      M79000
     C*LIMPIAR ZTVPA ZTCPA
     C                   CLEAR                   ZTVPA
     C                   CLEAR                   ZTCPA
     C*FIN
     C                   END
     C* PLANILLAS DIFERENTES  A PAGO NORMAL
     C*CASO ZINPLA = '0'
     C     ZINPLA        WHENEQ    '0'
     C*MIENTRAS NFA(CONAR202) Y PLANUM = CONNU5 Y CONTI3 = *BLANCO
     C     *IN41         DOWEQ     '0'
     C     PLANUM        ANDEQ     CONNU5
     C     CONTI3        ANDEQ     *BLANK
     C* Lote de depósitos
     C*MOVER ZLOTE  CONNU2
     C                   Z-ADD     CONNU2        ZLOTE
     C* Número de depósito
     C*MOVER ZDEPO  CONNU3
     C                   Z-ADD     CONNU3        ZDEPO
     C* Consecutivo depósito
     C*MOVER ZCONSE CONCO4
     C                   Z-ADD     CONCO4        ZCONSE
     C* Recuperar depósito
     C*EJECUTAR M12010
     C                   EXSR      M12010
     C* Si hubo error
     C*SI ZSALIR = '1'
     C     ZSALIR        IFEQ      '1'
     C*SALIR
     C                   GOTO      T$7
     C*FIN
     C                   END
     C* Valor pago en exceso
     C*SUMAR ZVRDEP ZVRPE
     C                   ADD       ZVRDEP        ZVRPE
     C* Cuotas pago en exceso
     C*SUMAR ZCUDEP ZCUPE
     C                   ADD       ZCUDEP        ZCUPE
     C*LEER CONAR202
     C                   READ      CONAR202                               41
     C*FIN
     C                   END
     C     T$7           TAG
     C*FINCASOS
     C                   ENDSL
     C                   ENDSR
     C*==================================================================
     C*==  Leer depósitos para acred. de rezagos                       ==
     C*==                                                              ==
     C*==================================================================
     C     M15026        BEGSR
     C* Acumula a partir del último depósito procesado en M00070
     C*MIENTRAS K < J
     C     K             DOWLT     J
     C* Cuotas x deposito - acr. rezagos
     C*CALCULAR ZCUPE = ZCUPE + ZARCRE[K]
     C     ZCUPE         ADD       $Y(K)         ZCUPE
     C* Valor x depósito - acr. rezagos
     C*CALCULAR ZVRPE = ZVRPE + ZAR$RE[K]
     C     ZVRPE         ADD       $X(K)         ZVRPE
     C*SUMAR 1 K
     C                   ADD       1             K
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Buscar compensaciones p.e.                                  ==
     C*==                                                              ==
     C*==================================================================
     C     M15027        BEGSR
     C* Número de planilla físico
     C*MOVER COMNU7 PLANU1
     C                   Z-ADD     PLANU1        COMNU7
     C* Número de página
     C*MOVER COMPAG *CERO
     C                   MOVE      *ZERO         COMPAG
     C* Número de secuencia
     C*MOVER COMSEC *CERO
     C                   MOVE      *ZERO         COMSEC
     C*LIMPIAR ZDICCR ZCCPE
     C                   CLEAR                   ZDICCR
     C                   CLEAR                   ZCCPE
     C* Cuotas del p.e. para cubrir comp.
     C*MOVER ZCCPE ZCUPE
     C                   Z-ADD     ZCUPE         ZCCPE
     C*INICIARI COMAR5 (COMNU7 COMPAG COMSEC)
     C     LL$111        KLIST
     C                   KFLD                    COMNU7
     C                   KFLD                    COMPAG
     C                   KFLD                    COMSEC
     C     LL$111        SETLL     COMAR5                                 84
     C     *IN84         IFEQ      '1'
     C                   MOVE      '0'           *IN84
     C                   ELSE
     C                   MOVE      '1'           *IN84
     C                   END
     C*SI ERE (COMAR5)
     C     *IN84         IFEQ      '0'
     C*RECUPERARD (N) COMAR5 (COMNU7 COMPAG COMSEC)
     C     LL$112        KLIST
     C                   KFLD                    COMNU7
     C                   KFLD                    COMPAG
     C                   KFLD                    COMSEC
     C     LL$112        CHAIN     COMAR5                             8494
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SI COMTI4 = '2' Y COMSA1 > *CERO
     C     COMTI4        IFEQ      '2'
     C     COMSA1        ANDGT     *ZERO
     C* Saldo antes del cambio
     C*MOVER ZSALAN COMSAL
     C                   Z-ADD     COMSAL        ZSALAN
     C*SI ZCCPE <= COMSA1
     C     ZCCPE         IFLE      COMSA1
     C* Valor y cuotas ajuste p.e.
     C* Ajuste del saldo en cuotas del p.e.
     C*MOVER ZAJCPE ZCUPE
     C                   Z-ADD     ZCUPE         ZAJCPE
     C*MOVER ZAJUPE ZVRPE
     C                   Z-ADD     ZVRPE         ZAJUPE
     C*CALCULAR COMSA1 = COMSA1 - ZCCPE
     C     COMSA1        SUB       ZCCPE         COMSA1
     C*SI COMCU1 ]= *CERO
     C     COMCU1        IFNE      *ZERO
     C*CALCULAR (R) COMSAL = ( COMSA1 * COMV01 ) / COMCU1
     C     COMSA1        MULT      COMV01        V$CA1           030 9
     C     V$CA1         DIV(H)    COMCU1        COMSAL
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Valor y cuotas ajuste p.e.
     C*MOVER ZAJCPE COMSA1
     C                   Z-ADD     COMSA1        ZAJCPE
     C*CALCULAR (R) ZAJUPE = ( ZVRPE * ZAJCPE ) / ZCUPE
     C     ZVRPE         MULT      ZAJCPE        V$CA1           030 9
     C     V$CA1         DIV(H)    ZCUPE         ZAJUPE
     C*LIMPIAR COMSA1
     C                   CLEAR                   COMSA1
     C*LIMPIAR COMSAL
     C                   CLEAR                   COMSAL
     C*FIN
     C                   END
     C* Fecha fondo última modif.
     C*PASAR COMF04 HISFE3
     C                   MOVEL     HISFE3        COMF04
     C* Fecha sist. modif.
     C*PASAR COMF05 ZFESIS
     C                   MOVEL     ZFESIS        COMF05
     C* Usuario modificó
     C*PASAR COMUSU USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        COMUSU
     C*GRABAR COMAR5
     C     *IN84         IFEQ      '0'
     C                   UPDATE    COMRE5                               94
     C                   ELSE
     C                   WRITE     COMRE5                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Des. especial 10592 activo
     C*SI Z10592 = 1
     C     Z10592        IFEQ      1
     C* Actualiza valor y saldo
     C*PASAR ZTIPRO '1'
     C                   MOVEL     '1'           ZTIPRO
     C* No completa proceso
     C*PASAR ZCOMPL 'N'
     C                   MOVEL     'N'           ZCOMPL
     C*LLAMAR TRFMCO54 (COMNU7 COMPAG COMSEC ZSALAN COMSAL ZTIPRO ZCOMPL
     C                   CALL      'TRFMCO54'
     C                   PARM                    COMNU7
     C                   PARM                    COMPAG
     C                   PARM                    COMSEC
     C                   PARM                    ZSALAN
     C                   PARM                    COMSAL
     C                   PARM                    ZTIPRO
     C                   PARM                    ZCOMPL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI RND
     C     I$RND         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'COMAR5 no disponible - M15027'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(083)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Distribuir pago en exceso entre los rezagos                 ==
     C*==                                                              ==
     C*==================================================================
     C     M15028        BEGSR
     C*LIMPIAR ZVRREP ZVRPRO ZCUREP ZCUCOM
     C                   CLEAR                   ZVRREP
     C                   CLEAR                   ZVRPRO
     C                   CLEAR                   ZCUREP
     C                   CLEAR                   ZCUCOM
     C* Ind. de distrib. p.e. en rezarc
     C*ASIGNAR ZDISPE '1'
     C                   MOVEL     '1'           ZDISPE
     C*INICIAR REZARC (PLANU1)
     C     PLANU1        SETLL     REZARC                             76
     C*LEER REZARC
     C                   READ      REZARC                                 76
     C*MIENTRAS NFA(REZARC) Y PLANU1 = REZNRO
     C     *IN76         DOWEQ     '0'
     C     PLANU1        ANDEQ     REZNRO
     C*CALCULAR ZVRREZ = REZCOT+REZCO1+REZCO2+REZCO4+REZVA1+REZINT+REZIN
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZVA1        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     V$CA1         ADD       REZIN9        V$CA1
     C     V$CA1         SUB       REZDEU        ZVRREZ
     C* Existe detalle rezago a distribuir
     C*SI ZVRREZ != *CERO
     C     ZVRREZ        IFNE      *ZERO
     C*SI ZTOVRE != ZVRPRO
     C     ZTOVRE        IFNE      ZVRPRO
     C*CALCULAR (R) REZVA3 = (ZVRREZ * (ZVRPE - ZVRREP))/(ZTOVRE - ZVRPR
     C     ZVRPE         SUB       ZVRREP        V$CA1           030 9
     C     ZVRREZ        MULT      V$CA1         V$CA1
     C     ZTOVRE        SUB       ZVRPRO        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         REZVA3
     C*CALCULAR (R) REZCU2 = (ZVRREZ * (ZCUPE - ZCUREP))/(ZTOVRE - ZVRPR
     C     ZCUPE         SUB       ZCUREP        V$CA1           030 9
     C     ZVRREZ        MULT      V$CA1         V$CA1
     C     ZTOVRE        SUB       ZVRPRO        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         REZCU2
     C* Genera reg. soporte tx 05-60
     C*EJECUTAR M15029
     C                   EXSR      M15029
     C* Cuotas a cubrir compensación
     C*MOVER ZCUCOM REZCU2
     C                   Z-ADD     REZCU2        ZCUCOM
     C* Valor repartido
     C*SUMAR REZVA3 ZVRREP
     C                   ADD       REZVA3        ZVRREP
     C* Cuotas repartidas
     C*SUMAR REZCU2 ZCUREP
     C                   ADD       REZCU2        ZCUREP
     C* Valor procesado
     C*SUMAR ZVRREZ ZVRPRO
     C                   ADD       ZVRREZ        ZVRPRO
     C*SI PLANU8 ]= *CERO
     C     PLANU8        IFNE      *ZERO
     C* Se concilió con más de un depósito
     C*SINO
     C                   ELSE
     C* Planilla
     C*MOVER DISNRO REZNRO
     C                   Z-ADD     REZNRO        DISNRO
     C* Página
     C*MOVER DISNR1 REZNR1
     C                   Z-ADD     REZNR1        DISNR1
     C* Secuencia
     C*MOVER DISNR2 REZNR2
     C                   Z-ADD     REZNR2        DISNR2
     C* Tipo de registro
     C*PASAR DISTIP '1'
     C                   MOVEL     '1'           DISTIP
     C*INICIARUI DISAR1 (DISNRO DISNR1 DISNR2 DISTIP)
     C     LL$113        KLIST
     C                   KFLD                    DISNRO
     C                   KFLD                    DISNR1
     C                   KFLD                    DISNR2
     C                   KFLD                    DISTIP
     C     LL$113        SETLL     DISAR1                                 57
     C     *IN57         IFEQ      '1'
     C     LL$113        SETGT     DISAR1                             57
     C                   MOVE      '0'           *IN57
     C                   ELSE
     C                   MOVE      '1'           *IN57
     C                   END
     C*SI ERE (DISAR1)
     C     *IN57         IFEQ      '0'
     C* Al último depósito se suma P.E.E
     C*LEEANT DISAR1
     C                   READP     DISAR1                                 57
     C*SUMAR REZVA3 DISVAL
     C                   ADD       REZVA3        DISVAL
     C*SUMAR REZCU2 DISCUO
     C                   ADD       REZCU2        DISCUO
     C*GRABAR DISAR1
     C     *IN57         IFEQ      '0'
     C                   UPDATE    DISRE1                               94
     C                   ELSE
     C                   WRITE     DISRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Imprime reporte detallado
     C*EJECUTAR DET@03
     C                   EXSR      DET@03
     C*SI REZEST = 'DEV' O REZEST = 'AFP'
     C     REZEST        IFEQ      'DEV'
     C     REZEST        OREQ      'AFP'
     C* Verifica compensación
     C*EJECUTAR M14062
     C                   EXSR      M14062
     C*FIN
     C                   END
     C*GRABAR REZARC
     C     *IN76         IFEQ      '0'
     C                   UPDATE    REZREG                               94
     C                   ELSE
     C                   WRITE     REZREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*  Ajustes de SAE
     C*SI ZREGCE = 1   Y ZENTI1= 3
     C     ZREGCE        IFEQ      1
     C     ZENTI1        ANDEQ     3
     C*CALCULAR ZVALRE = (REZCOT+REZCO1+REZCO2+REZCO4+REZINT) + (REZIN9+
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     REZIN9        ADD       REZVA1        V$CA2           030 9
     C     V$CA2         SUB       REZDEU        V$CA2
     C     V$CA2         ADD       REZVA3        V$CA2
     C     V$CA1         ADD       V$CA2         ZVALRE
     C*PASAR ZSIGNO '-'
     C                   MOVEL     '-'           ZSIGNO
     C*LLAMAR TRINCE65(REZNRO REZNR1 REZNR2 REZNR3 ZVALRE ZSIGNO)
     C                   CALL      'TRINCE65'
     C                   PARM                    REZNRO
     C                   PARM                    REZNR1
     C                   PARM                    REZNR2
     C                   PARM                    REZNR3
     C                   PARM                    ZVALRE
     C                   PARM                    ZSIGNO
     C*FIN
     C                   END
     C* Actualiza estadísticas de rezago con el valor del p.e.e.
     C* Tipo llamado masivo
     C*SI ZTIPXX <> 'W' Y ZTLLAM <> 'X'
     C     ZTIPXX        IFNE      'W'
     C     ZTLLAM        ANDNE     'X'
     C*RECUPERARD ESTAR1 (REZTI3 REZFEC)
     C     LL$114        KLIST
     C                   KFLD                    REZTI3
     C                   KFLD                    REZFEC
     C     LL$114        CHAIN     ESTAR1                             5994
     C                   MOVE      *IN94         I$RND
     C     *IN59         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   ESTRE1
     C                   END
     C* Registro ESTAR1 disponible
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*CALCULAR ESTVAL = ESTVAL + REZVA3
     C     ESTVAL        ADD       REZVA3        ESTVAL
     C*GRABAR ESTAR1
     C     *IN59         IFEQ      '0'
     C                   UPDATE    ESTRE1                               94
     C                   ELSE
     C                   WRITE     ESTRE1                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'ESTAR1 no disponible - M15028'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(084)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Valor del rezago
     C*MOVER ZVALHI REZVA3
     C                   Z-ADD     REZVA3        ZVALHI
     C* Tipo de Rezago
     C*PASAR ZCODTX REZTI3
     C                   MOVEL     REZTI3        ZCODTX
     C* Rezago generado
     C*PASAR ZFI 'P'
     C                   MOVEL     'P'           ZFI
     C*LLAMAR TRPLANB1(ZFONDO REZFEC PLANUM ZCODTX ZCONCE ZVALHI ZCUOHI
     C                   CALL      'TRPLANB1'
     C                   PARM                    ZFONDO
     C                   PARM                    REZFEC
     C                   PARM                    PLANUM
     C                   PARM                    ZCODTX
     C                   PARM                    ZCONCE
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C                   PARM                    ZFI
     C*FIN
     C                   END
     C*LEER REZARC
     C                   READ      REZARC                                 76
     C*FIN
     C                   END
     C* Total valor rezagos
     C*SUMAR ZVRPE ZTOVRE
     C                   ADD       ZVRPE         ZTOVRE
     C* Total cuotas rezagos
     C*SUMAR ZCUPE ZTOCRE
     C                   ADD       ZCUPE         ZTOCRE
     C* Total P.E. rezagos reporte
     C*SUMAR ZVRPE ZVAPER
     C                   ADD       ZVRPE         ZVAPER
     C* Cuotas P.E. rezagos reporte
     C*SUMAR ZCUPE ZCUPER
     C                   ADD       ZCUPE         ZCUPER
     C                   ENDSR
     C*==================================================================
     C*==  Genera registro soporte transacciòn 05 60                   ==
     C*==                                                              ==
     C*==================================================================
     C     M15029        BEGSR
     C*SI REZTI3 >= '31' Y REZTI3 <> '35' Y REZTI3 <= '40'
     C     REZTI3        IFGE      '31'
     C     REZTI3        ANDNE     '35'
     C     REZTI3        ANDLE     '40'
     C* Tx - Reversión movimiento
     C*PASAR ZCODTX '05'
     C                   MOVEL     '05'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '31'
     C                   MOVEL     '31'          ZCONCE
     C* Carga valor para PAGA04
     C*MOVER ZT@016 REZVA3
     C                   Z-ADD     REZVA3        ZT@016
     C* Carga cuotas para PAGA04
     C*MOVER ZT@017 REZCU2
     C                   Z-ADD     REZCU2        ZT@017
     C* Planilla pago adelantado
     C*LIMPIAR ZPLANA
     C                   CLEAR                   ZPLANA
     C* Genera registro en PAGA04
     C*LLAMAR TRPLAN90 (ZFONDO REZNRO REZNR1 REZNR2 ZCODTX ZCONCE REZFE3
     C                   CALL      'TRPLAN90'
     C                   PARM                    ZFONDO
     C                   PARM                    REZNRO
     C                   PARM                    REZNR1
     C                   PARM                    REZNR2
     C                   PARM                    ZCODTX
     C                   PARM                    ZCONCE
     C                   PARM                    REZFE3
     C                   PARM                    ZT@016
     C                   PARM                    ZT@017
     C                   PARM                    ZPLANA
     C*FIN
     C                   END
     C* No vinculado
     C*SI REZI01 = '1'
     C     REZI01        IFEQ      '1'
     C*SUMAR REZVA3 ZTOVRN
     C                   ADD       REZVA3        ZTOVRN
     C*SUMAR REZCU2 ZTOCRN
     C                   ADD       REZCU2        ZTOCRN
     C* Limpia planilla P.A.Para PAGA04
     C*LIMPIAR ZT@018
     C                   CLEAR                   ZT@018
     C* Carga N. planilla para PAGA04
     C*MOVER ZT@010 REZNRO
     C                   Z-ADD     REZNRO        ZT@010
     C* Carga pagina para PAGA04
     C*MOVER ZT@011 REZNR1
     C                   Z-ADD     REZNR1        ZT@011
     C* Carga secuencia para PAGA04
     C*MOVER ZT@012 REZNR2
     C                   Z-ADD     REZNR2        ZT@012
     C* Carga transacción para PAGA04
     C*ASIGNAR ZT@013 '05'
     C                   MOVEL     '05'          ZT@013
     C* Carga concepto para PAGA04
     C*ASIGNAR ZT@014 '60'
     C                   MOVEL     '60'          ZT@014
     C* Carga fecha fondo para PAGA04
     C*ASIGNAR ZT@015 HISFE3
     C                   MOVEL     HISFE3        ZT@015
     C* Carga valor para PAGA04
     C*MOVER ZT@016 REZVA3
     C                   Z-ADD     REZVA3        ZT@016
     C* Carga cuotas para PAGA04
     C*MOVER ZT@017 REZCU2
     C                   Z-ADD     REZCU2        ZT@017
     C*LLAMAR TRPLAN90 (ZFONDO ZT@010 ZT@011 ZT@012 ZT@013 ZT@014 ZT@015
     C                   CALL      'TRPLAN90'
     C                   PARM                    ZFONDO
     C                   PARM                    ZT@010
     C                   PARM                    ZT@011
     C                   PARM                    ZT@012
     C                   PARM                    ZT@013
     C                   PARM                    ZT@014
     C                   PARM                    ZT@015
     C                   PARM                    ZT@016
     C                   PARM                    ZT@017
     C                   PARM                    ZT@018
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Genera histórico y pagos por fondo de solidaridad           ==
     C*==                                                              ==
     C*==================================================================
     C     M15040        BEGSR
     C*LIMPIAR $$PAGR
     C                   CLEAR                   $$PAGR
     C* Indica si existe registro
     C*PASAR ZEXIST 'N'
     C                   MOVEL     'N'           ZEXIST
     C* Fecha pago
     C*PASAR Z59FE9 *BLANCO
     C                   MOVEL     *BLANK        Z59FE9
     C* Planilla
     C*MOVER Z59PLA PLANU1
     C                   Z-ADD     PLANU1        Z59PLA
     C* Fecha del fondo
     C*PASAR Z59F01 HISFE3
     C                   MOVEL     HISFE3        Z59F01
     C* Usuario
     C*PASAR Z59US2 USUÑÑÑ
     C                   MOVEL     USUÑÑÑ        Z59US2
     C* Fecha de depósito
     C*PASAR Z59F03 ZULFDE
     C                   MOVEL     ZULFDE        Z59F03
     C* Acción: Actualiza el registro
     C*PASAR Z59ACC 'A'
     C                   MOVEL     'A'           Z59ACC
     C* Fondo de solidaridad
     C*CASO ZINPAG = 'FS'
     C                   SELECT
     C     ZINPAG        WHENEQ    'FS'
     C* Tipo de pago
     C*PASAR Z59TI2 '03'
     C                   MOVEL     '03'          Z59TI2
     C* Subtipo
     C*PASAR Z59SUB '05'
     C                   MOVEL     '05'          Z59SUB
     C*LLAMAR TRPAGR65 ( $$PAGR ZVALHI ZCUOHI ZDEPR1)
     C                   CALL      'TRPAGR65'
     C                   PARM                    $$PAGR
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C                   PARM                    ZDEPR1
     C* Int. fondo de solidaridad
     C*CASO ZINPAG = 'IF'
     C     ZINPAG        WHENEQ    'IF'
     C* Tipo de pago
     C*PASAR Z59TI2 '03'
     C                   MOVEL     '03'          Z59TI2
     C* Subtipo
     C*PASAR Z59SUB '10'
     C                   MOVEL     '10'          Z59SUB
     C*LLAMAR TRPAGR65 ($$PAGR ZVALHI ZCUOHI ZDEPR1)
     C                   CALL      'TRPAGR65'
     C                   PARM                    $$PAGR
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C                   PARM                    ZDEPR1
     C* Prima de seguros
     C*CASO ZINPAG = 'PR'
     C     ZINPAG        WHENEQ    'PR'
     C* Tipo de pago
     C*PASAR Z59TI2 '02'
     C                   MOVEL     '02'          Z59TI2
     C* Subtipo
     C*PASAR Z59SUB *BLANCO
     C                   MOVEL     *BLANK        Z59SUB
     C*LIMPIAR ZCOBRO
     C                   CLEAR                   ZCOBRO
     C*MOVER ZCOBRO ZVMPS
     C                   Z-ADD     ZVMPS         ZCOBRO
     C*LLAMAR TRPAGR65 ($$PAGR ZCOBRO ZCMPS ZDEPR1)
     C                   CALL      'TRPAGR65'
     C                   PARM                    $$PAGR
     C                   PARM                    ZCOBRO
     C                   PARM                    ZCMPS
     C                   PARM                    ZDEPR1
     C* Comisión CVA
     C*CASO ZINPAG = 'VA'
     C     ZINPAG        WHENEQ    'VA'
     C* Tipo de pago
     C*PASAR Z59TI2 '01'
     C                   MOVEL     '01'          Z59TI2
     C* Subtipo
     C*PASAR Z59SUB '02'
     C                   MOVEL     '02'          Z59SUB
     C*LIMPIAR ZCOBRO
     C                   CLEAR                   ZCOBRO
     C*MOVER ZCOBRO ZVMCCA
     C                   Z-ADD     ZVMCCA        ZCOBRO
     C*LLAMAR TRPAGR65 ($$PAGR ZCOBRO ZCMCCA ZDEPR1)
     C                   CALL      'TRPAGR65'
     C                   PARM                    $$PAGR
     C                   PARM                    ZCOBRO
     C                   PARM                    ZCMCCA
     C                   PARM                    ZDEPR1
     C* Comisión CVE
     C*CASO ZINPAG = 'VE'
     C     ZINPAG        WHENEQ    'VE'
     C* Tipo de pago
     C*PASAR Z59TI2 '01'
     C                   MOVEL     '01'          Z59TI2
     C* Subtipo
     C*PASAR Z59SUB '03'
     C                   MOVEL     '03'          Z59SUB
     C*LIMPIAR ZCOBRO
     C                   CLEAR                   ZCOBRO
     C*MOVER ZCOBRO ZVMCCE
     C                   Z-ADD     ZVMCCE        ZCOBRO
     C*LLAMAR TRPAGR65 ($$PAGR ZCOBRO ZCMCCE ZDEPR1)
     C                   CALL      'TRPAGR65'
     C                   PARM                    $$PAGR
     C                   PARM                    ZCOBRO
     C                   PARM                    ZCMCCE
     C                   PARM                    ZDEPR1
     C* Comisión C.O
     C*CASO ZINPAG = 'CO'
     C     ZINPAG        WHENEQ    'CO'
     C* Tipo de pago
     C*PASAR Z59TI2 '01'
     C                   MOVEL     '01'          Z59TI2
     C* Subtipo
     C*PASAR Z59SUB '01'
     C                   MOVEL     '01'          Z59SUB
     C*LIMPIAR ZCOBRO
     C                   CLEAR                   ZCOBRO
     C*MOVER ZCOBRO ZVMCCO
     C                   Z-ADD     ZVMCCO        ZCOBRO
     C*LLAMAR TRPAGR65 ($$PAGR ZCOBRO ZCMCCO ZDEPR1)
     C                   CALL      'TRPAGR65'
     C                   PARM                    $$PAGR
     C                   PARM                    ZCOBRO
     C                   PARM                    ZCMCCO
     C                   PARM                    ZDEPR1
     C* SFSP
     C*CASO ZINPAG = 'SF'
     C     ZINPAG        WHENEQ    'SF'
     C* Tipo de pago
     C*PASAR Z59TI2 '06'
     C                   MOVEL     '06'          Z59TI2
     C* Subtipo
     C*LIMPIAR Z59SUB
     C                   CLEAR                   Z59SUB
     C*LLAMAR TRPAGR65 ($$PAGR ZVALHI ZCUOHI ZDEPR1)
     C                   CALL      'TRPAGR65'
     C                   PARM                    $$PAGR
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C                   PARM                    ZDEPR1
     C* ISFSP
     C*CASO ZINPAG = 'IS'
     C     ZINPAG        WHENEQ    'IS'
     C* Tipo de pago
     C*PASAR Z59TI2 '06'
     C                   MOVEL     '06'          Z59TI2
     C* Subtipo
     C*PASAR Z59SUB '10'
     C                   MOVEL     '10'          Z59SUB
     C*LLAMAR TRPAGR65 ($$PAGR ZVALHI ZCUOHI ZDEPR1)
     C                   CALL      'TRPAGR65'
     C                   PARM                    $$PAGR
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C                   PARM                    ZDEPR1
     C* FGPM
     C*CASO ZINPAG = 'FG'
     C     ZINPAG        WHENEQ    'FG'
     C* Tipo de pago
     C*PASAR Z59TI2 '05'
     C                   MOVEL     '05'          Z59TI2
     C* Subtipo
     C*LIMPIAR Z59SUB
     C                   CLEAR                   Z59SUB
     C*LLAMAR TRPAGR65 ($$PAGR ZVALHI ZCUOHI ZDEPR1)
     C                   CALL      'TRPAGR65'
     C                   PARM                    $$PAGR
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C                   PARM                    ZDEPR1
     C* IFGPM
     C*CASO ZINPAG = 'IG'
     C     ZINPAG        WHENEQ    'IG'
     C* Tipo de pago
     C*PASAR Z59TI2 '05'
     C                   MOVEL     '05'          Z59TI2
     C* Subtipo
     C*PASAR Z59SUB '11'
     C                   MOVEL     '11'          Z59SUB
     C*LLAMAR TRPAGR65 ($$PAGR ZVALHI ZCUOHI ZDEPR1)
     C                   CALL      'TRPAGR65'
     C                   PARM                    $$PAGR
     C                   PARM                    ZVALHI
     C                   PARM                    ZCUOHI
     C                   PARM                    ZDEPR1
     C*FINCASOS
     C                   ENDSL
     C                   ENDSR
     C*==================================================================
     C*==  Genera histórico II                                         ==
     C*==                                                              ==
     C*==================================================================
     C     M15050        BEGSR
     C* Genera histórico acred.X INTERESES
     C*SI ZVMINT > *CERO O ZCMINT > *CERO
     C     ZVMINT        IFGT      *ZERO
     C     ZCMINT        ORGT      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '04'
     C                   MOVEL     '04'          ZCONCE
     C* Valor valor movimiento Int.
     C*MOVER ZVALHI ZVMINT
     C                   Z-ADD     ZVMINT        ZVALHI
     C* Cuotas movimiento Int.
     C*MOVER ZCUOHI ZCMINT
     C                   Z-ADD     ZCMINT        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C* Acumulado valor rep. totales
     C*SUMAR ZVMINT ZVAINA
     C                   ADD       ZVMINT        ZVAINA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCMINT ZCUINA
     C                   ADD       ZCMINT        ZCUINA
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico acred.X RENDIMIENTOS
     C*SI ZVMREN > *CERO O ZCMREN > *CERO
     C     ZVMREN        IFGT      *ZERO
     C     ZCMREN        ORGT      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '11'
     C                   MOVEL     '11'          ZCONCE
     C* Valor valor movimiento Ren.
     C*MOVER ZVALHI ZVMREN
     C                   Z-ADD     ZVMREN        ZVALHI
     C* Cuotas movimiento Rendim.
     C*MOVER ZCUOHI ZCMREN
     C                   Z-ADD     ZCMREN        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C* Acumulado valor rep. totales
     C*SUMAR ZVMREN ZTOREN
     C                   ADD       ZVMREN        ZTOREN
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCMREN ZTOCUR
     C                   ADD       ZCMREN        ZTOCUR
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico acred.X ALTO RIESGO
     C*SI ZVMAR > *CERO O ZCMAR > *CERO
     C     ZVMAR         IFGT      *ZERO
     C     ZCMAR         ORGT      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '97'
     C                   MOVEL     '97'          ZCONCE
     C*
     C*MOVER ZVALHI ZVMAR
     C                   Z-ADD     ZVMAR         ZVALHI
     C*
     C*MOVER ZCUOHI ZCMAR
     C                   Z-ADD     ZCMAR         ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C* Acumulado valor rep. totales
     C*SUMAR ZVMAR  ZVAARA
     C                   ADD       ZVMAR         ZVAARA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCMAR  ZCUARA
     C                   ADD       ZCMAR         ZCUARA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico acred.X COTIZACION OBLIGATORIA
     C*SI ZVMAR > *CERO O ZCMAR > *CERO O ZVMCO > *CERO O ZCMCO > *CERO
     C     ZVMAR         IFGT      *ZERO
     C     ZCMAR         ORGT      *ZERO
     C     ZVMCO         ORGT      *ZERO
     C     ZCMCO         ORGT      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '01'
     C                   MOVEL     '01'          ZCONCE
     C* Valor valor movimiento C.O.
     C*SUMAR ZVMAR ZVMCO ZVALHI
     C     ZVMAR         ADD       ZVMCO         ZVALHI
     C* Cuotas movimiento C.O.
     C*SUMAR ZCMAR ZCMCO ZCUOHI
     C     ZCMAR         ADD       ZCMCO         ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C* Acumulado valor rep. totales
     C*SUMAR ZVMCO  ZVACOA
     C                   ADD       ZVMCO         ZVACOA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCMCO  ZCUCOA
     C                   ADD       ZCMCO         ZCUCOA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Histórico de acreditación III                               ==
     C*==                                                              ==
     C*==================================================================
     C     M15060        BEGSR
     C* Genera histórico acred.X PRIMA
     C*SI ZVMPS |= *CERO O ZCMPS |= *CERO
     C     ZVMPS         IFNE      *ZERO
     C     ZCMPS         ORNE      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '08'
     C                   MOVEL     '08'          ZCONCE
     C* Valor
     C*MOVER ZVALHI ZVMPS
     C                   Z-ADD     ZVMPS         ZVALHI
     C* Cuotas
     C*MOVER ZCUOHI ZCMPS
     C                   Z-ADD     ZCMPS         ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Acumulado valor rep. totales
     C*SUMAR ZVMPS  ZVAPRA
     C                   ADD       ZVMPS         ZVAPRA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCMPS  ZCUPRA
     C                   ADD       ZCMPS         ZCUPRA
     C* Ind de PAGAR1
     C*PASAR ZINPAG 'PR'
     C                   MOVEL     'PR'          ZINPAG
     C* Actualiza PAGAR1
     C*EJECUTAR M15040
     C                   EXSR      M15040
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico acred.X C.V.E
     C*SI ZVMCVE > *CERO O ZCMCVE > *CERO
     C     ZVMCVE        IFGT      *ZERO
     C     ZCMCVE        ORGT      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '03'
     C                   MOVEL     '03'          ZCONCE
     C* Valor valor movimiento C.V.E.
     C*MOVER ZVALHI ZVMCVE
     C                   Z-ADD     ZVMCVE        ZVALHI
     C* Cuotas movimiento C.V.E.
     C*MOVER ZCUOHI ZCMCVE
     C                   Z-ADD     ZCMCVE        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C* Acumulado valor rep. totales
     C*SUMAR ZVMCVE ZVAVEA
     C                   ADD       ZVMCVE        ZVAVEA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCMCVE ZCUVEA
     C                   ADD       ZCMCVE        ZCUVEA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico acred.X COMISION C.V.A
     C*SI ZVMCCA |= *CERO O ZCMCCA |= *CERO
     C     ZVMCCA        IFNE      *ZERO
     C     ZCMCCA        ORNE      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '07'
     C                   MOVEL     '07'          ZCONCE
     C* Valor
     C*MOVER ZVALHI ZVMCCA
     C                   Z-ADD     ZVMCCA        ZVALHI
     C* Cuotas
     C*MOVER ZCUOHI ZCMCCA
     C                   Z-ADD     ZCMCCA        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Acumulado valor rep. totales
     C*SUMAR ZVMCCA ZVACAA
     C                   ADD       ZVMCCA        ZVACAA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCMCCA ZCUCAA
     C                   ADD       ZCMCCA        ZCUCAA
     C* Ind de PAGAR1
     C*PASAR ZINPAG 'VA'
     C                   MOVEL     'VA'          ZINPAG
     C* Actualiza PAGAR1
     C*EJECUTAR M15040
     C                   EXSR      M15040
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico acred.X COMISION C.V.E
     C*SI ZVMCCE |= *CERO O ZCMCCE |= *CERO
     C     ZVMCCE        IFNE      *ZERO
     C     ZCMCCE        ORNE      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '09'
     C                   MOVEL     '09'          ZCONCE
     C* Valor
     C*MOVER ZVALHI ZVMCCE
     C                   Z-ADD     ZVMCCE        ZVALHI
     C* Cuotas
     C*MOVER ZCUOHI ZCMCCE
     C                   Z-ADD     ZCMCCE        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Acumulado valor rep. totales
     C*SUMAR ZVMCCE ZVACEA
     C                   ADD       ZVMCCE        ZVACEA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCMCCE ZCUCEA
     C                   ADD       ZCMCCE        ZCUCEA
     C* Ind de PAGAR1
     C*PASAR ZINPAG 'VE'
     C                   MOVEL     'VE'          ZINPAG
     C* Actualiza PAGAR1
     C*EJECUTAR M15040
     C                   EXSR      M15040
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Histórico de acreditación IV                                ==
     C*==                                                              ==
     C*==================================================================
     C     M15070        BEGSR
     C* Genera histórico acred.X COMISION C.O
     C*SI ZVMCCO |= *CERO O ZCMCCO |= *CERO
     C     ZVMCCO        IFNE      *ZERO
     C     ZCMCCO        ORNE      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '06'
     C                   MOVEL     '06'          ZCONCE
     C* Valor
     C*MOVER ZVALHI ZVMCCO
     C                   Z-ADD     ZVMCCO        ZVALHI
     C* Cuotas
     C*MOVER ZCUOHI ZCMCCO
     C                   Z-ADD     ZCMCCO        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Acumulado valor rep. totales
     C*SUMAR ZVMCCO ZVACCA
     C                   ADD       ZVMCCO        ZVACCA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCMCCO ZCUCCA
     C                   ADD       ZCMCCO        ZCUCCA
     C* Ind de PAGAR1
     C*PASAR ZINPAG 'CO'
     C                   MOVEL     'CO'          ZINPAG
     C* Actualiza PAGAR1
     C*EJECUTAR M15040
     C                   EXSR      M15040
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico acred.X FGPM
     C*SI ZVMFGP > *CERO O ZCMFGP > *CERO
     C     ZVMFGP        IFGT      *ZERO
     C     ZCMFGP        ORGT      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '12'
     C                   MOVEL     '12'          ZCONCE
     C* Valor
     C*MOVER ZVALHI ZVMFGP
     C                   Z-ADD     ZVMFGP        ZVALHI
     C* Cuotas
     C*MOVER ZCUOHI ZCMFGP
     C                   Z-ADD     ZCMFGP        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Acumulado valor rep. totales
     C*SUMAR ZVMFGP ZVAFGA
     C                   ADD       ZVMFGP        ZVAFGA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCMFGP ZCUFGA
     C                   ADD       ZCMFGP        ZCUFGA
     C* Ind de PAGAR1
     C*PASAR ZINPAG 'FG'
     C                   MOVEL     'FG'          ZINPAG
     C* Actualiza PAGAR1
     C*EJECUTAR M15040
     C                   EXSR      M15040
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico acred.X INT FGPM
     C*SI ZVMIFG > *CERO O ZCMIFG > *CERO
     C     ZVMIFG        IFGT      *ZERO
     C     ZCMIFG        ORGT      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '15'
     C                   MOVEL     '15'          ZCONCE
     C* Valor
     C*MOVER ZVALHI ZVMIFG
     C                   Z-ADD     ZVMIFG        ZVALHI
     C* Cuotas
     C*MOVER ZCUOHI ZCMIFG
     C                   Z-ADD     ZCMIFG        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Acumulado valor rep. totales
     C*SUMAR ZVALHI ZVIFGA
     C                   ADD       ZVALHI        ZVIFGA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCUOHI ZCIFGA
     C                   ADD       ZCUOHI        ZCIFGA
     C* Ind de PAGAR1
     C*PASAR ZINPAG 'IG'
     C                   MOVEL     'IG'          ZINPAG
     C* Actualiza PAGAR1
     C*EJECUTAR M15040
     C                   EXSR      M15040
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C*SI ZINREF = 'S'
     C     ZINREF        IFEQ      'S'
     C* Genera histórico acred.X SFSP
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C*SI ZVMSFS > *CERO O ZCMSFS > *CERO
     C     ZVMSFS        IFGT      *ZERO
     C     ZCMSFS        ORGT      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '13'
     C                   MOVEL     '13'          ZCONCE
     C* FSP valor
     C*CALCULAR ZVALHI = ZVMSFS
     C                   Z-ADD     ZVMSFS        ZVALHI
     C* FSP cuotas
     C*CALCULAR ZCUOHI = ZCMSFS
     C                   Z-ADD     ZCMSFS        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Acumulado valor rep. totales
     C*SUMAR ZVALHI ZVSFSA
     C                   ADD       ZVALHI        ZVSFSA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCUOHI ZCSFSA
     C                   ADD       ZCUOHI        ZCSFSA
     C* Ind de PAGAR1
     C*PASAR ZINPAG 'SF'
     C                   MOVEL     'SF'          ZINPAG
     C* Actualiza PAGAR1
     C*EJECUTAR M15040
     C                   EXSR      M15040
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico acred.X INT SFSP
     C*SI ZVMISF > *CERO O ZCMISF > *CERO
     C     ZVMISF        IFGT      *ZERO
     C     ZCMISF        ORGT      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '14'
     C                   MOVEL     '14'          ZCONCE
     C* Int. FSP valor
     C*CALCULAR ZVALHI = ZVMISF
     C                   Z-ADD     ZVMISF        ZVALHI
     C* Int. FSP cuotas
     C*CALCULAR ZCUOHI = ZCMISF
     C                   Z-ADD     ZCMISF        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Acumulado valor rep. totales
     C*SUMAR ZVALHI ZVISFA
     C                   ADD       ZVALHI        ZVISFA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZCUOHI ZCISFA
     C                   ADD       ZCUOHI        ZCISFA
     C* Ind de PAGAR1
     C*PASAR ZINPAG 'IS'
     C                   MOVEL     'IS'          ZINPAG
     C* Actualiza PAGAR1
     C*EJECUTAR M15040
     C                   EXSR      M15040
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico acred.X REZAGOS
     C*SI ZTOVRE > *CERO O ZTOCRE > *CERO
     C     ZTOVRE        IFGT      *ZERO
     C     ZTOCRE        ORGT      *ZERO
     C* Tipo de transaccion
     C*PASAR ZCODTX '05'
     C                   MOVEL     '05'          ZCODTX
     C* Tipo de concepto
     C*PASAR ZCONCE '31'
     C                   MOVEL     '31'          ZCONCE
     C*SI ZFSPRE = '1'
     C     ZFSPRE        IFEQ      '1'
     C*CALCULAR ZTOVRE = ZTOVRE - ZVFSRE
     C     ZTOVRE        SUB       ZVFSRE        ZTOVRE
     C*CALCULAR ZTOCRE = ZTOCRE - ZCFSRE
     C     ZTOCRE        SUB       ZCFSRE        ZTOCRE
     C*FIN
     C                   END
     C*SI ZDEURE > 0
     C     ZDEURE        IFGT      0
     C*CALCULAR ZTOVRE = ZTOVRE - ZDEURE
     C     ZTOVRE        SUB       ZDEURE        ZTOVRE
     C*FIN
     C                   END
     C* Valor
     C*MOVER ZVALHI ZTOVRE
     C                   Z-ADD     ZTOVRE        ZVALHI
     C* Cuotas
     C*MOVER ZCUOHI ZTOCRE
     C                   Z-ADD     ZTOCRE        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SI ZDEURE > 0
     C     ZDEURE        IFGT      0
     C*CALCULAR ZTOVRE = ZTOVRE + ZDEURE
     C     ZTOVRE        ADD       ZDEURE        ZTOVRE
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* No vinculados
     C*SI ZTOVRN > *CERO O ZTOCRN > *CERO
     C     ZTOVRN        IFGT      *ZERO
     C     ZTOCRN        ORGT      *ZERO
     C* Tipo de concepto
     C*PASAR ZCONCE '60'
     C                   MOVEL     '60'          ZCONCE
     C*MOVER ZVALHI ZTOVRN
     C                   Z-ADD     ZTOVRN        ZVALHI
     C*MOVER ZCUOHI ZTOCRN
     C                   Z-ADD     ZTOCRN        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Genera histórico acred.X RET. CONTINGENTE
     C*SI ZVRRET > *CERO
     C     ZVRRET        IFGT      *ZERO
     C* Tipo de transaccion
     C*PASAR ZCODTX '02'
     C                   MOVEL     '02'          ZCODTX
     C* Tipo de concepto
     C*PASAR ZCONCE '60'
     C                   MOVEL     '60'          ZCONCE
     C* Valor retención contingente
     C*MOVER ZVALHI ZVRRET
     C                   Z-ADD     ZVRRET        ZVALHI
     C* Cuotas
     C*LIMPIAR ZCUOHI
     C                   CLEAR                   ZCUOHI
     C* Genera histórico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  se verifica diferencia                                      ==
     C*==                                                              ==
     C*==================================================================
     C     M15169        BEGSR
     C*SI ZTVDEP <> ZTVHIS O ZTCDEP <> ZTCHIS
     C     ZTVDEP        IFNE      ZTVHIS
     C     ZTCDEP        ORNE      ZTCHIS
     C*CALCULAR ZDIFDE=ZTCDEP-ZTCHIS
     C     ZTCDEP        SUB       ZTCHIS        ZDIFDE
     C* ACREDITO MAS
     C*CALCULAR ZDEINF=(-1/10000)/10000
     C                   Z-SUB     1             V$CA1           030 9
     C     V$CA1         DIV       10000         V$CA1
     C     V$CA1         DIV       10000         ZDEINF
     C* ACREDITO MENOS
     C*CALCULAR ZDESUP=ZDEINF*-1
     C                   Z-SUB     1             V$CA1           030 9
     C     ZDEINF        MULT      V$CA1         ZDESUP
     C* Diferencia por redondeo
     C*SI ZDIFDE=ZDEINF O ZDIFDE=ZDESUP
     C     ZDIFDE        IFEQ      ZDEINF
     C     ZDIFDE        OREQ      ZDESUP
     C* Ajuste de cuotas
     C*EJECUTAR M15170
     C                   EXSR      M15170
     C*SINO
     C                   ELSE
     C*SI ZT@002<>'3'
     C     ZT@002        IFNE      '3'
     C*PASAR ZERROR 'Total depósitos diferente a total acreditado'
     C                   MOVEL     $HIL(085)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  ajuste de ultimo movimientos, rezago o PE                   ==
     C*==                                                              ==
     C*==================================================================
     C     M15170        BEGSR
     C*RECUPERAR MOVARC (ZFONDO ZMVPLA ZMVPAG ZMVSEC ZMVCNN ZMVINT)
     C     LL$115        KLIST
     C                   KFLD                    ZFONDO
     C                   KFLD                    ZMVPLA
     C                   KFLD                    ZMVPAG
     C                   KFLD                    ZMVSEC
     C                   KFLD                    ZMVCNN
     C                   KFLD                    ZMVINT
     C     LL$115        CHAIN     MOVARC                             67
     C     *IN67         IFEQ      '1'
     C     *NOKEY        CLEAR                   MOVREG
     C                   END
     C*SI ERE(MOVARC)
     C     *IN67         IFEQ      '0'
     C* Hay C.O
     C*SI MOVCUO>0
     C     MOVCUO        IFGT      0
     C* Acumula a CO
     C*SUMAR ZDIFDE MOVCUO
     C                   ADD       ZDIFDE        MOVCUO
     C*GRABAR MOVARC
     C     *IN67         IFEQ      '0'
     C                   UPDATE    MOVREG                               94
     C                   ELSE
     C                   WRITE     MOVREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Tipo de concepto
     C*PASAR ZCONCE '01'
     C                   MOVEL     '01'          ZCONCE
     C* Act HISAR4
     C*EJECUTAR M15171
     C                   EXSR      M15171
     C* Acumulado valor rep. totales
     C*SUMAR 0 ZVACOA
     C                   ADD       0             ZVACOA
     C* Acumulado cuotas rep. totales
     C*SUMAR ZDIFDE ZCUCOA
     C                   ADD       ZDIFDE        ZCUCOA
     C*SINO
     C                   ELSE
     C* hay comision
     C*SI MOVCU2>0
     C     MOVCU2        IFGT      0
     C* acumula a comision
     C*SUMAR ZDIFDE MOVCU2
     C                   ADD       ZDIFDE        MOVCU2
     C*GRABAR MOVARC
     C     *IN67         IFEQ      '0'
     C                   UPDATE    MOVREG                               94
     C                   ELSE
     C                   WRITE     MOVREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Tipo de concepto
     C*PASAR ZCONCE '06'
     C                   MOVEL     '06'          ZCONCE
     C* Valor
     C*MOVER ZVALHI 0
     C                   Z-ADD     0             ZVALHI
     C* Cuotas
     C*MOVER ZCUOHI ZDIFDE
     C                   Z-ADD     ZDIFDE        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Valor
     C*MOVER ZVMCCO 0
     C                   Z-ADD     0             ZVMCCO
     C* Cuotas
     C*MOVER ZCMCCO ZDIFDE
     C                   Z-ADD     ZDIFDE        ZCMCCO
     C* Ind de PAGAR1
     C*PASAR ZINPAG 'CO'
     C                   MOVEL     'CO'          ZINPAG
     C* Actualiza PAGAR1
     C*EJECUTAR M15040
     C                   EXSR      M15040
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*  hau prima
     C*SI MOVCU7>0
     C     MOVCU7        IFGT      0
     C* Acumula prima
     C*SUMAR ZDIFDE MOVCU7
     C                   ADD       ZDIFDE        MOVCU7
     C*GRABAR MOVARC
     C     *IN67         IFEQ      '0'
     C                   UPDATE    MOVREG                               94
     C                   ELSE
     C                   WRITE     MOVREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Tipo de concepto
     C*PASAR ZCONCE '08'
     C                   MOVEL     '08'          ZCONCE
     C* Valor
     C*MOVER ZVALHI 0
     C                   Z-ADD     0             ZVALHI
     C* Cuotas
     C*MOVER ZCUOHI ZDIFDE
     C                   Z-ADD     ZDIFDE        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Acumulado valor rep. totales
     C*MOVER ZVMPS 0
     C                   Z-ADD     0             ZVMPS
     C* Acumulado cuotas rep. totales
     C*MOVER ZCMPS ZDIFDE
     C                   Z-ADD     ZDIFDE        ZCMPS
     C* Ind de PAGAR1
     C*PASAR ZINPAG 'PR'
     C                   MOVEL     'PR'          ZINPAG
     C* Actualiza PAGAR1
     C*EJECUTAR M15040
     C                   EXSR      M15040
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* haY FGPM
     C*SI MOV056>0
     C     MOV056        IFGT      0
     C* Acumula FGPM
     C*SUMAR ZDIFDE MOV056
     C                   ADD       ZDIFDE        MOV056
     C*GRABAR MOVARC
     C     *IN67         IFEQ      '0'
     C                   UPDATE    MOVREG                               94
     C                   ELSE
     C                   WRITE     MOVREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Tipo de concepto
     C*PASAR ZCONCE '12'
     C                   MOVEL     '12'          ZCONCE
     C* Valor
     C*MOVER ZVALHI 0
     C                   Z-ADD     0             ZVALHI
     C* Cuotas
     C*MOVER ZCUOHI ZDIFDE
     C                   Z-ADD     ZDIFDE        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Ind de PAGAR1
     C*PASAR ZINPAG 'FG'
     C                   MOVEL     'FG'          ZINPAG
     C* Actualiza PAGAR1
     C*EJECUTAR M15040
     C                   EXSR      M15040
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*RECUPERAR REZARC (ZMVPLA ZMVPAG ZMVSEC)
     C     LL$116        KLIST
     C                   KFLD                    ZMVPLA
     C                   KFLD                    ZMVPAG
     C                   KFLD                    ZMVSEC
     C     LL$116        CHAIN     REZARC                             76
     C     *IN76         IFEQ      '1'
     C     *NOKEY        CLEAR                   REZREG
     C                   END
     C*SI ERE(REZARC)
     C     *IN76         IFEQ      '0'
     C* Acumula FGPM
     C*SUMAR ZDIFDE REZCUO
     C                   ADD       ZDIFDE        REZCUO
     C*GRABAR REZARC
     C     *IN76         IFEQ      '0'
     C                   UPDATE    REZREG                               94
     C                   ELSE
     C                   WRITE     REZREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Tipo de transaccion
     C*PASAR ZCODTX '05'
     C                   MOVEL     '05'          ZCODTX
     C* Tipo de concepto
     C*PASAR ZCONCE '31'
     C                   MOVEL     '31'          ZCONCE
     C*MOVER ZTOVRE 0
     C                   Z-ADD     0             ZTOVRE
     C*MOVER ZTOCRE ZDIFDE
     C                   Z-ADD     ZDIFDE        ZTOCRE
     C* Valor
     C*MOVER ZVALHI ZTOVRE
     C                   Z-ADD     ZTOVRE        ZVALHI
     C* Cuotas
     C*MOVER ZCUOHI ZTOCRE
     C                   Z-ADD     ZTOCRE        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*SINO
     C                   ELSE
     C*RECUPERAR PAGARC (ZMVPLA)
     C     ZMVPLA        CHAIN     PAGARC                             70
     C     *IN70         IFEQ      '1'
     C     *NOKEY        CLEAR                   PAGREG
     C                   END
     C*SI ERE(PAGARC)
     C     *IN70         IFEQ      '0'
     C* Acumula al PE
     C*SUMAR ZDIFDE PAGCU2
     C                   ADD       ZDIFDE        PAGCU2
     C* Acumula al PE
     C*SUMAR ZDIFDE PAGSA4
     C                   ADD       ZDIFDE        PAGSA4
     C*GRABAR PAGARC
     C     *IN70         IFEQ      '0'
     C                   UPDATE    PAGREG                               94
     C                   ELSE
     C                   WRITE     PAGREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Cód. transacción
     C*PASAR ZCODTX '04'
     C                   MOVEL     '04'          ZCODTX
     C* Si no se está acred. rezagos
     C*SI ZT@002 ]= '3'
     C     ZT@002        IFNE      '3'
     C* Tipo de concepto
     C*PASAR ZCONCE '34'
     C                   MOVEL     '34'          ZCONCE
     C*SINO
     C                   ELSE
     C* Tipo de concepto
     C*PASAR ZCONCE '35'
     C                   MOVEL     '35'          ZCONCE
     C*FIN
     C                   END
     C*MOVER ZVRPE 0
     C                   Z-ADD     0             ZVRPE
     C*MOVER ZCUPE ZDIFDE
     C                   Z-ADD     ZDIFDE        ZCUPE
     C* Valor pago en exceso
     C*MOVER ZVALHI 0
     C                   Z-ADD     0             ZVALHI
     C* Cuotas pago en exceso
     C*MOVER ZCUOHI ZDIFDE
     C                   Z-ADD     ZDIFDE        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C* Genera registro P.E. fecha fondo
     C*EJECUTAR M15021
     C                   EXSR      M15021
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza HISAR4 para ajuste de 0.0000001                   ==
     C*==                                                              ==
     C*==================================================================
     C     M15171        BEGSR
     C* Valor valor movimiento C.O.
     C*MOVER ZVALHI 0
     C                   Z-ADD     0             ZVALHI
     C* Cuotas movimiento C.O.
     C*MOVER ZCUOHI ZDIFDE
     C                   Z-ADD     ZDIFDE        ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C                   ENDSR
     C*==================================================================
     C*==  Determina si debe anular deudas por delta                   ==
     C*==                                                              ==
     C*==================================================================
     C     M15500        BEGSR
     C* Si debe anular deudas por delta
     C*SI ZANUDE = 'S' Y ZSALIR <> '1'
     C     ZANUDE        IFEQ      'S'
     C     ZSALIR        ANDNE     '1'
     C* Se debe inicializar los encabezados de los reportes de anulación
     C* Si existe deuda real a anular
     C*SI ZTOTDE > *CERO O ZTOTD1 > *CERO
     C     ZTOTDE        IFGT      *ZERO
     C     ZTOTD1        ORGT      *ZERO
     C* Recupera datos enc. de reportes
     C*EJECUTAR M15580
     C                   EXSR      M15580
     C* Imprime encabezados rep. deudas
     C*EJECUTAR ENC@@2
     C                   EXSR      ENC@@2
     C*
     C* Ind. plan. can. pendientes
     C*LIMPIAR ZPLCAN ZTIPDE
     C                   CLEAR                   ZPLCAN
     C                   CLEAR                   ZTIPDE
     C* Programa que determina si la planilla tiene planillas de cancela
     C* pendientes por acreditar, y si es así imprime reporte con estas.
     C*LLAMAR TRPLAN6B (PLANU1 PLAPER PLATI1 PLANU4 ZPLCAN)
     C                   CALL      'TRPLAN6B'
     C                   PARM                    PLANU1
     C                   PARM                    PLAPER
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    ZPLCAN
     C*
     C* Si no tiene plan. cancel.
     C*SI ZPLCAN != 'S'
     C     ZPLCAN        IFNE      'S'
     C* Valor de la deuda real 01 y 05
     C*LIMPIAR ZVRDEU
     C                   CLEAR                   ZVRDEU
     C*CALCULAR ZVRDEU = ZTOTDE + ZTOTD1
     C     ZTOTDE        ADD       ZTOTD1        ZVRDEU
     C* Valor de deuda de rezagos
     C*LIMPIAR ZVALRZ
     C                   CLEAR                   ZVALRZ
     C* Se posiciona en el archivo
     C*INICIAR REZARC (PLANU1)
     C     PLANU1        SETLL     REZARC                             76
     C*MIENTRAS NFA(REZARC) Y REZNRO=PLANU1
     C     *IN76         DOWEQ     '0'
     C     REZNRO        ANDEQ     PLANU1
     C* Calcula total deuda de RZ
     C*CALCULAR ZVALRZ = ZVALRZ + REZDEU
     C     ZVALRZ        ADD       REZDEU        ZVALRZ
     C* Lee el registro
     C*LEER REZARC
     C                   READ      REZARC                                 76
     C*FIN
     C                   END
     C*SI Z13783 = 1
     C     Z13783        IFEQ      1
     C* Valida si anula deuda nw delta
     C*EJECUTAR M15531
     C                   EXSR      M15531
     C*SINO
     C                   ELSE
     C* Valida si anula deuda
     C*EJECUTAR M15530
     C                   EXSR      M15530
     C* Si anula deuda por delta
     C*SI ZINDAN = '1'
     C     ZINDAN        IFEQ      '1'
     C* Si total deuda mayor a cero
     C*SI ZTOTDE > *CERO
     C     ZTOTDE        IFGT      *ZERO
     C* No es planilla de terceros
     C*SI PLATIP <> '07'
     C     PLATIP        IFNE      '07'
     C* Tipo de deuda
     C*ASIGNAR ZTIPDE '01'
     C                   MOVEL     '01'          ZTIPDE
     C* Planilla de terceros
     C*SINO
     C                   ELSE
     C* Tipo de deuda
     C*ASIGNAR ZTIPDE '07'
     C                   MOVEL     '07'          ZTIPDE
     C*FIN
     C                   END
     C* Proceso de anulación de deuda
     C*EJECUTAR M15540
     C                   EXSR      M15540
     C*FIN
     C                   END
     C* Si total deuda mayor a cero
     C*SI ZTOTD1 > *CERO Y ZSALIR != '1'
     C     ZTOTD1        IFGT      *ZERO
     C     ZSALIR        ANDNE     '1'
     C* Tipo de deuda
     C*ASIGNAR ZTIPDE '05'
     C                   MOVEL     '05'          ZTIPDE
     C* Proceso de anulación de deuda
     C*EJECUTAR M15540
     C                   EXSR      M15540
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*
     C* Saldo de la deuda no aplica para los deltas de anulación
     C*
     C*PASAR ZOBSER 'Saldo deuda no aplica para deltas de anulación'
     C                   MOVEL     $HIL(086)     ZOBSER
     C* Imprime det. deuda no anulada
     C*EJECUTAR DET@06
     C                   EXSR      DET@06
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*
     C* Planilla tiene planillas de cancelación pendientes
     C*
     C*PASAR ZOBSER 'Planilla tiene plan. de cancelación. Ver TRPLAN6B'
     C                   MOVEL     $HIL(087)     ZOBSER
     C* Imprime det. deuda no anulada
     C*EJECUTAR DET@06
     C                   EXSR      DET@06
     C*FIN
     C                   END
     C* Fin reporte deudas anuladas
     C*IMPRIMIR FMT@F5
     C                   EXCEPT    FMT@F5
     C* Fin reporte deudas no anuladas
     C*IMPRIMIR FMT@F6
     C                   EXCEPT    FMT@F6
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Valida anulación de deudas por delta                        ==
     C*==                                                              ==
     C*==================================================================
     C     M15530        BEGSR
     C* Valor deuda a anular
     C*LIMPIAR ZDEUSA
     C                   CLEAR                   ZDEUSA
     C* Indicador de anular deuda
     C*LIMPIAR ZINDAN
     C                   CLEAR                   ZINDAN
     C* Saldo deuda + rezagos con deuda
     C*CALCULAR ZDEUSA = ZVRDEU + ZVALRZ
     C     ZVRDEU        ADD       ZVALRZ        ZDEUSA
     C* Si saldo a anular es > cero
     C*SI ZDEUSA > *CERO
     C     ZDEUSA        IFGT      *ZERO
     C* Año de búsqueda de deltas
     C*PASAR ZANO PLAPER
     C                   MOVEL     PLAPER        ZANO
     C* Deltas por porcentaje y valor
     C*LIMPIAR ZVALPO ZVALVA
     C                   CLEAR                   ZVALPO
     C                   CLEAR                   ZVALVA
     C* Ind. error deltas anulación
     C*LIMPIAR ZERRDE
     C                   CLEAR                   ZERRDE
     C* Ind. Calculo deudas con o sin intereses
     C*LIMPIAR ZINDEL
     C                   CLEAR                   ZINDEL
     C*LLAMAR TRDELA50 (ZANO ZVALPO ZVALVA ZERRDE ZINDEL)
     C                   CALL      'TRDELA50'
     C                   PARM                    ZANO
     C                   PARM                    ZVALPO
     C                   PARM                    ZVALVA
     C                   PARM                    ZERRDE
     C                   PARM                    ZINDEL
     C* Ind. error en deltas de anul.
     C*SI ZERRDE = '0'
     C     ZERRDE        IFEQ      '0'
     C* Valor del delta por pocentaje
     C*LIMPIAR ZDELPO
     C                   CLEAR                   ZDELPO
     C*
     C* Calcula valor del delta por porcentaje con total planilla
     C*
     C*CALCULAR ZDELPO = (ZVALPO * PLATO8) / 100
     C     ZVALPO        MULT      PLATO8        V$CA1           030 9
     C     V$CA1         DIV       100           ZDELPO
     C*
     C* Si el saldo de la deuda < delta por % y < delta por valor
     C*
     C*SI ZDEUSA <= ZDELPO Y ZDEUSA <= ZVALVA
     C     ZDEUSA        IFLE      ZDELPO
     C     ZDEUSA        ANDLE     ZVALVA
     C* Ind. de anular deuda
     C*PASAR ZINDAN '1'
     C                   MOVEL     '1'           ZINDAN
     C*SINO
     C                   ELSE
     C* Ind. de anular deuda
     C*PASAR ZINDAN '0'
     C                   MOVEL     '0'           ZINDAN
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*
     C* Error al recuperar deltas de anulación para año de la deuda
     C*
     C*PASAR ZOBSER 'No existen deltas de anulación para año de deuda'
     C                   MOVEL     $HIL(088)     ZOBSER
     C* Imprime detalle deuda no anulada
     C*EJECUTAR DET@06
     C                   EXSR      DET@06
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*
     C* Deuda a anular no mayor a cero
     C*
     C*PASAR ZOBSER 'Saldo deuda a anular no es mayor a cero'
     C                   MOVEL     $HIL(089)     ZOBSER
     C* Imprime detalle deuda no anulada
     C*EJECUTAR DET@06
     C                   EXSR      DET@06
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Valida si anula deuda nuevo delta                           ==
     C*==                                                              ==
     C*==================================================================
     C     M15531        BEGSR
     C* Valor deuda a anular
     C*LIMPIAR ZDEUSA
     C                   CLEAR                   ZDEUSA
     C* Indicador de anular deuda
     C*LIMPIAR ZINDAN
     C                   CLEAR                   ZINDAN
     C* Saldo deuda + rezagos con deuda
     C*CALCULAR ZDEUSA = ZVRDEU + ZVALRZ
     C     ZVRDEU        ADD       ZVALRZ        ZDEUSA
     C* No es planilla de terceros
     C*SI PLATIP <> '07'
     C     PLATIP        IFNE      '07'
     C* Tipo de deuda
     C*ASIGNAR ZTIPDE '01'
     C                   MOVEL     '01'          ZTIPDE
     C* Planilla de terceros
     C*SINO
     C                   ELSE
     C* Tipo de deuda
     C*ASIGNAR ZTIPDE '07'
     C                   MOVEL     '07'          ZTIPDE
     C*FIN
     C                   END
     C* Si saldo a anular es > cero
     C*SI ZDEUSA > *CERO
     C     ZDEUSA        IFGT      *ZERO
     C*LIMPIAR ZINDAN ZCADDU
     C                   CLEAR                   ZINDAN
     C                   CLEAR                   ZCADDU
     C* Año de búsqueda de deltas
     C*PASAR ZANO PLAPER
     C                   MOVEL     PLAPER        ZANO
     C* Deltas por porcentaje y valor
     C*LIMPIAR ZVALPO ZVALVA
     C                   CLEAR                   ZVALPO
     C                   CLEAR                   ZVALVA
     C* Ind. error deltas anulación
     C*LIMPIAR ZERRDE
     C                   CLEAR                   ZERRDE
     C* Ind. Calculo deudas con o sin intereses
     C*LIMPIAR ZINDEL
     C                   CLEAR                   ZINDEL
     C*LLAMAR TRDELA50 (ZANO ZVALPO ZVALVA ZERRDE ZINDEL)
     C                   CALL      'TRDELA50'
     C                   PARM                    ZANO
     C                   PARM                    ZVALPO
     C                   PARM                    ZVALVA
     C                   PARM                    ZERRDE
     C                   PARM                    ZINDEL
     C* Ind. error en deltas de anul.
     C*SI ZERRDE = '0'
     C     ZERRDE        IFEQ      '0'
     C* Error en la anulación deuda
     C*LIMPIAR ZERRAN
     C                   CLEAR                   ZERRAN
     C* Causal de anulación por delta
     C*PASAR ZCAUSA 'A09'
     C                   MOVEL     'A09'         ZCAUSA
     C* Código movimiento de deuda
     C*MOVER ZCODMO 37
     C                   Z-ADD     37            ZCODMO
     C*PASAR ZOBSER 'DEUDA/DETALLE ANULADO POR DELTA ACREDITADOR'
     C                   MOVEL     $HIL(090)     ZOBSER
     C*SQL
     C/EXEC SQL
     C+  DECLARE DET CURSOR FOR
     C+  SELECT
     C+  DETNU9,DETPA2,DETSE4,DETPER,DETSA1
     C+  FROM
     C+  DETAR2
     C+  WHERE
     C+  DETTIP = :ZTIPDE  AND
     C+  DETNU9 = :PLANU1  AND
     C+  DETEST NOT IN ('AND' , 'CAN') AND
     C+  DETSA1 > 0
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  OPEN DET
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  FETCH DET INTO :ZETNU9,:ZETPA2,:ZETSE4,:ZETPER,:ZETSA1
     C/END-EXEC
     C*MIENTRAS SQLCOD = 0
     C     SQLCOD        DOWEQ     0
     C*LLAMAR RPDEUD5A(ZETNU9 ZETPA2 ZETSE4 ZETPER ZETSA1 ZVALPO ZDELDI
     C                   CALL      'RPDEUD5A'
     C                   PARM                    ZETNU9
     C                   PARM                    ZETPA2
     C                   PARM                    ZETSE4
     C                   PARM                    ZETPER
     C                   PARM                    ZETSA1
     C                   PARM                    ZVALPO
     C                   PARM                    ZDELDI
     C                   PARM                    ZINDAN
     C*SI ZINDAN = '1'
     C     ZINDAN        IFEQ      '1'
     C*LLAMAR TRDEUD77 (ZTIPDE ZETNU9 ZETPA2 ZETSE4 ZCAUSA ZCODMO ZOBSER
     C                   CALL      'TRDEUD77'
     C                   PARM                    ZTIPDE
     C                   PARM                    ZETNU9
     C                   PARM                    ZETPA2
     C                   PARM                    ZETSE4
     C                   PARM                    ZCAUSA
     C                   PARM                    ZCODMO
     C                   PARM                    ZOBSER
     C                   PARM                    ZERRAN
     C* Si se anuló la deuda
     C*SI ZERRAN != '1' Y ZERRAN != '2'
     C     ZERRAN        IFNE      '1'
     C     ZERRAN        ANDNE     '2'
     C*PASAR ZCADDU '1'
     C                   MOVEL     '1'           ZCADDU
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  FETCH DET INTO :ZETNU9,:ZETPA2,:ZETSE4,:ZETPER,:ZETSA1
     C/END-EXEC
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  CLOSE DET
     C/END-EXEC
     C*SI ZCADDU = *BLANCOS
     C     ZCADDU        IFEQ      *BLANKS
     C*
     C* Saldo de la deuda no aplica para los deltas de anulación
     C*
     C*PASAR ZOBSER 'Detalles de deuda no aplican para delta anulación'
     C                   MOVEL     $HIL(091)     ZOBSER
     C* Imprime det. deuda no anulada
     C*EJECUTAR DET@06
     C                   EXSR      DET@06
     C*SINO
     C                   ELSE
     C*
     C* Por lo menos se anuló un detalle
     C*
     C* Imprime detalle deuda anulada
     C*EJECUTAR DET@05
     C                   EXSR      DET@05
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*
     C* Error al recuperar deltas de anulación para año de la deuda
     C*
     C*PASAR ZOBSER 'No existen deltas de anulación para año de deuda'
     C                   MOVEL     $HIL(092)     ZOBSER
     C* Imprime detalle deuda no anulada
     C*EJECUTAR DET@06
     C                   EXSR      DET@06
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*
     C* Deuda a anular no mayor a cero
     C*
     C*PASAR ZOBSER 'Saldo deuda a anular no es mayor a cero'
     C                   MOVEL     $HIL(093)     ZOBSER
     C* Imprime detalle deuda no anulada
     C*EJECUTAR DET@06
     C                   EXSR      DET@06
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Proceso de anulación de la deuda por delta                  ==
     C*==                                                              ==
     C*==================================================================
     C     M15540        BEGSR
     C* Página y secuencia de planilla
     C*LIMPIAR ZPAGIN ZSECUE
     C                   CLEAR                   ZPAGIN
     C                   CLEAR                   ZSECUE
     C* Error en la anulación deuda
     C*LIMPIAR ZERRAN
     C                   CLEAR                   ZERRAN
     C* Causal de anulación por delta
     C*PASAR ZCAUSA 'A09'
     C                   MOVEL     'A09'         ZCAUSA
     C* Código movimiento de deuda
     C*MOVER ZCODMO 37
     C                   Z-ADD     37            ZCODMO
     C*PASAR ZOBSER 'DEUDA/DETALLE ANULADO POR DELTA ACREDITADOR'
     C                   MOVEL     $HIL(094)     ZOBSER
     C*LLAMAR TRDEUD77 (ZTIPDE PLANU1 ZPAGIN ZSECUE ZCAUSA ZCODMO ZOBSER
     C                   CALL      'TRDEUD77'
     C                   PARM                    ZTIPDE
     C                   PARM                    PLANU1
     C                   PARM                    ZPAGIN
     C                   PARM                    ZSECUE
     C                   PARM                    ZCAUSA
     C                   PARM                    ZCODMO
     C                   PARM                    ZOBSER
     C                   PARM                    ZERRAN
     C* Si se anuló la deuda
     C*SI ZERRAN != '1' Y ZERRAN != '2'
     C     ZERRAN        IFNE      '1'
     C     ZERRAN        ANDNE     '2'
     C*
     C* Deuda anulada por delta
     C*
     C* Imprime detalle deuda no anulada
     C*EJECUTAR DET@05
     C                   EXSR      DET@05
     C*SINO
     C                   ELSE
     C*
     C* Error al anular la deuda
     C*
     C* Imprime detalle deuda no anulada
     C*EJECUTAR DET@06
     C                   EXSR      DET@06
     C*FIN
     C                   END
     C* Error en deud60 con HISAR4.
     C*SI ZERRAN = '2'
     C     ZERRAN        IFEQ      '2'
     C*PASAR ZERROR 'Error al actualizar HISAR4 en DEUD77, revise spool'
     C                   MOVEL     $HIL(095)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Determina si debe o no anular deudas por delta              ==
     C*==                                                              ==
     C*==================================================================
     C     M15550        BEGSR
     C* Si anula deudas por delta
     C*SI ZANUDE = 'S'
     C     ZANUDE        IFEQ      'S'
     C* Se debe inicializar los encabezados de los reportes de anulación
     C* Si existe deuda real a anular
     C*SI ZTOTDE > *CERO O ZTOTD1 > *CERO
     C     ZTOTDE        IFGT      *ZERO
     C     ZTOTD1        ORGT      *ZERO
     C* Recupera datos enc. de reportes
     C*EJECUTAR M15580
     C                   EXSR      M15580
     C* Imprime encabezados rep. deudas
     C*EJECUTAR ENC@@2
     C                   EXSR      ENC@@2
     C* Valida si debe anular deudas
     C*EJECUTAR M15560
     C                   EXSR      M15560
     C* Si debe anular deudas por delta
     C*SI ZINANU = 'S'
     C     ZINANU        IFEQ      'S'
     C* Total de la deuda real
     C*SI ZTOTDE > *CERO
     C     ZTOTDE        IFGT      *ZERO
     C* Tipo de deuda
     C*ASIGNAR ZTIPDE '01'
     C                   MOVEL     '01'          ZTIPDE
     C* Proceso anulación deudas
     C*EJECUTAR M15540
     C                   EXSR      M15540
     C* Tipo de deuda
     C*ASIGNAR ZTIPDE '07'
     C                   MOVEL     '07'          ZTIPDE
     C* Proceso anulación deudas
     C*EJECUTAR M15540
     C                   EXSR      M15540
     C*FIN
     C                   END
     C* Total deuda por afil. anterior
     C*SI ZTOTD1 > *CERO
     C     ZTOTD1        IFGT      *ZERO
     C* Tipo de deuda
     C*ASIGNAR ZTIPDE '05'
     C                   MOVEL     '05'          ZTIPDE
     C* Proceso anulación deudas
     C*EJECUTAR M15540
     C                   EXSR      M15540
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*
     C* No anula deuda porque no encontró deudas ya anuladas por delta
     C*
     C*PASAR ZOBSER 'Planilla no tiene deudas ya anuladas por delta'
     C                   MOVEL     $HIL(096)     ZOBSER
     C* Imprime det. deuda no anulada
     C*EJECUTAR DET@06
     C                   EXSR      DET@06
     C*FIN
     C                   END
     C* Impresión de finales de reportes
     C* Fin reporte deudas anuladas
     C*IMPRIMIR FMT@F5
     C                   EXCEPT    FMT@F5
     C* Fin reporte deudas no anuladas
     C*IMPRIMIR FMT@F6
     C                   EXCEPT    FMT@F6
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Valida si existen detalles de deuda anulados por delta      ==
     C*==                                                              ==
     C*==================================================================
     C     M15560        BEGSR
     C* Indicador de anular deudas
     C*LIMPIAR ZINANU
     C                   CLEAR                   ZINANU
     C* Tipo de deuda
     C*PASAR ZTIPDE '01'
     C                   MOVEL     '01'          ZTIPDE
     C* Busca deudas anul. por delta
     C*EJECUTAR M15570
     C                   EXSR      M15570
     C* Si no encontró deudas 01 anuladas
     C*SI ZINANU != 'S'
     C     ZINANU        IFNE      'S'
     C* Tipo de deuda
     C*PASAR ZTIPDE '07'
     C                   MOVEL     '07'          ZTIPDE
     C* Busca deudas anul. por delta
     C*EJECUTAR M15570
     C                   EXSR      M15570
     C* Si no encontró deudas 01 anuladas
     C*SI ZINANU != 'S'
     C     ZINANU        IFNE      'S'
     C* Tipo de deuda
     C*PASAR ZTIPDE '05'
     C                   MOVEL     '05'          ZTIPDE
     C* Busca deudas anul. por delta
     C*EJECUTAR M15570
     C                   EXSR      M15570
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Busca detalles de deuda anulados por delta                  ==
     C*==                                                              ==
     C*==================================================================
     C     M15570        BEGSR
     C*LIMPIAR ZHAYDT ZINANU
     C                   CLEAR                   ZHAYDT
     C                   CLEAR                   ZINANU
     C*SQL
     C/EXEC SQL
     C+  SELECT COUNT (*) INTO :ZHAYDT
     C+  FROM DEUARC, DETAR2 WHERE
     C+  DEUTIP=DETTIP AND DEUNUM=DETNU9 AND
     C+  DETEST='AND' AND DETC56 IN ('A09', 'A17') AND
     C+  DEUTIP=:ZTIPDE AND DEUNUM=:PLANU1
     C/END-EXEC
     C*SI ZHAYDT>*CERO
     C     ZHAYDT        IFGT      *ZERO
     C* Indicador de anular deudas
     C*PASAR ZINANU 'S'
     C                   MOVEL     'S'           ZINANU
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Recupera datos del empleador para reportes de anulación po  ==
     C*==                                                              ==
     C*==================================================================
     C     M15580        BEGSR
     C* Planilla de independiente, voluntario, tercero
     C*SI PLATIP = '02' O PLATIP = '03' O PLATIP = '07'
     C     PLATIP        IFEQ      '02'
     C     PLATIP        OREQ      '03'
     C     PLATIP        OREQ      '07'
     C* Tipo identificación empl.
     C*PASAR ZTIPEM PLATI1
     C                   MOVEL     PLATI1        ZTIPEM
     C* Identificación empleador
     C*MOVER ZNUMEM PLANU4
     C                   Z-ADD     PLANU4        ZNUMEM
     C* Razón social empleador
     C*PASAR ZRAZON PLANOM
     C                   MOVEL     PLANOM        ZRAZON
     C*SINO
     C                   ELSE
     C* Tipo identificación empl.
     C*PASAR ZTIPEM EMPTI1
     C                   MOVEL     EMPTI1        ZTIPEM
     C* Identificación empleador
     C*MOVER ZNUMEM EMPNU2
     C                   Z-ADD     EMPNU2        ZNUMEM
     C* Razón social empleador
     C*PASAR ZRAZON EMPRAZ
     C                   MOVEL     EMPRAZ        ZRAZON
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesar detalle de declaración y no pago                   ==
     C*==                                                              ==
     C*==================================================================
     C     M16000        BEGSR
     C* Se procesan todos los detalles de planillas
     C* Limpiar variables
     C*EJECUTAR M14010
     C                   EXSR      M14010
     C* Detalles de planilla
     C*INICIAR DETARC (PLANU3 PLANUM)
     C     LL$117        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$117        SETLL     DETARC                             49
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$118        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$118        READE     DETARC                                 49
     C*
     C* Recorre detalles de la planilla por lote y número de planilla
     C*
     C*MIENTRAS NFA(DETARC) Y DETNUM = PLANU3 Y DETNU3 = PLANUM Y ZSALIR
     C     *IN49         DOWEQ     '0'
     C     DETNUM        ANDEQ     PLANU3
     C     DETNU3        ANDEQ     PLANUM
     C     ZSALIR        ANDNE     '1'
     C*LIMPIAR ZOVCO1 ZOVPER ZOVTIP
     C                   CLEAR                   ZOVCO1
     C                   CLEAR                   ZOVPER
     C                   CLEAR                   ZOVTIP
     C*LIMPIAR ZDILIC ZDITRA
     C                   CLEAR                   ZDILIC
     C                   CLEAR                   ZDITRA
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC WHERE DETNU3 = :DETNU3 AND
     C+  DETPAG = :DETPAG AND DETSEC = :DETSEC
     C/END-EXEC
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C* Código interno afiliado
     C*MOVER AFINUM DETN04
     C                   Z-ADD     DETN04        AFINUM
     C* Número de cuenta
     C*MOVER CUENUM DETN04
     C                   Z-ADD     DETN04        CUENUM
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Calcular valor cotización
     C*EJECUTAR M11100
     C                   EXSR      M11100
     C* Rendimientos
     C*MOVER ZRENDI DETV14
     C                   Z-ADD     DETV14        ZRENDI
     C* Tot. cotizac.
     C*CALCULAR ZTOCOT = ZCOTAR + ZCOTOB + ZCOTVA + ZCOTVE
     C     ZCOTAR        ADD       ZCOTOB        V$CA1           030 9
     C     V$CA1         ADD       ZCOTVA        V$CA1
     C     V$CA1         ADD       ZCOTVE        ZTOCOT
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Período de la planilla
     C*PASAR ZPERCO PLAPER
     C                   MOVEL     PLAPER        ZPERCO
     C* Tipo de planilla
     C*PASAR ZTIPLA PLATIP
     C                   MOVEL     PLATIP        ZTIPLA
     C* Actualiza relación afil/empl.
     C*EJECUTAR M14040
     C                   EXSR      M14040
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Anula deudas presuntas
     C*EJECUTAR M14050
     C                   EXSR      M14050
     C* Verifica si hay deuda
     C*EJECUTAR M14080
     C                   EXSR      M14080
     C*LIMPIAR $$REDH
     C                   CLEAR                   $$REDH
     C* tipo RD
     C*PASAR ZPRF 'RD'
     C                   MOVEL     'RD'          ZPRF
     C*SI PLAFEC >= ZFEREC
     C     PLAFEC        IFGE      ZFEREC
     C*LLAMAR RPTPPF50(ZPRF ZTIPLP PLATIP PLAT03 ZEXITT)
     C                   CALL      'RPTPPF50'
     C                   PARM                    ZPRF
     C                   PARM                    ZTIPLP
     C                   PARM                    PLATIP
     C                   PARM                    PLAT03
     C                   PARM                    ZEXITT
     C*SI ZEXITT='S'
     C     ZEXITT        IFEQ      'S'
     C*SQL
     C/EXEC SQL
     C+  UPDATE SBDETARC SET DETDIA=0, DETDI1=0
     C+  WHERE DETNU3 = :DETNU3 AND
     C+  DETPAG = :DETPAG AND DETSEC = :DETSEC
     C/END-EXEC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Perìodo anterior cesantes
     C*SI ZSALIR |= '1'  Y PLAPER < ZPEVIG
     C     ZSALIR        IFNE      '1'
     C     PLAPER        ANDLT     ZPEVIG
     C* Reversa comisión cesantes
     C*EJECUTAR M14090
     C                   EXSR      M14090
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$119        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$119        READE     DETARC                                 49
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesa planillas de cancelación de deuda                   ==
     C*==                                                              ==
     C*==================================================================
     C     M20000        BEGSR
     C* Indicador pago en exceso
     C*MOVER ZINDPE '0'
     C                   MOVE      '0'           ZINDPE
     C* Número depósitos leidos
     C*MOVER K 1
     C                   Z-ADD     1             K
     C* Concilió con mas de un depós.
     C*SI PLANU8 = *CERO
     C     PLANU8        IFEQ      *ZERO
     C*LIMPIAR CONTI3
     C                   CLEAR                   CONTI3
     C*INICIAR CONAR202 (PLANU3 PLANUM CONTI3)
     C     LL$120        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    CONTI3
     C     LL$120        SETLL     CONAR202                           41
     C*LEER CONAR202
     C                   READ      CONAR202                               41
     C* Indicador pago en exceso
     C*MOVER ZINDPE '0'
     C                   MOVE      '0'           ZINDPE
     C*MIENTRAS NFA(CONAR202) Y PLANUM=CONNU5 Y CONTI3 = *BLANCO Y ZINDP
     C     *IN41         DOWEQ     '0'
     C     PLANUM        ANDEQ     CONNU5
     C     CONTI3        ANDEQ     *BLANK
     C     ZINDPE        ANDEQ     '0'
     C     ZSALIR        ANDNE     '1'
     C* Lote de depósitos
     C*MOVER ZLOTE  CONNU2
     C                   Z-ADD     CONNU2        ZLOTE
     C* Número de depósito
     C*MOVER ZDEPO  CONNU3
     C                   Z-ADD     CONNU3        ZDEPO
     C* Consecutivo depósito
     C*MOVER ZCONSE CONCO4
     C                   Z-ADD     CONCO4        ZCONSE
     C* Recuperar depósito
     C*EJECUTAR M12010
     C                   EXSR      M12010
     C* Liquida ints. deudas empleador
     C*EJECUTAR M12030
     C                   EXSR      M12030
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Cancelar deudas con plan.can.
     C*EJECUTAR M21000
     C                   EXSR      M21000
     C*FIN
     C                   END
     C* Valor depósito
     C*SI ZVRDEP > *CERO
     C     ZVRDEP        IFGT      *ZERO
     C* Indicador pago en exceso
     C*PASAR ZINDPE '1'
     C                   MOVEL     '1'           ZINDPE
     C*FIN
     C                   END
     C* Número de depósitos leidos
     C*SUMAR 1 K
     C                   ADD       1             K
     C*LEER CONAR202
     C                   READ      CONAR202                               41
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Lote de depósitos
     C*MOVER ZLOTE  PLANU8
     C                   Z-ADD     PLANU8        ZLOTE
     C* Número de depósito
     C*MOVER ZDEPO  PLANU9
     C                   Z-ADD     PLANU9        ZDEPO
     C* Consecutivo depósito
     C*MOVER ZCONSE PLACON
     C                   Z-ADD     PLACON        ZCONSE
     C* Recuperar depósito
     C*EJECUTAR M12010
     C                   EXSR      M12010
     C* Liquida ints. deudas empleador
     C*EJECUTAR M12030
     C                   EXSR      M12030
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Cancelar deudas con plan.can.
     C*EJECUTAR M21000
     C                   EXSR      M21000
     C*FIN
     C                   END
     C*SUMAR 1 K
     C                   ADD       1             K
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Genera encabezados e históri.
     C*EJECUTAR M15000
     C                   EXSR      M15000
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar deudas con planilla de cancelación                 ==
     C*==                                                              ==
     C*==================================================================
     C     M21000        BEGSR
     C* Canc. deudas
     C*EJECUTAR M21100
     C                   EXSR      M21100
     C                   ENDSR
     C*==================================================================
     C*==  Cancela deudas planilla                                     ==
     C*==                                                              ==
     C*==================================================================
     C     M21001        BEGSR
     C* Tipo de la deuda
     C*PASAR DEUTIP ZTIPDE
     C                   MOVEL     ZTIPDE        DEUTIP
     C* Planilla a corregir
     C*MOVER DEUNUM PLAN05
     C                   Z-ADD     PLAN05        DEUNUM
     C*INICIARI DEUARC (DEUTIP DEUNUM)
     C     LL$121        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C     LL$121        SETLL     DEUARC                                 50
     C     *IN50         IFEQ      '1'
     C                   MOVE      '0'           *IN50
     C                   ELSE
     C                   MOVE      '1'           *IN50
     C                   END
     C*SI ERE (DEUARC)
     C     *IN50         IFEQ      '0'
     C*RECUPERARD DEUARC (DEUTIP DEUNUM)
     C     LL$122        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C     LL$122        CHAIN     DEUARC                             5094
     C                   MOVE      *IN94         I$RND
     C     *IN50         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   DEUREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SI ZVRDEP > *CERO Y ZSALIR ]= '1'
     C     ZVRDEP        IFGT      *ZERO
     C     ZSALIR        ANDNE     '1'
     C* Histórico param. per. deuda
     C*EJECUTAR M21002
     C                   EXSR      M21002
     C*SI ZSALIR ]= '1'
     C     ZSALIR        IFNE      '1'
     C* Procesa deuda
     C*EJECUTAR M21500
     C                   EXSR      M21500
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SI RND
     C     I$RND         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'DEUARC no disponible - M21001'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(097)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*INICIAR DEUARC
     C     *LOVAL        SETLL     DEUARC                             50
     C                   ENDSR
     C*==================================================================
     C*==  Leer histórico de parámetros período de la deuda            ==
     C*==                                                              ==
     C*==================================================================
     C     M21002        BEGSR
     C* Estado de la deuda
     C*SI DEUEST <> 'AND' Y DEUEST <> 'CAN'
     C     DEUEST        IFNE      'AND'
     C     DEUEST        ANDNE     'CAN'
     C* Período para HISAR6
     C*PASAR ZHPPE1 DEUPER
     C                   MOVEL     DEUPER        ZHPPE1
     C* Recupera Hisar6
     C*LLAMAR TRHPAR55($$REG1)
     C                   CALL      'TRHPAR55'
     C                   PARM                    $$REG1
     C* Indicador de error
     C*SI ZHPIND = '1'
     C     ZHPIND        IFEQ      '1'
     C* Período de la deuda
     C*PASAR ZPERER DEUPER
     C                   MOVEL     DEUPER        ZPERER
     C* Período en formato pantalla
     C*F FPANPER (ZPERER)
     C                   CALL      'TRPANPER'                                   FPANPER
     C     ZPERER        PARM      ZPERER        F$0P1             6
     C*OBTENER (1) ZERROR = 'No existe histórico de parámetros para el p
     C                   CLEAR                   ZERROR
     C     $HIL(098)     CAT       ZPERER:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*SINO
     C                   ELSE
     C*PASAR ZPLAAA DEUNUM
     C                   MOVEL     DEUNUM        ZPLAAA
     C* Parametros decreto 558
     C*EJECUTAR M98415
     C                   EXSR      M98415
     C* Porcentaje de C.O.
     C*MOVER ZPCTCO ZHPPOR
     C                   Z-ADD     ZHPPOR        ZPCTCO
     C* Porcentaje fondo solidaridad
     C*MOVER ZPCTFS ZHPPO4
     C                   Z-ADD     ZHPPO4        ZPCTFS
     C* % a distrib. de FS a SFS
     C*MOVER ZPDSFS ZHPP50
     C                   Z-ADD     ZHPP50        ZPDSFS
     C* Salario mínimo
     C*MOVER ZSALMI ZHPVA2
     C                   Z-ADD     ZHPVA2        ZSALMI
     C* Salario máximo de cotización
     C*CALCULAR (R) ZSALMA = ZHPVA2 * ZHPN24
     C     ZHPVA2        MULT(H)   ZHPN24        ZSALMA
     C* Salario para cotizar f.s.
     C*CALCULAR (R) ZSALFS = ZHPVA2 * ZHPN05
     C     ZHPVA2        MULT(H)   ZHPN05        ZSALFS
     C* Días del período
     C*MOVER ZDIAPE ZHPN26
     C                   Z-ADD     ZHPN26        ZDIAPE
     C* Sector salud
     C*SI PLATIP = '04'
     C     PLATIP        IFEQ      '04'
     C* Período de planilla
     C*PASAR ZPER1 ZPERIO
     C                   MOVEL     ZPERIO        ZPER1
     C* Traer % sector salud
     C*EJECUTAR M21006
     C                   EXSR      M21006
     C*SINO
     C                   ELSE
     C* % com. cotiz. oblig.
     C*MOVER ZPCOCO ZHPPO1
     C                   Z-ADD     ZHPPO1        ZPCOCO
     C* % prima de seguro
     C*MOVER ZPORPS ZHPPO2
     C                   Z-ADD     ZHPPO2        ZPORPS
     C* % FGPM
     C*MOVER ZPFGPM ZHPP49
     C                   Z-ADD     ZHPP49        ZPFGPM
     C*FIN
     C                   END
     C* % com. cotiz. volunt.
     C*MOVER ZPORCV ZHPPO3
     C                   Z-ADD     ZHPPO3        ZPORCV
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Cancela deudas empleador                                    ==
     C*==                                                              ==
     C*==================================================================
     C     M21003        BEGSR
     C* Ind. Cancelación deuda
     C*LIMPIAR ZINCAD ZFDARC
     C                   CLEAR                   ZINCAD
     C                   CLEAR                   ZFDARC
     C*PASAR DEUTIP ZTIPDE
     C                   MOVEL     ZTIPDE        DEUTIP
     C* Busca deudas del empleador
     C*INICIAR DEUARC08 (DEUTIP PLANU4)
     C     LL$123        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C     LL$123        SETLL     DEUARC08                           53
     C*LEER DEUARC08(DEUTIP PLANU4)
     C     LL$124        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C     LL$124        READE     DEUARC08                               53
     C*MIENTRAS NFA(DEUARC08) Y DEUTIP=ZTIPDE Y PLANU4=DEUNRO Y ZVRDEP >
     C     *IN53         DOWEQ     '0'
     C     DEUTIP        ANDEQ     ZTIPDE
     C     PLANU4        ANDEQ     DEUNRO
     C     ZVRDEP        ANDGT     *ZERO
     C     ZSALIR        ANDNE     '1'
     C* Orden de acreditación definido en configuración
     C* Planillas normales o con prioridad
     C*SI ZACRCD = '1' O ZACRCD ='2'
     C     ZACRCD        IFEQ      '1'
     C     ZACRCD        OREQ      '2'
     C* Verifica si la planilla que generó deuda es de plaarc
     C*SQL
     C/EXEC SQL
     C+  SELECT PLANU1 INTO :ZDPLAN FROM PLAARC
     C+  WHERE PLANU1 = :DEUNUM
     C/END-EXEC
     C*FIN
     C                   END
     C* Si no es de PLAARC agrega a temporal
     C*SI SQLCOD =100 Y ZACRCD ='2'
     C     SQLCOD        IFEQ      100
     C     ZACRCD        ANDEQ     '2'
     C*SQL
     C/EXEC SQL
     C+  INSERT INTO DEUAR9 VALUES (:DEUTIP,:DEUNUM )
     C/END-EXEC
     C*SINO
     C                   ELSE
     C* Si la planilla no es de plaarc pero solo se deben acreditar norm
     C*SI SQLCOD =100 Y ZACRCD ='1'
     C     SQLCOD        IFEQ      100
     C     ZACRCD        ANDEQ     '1'
     C*LIMPIAR SQLCOD
     C                   CLEAR                   SQLCOD
     C* Es de PLAARC y el orden es 1 o 3
     C*SINO
     C                   ELSE
     C* Hist. parámetros per. deuda
     C*EJECUTAR M21002
     C                   EXSR      M21002
     C*SI ZSALIR ]= '1'
     C     ZSALIR        IFNE      '1'
     C* Procesa deuda
     C*EJECUTAR M21500
     C                   EXSR      M21500
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Deuda posterior a reforma
     C*PASAR ZINCAD '2'
     C                   MOVEL     '2'           ZINCAD
     C*LEER DEUARC08(DEUTIP PLANU4)
     C     LL$125        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C     LL$125        READE     DEUARC08                               53
     C*FIN
     C                   END
     C* No hay deudas antes reforma
     C*SI ZINCAD = '1'
     C     ZINCAD        IFEQ      '1'
     C*PASAR ZERROR 'No se encontraron deudas anteriores a reforma'
     C                   MOVEL     $HIL(099)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*INICIAR DEUARC08 (DEUTIP PLANU4)
     C     LL$126        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C     LL$126        SETLL     DEUARC08                           53
     C                   ENDSR
     C*==================================================================
     C*==  Cancela deudas - período                                    ==
     C*==                                                              ==
     C*==================================================================
     C     M21004        BEGSR
     C*PASAR DEUTIP ZTIPDE
     C                   MOVEL     ZTIPDE        DEUTIP
     C*INICIAR DEUARC08 (DEUTIP PLANU4 PLAPER)
     C     LL$127        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C                   KFLD                    PLAPER
     C     LL$127        SETLL     DEUARC08                           53
     C*LEER DEUARC08(DEUTIP PLANU4 PLAPER)
     C     LL$128        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C                   KFLD                    PLAPER
     C     LL$128        READE     DEUARC08                               53
     C*LIMPIAR ZFDARC
     C                   CLEAR                   ZFDARC
     C*MIENTRAS NFA(DEUARC08) Y DEUTIP=ZTIPDE Y PLANU4=DEUNRO Y ZVRDEP >
     C     *IN53         DOWEQ     '0'
     C     DEUTIP        ANDEQ     ZTIPDE
     C     PLANU4        ANDEQ     DEUNRO
     C     ZVRDEP        ANDGT     *ZERO
     C     PLAPER        ANDEQ     DEUPER
     C     ZSALIR        ANDNE     '1'
     C* Orden de acreditación definido en configuración
     C*SI ZACRCD = '1' O ZACRCD = '2'
     C     ZACRCD        IFEQ      '1'
     C     ZACRCD        OREQ      '2'
     C* Verifica si la planilla que generó deuda es de plaarc
     C*SQL
     C/EXEC SQL
     C+  SELECT PLANU1 INTO :ZDPLAN FROM PLAARC
     C+  WHERE PLANU1 = :DEUNUM
     C/END-EXEC
     C*FIN
     C                   END
     C*SI SQLCOD =100 Y ZACRCD = '2'
     C     SQLCOD        IFEQ      100
     C     ZACRCD        ANDEQ     '2'
     C*SQL
     C/EXEC SQL
     C+  INSERT INTO DEUAR9 VALUES (:DEUTIP,:DEUNUM )
     C/END-EXEC
     C* Si la planilla no es de plaarc
     C*SINO
     C                   ELSE
     C* Si la planilla no es de plaarc pero solo se deben acreditar norm
     C*SI SQLCOD =100 Y ZACRCD ='1'
     C     SQLCOD        IFEQ      100
     C     ZACRCD        ANDEQ     '1'
     C*LIMPIAR SQLCOD
     C                   CLEAR                   SQLCOD
     C* Es de plaarc y el orden es 1 O 3
     C*SINO
     C                   ELSE
     C* Hist. parámetros per. deuda
     C*EJECUTAR M21002
     C                   EXSR      M21002
     C*SI ZSALIR ]= '1'
     C     ZSALIR        IFNE      '1'
     C* Prodesa deuda
     C*EJECUTAR M21500
     C                   EXSR      M21500
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LEER DEUARC08(DEUTIP PLANU4 PLAPER)
     C     LL$129        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C                   KFLD                    PLAPER
     C     LL$129        READE     DEUARC08                               53
     C*FIN
     C                   END
     C*INICIAR DEUARC08
     C     *LOVAL        SETLL     DEUARC08                           53
     C                   ENDSR
     C*==================================================================
     C*==  Procesar deuda                                              ==
     C*==                                                              ==
     C*==================================================================
     C     M21005        BEGSR
     C*LIMPIAR ZINDIA
     C                   CLEAR                   ZINDIA
     C*SQL
     C/EXEC SQL
     C+  SELECT COUNT(*) INTO :ZINDIA
     C+  FROM MOVARC
     C+  WHERE MOV148 = '002'  AND
     C+  MOVNU2 = :DETNU9 AND
     C+  MOVPAG = :DETPA2 AND
     C+  MOVSEC = :DETSE4 AND
     C+  MOVEST <>'R'  AND
     C+  MOVCO1 = '02' AND
     C+  MOVTIP IN ('34','35') AND
     C+  MOVPLA <> 0 AND
     C+  MOVTI5 = '01' AND
     C+  MOVT10 = '03' AND
     C+  (MOVNUM <> 0 OR MOVDIA<>0)
     C/END-EXEC
     C*SI SQLCOD = 100
     C     SQLCOD        IFEQ      100
     C*LIMPIAR ZINDIA
     C                   CLEAR                   ZINDIA
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Traer % sector salud planilla canc.deuda                    ==
     C*==                                                              ==
     C*==================================================================
     C     M21006        BEGSR
     C*LIMPIAR ZERROR
     C                   CLEAR                   ZERROR
     C*LLAMAR TRHISF50 (ZPER1 DEUT01 ZCOSIT ZCOMSI ZPRISI ZFGPSI ZCOHOS
     C                   CALL      'TRHISF50'
     C                   PARM                    ZPER1
     C                   PARM                    DEUT01
     C                   PARM                    ZCOSIT
     C                   PARM                    ZCOMSI
     C                   PARM                    ZPRISI
     C                   PARM                    ZFGPSI
     C                   PARM                    ZCOHOS
     C                   PARM                    ZCOMHO
     C                   PARM                    ZPRIHO
     C                   PARM                    ZFGPHO
     C                   PARM                    ZERROR
     C* Tipo de planilla de la deuda
     C*SI DEUT01 = '04' O DEUT01 = '11'
     C     DEUT01        IFEQ      '04'
     C     DEUT01        OREQ      '11'
     C* Comisión situados
     C*MOVER ZPCOCO ZCOMSI
     C                   Z-ADD     ZCOMSI        ZPCOCO
     C* C.O. situados
     C*MOVER ZPCTCO ZCOSIT
     C                   Z-ADD     ZCOSIT        ZPCTCO
     C* Prima situados
     C*MOVER ZPORPS ZPRISI
     C                   Z-ADD     ZPRISI        ZPORPS
     C* F.G.P.M
     C*MOVER ZPFGPM ZFGPSI
     C                   Z-ADD     ZFGPSI        ZPFGPM
     C*SINO
     C                   ELSE
     C* Comisión hospitales
     C*MOVER ZPCOCO ZCOMHO
     C                   Z-ADD     ZCOMHO        ZPCOCO
     C* C.O. hospitales
     C*MOVER ZPCTCO ZCOHOS
     C                   Z-ADD     ZCOHOS        ZPCTCO
     C* Prima hospitales
     C*MOVER ZPORPS ZPRIHO
     C                   Z-ADD     ZPRIHO        ZPORPS
     C* F.G.P.M
     C*MOVER ZPFGPM ZFGPHO
     C                   Z-ADD     ZFGPHO        ZPFGPM
     C*FIN
     C                   END
     C*SI ZERROR |= *BLANCO
     C     ZERROR        IFNE      *BLANK
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular valor a pagar                                      ==
     C*==                                                              ==
     C*==================================================================
     C     M21010        BEGSR
     C* Desarrollo especial activo
     C*SI ZD7046 = 1 Y ZR9072 = 1
     C     ZD7046        IFEQ      1
     C     ZR9072        ANDEQ     1
     C*LIMPIAR ZINVA2
     C                   CLEAR                   ZINVA2
     C* Código interno auxiliar
     C*LIMPIAR ZCODIN
     C                   CLEAR                   ZCODIN
     C* Verificar empleador
     C*PASAR ZLLAM1 'E'
     C                   MOVEL     'E'           ZLLAM1
     C*LLAMAR TREMPN52 (ZCODIN PLATI1 PLANU4 DEUPER DEUPER ZINVA2 ZLLAM1
     C                   CALL      'TREMPN52'
     C                   PARM                    ZCODIN
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    DEUPER
     C                   PARM                    DEUPER
     C                   PARM                    ZINVA2
     C                   PARM                    ZLLAM1
     C*SI ZINVA2 <> *BLANCO
     C     ZINVA2        IFNE      *BLANK
     C*PASAR ZINVA2 '1'
     C                   MOVEL     '1'           ZINVA2
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZPLCND <> '1' Y PLAT03 = '02' Y ZINVA2 = '1'
     C     ZPLCND        IFNE      '1'
     C     PLAT03        ANDEQ     '02'
     C     ZINVA2        ANDEQ     '1'
     C*LIMPIAR ZINDUL
     C                   CLEAR                   ZINDUL
     C*LLAMAR TRACUE57(DEUTIP DEUNUM ZSALDE ZINDUL ZCODIN)
     C                   CALL      'TRACUE57'
     C                   PARM                    DEUTIP
     C                   PARM                    DEUNUM
     C                   PARM                    ZSALDE
     C                   PARM                    ZINDUL
     C                   PARM                    ZCODIN
     C*SINO
     C                   ELSE
     C* Saldo de la deuda
     C*CALCULAR ZSALDE = DEUSAL + DEUSA1 + DEUS03
     C     DEUSAL        ADD       DEUSA1        V$CA1           030 9
     C     V$CA1         ADD       DEUS03        ZSALDE
     C*FIN
     C                   END
     C* Si el empleador se encuentra en acuerdo de pago Activo, pero est
     C* ya cancelo las deudas y no se ha modificado el estado del acuerd
     C* a Finalizado,y se presenta que el saldo de las deudas es igual a
     C* es por esta razón que se debe verificar nuevamente si el valor c
     C* lado es igual a cero si es asi se debe sumar el total de la deud
     C*SI ZSALDE = *CERO
     C     ZSALDE        IFEQ      *ZERO
     C* Saldo de la deuda
     C*CALCULAR ZSALDE = DEUSAL + DEUSA1 + DEUS03
     C     DEUSAL        ADD       DEUSA1        V$CA1           030 9
     C     V$CA1         ADD       DEUS03        ZSALDE
     C*FIN
     C                   END
     C*SI ZSALDE > ZVRDEP
     C     ZSALDE        IFGT      ZVRDEP
     C* Valor pagado
     C*MOVER ZVRPAG ZVRDEP
     C                   Z-ADD     ZVRDEP        ZVRPAG
     C* Cuotas pagadas
     C*MOVER ZCUPAG ZCUDEP
     C                   Z-ADD     ZCUDEP        ZCUPAG
     C* Valor y cuotas depósito
     C*LIMPIAR ZVRDEP ZCUDEP
     C                   CLEAR                   ZVRDEP
     C                   CLEAR                   ZCUDEP
     C*SINO
     C                   ELSE
     C* Valor pagado
     C*MOVER ZVRPAG ZSALDE
     C                   Z-ADD     ZSALDE        ZVRPAG
     C*CALCULAR (R) ZCUPAG = (ZCUDEP * ZSALDE)/ZVRDEP
     C     ZCUDEP        MULT      ZSALDE        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVRDEP        ZCUPAG
     C* Valor depósito
     C*RESTAR ZVRPAG ZVRDEP
     C                   SUB       ZVRPAG        ZVRDEP
     C* Cuotas depósito
     C*RESTAR ZCUPAG ZCUDEP
     C                   SUB       ZCUPAG        ZCUDEP
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Leer afiliado y cuenta detalle de deuda                     ==
     C*==                                                              ==
     C*==================================================================
     C     M21015        BEGSR
     C*INICIARI AFIARC01 (DETNR1)
     C     DETNR1        SETLL     AFIARC01                               36
     C     *IN36         IFEQ      '1'
     C                   MOVE      '0'           *IN36
     C                   ELSE
     C                   MOVE      '1'           *IN36
     C                   END
     C*SI NER(AFIARC01)
     C     *IN36         IFEQ      '1'
     C* Número de identificación
     C*MOVER ZNUMAL DETNR1
     C                   MOVE      DETNR1        ZNUMAL
     C*OBTENER (1) ZERROR = 'No existe afiliado' || ZNUMAL
     C                   CLEAR                   ZERROR
     C     $HIL(100)     CAT       ZNUMAL:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*SINO
     C                   ELSE
     C*RECUPERARD (N) AFIARC01 (DETNR1)
     C     DETNR1        CHAIN     AFIARC01                           3694
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SI ZINDSO |= 1
     C     ZINDSO        IFNE      1
     C*MOVER ZIDENT DETNR1
     C                   Z-ADD     DETNR1        ZIDENT
     C* Ind. de llamado
     C*ASIGNAR ZINDOP '1'
     C                   MOVEL     '1'           ZINDOP
     C* Ind. de grabación interno
     C*LIMPIAR ZINDGR
     C                   CLEAR                   ZINDGR
     C* Reversa selección de modalidad
     C*LLAMAR TRSOLP55 (ZIDENT ZINDOP ZINDGR)
     C                   CALL      'TRSOLP55'
     C                   PARM                    ZIDENT
     C                   PARM                    ZINDOP
     C                   PARM                    ZINDGR
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Número de identificación
     C*MOVER ZNUMAL DETNR1
     C                   MOVE      DETNR1        ZNUMAL
     C*OBTENER (1) ZERROR = 'Registro AFIARC no disponible M21015 ' || Z
     C                   CLEAR                   ZERROR
     C     $HIL(101)     CAT       ZNUMAL:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Identificación afiliado - alfa
     C*MOVER ZIDENA AFIC01
     C                   MOVE      AFIC01        ZIDENA
     C* Código interno afil
     C*MOVER CUENUM AFINUM
     C                   Z-ADD     AFINUM        CUENUM
     C* Código fondo moderado
     C*PASAR CUEC17 ZFONDO
     C                   MOVEL     ZFONDO        CUEC17
     C*RECUPERARD CUEARC (CUENUM CUEC17)
     C     LL$130        KLIST
     C                   KFLD                    CUENUM
     C                   KFLD                    CUEC17
     C     LL$130        CHAIN     CUEARC                             4594
     C                   MOVE      *IN94         I$RND
     C     *IN45         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   CUEREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SINO
     C                   ELSE
     C*MOVER ZPLAER PLANUM
     C                   MOVE      PLANUM        ZPLAER
     C*MOVER ZAFIIN CUENUM
     C                   CLEAR                   ZAFIIN
     C                   MOVE      CUENUM        ZAFIIN
     C*OBTENER (1) ZERROR = 'CUEARC no disponible - M21015' || ZPLAER ||
     C                   CLEAR                   H$1
     C     $HIL(102)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular valor distribuido detalle de deuda                 ==
     C*==                                                              ==
     C*==================================================================
     C     M21020        BEGSR
     C*CALCULAR ZSADET = DETSA1 + DETSA4 + DETSA3 + DETSA7 + DETSA5 + DE
     C     DETSA1        ADD       DETSA4        V$CA1           030 9
     C     V$CA1         ADD       DETSA3        V$CA1
     C     V$CA1         ADD       DETSA7        V$CA1
     C     V$CA1         ADD       DETSA5        V$CA1
     C     V$CA1         ADD       DETS07        V$CA1
     C     V$CA1         ADD       DETS01        V$CA1
     C     V$CA1         ADD       DETS95        V$CA1
     C     V$CA1         ADD       DETS96        V$CA1
     C     V$CA1         ADD       DETS97        V$CA1
     C     V$CA1         ADD       DETS98        V$CA1
     C     V$CA1         ADD       DET120        V$CA1
     C     V$CA1         ADD       DET125        V$CA1
     C     V$CA1         ADD       DET126        V$CA1
     C     V$CA1         ADD       DET127        ZSADET
     C*CALCULAR ZVLDET = DETCO3 + DETCO6 + DETV10 + DETV11 + DETINT + DE
     C     DETCO3        ADD       DETCO6        V$CA1           030 9
     C     V$CA1         ADD       DETV10        V$CA1
     C     V$CA1         ADD       DETV11        V$CA1
     C     V$CA1         ADD       DETINT        V$CA1
     C     V$CA1         ADD       DETV15        V$CA1
     C     V$CA1         ADD       DETV21        V$CA1
     C     V$CA1         ADD       DETV77        V$CA1
     C     V$CA1         ADD       DETV78        V$CA1
     C     V$CA1         ADD       DETV79        V$CA1
     C     V$CA1         ADD       DETI32        V$CA1
     C     V$CA1         ADD       DETV94        V$CA1
     C     V$CA1         ADD       DETI56        V$CA1
     C     V$CA1         ADD       DETV95        V$CA1
     C     V$CA1         ADD       DETV96        ZVLDET
     C*SI ZSALDE != ZADEPR
     C     ZSALDE        IFNE      ZADEPR
     C*CALCULAR (R) ZVDCO = (ZSADET * (ZVRPAG - ZAVRDI)) / (ZSALDE - ZAD
     C     ZVRPAG        SUB       ZAVRDI        V$CA1           030 9
     C     ZSADET        MULT      V$CA1         V$CA1
     C     ZSALDE        SUB       ZADEPR        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVDCO
     C*SI ZVRPAG |= ZAVRDI
     C     ZVRPAG        IFNE      ZAVRDI
     C*CALCULAR (R) ZCUCO = (ZVDCO  * (ZCUPAG - ZACUDI)) / (ZVRPAG - ZAV
     C     ZCUPAG        SUB       ZACUDI        V$CA1           030 9
     C     ZVDCO         MULT      V$CA1         V$CA1
     C     ZVRPAG        SUB       ZAVRDI        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZCUCO
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*PASAR ZERROR 'Error en el proceso de distribución detalle deuda'
     C                   MOVEL     $HIL(103)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* Acumulado valor distribuido
     C*SUMAR ZVDCO  ZAVRDI
     C                   ADD       ZVDCO         ZAVRDI
     C* Acum. cuotas distribuidas
     C*SUMAR ZCUCO  ZACUDI
     C                   ADD       ZCUCO         ZACUDI
     C* Acum. detalles procesados
     C*SUMAR ZSADET ZADEPR
     C                   ADD       ZSADET        ZADEPR
     C* Valor acumulado por enc. deuda
     C*SUMAR ZVDCO  ZVACED
     C                   ADD       ZVDCO         ZVACED
     C* Cuotas acum. por enc. deuda
     C*SUMAR ZCUCO  ZVACUD
     C                   ADD       ZCUCO         ZVACUD
     C                   ENDSR
     C*==================================================================
     C*==  Cancela deudas                                              ==
     C*==                                                              ==
     C*==================================================================
     C     M21100        BEGSR
     C* Si se desea cancelar las deudas
     C*SI PLAN05 <> *CERO
     C     PLAN05        IFNE      *ZERO
     C* Deuda liq. erronea afil. ante
     C*PASAR ZTIPDE '05'
     C                   MOVEL     '05'          ZTIPDE
     C* Cancela deudas planilla
     C*EJECUTAR M21001
     C                   EXSR      M21001
     C* Deuda liq. erronea
     C*PASAR ZTIPDE '01'
     C                   MOVEL     '01'          ZTIPDE
     C* Cancela deudas planilla
     C*EJECUTAR M21001
     C                   EXSR      M21001
     C* Deuda liq. erronea
     C*PASAR ZTIPDE '07'
     C                   MOVEL     '07'          ZTIPDE
     C* Cancela deudas planilla
     C*EJECUTAR M21001
     C                   EXSR      M21001
     C*SINO
     C                   ELSE
     C* Periodo
     C*SI PLAPER = *BLANCO
     C     PLAPER        IFEQ      *BLANK
     C* Deuda liq. erronea afil. ante
     C*PASAR ZTIPDE '05'
     C                   MOVEL     '05'          ZTIPDE
     C* Cancela deudas empleador
     C*EJECUTAR M21003
     C                   EXSR      M21003
     C* Deuda liq. erronea
     C*PASAR ZTIPDE '01'
     C                   MOVEL     '01'          ZTIPDE
     C* Cancela deudas empleador
     C*EJECUTAR M21003
     C                   EXSR      M21003
     C* No aplica para deudas 07 porque siempre debe tener planilla a co
     C*SINO
     C                   ELSE
     C* Deuda liq. erronea afil. ante
     C*PASAR ZTIPDE '05'
     C                   MOVEL     '05'          ZTIPDE
     C* Cancela deudas periodo
     C*EJECUTAR M21004
     C                   EXSR      M21004
     C* Deuda liq. erronea
     C*PASAR ZTIPDE '01'
     C                   MOVEL     '01'          ZTIPDE
     C* Cancela deudas periodo
     C*EJECUTAR M21004
     C                   EXSR      M21004
     C* No aplica para deudas 07 porque siempre debe tener planilla a co
     C*FIN
     C                   END
     C* Procesar deudas INFAR4
     C*SI ZACRCD = '2' Y ZVRDEP > *CERO
     C     ZACRCD        IFEQ      '2'
     C     ZVRDEP        ANDGT     *ZERO
     C* Lee las deudas generadas por planillas de otras APFS del tempora
     C* Indicador para grabar en DEUARC
     C*PASAR ZFDARC 'N'
     C                   MOVEL     'N'           ZFDARC
     C*SQL
     C/EXEC SQL
     C+  DECLARE CUR1 CURSOR FOR
     C+  SELECT DEUT08,DEUPL3
     C+  FROM DEUAR9
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  OPEN CUR1
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  FETCH CUR1 INTO :ZTIPDE, :DEUNUM
     C/END-EXEC
     C* Mientras existan deudas en duar9
     C*MIENTRAS SQLCOD <> 100
     C     SQLCOD        DOWNE     100
     C* Obtiene datos de la deuda
     C*RECUPERARD DEUARC (ZTIPDE DEUNUM)
     C     LL$131        KLIST
     C                   KFLD                    ZTIPDE
     C                   KFLD                    DEUNUM
     C     LL$131        CHAIN     DEUARC                             5094
     C                   MOVE      *IN94         I$RND
     C     *IN50         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   DEUREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* No existe periodo para cancelación
     C*SI PLAPER = *BLANCO
     C     PLAPER        IFEQ      *BLANK
     C* Hist. Parámetros per. Deuda
     C*EJECUTAR M21002
     C                   EXSR      M21002
     C*FIN
     C                   END
     C* Procesa deuda
     C*EJECUTAR M21500
     C                   EXSR      M21500
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DEUARC no disponible - M21100'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(104)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* Lee siguiente deuda del temporal DEUAR9
     C*SQL
     C/EXEC SQL
     C+  FETCH CUR1 INTO :ZTIPDE, :DEUNUM
     C/END-EXEC
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  CLOSE CUR1
     C/END-EXEC
     C* Deuda posterior a reforma
     C*PASAR ZINCAD '2'
     C                   MOVEL     '2'           ZINCAD
     C* Elimina datos del temporal
     C*SQL
     C/EXEC SQL
     C+  DELETE FROM DEUAR9
     C/END-EXEC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Cancela deuda total                                         ==
     C*==                                                              ==
     C*==================================================================
     C     M21500        BEGSR
     C*LIMPIAR ZVACED ZVACUD ZPLADE ZDENAC
     C                   CLEAR                   ZVACED
     C                   CLEAR                   ZVACUD
     C                   CLEAR                   ZPLADE
     C                   CLEAR                   ZDENAC
     C*LIMPIAR ZADEPR ZAVRDI ZACUDI ZVRPAD ZCUPAD ZINDAJ
     C                   CLEAR                   ZADEPR
     C                   CLEAR                   ZAVRDI
     C                   CLEAR                   ZACUDI
     C                   CLEAR                   ZVRPAD
     C                   CLEAR                   ZCUPAD
     C                   CLEAR                   ZINDAJ
     C*
     C* Estado deuda no AND ni CAN
     C*SI DEUEST <> 'AND' Y DEUEST <> 'CAN'
     C     DEUEST        IFNE      'AND'
     C     DEUEST        ANDNE     'CAN'
     C* Calcular valor a pagar
     C*EJECUTAR M21010
     C                   EXSR      M21010
     C*INICIAR DETAR201 (DEUTIP DEUNUM)
     C     LL$132        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C     LL$132        SETLL     DETAR201                           48
     C*LEER DETAR201(DEUTIP DEUNUM)
     C     LL$133        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C     LL$133        READE     DETAR201                               48
     C*MIENTRAS NFA(DETAR201) Y DEUTIP=DETTIP Y DEUNUM=DETNU9
     C     *IN48         DOWEQ     '0'
     C     DEUTIP        ANDEQ     DETTIP
     C     DEUNUM        ANDEQ     DETNU9
     C* Estado detalle no AND ni CAN
     C*SI DETEST <> 'AND' Y DETEST <> 'CAN'
     C     DETEST        IFNE      'AND'
     C     DETEST        ANDNE     'CAN'
     C*LLAMAR TRACUE60 (DETTI6 DETID2 DETSUB ZINDAJ)
     C                   CALL      'TRACUE60'
     C                   PARM                    DETTI6
     C                   PARM                    DETID2
     C                   PARM                    DETSUB
     C                   PARM                    ZINDAJ
     C*SI ZINDAJ = ' '
     C     ZINDAJ        IFEQ      ' '
     C* Corroborar deudas
     C*EJECUTAR M00120
     C                   EXSR      M00120
     C* Si no hay error
     C*SI ZSALIR <> '1'
     C     ZSALIR        IFNE      '1'
     C* Calcular valor ditribuido
     C*LIMPIAR ZCALVD
     C                   CLEAR                   ZCALVD
     C* Calcular valor distribuido
     C*EJECUTAR M21020
     C                   EXSR      M21020
     C* Si no hay error
     C*SI ZSALIR <> '1'
     C     ZSALIR        IFNE      '1'
     C* Tipo de planilla
     C*PASAR ZTIPLA PLATIP
     C                   MOVEL     PLATIP        ZTIPLA
     C* Transacción
     C*MOVER ZOVPER PLAPER
     C                   MOVE      PLAPER        ZOVPER
     C* Transacción
     C*MOVER ZOVCO1 '02'
     C                   MOVE      '02'          ZOVCO1
     C* Planilla sector salud
     C*SI ZTIPLA = '04'
     C     ZTIPLA        IFEQ      '04'
     C* Pago del situado
     C*SI DEUT01 = '04' O DEUT01 = '11'
     C     DEUT01        IFEQ      '04'
     C     DEUT01        OREQ      '11'
     C* Concepto
     C*MOVER ZOVTIP '74'
     C                   MOVE      '74'          ZOVTIP
     C* Pago Hospital
     C*SINO
     C                   ELSE
     C* Concepto
     C*MOVER ZOVTIP '94'
     C                   MOVE      '94'          ZOVTIP
     C*FIN
     C                   END
     C* Planillas normales
     C*SINO
     C                   ELSE
     C* Concepto
     C*MOVER ZOVTIP '34'
     C                   MOVE      '34'          ZOVTIP
     C*FIN
     C                   END
     C* Valida actualiz. días cotiz.
     C*EJECUTAR M00100
     C                   EXSR      M00100
     C* Cancelar detalle de deuda
     C*EJECUTAR M14308
     C                   EXSR      M14308
     C* Actualizar cuenta afiliado
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Acreditación de cancel. de deuda no actuali
     C                   CLEAR                   ZERROR
     C     $HIL(105)     CAT       ZIDENA:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Hay error
     C*SI ZSALIR = '1'
     C     ZSALIR        IFEQ      '1'
     C*SALIR
     C                   GOTO      T$8
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Lee el registro
     C*LEER DETAR201(DEUTIP DEUNUM)
     C     LL$134        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C     LL$134        READE     DETAR201                               48
     C*FIN
     C                   END
     C     T$8           TAG
     C* Si no hay error
     C*SI ZSALIR <> '1'
     C     ZSALIR        IFNE      '1'
     C* Vlrs. distribuidos dif. a sa
     C*SI ZVACED <> ZVRPAG O ZCUPAG <> ZVACUD
     C     ZVACED        IFNE      ZVRPAG
     C     ZCUPAG        ORNE      ZVACUD
     C* Planilla deuda
     C*MOVER ZPLADE DEUNUM
     C                   Z-ADD     DEUNUM        ZPLADE
     C*PASAR ZERROR 'Descuadre en saldo de encabezado de deuda contra de
     C                   MOVEL     $HIL(106)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*IMPRIMIR FMT@D4
     C                   EXCEPT    FMT@D4
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR <> '1' Y ZVRPAD <> *CERO
     C     ZSALIR        IFNE      '1'
     C     ZVRPAD        ANDNE     *ZERO
     C* Cód. transacción
     C*PASAR ZCODTX '03'
     C                   MOVEL     '03'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '22'
     C                   MOVEL     '22'          ZCONCE
     C* Valor histórico
     C*MOVER ZVALHI ZVRPAD
     C                   Z-ADD     ZVRPAD        ZVALHI
     C* Cuotas
     C*LIMPIAR ZCUOHI
     C                   CLEAR                   ZCUOHI
     C* Genera històrico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*
     C* Grabar deuda cancelada
     C*EJECUTAR M14392
     C                   EXSR      M14392
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesar planilla extraordinaria                            ==
     C*==                                                              ==
     C*==================================================================
     C     M30000        BEGSR
     C* Calcular total por concepto
     C*EJECUTAR M30010
     C                   EXSR      M30010
     C* Número depósitos leidos
     C*MOVER K 1
     C                   Z-ADD     1             K
     C* Concilió con mas de un depós.
     C*SI PLANU8 = *CERO
     C     PLANU8        IFEQ      *ZERO
     C*LIMPIAR CONTI3
     C                   CLEAR                   CONTI3
     C*INICIAR CONAR202 (PLANU3 PLANUM CONTI3)
     C     LL$135        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    CONTI3
     C     LL$135        SETLL     CONAR202                           41
     C*LEER CONAR202
     C                   READ      CONAR202                               41
     C* Indicador pago en exceso
     C*MOVER ZINDPE '0'
     C                   MOVE      '0'           ZINDPE
     C*MIENTRAS NFA(CONAR202) Y PLANUM = CONNU5 Y CONTI3 = *BLANCO Y ZIN
     C     *IN41         DOWEQ     '0'
     C     PLANUM        ANDEQ     CONNU5
     C     CONTI3        ANDEQ     *BLANK
     C     ZINDPE        ANDEQ     '0'
     C* Lote de depósitos
     C*MOVER ZLOTE  CONNU2
     C                   Z-ADD     CONNU2        ZLOTE
     C* Número de depósito
     C*MOVER ZDEPO  CONNU3
     C                   Z-ADD     CONNU3        ZDEPO
     C* Consecutivo depósito
     C*MOVER ZCONSE CONCO4
     C                   Z-ADD     CONCO4        ZCONSE
     C* Leer depósito
     C*EJECUTAR M12010
     C                   EXSR      M12010
     C* Liquida ints. deudas empleador
     C*EJECUTAR M12030
     C                   EXSR      M12030
     C* Hay error
     C*SI ZSALIR = '1'
     C     ZSALIR        IFEQ      '1'
     C*SALIR
     C                   GOTO      T$9
     C*FIN
     C                   END
     C* Procesar planilla extraordin.
     C*EJECUTAR M30020
     C                   EXSR      M30020
     C*SUMAR 1 K
     C                   ADD       1             K
     C*LEER CONAR202
     C                   READ      CONAR202                               41
     C*FIN
     C                   END
     C     T$9           TAG
     C* Concilió con un depósito
     C*SINO
     C                   ELSE
     C* Lote de depósitos
     C*MOVER ZLOTE  PLANU8
     C                   Z-ADD     PLANU8        ZLOTE
     C* Número de depósito
     C*MOVER ZDEPO  PLANU9
     C                   Z-ADD     PLANU9        ZDEPO
     C* Consecutivo depósito
     C*MOVER ZCONSE PLACON
     C                   Z-ADD     PLACON        ZCONSE
     C* Leer depósito
     C*EJECUTAR M12010
     C                   EXSR      M12010
     C* Liquida ints. deudas empleador
     C*EJECUTAR M12030
     C                   EXSR      M12030
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Procesar planilla extraordin.
     C*EJECUTAR M30020
     C                   EXSR      M30020
     C*FIN
     C                   END
     C*SUMAR 1 K
     C                   ADD       1             K
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Procesar detalles plan. extr.
     C*EJECUTAR M31000
     C                   EXSR      M31000
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Genera encabezados e históri.
     C*EJECUTAR M15000
     C                   EXSR      M15000
     C* Anulación deudas por delta
     C*EJECUTAR M15500
     C                   EXSR      M15500
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular total por concepto                                 ==
     C*==                                                              ==
     C*==================================================================
     C     M30010        BEGSR
     C* Se deben procesar todos los detalles
     C* Total por concepto
     C*LIMPIAR ZTOCO ZTOCVA ZTOCVE ZTOFS ZTOAR ZTOREN ZTOSFS ZTOFGP
     C                   CLEAR                   ZTOCO
     C                   CLEAR                   ZTOCVA
     C                   CLEAR                   ZTOCVE
     C                   CLEAR                   ZTOFS
     C                   CLEAR                   ZTOAR
     C                   CLEAR                   ZTOREN
     C                   CLEAR                   ZTOSFS
     C                   CLEAR                   ZTOFGP
     C* Detalles de planilla
     C*INICIAR DETARC (PLANU3 PLANUM)
     C     LL$136        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$136        SETLL     DETARC                             49
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$137        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$137        READE     DETARC                                 49
     C*MIENTRAS NFA(DETARC) Y PLANU3 = DETNUM Y PLANUM = DETNU3
     C     *IN49         DOWEQ     '0'
     C     PLANU3        ANDEQ     DETNUM
     C     PLANUM        ANDEQ     DETNU3
     C*LIMPIAR ZDILIC ZDITRA
     C                   CLEAR                   ZDILIC
     C                   CLEAR                   ZDITRA
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC WHERE DETNU3 = :DETNU3 AND
     C+  DETPAG = :DETPAG AND DETSEC = :DETSEC
     C/END-EXEC
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C* Per.planilla >= Per.reforma
     C*SI PLAPER > ZPEREF
     C     PLAPER        IFGT      ZPEREF
     C* Período para procesar F.S.
     C*PASAR ZPERFS PLAPER
     C                   MOVEL     PLAPER        ZPERFS
     C*PASAR ZINREF 'S'
     C                   MOVEL     'S'           ZINREF
     C* IBC del afiliado
     C*SI DETVA7 > 0
     C     DETVA7        IFGT      0
     C* Valor salario calculado
     C*MOVER ZIBCAF DETVA7
     C                   Z-ADD     DETVA7        ZIBCAF
     C*SINO
     C                   ELSE
     C* IBC
     C*MOVER ZIBCAF DETSAL
     C                   Z-ADD     DETSAL        ZIBCAF
     C*FIN
     C                   END
     C* Retorna FGPM Y SFSP
     C*EJECUTAR M77000
     C                   EXSR      M77000
     C*FIN
     C                   END
     C*SI DETTAR |= *CERO
     C     DETTAR        IFNE      *ZERO
     C* Total alto riesgo
     C*CALCULAR ZTOAR = ZTOAR + (DETCOT-ZVFGPM)
     C     DETCOT        SUB       ZVFGPM        V$CA1           030 9
     C     ZTOAR         ADD       V$CA1         ZTOAR
     C*SINO
     C                   ELSE
     C* Total cot. obligatoria
     C*CALCULAR ZTOCO = ZTOCO + (DETCOT-ZVFGPM)
     C     DETCOT        SUB       ZVFGPM        V$CA1           030 9
     C     ZTOCO         ADD       V$CA1         ZTOCO
     C*FIN
     C                   END
     C* Total C.V.A.
     C*SUMAR DETCO1 ZTOCVA
     C                   ADD       DETCO1        ZTOCVA
     C* Total C.V.E.
     C*SUMAR DETCO2 ZTOCVE
     C                   ADD       DETCO2        ZTOCVE
     C* Total fondo solidaridad
     C*CALCULAR ZTOFS = ZTOFS + (DETCTA- ZVSFSP)
     C     DETCTA        SUB       ZVSFSP        V$CA1           030 9
     C     ZTOFS         ADD       V$CA1         ZTOFS
     C* Total Rendimientos
     C*SUMAR DETV14 ZTOREN
     C                   ADD       DETV14        ZTOREN
     C* Total FGPM
     C*SUMAR ZVFGPM ZTOFGP
     C                   ADD       ZVFGPM        ZTOFGP
     C* Total SFSP
     C*SUMAR ZVSFSP ZTOSFS
     C                   ADD       ZVSFSP        ZTOSFS
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$138        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$138        READE     DETARC                                 49
     C*FIN
     C                   END
     C* Saldo cotización obligatoria
     C*MOVER ZSACO  ZTOCO
     C                   Z-ADD     ZTOCO         ZSACO
     C* Saldo alto riesgo
     C*MOVER ZSAAR  ZTOAR
     C                   Z-ADD     ZTOAR         ZSAAR
     C* Saldo voluntaria afiliado
     C*MOVER ZSACVA ZTOCVA
     C                   Z-ADD     ZTOCVA        ZSACVA
     C* Saldo voluntaria empleador
     C*MOVER ZSACVE ZTOCVE
     C                   Z-ADD     ZTOCVE        ZSACVE
     C* Saldo rendimientos
     C*MOVER ZSAREN ZTOREN
     C                   Z-ADD     ZTOREN        ZSAREN
     C* Saldo fondo de solidaridad
     C*MOVER ZSAFS  ZTOFS
     C                   Z-ADD     ZTOFS         ZSAFS
     C* Saldo FSFP
     C*MOVER ZSASFS ZTOSFS
     C                   Z-ADD     ZTOSFS        ZSASFS
     C* Saldo FGPM
     C*MOVER ZSAFGP ZTOFGP
     C                   Z-ADD     ZTOFGP        ZSAFGP
     C*CALCULAR ZSACOT = ZTOCO + ZTOAR + ZTOCVA + ZTOCVE
     C     ZTOCO         ADD       ZTOAR         V$CA1           030 9
     C     V$CA1         ADD       ZTOCVA        V$CA1
     C     V$CA1         ADD       ZTOCVE        ZSACOT
     C* Total cotizaciones
     C*MOVER ZTOTCO ZSACOT
     C                   Z-ADD     ZSACOT        ZTOTCO
     C* INT SFSP Y FSP
     C*SI ZPSFSP <> 0
     C     ZPSFSP        IFNE      0
     C* Int. solidaridad
     C*CALCULAR ZSAIFS = (PLAIN7*ZHPPO4)/(ZPSFSP+ZHPPO4)
     C     PLAIN7        MULT      ZHPPO4        V$CA1           030 9
     C     ZPSFSP        ADD       ZHPPO4        V$CA2           030 9
     C     V$CA1         DIV       V$CA2         ZSAIFS
     C* Int. Subsistencia
     C*CALCULAR ZSAISF = PLAIN7 - ZSAIFS
     C     PLAIN7        SUB       ZSAIFS        ZSAISF
     C*SINO
     C                   ELSE
     C* Int. Solidaridad
     C*MOVER ZSAIFS PLAIN7
     C                   Z-ADD     PLAIN7        ZSAIFS
     C*FIN
     C                   END
     C*Int FGPM y C.O
     C* Hay Garantìa
     C*SI ZHPP49 <> *CERO
     C     ZHPP49        IFNE      *ZERO
     C* Int. C.O
     C*CALCULAR ZSAIFG = (PLAREC*ZHPP49)/ZHPPOR
     C     PLAREC        MULT      ZHPP49        V$CA1           030 9
     C     V$CA1         DIV       ZHPPOR        ZSAIFG
     C* Int. FGPM
     C*CALCULAR ZSAINT = PLAREC - ZSAIFG
     C     PLAREC        SUB       ZSAIFG        ZSAINT
     C*SINO
     C                   ELSE
     C* Saldo intereses
     C*MOVER ZSAINT PLAREC
     C                   Z-ADD     PLAREC        ZSAINT
     C* Saldo intereses garantía
     C*LIMPIAR ZSAIFG
     C                   CLEAR                   ZSAIFG
     C*FIN
     C                   END
     C* Si hay saldo y cotizaciones
     C*SI ZSAINT <> *CERO Y ZTOTCO <> *CERO
     C     ZSAINT        IFNE      *ZERO
     C     ZTOTCO        ANDNE     *ZERO
     C* Total alto riesgo
     C*SI ZTOAR <> *CERO
     C     ZTOAR         IFNE      *ZERO
     C*CALCULAR (R) ZSINAR = (ZTOAR * ZSAINT)/ZTOTCO
     C     ZTOAR         MULT      ZSAINT        V$CA1           030 9
     C     V$CA1         DIV(H)    ZTOTCO        ZSINAR
     C*FIN
     C                   END
     C* Total vol. afiliado
     C*SI ZTOCVA <> *CERO
     C     ZTOCVA        IFNE      *ZERO
     C*CALCULAR (R) ZSICVA = (ZTOCVA * ZSAINT)/ZTOTCO
     C     ZTOCVA        MULT      ZSAINT        V$CA1           030 9
     C     V$CA1         DIV(H)    ZTOTCO        ZSICVA
     C*FIN
     C                   END
     C* Total vol. afiliado
     C*SI ZTOCVE <> *CERO
     C     ZTOCVE        IFNE      *ZERO
     C*CALCULAR (R) ZSICVE = (ZTOCVE * ZSAINT)/ZTOTCO
     C     ZTOCVE        MULT      ZSAINT        V$CA1           030 9
     C     V$CA1         DIV(H)    ZTOTCO        ZSICVE
     C*FIN
     C                   END
     C*CALCULAR ZSAINT = ZSAINT - ZSINAR - ZSICVA - ZSICVE
     C     ZSAINT        SUB       ZSINAR        V$CA1           030 9
     C     V$CA1         SUB       ZSICVA        V$CA1
     C     V$CA1         SUB       ZSICVE        ZSAINT
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesar planilla extraordinaria                            ==
     C*==                                                              ==
     C*==================================================================
     C     M30020        BEGSR
     C* Fecha de depósito
     C*MOVER AFECDE[K] ZFECDE
     C                   MOVE      ZFECDE        $G(K)
     C* Pagar voluntaria afiliado
     C*EJECUTAR M12210
     C                   EXSR      M12210
     C* Pagar fondo de solidaridad
     C*EJECUTAR M12215
     C                   EXSR      M12215
     C* Pagar FGPM e int FGPM
     C*EJECUTAR M12221
     C                   EXSR      M12221
     C* Pagar int. fondo de solidaridad
     C*EJECUTAR M12220
     C                   EXSR      M12220
     C* Pagar intereses
     C*EJECUTAR M12225
     C                   EXSR      M12225
     C* Pagar rendimientos
     C*EJECUTAR M12230
     C                   EXSR      M12230
     C* Pagar alto riesgo
     C*EJECUTAR M12235
     C                   EXSR      M12235
     C* Pagar obligatoria
     C*EJECUTAR M12240
     C                   EXSR      M12240
     C* Pagar voluntaria empleador
     C*EJECUTAR M12245
     C                   EXSR      M12245
     C                   ENDSR
     C*==================================================================
     C*==  Procesar detalles planilla extraordinaria                   ==
     C*==                                                              ==
     C*==================================================================
     C     M31000        BEGSR
     C* Se deben procesar todos los detalles
     C* Limpiar variables
     C*EJECUTAR M14010
     C                   EXSR      M14010
     C*LIMPIAR ZVSFSP ZVFGPM
     C                   CLEAR                   ZVSFSP
     C                   CLEAR                   ZVFGPM
     C*INICIAR DETARC (PLANU3 PLANUM)
     C     LL$139        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$139        SETLL     DETARC                             49
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$140        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$140        READE     DETARC                                 49
     C*MIENTRAS NFA(DETARC) Y DETNUM = PLANU3 Y DETNU3 = PLANUM Y ZSALIR
     C     *IN49         DOWEQ     '0'
     C     DETNUM        ANDEQ     PLANU3
     C     DETNU3        ANDEQ     PLANUM
     C     ZSALIR        ANDNE     '1'
     C*LIMPIAR ZDILIC ZDITRA
     C                   CLEAR                   ZDILIC
     C                   CLEAR                   ZDITRA
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC WHERE DETNU3 = :DETNU3 AND
     C+  DETPAG = :DETPAG AND DETSEC = :DETSEC
     C/END-EXEC
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C* Per.planilla >= Per.reforma
     C*SI PLAPER > ZPEREF
     C     PLAPER        IFGT      ZPEREF
     C* Período procesar F.S.
     C*PASAR ZPERFS PLAPER
     C                   MOVEL     PLAPER        ZPERFS
     C*PASAR ZINREF 'S'
     C                   MOVEL     'S'           ZINREF
     C* IBC del afiliado
     C*SI DETVA7 > 0
     C     DETVA7        IFGT      0
     C* Valor salario calculado
     C*MOVER ZIBCAF DETVA7
     C                   Z-ADD     DETVA7        ZIBCAF
     C*SINO
     C                   ELSE
     C* IBC
     C*MOVER ZIBCAF DETSAL
     C                   Z-ADD     DETSAL        ZIBCAF
     C*FIN
     C                   END
     C* Retorna FGPM Y SFSP
     C*EJECUTAR M77000
     C                   EXSR      M77000
     C*FIN
     C                   END
     C*SI DETIN4 = '07' O DETIN4 = '08'
     C     DETIN4        IFEQ      '07'
     C     DETIN4        OREQ      '08'
     C*LIMPIAR ZFEC01 ZTIREZ ZINDIF ZESRAE
     C                   CLEAR                   ZFEC01
     C                   CLEAR                   ZTIREZ
     C                   CLEAR                   ZINDIF
     C                   CLEAR                   ZESRAE
     C* Indicador llamado desde acreditación
     C*PASAR ZESRAE 'A'
     C                   MOVEL     'A'           ZESRAE
     C*LLAMAR TRREZA5C (DETN04 PLACOD ZFEC01 PLAPER DETNOV ZTIREZ ZINDIF
     C                   CALL      'TRREZA5C'
     C                   PARM                    DETN04
     C                   PARM                    PLACOD
     C                   PARM                    ZFEC01
     C                   PARM                    PLAPER
     C                   PARM                    DETNOV
     C                   PARM                    ZTIREZ
     C                   PARM                    ZINDIF
     C                   PARM                    ZESRAE
     C                   PARM                    PLATIP
     C*PASAR DETIN4 ZTIREZ
     C                   MOVEL     ZTIREZ        DETIN4
     C*FIN
     C                   END
     C*
     C* Leer afiliado y cuenta
     C*EJECUTAR M14020
     C                   EXSR      M14020
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*LIMPIAR ZCOTAR ZCOTOB
     C                   CLEAR                   ZCOTAR
     C                   CLEAR                   ZCOTOB
     C* Tarifa alto riesgo
     C*SI DETTAR |= *CERO
     C     DETTAR        IFNE      *ZERO
     C* Cotización alto riesgo
     C*CALCULAR ZCOTAR = DETCOT-ZVFGPM
     C     DETCOT        SUB       ZVFGPM        ZCOTAR
     C*SINO
     C                   ELSE
     C* Cotización obligatoria
     C*CALCULAR ZCOTOB = DETCOT-ZVFGPM
     C     DETCOT        SUB       ZVFGPM        ZCOTOB
     C*FIN
     C                   END
     C* Cot. voluntaria afiliado
     C*MOVER ZCOTVA DETCO1
     C                   Z-ADD     DETCO1        ZCOTVA
     C* Cot. voluntaria empleador
     C*MOVER ZCOTVE DETCO2
     C                   Z-ADD     DETCO2        ZCOTVE
     C* Fondo de solidaridad
     C*CALCULAR ZCOTFS = DETCTA-ZVSFSP
     C     DETCTA        SUB       ZVSFSP        ZCOTFS
     C* Rendimientos
     C*MOVER ZRENDI DETV14
     C                   Z-ADD     DETV14        ZRENDI
     C* Fondo de garantía
     C*MOVER ZCOTFG ZVFGPM
     C                   Z-ADD     ZVFGPM        ZCOTFG
     C* Fondo de subsistencia
     C*MOVER ZCOTSF ZVSFSP
     C                   Z-ADD     ZVSFSP        ZCOTSF
     C*CALCULAR ZTOCOT = ZCOTAR + ZCOTOB + ZCOTVA + ZCOTVE
     C     ZCOTAR        ADD       ZCOTOB        V$CA1           030 9
     C     V$CA1         ADD       ZCOTVA        V$CA1
     C     V$CA1         ADD       ZCOTVE        ZTOCOT
     C* Procesa depósitos por detalle
     C*EJECUTAR M31100
     C                   EXSR      M31100
     C* Si no hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Indicador de rezago
     C*SI DETIN4 |= *BLANCO
     C     DETIN4        IFNE      *BLANK
     C* Genera rezago
     C*EJECUTAR M14060
     C                   EXSR      M14060
     C*SINO
     C                   ELSE
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Mov. acreditación planilla ext. no actualiz
     C                   CLEAR                   ZERROR
     C     $HIL(107)     CAT       ZIDENA:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Anula deuda presunta con planilla extraordinaria
     C*SI ZCOTOB |= *CERO Y PLAPER |= *BLANCO Y ZANDEP = 'S'
     C     ZCOTOB        IFNE      *ZERO
     C     PLAPER        ANDNE     *BLANK
     C     ZANDEP        ANDEQ     'S'
     C* Anula deuda presunta
     C*EJECUTAR M14050
     C                   EXSR      M14050
     C*FIN
     C                   END
     C* Acumula valores cotizaciones
     C*EJECUTAR M14085
     C                   EXSR      M14085
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$141        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$141        READE     DETARC                                 49
     C*FIN
     C                   END
     C* Se inicializa esta variable para que no sume 2 veces en el lista
     C*LIMPIAR ZTOREN
     C                   CLEAR                   ZTOREN
     C                   ENDSR
     C*==================================================================
     C*==  Procesa depósitos por detalle                               ==
     C*==                                                              ==
     C*==================================================================
     C     M31100        BEGSR
     C* Posición en el arreglo
     C*MOVER L 1
     C                   Z-ADD     1             L
     C*LIMPIAR ZVRREZ ZCUREZ ZINTRE ZIFSRE
     C                   CLEAR                   ZVRREZ
     C                   CLEAR                   ZCUREZ
     C                   CLEAR                   ZINTRE
     C                   CLEAR                   ZIFSRE
     C*LIMPIAR ZINCDE ZGRAMV
     C                   CLEAR                   ZINCDE
     C                   CLEAR                   ZGRAMV
     C*LIMPIAR ZCUERZ
     C                   CLEAR                   ZCUERZ
     C* Número depósitos procesados
     C*MIENTRAS L < K Y ZSALIR |= '1'
     C     L             DOWLT     K
     C     ZSALIR        ANDNE     '1'
     C*LIMPIAR ZVDFS ZVDIFS ZVDINT ZVDCVA ZVDREN ZVDCO ZVDCVE ZVDCVA ZVD
     C                   CLEAR                   ZVDFS
     C                   CLEAR                   ZVDIFS
     C                   CLEAR                   ZVDINT
     C                   CLEAR                   ZVDCVA
     C                   CLEAR                   ZVDREN
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZVDCVE
     C                   CLEAR                   ZVDCVA
     C                   CLEAR                   ZVDAR
     C*LIMPIAR ZCUFS ZCUIFS ZCUINT ZCUCVA ZCUREN ZCUCO ZCUCVE ZCUCVA ZCU
     C                   CLEAR                   ZCUFS
     C                   CLEAR                   ZCUIFS
     C                   CLEAR                   ZCUINT
     C                   CLEAR                   ZCUCVA
     C                   CLEAR                   ZCUREN
     C                   CLEAR                   ZCUCO
     C                   CLEAR                   ZCUCVE
     C                   CLEAR                   ZCUCVA
     C                   CLEAR                   ZCUAR
     C*LIMPIAR ZVDSFS ZVDISF ZVDFGP ZVDIFG
     C                   CLEAR                   ZVDSFS
     C                   CLEAR                   ZVDISF
     C                   CLEAR                   ZVDFGP
     C                   CLEAR                   ZVDIFG
     C*LIMPIAR ZCUSFS ZCUISF ZCUFGP ZCUIFG
     C                   CLEAR                   ZCUSFS
     C                   CLEAR                   ZCUISF
     C                   CLEAR                   ZCUFGP
     C                   CLEAR                   ZCUIFG
     C*LIMPIAR ZVDIVA ZVDIVE ZVDIAR ZCUIVA ZCUIVE ZCUIAR
     C                   CLEAR                   ZVDIVA
     C                   CLEAR                   ZVDIVE
     C                   CLEAR                   ZVDIAR
     C                   CLEAR                   ZCUIVA
     C                   CLEAR                   ZCUIVE
     C                   CLEAR                   ZCUIAR
     C*LIMPIAR ZOVCO8 ZOVIN2 ZOVV13 ZOVI06 ZOVCOM ZOVVAL ZOVCO7 ZOVC27 Z
     C                   CLEAR                   ZOVCO8
     C                   CLEAR                   ZOVIN2
     C                   CLEAR                   ZOVV13
     C                   CLEAR                   ZOVI06
     C                   CLEAR                   ZOVCOM
     C                   CLEAR                   ZOVVAL
     C                   CLEAR                   ZOVCO7
     C                   CLEAR                   ZOVC27
     C                   CLEAR                   ZOVRET
     C* Distribuir valor
     C*EJECUTAR M14105
     C                   EXSR      M14105
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Indicador de rezago
     C*SI DETIN4 |= *BLANCO
     C     DETIN4        IFNE      *BLANK
     C* Distribución rezago
     C*EJECUTAR M14170
     C                   EXSR      M14170
     C*SINO
     C                   ELSE
     C* Generar movimiento
     C*EJECUTAR M31105
     C                   EXSR      M31105
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SUMAR 1 L
     C                   ADD       1             L
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Generar movimiento planilla extraordinaria                  ==
     C*==                                                              ==
     C*==================================================================
     C     M31105        BEGSR
     C*SI PLAPER |= *BLANCO Y ZVDFS > *CERO Y PLATIP |= '06'
     C     PLAPER        IFNE      *BLANK
     C     ZVDFS         ANDGT     *ZERO
     C     PLATIP        ANDNE     '06'
     C* Cancelar deudas con plan.ext.
     C*EJECUTAR M31110
     C                   EXSR      M31110
     C*FIN
     C                   END
     C* Rendimientos del fondo de sol
     C*SI ZVDREN |= *CERO
     C     ZVDREN        IFNE      *ZERO
     C* Calcular rendimientos fondo
     C*EJECUTAR M31106
     C                   EXSR      M31106
     C*FIN
     C                   END
     C* Valor retención contingente
     C*LIMPIAR ZVRECO
     C                   CLEAR                   ZVRECO
     C* Mover datos movimiento acred.
     C*EJECUTAR M14395
     C                   EXSR      M14395
     C* Calcular comisiones - cot. volunt.
     C*EJECUTAR M14370
     C                   EXSR      M14370
     C* Evalua si genera reg. de mvto
     C*EJECUTAR M14302
     C                   EXSR      M14302
     C* Si genera mvto
     C*SI ZGENMV = '1'
     C     ZGENMV        IFEQ      '1'
     C*SI ZT@002 = '1'
     C     ZT@002        IFEQ      '1'
     C* Ind. vigencia siafp
     C*PASAR MOVI11 '1'
     C                   MOVEL     '1'           MOVI11
     C* Transacción
     C*MOVER MOVCO1 '02'
     C                   MOVE      '02'          MOVCO1
     C* Concepto
     C*MOVER MOVTIP '51'
     C                   MOVE      '51'          MOVTIP
     C*SINO
     C                   ELSE
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C* Ind. vigencia siafp
     C*PASAR MOVI11 '1'
     C                   MOVEL     '1'           MOVI11
     C* Transacción
     C*MOVER MOVCO1 '02'
     C                   MOVE      '02'          MOVCO1
     C* Concepto
     C*MOVER MOVTIP '52'
     C                   MOVE      '52'          MOVTIP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Si es el primer reg. de movarc
     C*SI ZGRAMV ]= '1'
     C     ZGRAMV        IFNE      '1'
     C* Salario informado
     C*MOVER MOVSAL DETSAL
     C                   Z-ADD     DETSAL        MOVSAL
     C* Salario calculado
     C*MOVER MOVSA2 DETVA7
     C                   Z-ADD     DETVA7        MOVSA2
     C* Retroactivos
     C*SI PLAT03 = '09' O PLAT03 = '10' O PLAT03 = '11' O PLAT03 = '12'
     C     PLAT03        IFEQ      '09'
     C     PLAT03        OREQ      '10'
     C     PLAT03        OREQ      '11'
     C     PLAT03        OREQ      '12'
     C* Días trabajados
     C*MOVER MOVNUM ZDITRA
     C                   Z-ADD     ZDITRA        MOVNUM
     C*FIN
     C                   END
     C* Prende indicador de gener. mvto
     C*PASAR ZGRAMV '1'
     C                   MOVEL     '1'           ZGRAMV
     C*FIN
     C                   END
     C* Calcular retención conting
     C*EJECUTAR M14330
     C                   EXSR      M14330
     C* Agregar registro a movarc
     C*EJECUTAR M00009
     C                   EXSR      M00009
     C*
     C* Si el valor de C.V.A o C.V.E es mayor a 0
     C*SI MOVCO5 |= 0 O MOVCU3 |= 0 O MOVCO6 |= 0 O MOVCU4 |= 0
     C     MOVCO5        IFNE      0
     C     MOVCU3        ORNE      0
     C     MOVCO6        ORNE      0
     C     MOVCU4        ORNE      0
     C* Indicador de acreditación
     C*PASAR ZINACR '1'
     C                   MOVEL     '1'           ZINACR
     C* Crear registro de aporte vol
     C*EJECUTAR M09000
     C                   EXSR      M09000
     C*FIN
     C                   END
     C*
     C*
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Imprime reporte detallado
     C*EJECUTAR DET@01
     C                   EXSR      DET@01
     C* Acumular valores por concepto
     C*EJECUTAR M14380
     C                   EXSR      M14380
     C* Actualizar cuenta afiliado
     C*EJECUTAR M14385
     C                   EXSR      M14385
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular rendimientos del fondo                             ==
     C*==                                                              ==
     C*==================================================================
     C     M31106        BEGSR
     C*LIMPIAR ZVDRFS ZCURFS
     C                   CLEAR                   ZVDRFS
     C                   CLEAR                   ZCURFS
     C*CALCULAR ZVDRFS = ZTOCOT + ZCOTFS + ZCOTSF
     C     ZTOCOT        ADD       ZCOTFS        V$CA1           030 9
     C     V$CA1         ADD       ZCOTSF        ZVDRFS
     C* Si se reportaron cotizaciones o fondo solid.
     C*SI ZVDRFS != *CERO
     C     ZVDRFS        IFNE      *ZERO
     C*CALCULAR (R) ZVDRFS = (ZVDREN * (ZCOTFS+ZCOTSF)) / (ZTOCOT+ZCOTFS
     C     ZCOTFS        ADD       ZCOTSF        V$CA1           030 9
     C     ZVDREN        MULT      V$CA1         V$CA1
     C     ZTOCOT        ADD       ZCOTFS        V$CA2           030 9
     C     V$CA2         ADD       ZCOTSF        V$CA2
     C     V$CA1         DIV(H)    V$CA2         ZVDRFS
     C*CALCULAR (R) ZCURFS = (ZVDRFS * ZCUREN) / ZVDREN
     C     ZVDRFS        MULT      ZCUREN        V$CA1           030 9
     C     V$CA1         DIV(H)    ZVDREN        ZCURFS
     C*FIN
     C                   END
     C* Rendimientos a intereses F.S.
     C*SUMAR ZVDRFS ZVDIFS
     C                   ADD       ZVDRFS        ZVDIFS
     C* Cuotas ren a cuotas int.F.S.
     C*SUMAR ZCURFS ZCUIFS
     C                   ADD       ZCURFS        ZCUIFS
     C* Vlr. distribuido rendimientos
     C*RESTAR ZVDRFS ZVDREN
     C                   SUB       ZVDRFS        ZVDREN
     C* Cuotas distrib. rendimientos
     C*RESTAR ZCURFS ZCUREN
     C                   SUB       ZCURFS        ZCUREN
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar deudas con planilla extraordinaria                 ==
     C*==                                                              ==
     C*==================================================================
     C     M31110        BEGSR
     C* Guarda valor distrib. C.O.
     C*MOVER ZVALTE ZVDCO
     C                   Z-ADD     ZVDCO         ZVALTE
     C* Guarda cuotas distrib. C.O.
     C*MOVER ZCUOTE ZCUCO
     C                   Z-ADD     ZCUCO         ZCUOTE
     C* Liq. errónea afil. anteriores
     C*PASAR ZTIPDE '05'
     C                   MOVEL     '05'          ZTIPDE
     C* Cancela deuda fondo solidaridad
     C*EJECUTAR M31115
     C                   EXSR      M31115
     C* Liq. errónea
     C*PASAR ZTIPDE '01'
     C                   MOVEL     '01'          ZTIPDE
     C* Cancela deuda fondo solidaridad
     C*EJECUTAR M31115
     C                   EXSR      M31115
     C* Liq. errónea
     C*PASAR ZTIPDE '07'
     C                   MOVEL     '07'          ZTIPDE
     C* Cancela deuda fondo solidaridad
     C*EJECUTAR M31115
     C                   EXSR      M31115
     C* Valor C.O. = Valor temporal
     C*MOVER ZVDCO ZVALTE
     C                   Z-ADD     ZVALTE        ZVDCO
     C* Coutas C.O. = Cuotas temporal
     C*MOVER ZCUCO ZCUOTE
     C                   Z-ADD     ZCUOTE        ZCUCO
     C                   ENDSR
     C*==================================================================
     C*==  Cancela deuda fondo de solidaridad                          ==
     C*==                                                              ==
     C*==================================================================
     C     M31115        BEGSR
     C* Tipo de deuda
     C*ASIGNAR DEUTIP ZTIPDE
     C                   MOVEL     ZTIPDE        DEUTIP
     C*INICIAR DEUARC08 (DEUTIP PLANU4)
     C     LL$142        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C     LL$142        SETLL     DEUARC08                           53
     C*LEER DEUARC08(DEUTIP PLANU4)
     C     LL$143        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C     LL$143        READE     DEUARC08                               53
     C*MIENTRAS NFA(DEUARC08) Y DEUTIP=ZTIPDE Y DEUNRO=PLANU4 Y DEUPER<=
     C     *IN53         DOWEQ     '0'
     C     DEUTIP        ANDEQ     ZTIPDE
     C     DEUNRO        ANDEQ     PLANU4
     C     DEUPER        ANDLE     PLAPER
     C     ZVDCO         ANDGT     0
     C*SI DEUEST |= 'AND' Y DEUEST |= 'CAN'
     C     DEUEST        IFNE      'AND'
     C     DEUEST        ANDNE     'CAN'
     C* Valor y cuotas pagadas deuda
     C*LIMPIAR ZVRPAD ZCUPAD
     C                   CLEAR                   ZVRPAD
     C                   CLEAR                   ZCUPAD
     C* Se posiciona en el archivo
     C*INICIAR DETAR201 (DEUTIP DEUNUM DETNU2)
     C     LL$144        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C                   KFLD                    DETNU2
     C     LL$144        SETLL     DETAR201                           48
     C* Lee el registro
     C*LEER DETAR201(DEUTIP DEUNUM DETNU2)
     C     LL$145        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C                   KFLD                    DETNU2
     C     LL$145        READE     DETAR201                               48
     C*MIENTRAS NFA(DETAR201) Y DEUTIP=DETTIP Y DEUNUM=DETNU9 Y DETNU2=D
     C     *IN48         DOWEQ     '0'
     C     DEUTIP        ANDEQ     DETTIP
     C     DEUNUM        ANDEQ     DETNU9
     C     DETNU2        ANDEQ     DETNR1
     C*SI DETEST ]= 'AND' Y  DETEST ]= 'CAN'
     C     DETEST        IFNE      'AND'
     C     DETEST        ANDNE     'CAN'
     C* Generar mvto canc. deuda plan. ext.
     C*EJECUTAR M31120
     C                   EXSR      M31120
     C*FIN
     C                   END
     C*LEER DETAR201(DEUTIP DEUNUM DETNU2)
     C     LL$146        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    DEUNUM
     C                   KFLD                    DETNU2
     C     LL$146        READE     DETAR201                               48
     C*FIN
     C                   END
     C*SI ZVRPAD ]= *CERO O ZCUPAD ]= *CERO
     C     ZVRPAD        IFNE      *ZERO
     C     ZCUPAD        ORNE      *ZERO
     C* Cód. transacción
     C*PASAR ZCODTX '03'
     C                   MOVEL     '03'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '22'
     C                   MOVEL     '22'          ZCONCE
     C* Valor histórico
     C*MOVER ZVALHI ZVRPAD
     C                   Z-ADD     ZVRPAD        ZVALHI
     C* Cuotas
     C*LIMPIAR ZCUOHI
     C                   CLEAR                   ZCUOHI
     C* Genera histórico
     C*EJECUTAR M15008
     C                   EXSR      M15008
     C*
     C* Grabar deuda cancelada
     C*EJECUTAR M14392
     C                   EXSR      M14392
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LEER DEUARC08(DEUTIP PLANU4)
     C     LL$147        KLIST
     C                   KFLD                    DEUTIP
     C                   KFLD                    PLANU4
     C     LL$147        READE     DEUARC08                               53
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Generar mvto canc. deuda plan. ext.                         ==
     C*==                                                              ==
     C*==================================================================
     C     M31120        BEGSR
     C*INICIARUI MOVARC06 (ZFONDO DETNU9 DETPA2 DETSE4)
     C     LL$148        KLIST
     C                   KFLD                    ZFONDO
     C                   KFLD                    DETNU9
     C                   KFLD                    DETPA2
     C                   KFLD                    DETSE4
     C     LL$148        SETLL     MOVARC06                               68
     C     *IN68         IFEQ      '1'
     C     LL$148        SETGT     MOVARC06                           68
     C                   MOVE      '0'           *IN68
     C                   ELSE
     C                   MOVE      '1'           *IN68
     C                   END
     C* Calcula último consecutivo
     C*EJECUTAR M14035
     C                   EXSR      M14035
     C* Mover datos detalle de deuda
     C*EJECUTAR M14309
     C                   EXSR      M14309
     C* Valor C.O. = Valor F.S.
     C*MOVER ZVDCO ZVDFS
     C                   Z-ADD     ZVDFS         ZVDCO
     C* Cuotas C.O. = Cuotas F.S.
     C*MOVER ZCUCO ZCUFS
     C                   Z-ADD     ZCUFS         ZCUCO
     C* Cancelar intereses F.S.
     C*EJECUTAR M14315
     C                   EXSR      M14315
     C* Cancelar F.S.
     C*EJECUTAR M14320
     C                   EXSR      M14320
     C* Valor F.S = Valor C.O
     C*MOVER ZVDFS ZVDCO
     C                   Z-ADD     ZVDCO         ZVDFS
     C* Cuotas F.S = Cuotas C.O
     C*MOVER ZCUFS ZCUCO
     C                   Z-ADD     ZCUCO         ZCUFS
     C* Valor C.O = Valor S.F.S
     C*MOVER ZVDCO ZVDSFS
     C                   Z-ADD     ZVDSFS        ZVDCO
     C* Cuotas C.O = cuotas S.F.S
     C*MOVER ZCUCO ZCUSFS
     C                   Z-ADD     ZCUSFS        ZCUCO
     C* Cancelar intereses SFS
     C*EJECUTAR M14316
     C                   EXSR      M14316
     C* Cancelar SFS
     C*EJECUTAR M14321
     C                   EXSR      M14321
     C* Valor S.F.S = Valor C.O
     C*MOVER ZVDSFS ZVDCO
     C                   Z-ADD     ZVDCO         ZVDSFS
     C* Cuotas S.F.S = cuotas C.O
     C*MOVER ZCUSFS ZCUCO
     C                   Z-ADD     ZCUCO         ZCUSFS
     C* Evalua si genera movarc
     C*EJECUTAR M14302
     C                   EXSR      M14302
     C* Genera mvto si existen vlr MOVARC
     C*SI ZGENMV = '1'
     C     ZGENMV        IFEQ      '1'
     C* Planilla cancelación deuda
     C*MOVER MOVPLA PLANU1
     C                   Z-ADD     PLANU1        MOVPLA
     C* Actualizar detalle deuda
     C*EJECUTAR M14375
     C                   EXSR      M14375
     C* Acumular valores por concepto
     C*EJECUTAR M14380
     C                   EXSR      M14380
     C* Actualizar cuenta afiliado
     C*EJECUTAR M14385
     C                   EXSR      M14385
     C* Ind. canc.deudas ant. con FS no pac
     C*PASAR ZINCDE '1'
     C                   MOVEL     '1'           ZINCDE
     C* Ind. vigencia Siafp
     C*PASAR MOVI11 '1'
     C                   MOVEL     '1'           MOVI11
     C* Transacción
     C*MOVER MOVCO1 '02'
     C                   MOVE      '02'          MOVCO1
     C* Concepto
     C*MOVER MOVTIP '54'
     C                   MOVE      '54'          MOVTIP
     C* Agregar registro a movarc
     C*EJECUTAR M00009
     C                   EXSR      M00009
     C* Imprime reporte detallado
     C*EJECUTAR DET@01
     C                   EXSR      DET@01
     C* No hay error
     C*SI ZVRPAD <> *CERO
     C     ZVRPAD        IFNE      *ZERO
     C* Código transacción
     C*PASAR ZCODTX '03'
     C                   MOVEL     '03'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '22'
     C                   MOVEL     '22'          ZCONCE
     C* Página
     C*MOVER MOVPA2 MOVPAG
     C                   Z-ADD     MOVPAG        MOVPA2
     C* Secuencia
     C*MOVER MOVSE2 MOVSEC
     C                   Z-ADD     MOVSEC        MOVSE2
     C* Consecutivo
     C*MOVER MOV076 MOVCON
     C                   Z-ADD     MOVCON        MOV076
     C*CALCULAR MOVVA1 = MOVCOT+MOVCOM+MOVVAL+MOVC24+MOVCO5+MOVCO7+MOVCO
     C     MOVCOT        ADD       MOVCOM        V$CA1           030 9
     C     V$CA1         ADD       MOVVAL        V$CA1
     C     V$CA1         ADD       MOVC24        V$CA1
     C     V$CA1         ADD       MOVCO5        V$CA1
     C     V$CA1         ADD       MOVCO7        V$CA1
     C     V$CA1         ADD       MOVCO6        V$CA1
     C     V$CA1         ADD       MOVC27        V$CA1
     C     V$CA1         ADD       MOVCO8        V$CA1
     C     V$CA1         ADD       MOVV12        V$CA1
     C     V$CA1         ADD       MOVV13        V$CA1
     C     V$CA1         ADD       MOVINT        V$CA1
     C     V$CA1         ADD       MOVIN2        V$CA1
     C     V$CA1         ADD       MOVI05        V$CA1
     C     V$CA1         ADD       MOVI06        MOVVA1
     C* Movimiento de deuda
     C*EJECUTAR M14391
     C                   EXSR      M14391
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Proceso de planillas de declaración y no pago               ==
     C*==                                                              ==
     C*==================================================================
     C     M40000        BEGSR
     C* Ind. de actualizar o crear Temp. TEM708
     C*LIMPIAR ZINTEM
     C                   CLEAR                   ZINTEM
     C* Calcular total por concepto
     C*EJECUTAR M11000
     C                   EXSR      M11000
     C* Saldo a cargo
     C*MOVER ZSALCA PLASA3
     C                   Z-ADD     PLASA3        ZSALCA
     C* Saldo
     C*CALCULAR ZSALDO = ZSACO+ZSAAR+ZSACVA+ZSACVE+ZSAFS+ZSAINT+ZSAIFS+Z
     C     ZSACO         ADD       ZSAAR         V$CA1           030 9
     C     V$CA1         ADD       ZSACVA        V$CA1
     C     V$CA1         ADD       ZSACVE        V$CA1
     C     V$CA1         ADD       ZSAFS         V$CA1
     C     V$CA1         ADD       ZSAINT        V$CA1
     C     V$CA1         ADD       ZSAIFS        V$CA1
     C     V$CA1         ADD       ZSAFGP        V$CA1
     C     V$CA1         ADD       ZSAIFG        V$CA1
     C     V$CA1         ADD       ZSASFS        V$CA1
     C     V$CA1         ADD       ZSAISF        ZSALDO
     C*SI ZD7046 = 1 O ZR9072 = 1
     C     ZD7046        IFEQ      1
     C     ZR9072        OREQ      1
     C* Variable que controla proceso
     C*LIMPIAR ZINVAL
     C                   CLEAR                   ZINVAL
     C* Código interno auxiliar
     C*LIMPIAR ZCODIN
     C                   CLEAR                   ZCODIN
     C* Verificar empleador
     C*PASAR ZLLAM1 'E'
     C                   MOVEL     'E'           ZLLAM1
     C*LLAMAR TREMPN52 (ZCODIN PLATI1 PLANU4 PLAPER PLAPER ZINVAL ZLLAM1
     C                   CALL      'TREMPN52'
     C                   PARM                    ZCODIN
     C                   PARM                    PLATI1
     C                   PARM                    PLANU4
     C                   PARM                    PLAPER
     C                   PARM                    PLAPER
     C                   PARM                    ZINVAL
     C                   PARM                    ZLLAM1
     C* se encuentra en acuerdo
     C*SI ZINVAL <> ' '
     C     ZINVAL        IFNE      ' '
     C*PASAR ZINVAL '1'
     C                   MOVEL     '1'           ZINVAL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Indicador de error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Procesar detalles dec. y no p.
     C*EJECUTAR M16000
     C                   EXSR      M16000
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Genera encabezados de deuda
     C*EJECUTAR M15010
     C                   EXSR      M15010
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Anulación deudas por delta
     C*EJECUTAR M15500
     C                   EXSR      M15500
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Indicador de act. empleador
     C*SI ZACTEM = 'S' Y PLAPER >= ZPERVI
     C     ZACTEM        IFEQ      'S'
     C     PLAPER        ANDGE     ZPERVI
     C*SI PLAPER > EMPPE1 Y EMPPE1 ]= *BLANCO O EMPPE1 = *BLANCO
     C     PLAPER        IFGT      EMPPE1
     C     EMPPE1        ANDNE     *BLANK
     C     EMPPE1        OREQ      *BLANK
     C* Total de empleados
     C*SI PLAN09  ]= *CERO
     C     PLAN09        IFNE      *ZERO
     C*SI ZSALIR |= '1' Y PLATIP = '01' Y ERE (EMPAR204) O ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C     PLATIP        ANDEQ     '01'
     C     *IN58         ANDEQ     '0'
     C     ZSALIR        ORNE      '1'
     C     PLATIP        ANDEQ     '04'
     C     *IN58         ANDEQ     '0'
     C*SI ZTIPXX <> 'W' Y ZTLLAM <> 'X'
     C     ZTIPXX        IFNE      'W'
     C     ZTLLAM        ANDNE     'X'
     C*SQL
     C/EXEC SQL
     C+  UPDATE EMPAR204 SET EMPEMP=:PLAN09
     C+  WHERE EMPNU2 = :PLANU4
     C/END-EXEC
     C*SINO
     C                   ELSE
     C*SQL
     C/EXEC SQL
     C+  INSERT INTO TEM708 VALUES (:PLANU1, :PLANU4, :PLAN09,
     C+  '', '', '', '')
     C/END-EXEC
     C* Ind. que ya creo registro
     C*PASAR ZINTEM 'S'
     C                   MOVEL     'S'           ZINTEM
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*            MOVER EMPEMP PLAN09        ** Total de empleados
     C*FIN
     C                   END
     C*SI ZCLASE = 'B' Y EMPCLA = 'A' Y EMPPE1 ]= *BLANCO
     C     ZCLASE        IFEQ      'B'
     C     EMPCLA        ANDEQ     'A'
     C     EMPPE1        ANDNE     *BLANK
     C*SINO
     C                   ELSE
     C*SI ZSALIR |= '1' Y PLATIP = '01' Y ERE (EMPAR204) O ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C     PLATIP        ANDEQ     '01'
     C     *IN58         ANDEQ     '0'
     C     ZSALIR        ORNE      '1'
     C     PLATIP        ANDEQ     '04'
     C     *IN58         ANDEQ     '0'
     C*SI ZTIPXX <> 'W' Y ZTLLAM <> 'X'
     C     ZTIPXX        IFNE      'W'
     C     ZTLLAM        ANDNE     'X'
     C*SQL
     C/EXEC SQL
     C+  UPDATE EMPAR204 SET EMPCLA=:ZCLASE,
     C+  EMPFOR=:ZFORDE, EMPPE1=:PLAPER
     C+  WHERE EMPNU2 = :PLANU4
     C/END-EXEC
     C*SINO
     C                   ELSE
     C*SI ZINTEM = *BLANCO
     C     ZINTEM        IFEQ      *BLANK
     C*SQL
     C/EXEC SQL
     C+  INSERT INTO TEM708 VALUES (:PLANU1, :PLANU4, 0,
     C+  :ZCLASE, :ZFORDE, :PLAPER, '')
     C/END-EXEC
     C*SINO
     C                   ELSE
     C*SQL
     C/EXEC SQL
     C+  UPDATE TEM708 SET TEMCLA=:ZCLASE, TEMFO2=:ZFORDE,
     C+  TEMP57=:PLAPER  WHERE TEM710=:PLANU1 AND
     C+  TEMI83=:PLANU4
     C/END-EXEC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*            PASAR EMPCLA ZCLASE        ** Clasificación empleador
     C*            PASAR EMPFOR ZFORDE        ** Forma de declaración
     C*            PASAR EMPPE1 PLAPER        ** Período última actualiz
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesar planilla de traspasos de entrada                   ==
     C*==                                                              ==
     C*==================================================================
     C     M50000        BEGSR
     C* Calcular total por concepto
     C*EJECUTAR M50010
     C                   EXSR      M50010
     C* Número depósitos leidos
     C*MOVER K 1
     C                   Z-ADD     1             K
     C* Concilió con mas de un depós.
     C*SI PLANU8 = *CERO
     C     PLANU8        IFEQ      *ZERO
     C*LIMPIAR CONTI3
     C                   CLEAR                   CONTI3
     C*INICIAR CONAR202 (PLANU3 PLANUM CONTI3)
     C     LL$149        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    CONTI3
     C     LL$149        SETLL     CONAR202                           41
     C*LEER CONAR202
     C                   READ      CONAR202                               41
     C* Indicador pago en exceso
     C*MOVER ZINDPE '0'
     C                   MOVE      '0'           ZINDPE
     C*MIENTRAS NFA(CONAR202) Y PLANUM = CONNU5 Y CONTI3 = *BLANCO Y ZIN
     C     *IN41         DOWEQ     '0'
     C     PLANUM        ANDEQ     CONNU5
     C     CONTI3        ANDEQ     *BLANK
     C     ZINDPE        ANDEQ     '0'
     C     ZSALIR        ANDNE     '1'
     C* Lote de depósitos
     C*MOVER ZLOTE  CONNU2
     C                   Z-ADD     CONNU2        ZLOTE
     C* Número de depósito
     C*MOVER ZDEPO  CONNU3
     C                   Z-ADD     CONNU3        ZDEPO
     C* Consecutivo depósito
     C*MOVER ZCONSE CONCO4
     C                   Z-ADD     CONCO4        ZCONSE
     C* Leer depósito
     C*EJECUTAR M12010
     C                   EXSR      M12010
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Fecha de depósito
     C*MOVER AFECDE[K] ZFECDE
     C                   MOVE      ZFECDE        $G(K)
     C* Pagar Fondo GPM e intereses FGPM
     C*EJECUTAR M12221
     C                   EXSR      M12221
     C* Pagar voluntaria afiliado
     C*EJECUTAR M12210
     C                   EXSR      M12210
     C* Pagar rendimientos
     C*EJECUTAR M12230
     C                   EXSR      M12230
     C* Pagar obligatoria
     C*EJECUTAR M12240
     C                   EXSR      M12240
     C* Pagar voluntaria empleador
     C*EJECUTAR M12245
     C                   EXSR      M12245
     C*SUMAR 1 K
     C                   ADD       1             K
     C*LEER CONAR202
     C                   READ      CONAR202                               41
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Lote de depósitos
     C*MOVER ZLOTE  PLANU8
     C                   Z-ADD     PLANU8        ZLOTE
     C* Número de depósito
     C*MOVER ZDEPO  PLANU9
     C                   Z-ADD     PLANU9        ZDEPO
     C* Consecutivo depósito
     C*MOVER ZCONSE PLACON
     C                   Z-ADD     PLACON        ZCONSE
     C* Leer depósito
     C*EJECUTAR M12010
     C                   EXSR      M12010
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Fecha de depósito
     C*MOVER AFECDE[K] ZFECDE
     C                   MOVE      ZFECDE        $G(K)
     C* Pagar Fondo GPM e intereses FGPM
     C*EJECUTAR M12221
     C                   EXSR      M12221
     C* Pagar voluntaria afiliado
     C*EJECUTAR M12210
     C                   EXSR      M12210
     C* Pagar rendimientos
     C*EJECUTAR M12230
     C                   EXSR      M12230
     C* Pagar obligatoria
     C*EJECUTAR M12240
     C                   EXSR      M12240
     C* Pagar voluntaria empleador
     C*EJECUTAR M12245
     C                   EXSR      M12245
     C*SUMAR 1 K
     C                   ADD       1             K
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Procesar detalles plan.trasp.
     C*EJECUTAR M51000
     C                   EXSR      M51000
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Evaluar deuda o P.E.
     C*PASAR ZEVALU 'N'
     C                   MOVEL     'N'           ZEVALU
     C* Genera encabezados e históri.
     C*EJECUTAR M15000
     C                   EXSR      M15000
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular total por concepto planilla extraordinaria         ==
     C*==                                                              ==
     C*==================================================================
     C     M50010        BEGSR
     C* Se deben procesar todos los detalles
     C* Total por concepto
     C*LIMPIAR ZTOCO ZTOCVA ZTOCVE ZTOFS ZTOAR ZTOREN ZTOFGP ZFGPMP
     C                   CLEAR                   ZTOCO
     C                   CLEAR                   ZTOCVA
     C                   CLEAR                   ZTOCVE
     C                   CLEAR                   ZTOFS
     C                   CLEAR                   ZTOAR
     C                   CLEAR                   ZTOREN
     C                   CLEAR                   ZTOFGP
     C                   CLEAR                   ZFGPMP
     C* Detalles de planilla
     C*INICIAR DETARC (PLANU3 PLANUM)
     C     LL$150        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$150        SETLL     DETARC                             49
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$151        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$151        READE     DETARC                                 49
     C*MIENTRAS NFA(DETARC) Y PLANU3 = DETNUM Y PLANUM = DETNU3
     C     *IN49         DOWEQ     '0'
     C     PLANU3        ANDEQ     DETNUM
     C     PLANUM        ANDEQ     DETNU3
     C*LIMPIAR ZDILIC ZDITRA
     C                   CLEAR                   ZDILIC
     C                   CLEAR                   ZDITRA
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC WHERE DETNU3 = :DETNU3 AND
     C+  DETPAG = :DETPAG AND DETSEC = :DETSEC
     C/END-EXEC
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C*LIMPIAR ZTOCO2
     C                   CLEAR                   ZTOCO2
     C* Busqueda DETA53 plan, pag, sec
     C*PASAR ZOPCI2 '2'
     C                   MOVEL     '2'           ZOPCI2
     C*LLAMAR TRFGPM50 (DETNU3 DETPAG DETSEC ZFGPMP ZOPCI2)
     C                   CALL      'TRFGPM50'
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    ZFGPMP
     C                   PARM                    ZOPCI2
     C* TOTAL FGPM
     C*SUMAR ZFGPMP ZTOFGP
     C                   ADD       ZFGPMP        ZTOFGP
     C*CALCULAR ZTOCO2 = DETCOT - ZFGPMP
     C     DETCOT        SUB       ZFGPMP        ZTOCO2
     C* Total cotización obligatoria
     C*SUMAR ZTOCO2 ZTOCO
     C                   ADD       ZTOCO2        ZTOCO
     C* Total C.V.A.
     C*SUMAR DETCO1 ZTOCVA
     C                   ADD       DETCO1        ZTOCVA
     C* Total C.V.E.
     C*SUMAR DETCO2 ZTOCVE
     C                   ADD       DETCO2        ZTOCVE
     C* Total Rendimientos
     C*SUMAR DETV14 ZTOREN
     C                   ADD       DETV14        ZTOREN
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$152        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$152        READE     DETARC                                 49
     C*FIN
     C                   END
     C* Saldo cotización obligatoria
     C*MOVER ZSACO  ZTOCO
     C                   Z-ADD     ZTOCO         ZSACO
     C* Saldo voluntaria afiliado
     C*MOVER ZSACVA ZTOCVA
     C                   Z-ADD     ZTOCVA        ZSACVA
     C* Saldo voluntaria empleador
     C*MOVER ZSACVE ZTOCVE
     C                   Z-ADD     ZTOCVE        ZSACVE
     C* Saldo rendimientos
     C*MOVER ZSAREN ZTOREN
     C                   Z-ADD     ZTOREN        ZSAREN
     C* Saldo FGPM
     C*MOVER ZSAFGP ZTOFGP
     C                   Z-ADD     ZTOFGP        ZSAFGP
     C*CALCULAR ZSACOT = ZTOCO + ZTOCVA + ZTOCVE + ZSAFGP
     C     ZTOCO         ADD       ZTOCVA        V$CA1           030 9
     C     V$CA1         ADD       ZTOCVE        V$CA1
     C     V$CA1         ADD       ZSAFGP        ZSACOT
     C* Total cotizaciones
     C*MOVER ZTOTCO ZSACOT
     C                   Z-ADD     ZSACOT        ZTOTCO
     C                   ENDSR
     C*==================================================================
     C*==  Procesar detalles planilla de traspasos                     ==
     C*==                                                              ==
     C*==================================================================
     C     M51000        BEGSR
     C* Se deben procesar todos los detalles
     C* Limpiar variables
     C*EJECUTAR M14010
     C                   EXSR      M14010
     C*INICIAR DETARC (PLANU3 PLANUM)
     C     LL$153        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$153        SETLL     DETARC                             49
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$154        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$154        READE     DETARC                                 49
     C*MIENTRAS NFA(DETARC) Y DETNUM = PLANU3 Y DETNU3 = PLANUM Y ZSALIR
     C     *IN49         DOWEQ     '0'
     C     DETNUM        ANDEQ     PLANU3
     C     DETNU3        ANDEQ     PLANUM
     C     ZSALIR        ANDNE     '1'
     C*LIMPIAR ZDILIC ZDITRA
     C                   CLEAR                   ZDILIC
     C                   CLEAR                   ZDITRA
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC WHERE DETNU3 = :DETNU3 AND
     C+  DETPAG = :DETPAG AND DETSEC = :DETSEC
     C/END-EXEC
     C* Leer afiliado y cuenta
     C*EJECUTAR M14020
     C                   EXSR      M14020
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*LIMPIAR ZTOCO2
     C                   CLEAR                   ZTOCO2
     C* Busqueda DETA53 plan, pag, sec
     C*PASAR ZOPCI2 '2'
     C                   MOVEL     '2'           ZOPCI2
     C*LLAMAR TRFGPM50 (DETNU3 DETPAG DETSEC ZFGPMP ZOPCI2)
     C                   CALL      'TRFGPM50'
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    ZFGPMP
     C                   PARM                    ZOPCI2
     C* Cotización FGPM
     C*MOVER ZCOTFG ZFGPMP
     C                   Z-ADD     ZFGPMP        ZCOTFG
     C*CALCULAR ZTOCO2 = DETCOT - ZCOTFG
     C     DETCOT        SUB       ZCOTFG        ZTOCO2
     C* Cotización obligatoria
     C*MOVER ZCOTOB ZTOCO2
     C                   Z-ADD     ZTOCO2        ZCOTOB
     C* Cot. voluntaria afiliado
     C*MOVER ZCOTVA DETCO1
     C                   Z-ADD     DETCO1        ZCOTVA
     C* Cot. voluntaria empleador
     C*MOVER ZCOTVE DETCO2
     C                   Z-ADD     DETCO2        ZCOTVE
     C* Rendimientos
     C*MOVER ZRENDI DETV14
     C                   Z-ADD     DETV14        ZRENDI
     C*CALCULAR ZTOCOT = ZCOTOB + ZCOTVA + ZCOTVE + ZCOTFG
     C     ZCOTOB        ADD       ZCOTVA        V$CA1           030 9
     C     V$CA1         ADD       ZCOTVE        V$CA1
     C     V$CA1         ADD       ZCOTFG        ZTOCOT
     C* Procesa depósitos por detalle
     C*EJECUTAR M51100
     C                   EXSR      M51100
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Indicador de rezago
     C*SI DETIN4 |= *BLANCO
     C     DETIN4        IFNE      *BLANK
     C* Genera rezago
     C*EJECUTAR M14060
     C                   EXSR      M14060
     C*SINO
     C                   ELSE
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Mov. acreditación plan. traspaso no actuali
     C                   CLEAR                   ZERROR
     C     $HIL(108)     CAT       ZIDENA:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Acumula valores cotizaciones
     C*EJECUTAR M14085
     C                   EXSR      M14085
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LEER DETARC(PLANU3 PLANUM)
     C     LL$155        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C     LL$155        READE     DETARC                                 49
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesa depósito por detalle planilla de traspasos          ==
     C*==                                                              ==
     C*==================================================================
     C     M51100        BEGSR
     C* Posición en el arreglo
     C*MOVER L 1
     C                   Z-ADD     1             L
     C*LIMPIAR ZVRREZ ZCUREZ ZIFSRE ZINTRE
     C                   CLEAR                   ZVRREZ
     C                   CLEAR                   ZCUREZ
     C                   CLEAR                   ZIFSRE
     C                   CLEAR                   ZINTRE
     C*LIMPIAR ZINCDE ZGRAMV
     C                   CLEAR                   ZINCDE
     C                   CLEAR                   ZGRAMV
     C*LIMPIAR ZCTCVE ZVTVVE ZCTCVA ZVTVVA ZFEDEP
     C                   CLEAR                   ZCTCVE
     C                   CLEAR                   ZVTVVE
     C                   CLEAR                   ZCTCVA
     C                   CLEAR                   ZVTVVA
     C                   CLEAR                   ZFEDEP
     C*LIMPIAR ZCUERZ
     C                   CLEAR                   ZCUERZ
     C* Número depósitos procesados
     C*MIENTRAS L < K Y ZSALIR |= '1'
     C     L             DOWLT     K
     C     ZSALIR        ANDNE     '1'
     C*LIMPIAR ZVDFS ZVDIFS ZVDINT ZVDCVA ZVDREN ZVDCO ZVDCVE ZVDAR
     C                   CLEAR                   ZVDFS
     C                   CLEAR                   ZVDIFS
     C                   CLEAR                   ZVDINT
     C                   CLEAR                   ZVDCVA
     C                   CLEAR                   ZVDREN
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZVDCVE
     C                   CLEAR                   ZVDAR
     C*LIMPIAR ZCUFS ZCUIFS ZCUINT ZCUCVA ZCUREN ZCUCO ZCUCVE ZCUAR
     C                   CLEAR                   ZCUFS
     C                   CLEAR                   ZCUIFS
     C                   CLEAR                   ZCUINT
     C                   CLEAR                   ZCUCVA
     C                   CLEAR                   ZCUREN
     C                   CLEAR                   ZCUCO
     C                   CLEAR                   ZCUCVE
     C                   CLEAR                   ZCUAR
     C*LIMPIAR ZVDIVA ZVDIVE ZVDIAR ZCUIVA ZCUIVE ZCUIAR ZVDFGP ZCUFGP
     C                   CLEAR                   ZVDIVA
     C                   CLEAR                   ZVDIVE
     C                   CLEAR                   ZVDIAR
     C                   CLEAR                   ZCUIVA
     C                   CLEAR                   ZCUIVE
     C                   CLEAR                   ZCUIAR
     C                   CLEAR                   ZVDFGP
     C                   CLEAR                   ZCUFGP
     C*LIMPIAR ZOVCO8 ZOVIN2 ZOVV13 ZOVI06 ZOVCOM ZOVVAL ZOVCO7 ZOVC27 Z
     C                   CLEAR                   ZOVCO8
     C                   CLEAR                   ZOVIN2
     C                   CLEAR                   ZOVV13
     C                   CLEAR                   ZOVI06
     C                   CLEAR                   ZOVCOM
     C                   CLEAR                   ZOVVAL
     C                   CLEAR                   ZOVCO7
     C                   CLEAR                   ZOVC27
     C                   CLEAR                   ZOVRET
     C* Distribuir valor
     C*EJECUTAR M14105
     C                   EXSR      M14105
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Indicador de rezago
     C*SI DETIN4 |= *BLANCO
     C     DETIN4        IFNE      *BLANK
     C* Distribución rezago
     C*EJECUTAR M14170
     C                   EXSR      M14170
     C*SINO
     C                   ELSE
     C* Generar movimiento
     C*EJECUTAR M51105
     C                   EXSR      M51105
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SUMAR 1 L
     C                   ADD       1             L
     C*FIN
     C                   END
     C*
     C* Si tiene detalle aportes voluntarios traspasados
     C*SI ZCTCVE |= 0 O ZVTVVE |= 0 O ZCTCVA |= 0 O ZVTVVA |= 0
     C     ZCTCVE        IFNE      0
     C     ZVTVVE        ORNE      0
     C     ZCTCVA        ORNE      0
     C     ZVTVVA        ORNE      0
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Acred. aportes vol. plan. traspaso no actua
     C                   CLEAR                   ZERROR
     C     $HIL(109)     CAT       ZIDENA:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*GRABAR DETARC
     C     *IN49         IFEQ      '0'
     C                   UPDATE    DETREG                               94
     C                   ELSE
     C                   WRITE     DETREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Crear registro de aporte voluntario
     C* Indicador tipo acreditación
     C*PASAR ZINACR '2'
     C                   MOVEL     '2'           ZINACR
     C* Crear registro de aporte voluntario
     C*MOVER MOVCON ZMVCON
     C                   Z-ADD     ZMVCON        MOVCON
     C* Acreditación aporte voluntario
     C*EJECUTAR M00210
     C                   EXSR      M00210
     C*RECUPERARD CUEARC (MOVCO4 ZFONDO)
     C     LL$156        KLIST
     C                   KFLD                    MOVCO4
     C                   KFLD                    ZFONDO
     C     LL$156        CHAIN     CUEARC                             4594
     C                   MOVE      *IN94         I$RND
     C     *IN45         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   CUEREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Retención contingente
     C*SUMAR MOVRET ZVRRET
     C                   ADD       MOVRET        ZVRRET
     C* Saldo retención conting
     C*SUMAR MOVRET CUESAL
     C                   ADD       MOVRET        CUESAL
     C*INICIARI DETARC(DETNUM DETNU3 DETPAG DETSEC)
     C     LL$157        KLIST
     C                   KFLD                    DETNUM
     C                   KFLD                    DETNU3
     C                   KFLD                    DETPAG
     C                   KFLD                    DETSEC
     C     LL$157        SETLL     DETARC                                 49
     C     *IN49         IFEQ      '1'
     C                   MOVE      '0'           *IN49
     C                   ELSE
     C                   MOVE      '1'           *IN49
     C                   END
     C*SI ERE(DETARC)
     C     *IN49         IFEQ      '0'
     C*LEER DETARC
     C                   READ      DETARC                                 49
     C*FIN
     C                   END
     C* Indicador de error
     C*SI ZINDER = '1'
     C     ZINDER        IFEQ      '1'
     C* Mensaje de error
     C*PASAR ZERROR ZERRET
     C                   CLEAR                   ZERROR
     C                   MOVEL     ZERRET        ZERROR
     C* Imprimir error
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*MOVER ZPLAER PLANUM
     C                   MOVE      PLANUM        ZPLAER
     C*MOVER ZAFIIN MOVCO4
     C                   CLEAR                   ZAFIIN
     C                   MOVE      MOVCO4        ZAFIIN
     C*OBTENER (1) ZERROR = 'CUEARC no disponible - M51100' || ZPLAER ||
     C                   CLEAR                   H$1
     C     $HIL(110)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Generar movimiento planilla de traspasos                    ==
     C*==                                                              ==
     C*==================================================================
     C     M51105        BEGSR
     C* Valor retención contingente
     C*LIMPIAR ZVRECO
     C                   CLEAR                   ZVRECO
     C* Mover datos movimiento acred.
     C*EJECUTAR M14395
     C                   EXSR      M14395
     C* Evalua si genera reg. de mvto
     C*EJECUTAR M14302
     C                   EXSR      M14302
     C* Si genera mvto
     C*SI ZGENMV = '1'
     C     ZGENMV        IFEQ      '1'
     C* Transacción
     C*MOVER MOVCO1 '02'
     C                   MOVE      '02'          MOVCO1
     C* No es acreditación de rezagos
     C*SI ZT@002 |= '3'
     C     ZT@002        IFNE      '3'
     C* Concepto
     C*MOVER MOVTIP '36'
     C                   MOVE      '36'          MOVTIP
     C* Es acreditación de rezagos
     C*SINO
     C                   ELSE
     C* Concepto
     C*MOVER MOVTIP '44'
     C                   MOVE      '44'          MOVTIP
     C*FIN
     C                   END
     C* Si es el primer reg. de movarc
     C*SI ZGRAMV ]= '1'
     C     ZGRAMV        IFNE      '1'
     C* Retroactivos
     C*SI PLAT03 = '09' O PLAT03 = '10' O PLAT03 = '11' O PLAT03 = '12'
     C     PLAT03        IFEQ      '09'
     C     PLAT03        OREQ      '10'
     C     PLAT03        OREQ      '11'
     C     PLAT03        OREQ      '12'
     C* Días trabajados
     C*MOVER MOVNUM ZDITRA
     C                   Z-ADD     ZDITRA        MOVNUM
     C*FIN
     C                   END
     C* Salario informado
     C*MOVER MOVSAL DETSAL
     C                   Z-ADD     DETSAL        MOVSAL
     C* Salario calculado
     C*MOVER MOVSA2 DETVA7
     C                   Z-ADD     DETVA7        MOVSA2
     C* Prende indicador de gener. mvto
     C*PASAR ZGRAMV '1'
     C                   MOVEL     '1'           ZGRAMV
     C*FIN
     C                   END
     C* Agregar registro a movarc
     C*EJECUTAR M00009
     C                   EXSR      M00009
     C*
     C* Si el valor de C.V.A o C.V.E es mayor a 0
     C*SI MOVCO5 |= 0 O MOVCU3 |= 0 O MOVCO6 |= 0 O MOVCU4 |= 0
     C     MOVCO5        IFNE      0
     C     MOVCU3        ORNE      0
     C     MOVCO6        ORNE      0
     C     MOVCU4        ORNE      0
     C* Limpia var. de trabajo
     C*LIMPIAR ZALFA8 ZALFA5 ZINERE
     C                   CLEAR                   ZALFA8
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUM12 ZNUME9 ZNUMI9
     C                   CLEAR                   ZNUM12
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUMR9 ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* ARCA11
     C*PASAR ZENTID '7'
     C                   MOVEL     '7'           ZENTID
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZFITIP
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZFITIP
     C* Planilla
     C*MOVER ZNUM12 PLANUM
     C                   Z-ADD     PLANUM        ZNUM12
     C* Página
     C*MOVER ZNUME3 DETPAG
     C                   Z-ADD     DETPAG        ZNUME3
     C* Secuencia
     C*MOVER ZNUMI3 DETSEC
     C                   Z-ADD     DETSEC        ZNUMI3
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C* Actualizar detalle a.v trs
     C*EJECUTAR M51110
     C                   EXSR      M51110
     C*FIN
     C                   END
     C*
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Imprime reporte detallado
     C*EJECUTAR DET@01
     C                   EXSR      DET@01
     C* Acumular valores por concepto
     C*EJECUTAR M14380
     C                   EXSR      M14380
     C* Actualizar cuenta afiliado
     C*EJECUTAR M14385
     C                   EXSR      M14385
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actualizar detalles aportes voluntarios traspasados         ==
     C*==                                                              ==
     C*==================================================================
     C     M51110        BEGSR
     C*SI ZINERE = '0'
     C     ZINERE        IFEQ      '0'
     C* Acumular cuotas CVE
     C*CALCULAR ZCTCVE = ZCTCVE + MOVCU4
     C     ZCTCVE        ADD       MOVCU4        ZCTCVE
     C* Acumular valor CVE
     C*CALCULAR ZVTVVE = ZVTVVE + MOVCO6
     C     ZVTVVE        ADD       MOVCO6        ZVTVVE
     C* Acumular cuotas CVA
     C*CALCULAR ZCTCVA = ZCTCVA + MOVCU3
     C     ZCTCVA        ADD       MOVCU3        ZCTCVA
     C* Acumular valor CVA
     C*CALCULAR ZVTVVA = ZVTVVA + MOVCO5
     C     ZVTVVA        ADD       MOVCO5        ZVTVVA
     C*SI  MOVFEC > ZFEDEP
     C     MOVFEC        IFGT      ZFEDEP
     C* Fecha depósito de la planilla
     C*PASAR ZFEDEP MOVFEC
     C                   MOVEL     MOVFEC        ZFEDEP
     C*FIN
     C                   END
     C*MOVER ZMVCON MOVCON
     C                   Z-ADD     MOVCON        ZMVCON
     C*SINO
     C                   ELSE
     C* Indicador de acreditación
     C*PASAR ZINACR '1'
     C                   MOVEL     '1'           ZINACR
     C*CALCULAR (R) ZVRECO = ZDTVA8 * (MOVCO5+MOVCO7+MOVCO6+MOVC27)/(DET
     C     MOVCO5        ADD       MOVCO7        V$CA1           030 9
     C     V$CA1         ADD       MOVCO6        V$CA1
     C     V$CA1         ADD       MOVC27        V$CA1
     C     ZDTVA8        MULT      V$CA1         V$CA1
     C     DETCO1        ADD       DETCO2        V$CA2           030 9
     C     V$CA1         DIV(H)    V$CA2         ZVRECO
     C* Crear registro de aporte vol
     C*EJECUTAR M09000
     C                   EXSR      M09000
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar detalle de deuda con pago en exceso                ==
     C*==                                                              ==
     C*==================================================================
     C     M61000        BEGSR
     C* Valor retención contingente
     C*LIMPIAR ZVRECO ZMICOM ZDITRA ZDILIC
     C                   CLEAR                   ZVRECO
     C                   CLEAR                   ZMICOM
     C                   CLEAR                   ZDITRA
     C                   CLEAR                   ZDILIC
     C*INICIARUI MOVARC06 (ZFONDO DETNU9 DETPA2 DETSE4)
     C     LL$158        KLIST
     C                   KFLD                    ZFONDO
     C                   KFLD                    DETNU9
     C                   KFLD                    DETPA2
     C                   KFLD                    DETSE4
     C     LL$158        SETLL     MOVARC06                               68
     C     *IN68         IFEQ      '1'
     C     LL$158        SETGT     MOVARC06                           68
     C                   MOVE      '0'           *IN68
     C                   ELSE
     C                   MOVE      '1'           *IN68
     C                   END
     C* Cancelar movimiento
     C*EJECUTAR M61001
     C                   EXSR      M61001
     C* Si genera mvto
     C*SI ZGENMV = '1'
     C     ZGENMV        IFEQ      '1'
     C* Calcular retconting deuda
     C*EJECUTAR M14350
     C                   EXSR      M14350
     C* Planilla cancelación deuda - P.E.E.
     C*MOVER MOVPLA PAGNUM
     C                   Z-ADD     PAGNUM        MOVPLA
     C* Actualizar detalle deuda
     C*EJECUTAR M14375
     C                   EXSR      M14375
     C* Ind. vigencia Siafp
     C*PASAR MOVI11 '1'
     C                   MOVEL     '1'           MOVI11
     C* Transacción
     C*MOVER MOVCO1 '02'
     C                   MOVE      '02'          MOVCO1
     C*SI ZINPED = 'S'
     C     ZINPED        IFEQ      'S'
     C* Planilla sector salud
     C*SI INFT04 = '04'
     C     INFT04        IFEQ      '04'
     C* Pago del situado
     C*SI INFTI9 = '04' O INFTI9 = '11'
     C     INFTI9        IFEQ      '04'
     C     INFTI9        OREQ      '11'
     C* Concepto
     C*MOVER MOVTIP '75'
     C                   MOVE      '75'          MOVTIP
     C* Pago Hospital
     C*SINO
     C                   ELSE
     C* Concepto
     C*MOVER MOVTIP '95'
     C                   MOVE      '95'          MOVTIP
     C*FIN
     C                   END
     C* Planillas normales
     C*SINO
     C                   ELSE
     C* Concepto
     C*MOVER MOVTIP '35'
     C                   MOVE      '35'          MOVTIP
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Planilla sector salud
     C*SI PLATIP = '04'
     C     PLATIP        IFEQ      '04'
     C* Pago del situado
     C*SI PLAT03 = '04' O PLAT03 = '11'
     C     PLAT03        IFEQ      '04'
     C     PLAT03        OREQ      '11'
     C* Concepto
     C*MOVER MOVTIP '75'
     C                   MOVE      '75'          MOVTIP
     C* Pago Hospital
     C*SINO
     C                   ELSE
     C* Concepto
     C*MOVER MOVTIP '95'
     C                   MOVE      '95'          MOVTIP
     C*FIN
     C                   END
     C* Planillas normales
     C*SINO
     C                   ELSE
     C* Concepto
     C*MOVER MOVTIP '35'
     C                   MOVE      '35'          MOVTIP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI Z10592 = 1 Y ZIPEFP = '1'
     C     Z10592        IFEQ      1
     C     ZIPEFP        ANDEQ     '1'
     C* Inserta Ingreso Diverso
     C*SI ZINPEE = 'N'
     C     ZINPEE        IFEQ      'N'
     C* Fecha fusión ING-Pro (Fecha del Deposito)
     C*PASAR MOVFEC ZFECFU
     C                   MOVEL     ZFECFU        MOVFEC
     C* Se pasan a valores 9,0 para hacer el INSERT
     C*MOVER ZRING9 ZREING
     C                   Z-ADD     ZREING        ZRING9
     C*MOVER ZVRIA9 ZVRINA
     C                   Z-ADD     ZVRINA        ZVRIA9
     C*MOVER ZNGNUM PAGNUM
     C                   Z-ADD     PAGNUM        ZNGNUM
     C*MOVER ZNGPLA MOVNU2
     C                   Z-ADD     MOVNU2        ZNGPLA
     C*MOVER ZNGPAG MOVPAG
     C                   Z-ADD     MOVPAG        ZNGPAG
     C*MOVER ZNGSE1 MOVSEC
     C                   Z-ADD     MOVSEC        ZNGSE1
     C*MOVER ZNGCO2 MOVCON
     C                   Z-ADD     MOVCON        ZNGCO2
     C*PASAR ZNGFEC HISFE3
     C                   MOVEL     HISFE3        ZNGFEC
     C*LIMPIAR ZNGFE1
     C                   CLEAR                   ZNGFE1
     C*MOVER ZNGTIP *CEROS
     C                   MOVE      *ZEROS        ZNGTIP
     C* Movto = C.O. + C.V.A. + C.V.E. + Int. + C.F.S. + I.F.S + Rendim
     C*CALCULAR ZSUMOV = MOVCOT+MOVCOM+MOVV12+MOVVAL+MOVCO5+MOVCO7+MOVCO
     C     MOVCOT        ADD       MOVCOM        V$CA1           030 9
     C     V$CA1         ADD       MOVV12        V$CA1
     C     V$CA1         ADD       MOVVAL        V$CA1
     C     V$CA1         ADD       MOVCO5        V$CA1
     C     V$CA1         ADD       MOVCO7        V$CA1
     C     V$CA1         ADD       MOVCO6        V$CA1
     C     V$CA1         ADD       MOVC27        V$CA1
     C     V$CA1         ADD       MOVINT        V$CA1
     C     V$CA1         ADD       MOVCO8        V$CA1
     C     V$CA1         ADD       MOVIN2        V$CA1
     C     V$CA1         ADD       MOVVA4        V$CA1
     C     V$CA1         ADD       MOVC24        V$CA1
     C     V$CA1         ADD       MOVI05        V$CA1
     C     V$CA1         ADD       MOVV13        V$CA1
     C     V$CA1         ADD       MOVI06        ZSUMOV
     C*CALCULAR ZSU229 = MOVCUO+MOVCU2+MOV056+MOVCU7+MOVCU3+MOVCU5+MOVCU
     C     MOVCUO        ADD       MOVCU2        V$CA1           030 9
     C     V$CA1         ADD       MOV056        V$CA1
     C     V$CA1         ADD       MOVCU7        V$CA1
     C     V$CA1         ADD       MOVCU3        V$CA1
     C     V$CA1         ADD       MOVCU5        V$CA1
     C     V$CA1         ADD       MOVCU4        V$CA1
     C     V$CA1         ADD       MOVC28        V$CA1
     C     V$CA1         ADD       MOVCU6        V$CA1
     C     V$CA1         ADD       MOVCU8        V$CA1
     C     V$CA1         ADD       MOVC16        V$CA1
     C     V$CA1         ADD       MOVC19        V$CA1
     C     V$CA1         ADD       MOVC25        V$CA1
     C     V$CA1         ADD       MOV057        V$CA1
     C     V$CA1         ADD       MOV058        V$CA1
     C     V$CA1         ADD       MOV059        ZSU229
     C*CALCULAR (R) ZSUMOC = ZSU229
     C                   Z-ADD(H)  ZSU229        ZSUMOC
     C*SI ZINFH3 <> *BLANCOS
     C     ZINFH3        IFNE      *BLANKS
     C* Calculo cuotas a fecha deposito ING
     C*LIMPIAR ZCP229
     C                   CLEAR                   ZCP229
     C*CALCULAR ZCP229 = ZSUMOV / ZVCFDI
     C     ZSUMOV        DIV       ZVCFDI        ZCP229
     C*CALCULAR (R) ZCUOMO = ZCP229
     C                   Z-ADD(H)  ZCP229        ZCUOMO
     C* Valor en cuotas Rendimientos (Se redondea)
     C*CALCULAR ZVGVLR = (ZCUOMO * ZVCFFI) - ZSUMOV
     C     ZCUOMO        MULT      ZVCFFI        V$CA1           030 9
     C     V$CA1         SUB       ZSUMOV        ZVGVLR
     C*CALCULAR (R) ZNGVLR = ZVGVLR
     C                   Z-ADD(H)  ZVGVLR        ZNGVLR
     C*SI ZNGVLR <> 0
     C     ZNGVLR        IFNE      0
     C*CALCULAR (R) ZNGCUO = (ZVGVLR * ZSUMOC) / ZSUMOV
     C     ZVGVLR        MULT      ZSUMOC        V$CA1           030 9
     C     V$CA1         DIV(H)    ZSUMOV        ZNGCUO
     C*CALCULAR (R) ZNGVL1 = ZNGCUO * HISC28
     C     ZNGCUO        MULT(H)   HISC28        ZNGVL1
     C*SINO
     C                   ELSE
     C*LIMPIAR ZNGCUO ZNGVL1
     C                   CLEAR                   ZNGCUO
     C                   CLEAR                   ZNGVL1
     C*FIN SI
     C                   END
     C* Sumatorias
     C* Sumatoria INGARC Valor
     C*CALCULAR ZSGVLR = ZSGVLR + ZNGVLR
     C     ZSGVLR        ADD       ZNGVLR        ZSGVLR
     C* Sumatoria INGARC Cuotas
     C*CALCULAR ZSGCUO = ZSGCUO + ZNGCUO
     C     ZSGCUO        ADD       ZNGCUO        ZSGCUO
     C* Sumatoria Movimiento
     C*CALCULAR ZSSMOV = ZSSMOV + ZSUMOV
     C     ZSSMOV        ADD       ZSUMOV        ZSSMOV
     C* Sumatoria Movimiento Cuotas
     C*CALCULAR ZSSMOC = ZSSMOC + ZSUMOC
     C     ZSSMOC        ADD       ZSUMOC        ZSSMOC
     C*FIN SI
     C                   END
     C*MOVER ZNGVL2 *CEROS
     C                   MOVE      *ZEROS        ZNGVL2
     C* Acumulado de valor
     C*SUMAR ZNGVLR ZACVLI
     C                   ADD       ZNGVLR        ZACVLI
     C* Acumulado de cuotas
     C*SUMAR ZNGCUO ZACCUI
     C                   ADD       ZNGCUO        ZACCUI
     C*LLAMAR TRFPEX24 ($$INGA)
     C                   CALL      'TRFPEX24'
     C                   PARM                    $$INGA
     C*FIN SI
     C                   END
     C* Existe registro PLAA55
     C*SI ZLA113 <> *CERO
     C     ZLA113        IFNE      *ZERO
     C* Tipo de planilla PLAA55
     C*PASAR MOVTI5 ZLA114
     C                   MOVEL     ZLA114        MOVTI5
     C*FIN SI
     C                   END
     C*FIN SI
     C                   END
     C* Valida actualiz. días cotiz.
     C*EJECUTAR M00100
     C                   EXSR      M00100
     C* Agregar registro a MOVARC
     C*EJECUTAR M00009
     C                   EXSR      M00009
     C* Grabar cuenta del afiliado
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Canc. deuda con pago en exceso no actualizó
     C                   CLEAR                   ZERROR
     C     $HIL(111)     CAT       ZIDENA:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*
     C* Si el valor de C.V.A o C.V.E es mayor a 0
     C*SI MOVCO5 |= 0 O MOVCU3 |= 0 O MOVCO6 |= 0 O MOVCU4 |= 0
     C     MOVCO5        IFNE      0
     C     MOVCU3        ORNE      0
     C     MOVCO6        ORNE      0
     C     MOVCU4        ORNE      0
     C* Crear registro de aporte voluntario
     C* Indicador de acreditación
     C*PASAR ZINACR '1'
     C                   MOVEL     '1'           ZINACR
     C* Acreditación aporte voluntario
     C*EJECUTAR M00210
     C                   EXSR      M00210
     C* Indicador de error
     C*SI ZINDER = '1'
     C     ZINDER        IFEQ      '1'
     C* Mensaje de error
     C*PASAR ZERROR ZERRET
     C                   CLEAR                   ZERROR
     C                   MOVEL     ZERRET        ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*
     C*SI ZSALIR  <> '1'
     C     ZSALIR        IFNE      '1'
     C*MOVER DETNU2 DETNR1
     C                   Z-ADD     DETNR1        DETNU2
     C* Imprime reporte detallado
     C*EJECUTAR DET@01
     C                   EXSR      DET@01
     C* Acumular valores por concepto
     C*EJECUTAR M14380
     C                   EXSR      M14380
     C* Código interno afil
     C*MOVER CUENUM AFINUM
     C                   Z-ADD     AFINUM        CUENUM
     C* Código fondo moderado
     C*PASAR CUEC17 ZFONDO
     C                   MOVEL     ZFONDO        CUEC17
     C*RECUPERARD CUEARC (CUENUM CUEC17)
     C     LL$159        KLIST
     C                   KFLD                    CUENUM
     C                   KFLD                    CUEC17
     C     LL$159        CHAIN     CUEARC                             4594
     C                   MOVE      *IN94         I$RND
     C     *IN45         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   CUEREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Actualizar cuenta afiliado
     C*EJECUTAR M14385
     C                   EXSR      M14385
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Canc. deuda con pago en exceso no actualizó
     C                   CLEAR                   ZERROR
     C     $HIL(112)     CAT       ZIDENA:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*MOVER ZPLAER PLANUM
     C                   MOVE      PLANUM        ZPLAER
     C*MOVER ZAFIIN CUENUM
     C                   CLEAR                   ZAFIIN
     C                   MOVE      CUENUM        ZAFIIN
     C*OBTENER (1) ZERROR = 'CUEARC no disponible - M61000' || ZPLAER ||
     C                   CLEAR                   H$1
     C     $HIL(113)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SI ZSALIR  <> '1'
     C     ZSALIR        IFNE      '1'
     C* No hay error
     C*SI ZVRPAD <> *CERO
     C     ZVRPAD        IFNE      *ZERO
     C* Código transacción
     C*PASAR ZCODTX '03'
     C                   MOVEL     '03'          ZCODTX
     C* Concepto
     C*PASAR ZCONCE '22'
     C                   MOVEL     '22'          ZCONCE
     C* Página
     C*MOVER MOVPA2 MOVPAG
     C                   Z-ADD     MOVPAG        MOVPA2
     C* Secuencia
     C*MOVER MOVSE2 MOVSEC
     C                   Z-ADD     MOVSEC        MOVSE2
     C* Consecutivo
     C*MOVER MOV076 MOVCON
     C                   Z-ADD     MOVCON        MOV076
     C*CALCULAR MOVVA1 = MOVCOT+MOVCOM+MOVVAL+MOVC24+MOVCO5+MOVCO7+MOVCO
     C     MOVCOT        ADD       MOVCOM        V$CA1           030 9
     C     V$CA1         ADD       MOVVAL        V$CA1
     C     V$CA1         ADD       MOVC24        V$CA1
     C     V$CA1         ADD       MOVCO5        V$CA1
     C     V$CA1         ADD       MOVCO7        V$CA1
     C     V$CA1         ADD       MOVCO6        V$CA1
     C     V$CA1         ADD       MOVC27        V$CA1
     C     V$CA1         ADD       MOVCO8        V$CA1
     C     V$CA1         ADD       MOVV12        V$CA1
     C     V$CA1         ADD       MOVV13        V$CA1
     C     V$CA1         ADD       MOVINT        V$CA1
     C     V$CA1         ADD       MOVIN2        V$CA1
     C     V$CA1         ADD       MOVI05        V$CA1
     C     V$CA1         ADD       MOVI06        MOVVA1
     C* Movimiento de deuda
     C*EJECUTAR M14391
     C                   EXSR      M14391
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Cancelar movimiento                                         ==
     C*==                                                              ==
     C*==================================================================
     C     M61001        BEGSR
     C* Calcula último consecutivo
     C*EJECUTAR M14035
     C                   EXSR      M14035
     C* Mover datos detalle de deuda
     C*EJECUTAR M14309
     C                   EXSR      M14309
     C* Cancelar C.V.A.
     C*EJECUTAR M14310
     C                   EXSR      M14310
     C* Cancelar intereses F.S.
     C*EJECUTAR M14315
     C                   EXSR      M14315
     C* Cancelar intereses SFS
     C*EJECUTAR M14316
     C                   EXSR      M14316
     C* Cancelar F.S.
     C*EJECUTAR M14320
     C                   EXSR      M14320
     C* Cancelar SFS
     C*EJECUTAR M14321
     C                   EXSR      M14321
     C* Cancelar intereses
     C*EJECUTAR M14325
     C                   EXSR      M14325
     C* Cancelar intereses FGPM
     C*EJECUTAR M14326
     C                   EXSR      M14326
     C* Cancelar FGPM
     C*EJECUTAR M14327
     C                   EXSR      M14327
     C* Cancelar alto riesgo
     C*EJECUTAR M14335
     C                   EXSR      M14335
     C* Cancelar C.O.
     C*EJECUTAR M14340
     C                   EXSR      M14340
     C* Cancelar C.V.E.
     C*EJECUTAR M14345
     C                   EXSR      M14345
     C* Calcular comisiones y prima
     C*EJECUTAR M14370
     C                   EXSR      M14370
     C* Evalua si genera reg. mvto
     C*EJECUTAR M14302
     C                   EXSR      M14302
     C                   ENDSR
     C*==================================================================
     C*==  Actualiza Saldo del P.E.                                    ==
     C*==                                                              ==
     C*==================================================================
     C     M63000        BEGSR
     C* Indicador reste las cuotas normal
     C*LIMPIAR ZIRNPE
     C                   CLEAR                   ZIRNPE
     C* Si esta el desarrollo especial activo y el pago en exceso es Fus
     C*SI Z10592 = 1 Y ZIPEFP = '1'
     C     Z10592        IFEQ      1
     C     ZIPEFP        ANDEQ     '1'
     C*CASO ZINPEE = 'N'
     C                   SELECT
     C     ZINPEE        WHENEQ    'N'
     C*PASAR ZINDI2 '1'
     C                   MOVEL     '1'           ZINDI2
     C* Confirma INGARC
     C*EJECUTAR M63001
     C                   EXSR      M63001
     C* Debe trabajar con los valores originales
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C*MOVER ZSALPA ZAGS16
     C                   Z-ADD     ZAGS16        ZSALPA
     C*FIN
     C                   END
     C* Cuotas P.E. empleador <> 0
     C*SI ZAG019 ]= *CERO
     C     ZAG019        IFNE      *ZERO
     C* Actualiza pago en exceso de fusión.
     C*EJECUTAR M000FF
     C                   EXSR      M000FF
     C*CALCULAR PAGSA3 = PAGSA3 - ZVRPAG - ZACVLI - ZDIFAV
     C     PAGSA3        SUB       ZVRPAG        V$CA1           030 9
     C     V$CA1         SUB       ZACVLI        V$CA1
     C     V$CA1         SUB       ZDIFAV        PAGSA3
     C*CALCULAR PAGSA4 = PAGSA4 - ZCUPAG - ZACCUI - ZDIFAU
     C     PAGSA4        SUB       ZCUPAG        V$CA1           030 9
     C     V$CA1         SUB       ZACCUI        V$CA1
     C     V$CA1         SUB       ZDIFAU        PAGSA4
     C*PASAR ZINDI2 '2'
     C                   MOVEL     '2'           ZINDI2
     C* Confirme INGARC (Proceso masivo)
     C*EJECUTAR M63001
     C                   EXSR      M63001
     C* Registro control empleadores
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C* Saldo P.E. SAE
     C*CALCULAR ZSALPA = ZSALPA - PAGSA3
     C     ZSALPA        SUB       PAGSA3        ZSALPA
     C*PASAR ZSIGNO '-'
     C                   MOVEL     '-'           ZSIGNO
     C* Actualiza P.E. de incons. empl.
     C*LLAMAR TRINCE62(PAGNUM ZSALPA ZSIGNO)
     C                   CALL      'TRINCE62'
     C                   PARM                    PAGNUM
     C                   PARM                    ZSALPA
     C                   PARM                    ZSIGNO
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C* Rollback
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C* Nro. planilla alfanumérico
     C*MOVER ZALPLA PAGNUM
     C                   MOVE      PAGNUM        ZALPLA
     C*OBTENER (1) ZERROR = 'Valor en cuotas del pago en exceso es igual
     C                   CLEAR                   ZERROR
     C     $HIL(114)     CAT       ZALPLA:1      ZERROR
     C* Planilla de PLAA55
     C*MOVER PLANU1 ZLA113
     C                   Z-ADD     ZLA113        PLANU1
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN SI
     C                   END
     C*CASO ZINPEE = 'S'
     C     ZINPEE        WHENEQ    'S'
     C* Indicador reste las cuotas normal
     C*PASAR ZIRNPE 'S'
     C                   MOVEL     'S'           ZIRNPE
     C*FINCASOS
     C                   ENDSL
     C*SINO
     C                   ELSE
     C* Indicador reste las cuotas normal
     C*PASAR ZIRNPE 'S'
     C                   MOVEL     'S'           ZIRNPE
     C*FIN SI
     C                   END
     C*SI ZIRNPE <> *BLANCOS
     C     ZIRNPE        IFNE      *BLANKS
     C* Saldo cuotas P.E. empleador
     C*CALCULAR PAGSA4 = PAGSA4 - ZCUPAG
     C     PAGSA4        SUB       ZCUPAG        PAGSA4
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C*MOVER ZSALPA PAGSA3
     C                   Z-ADD     PAGSA3        ZSALPA
     C*FIN
     C                   END
     C* Cuotas P.E. empleador <> 0
     C*SI PAGCU2 ]= *CERO
     C     PAGCU2        IFNE      *ZERO
     C* Valor Actual P.E ---> PAGCU2 (Cuotas)
     C*  ZSALPE (?)      <--- (Cuotas Actuales - Cuotas que Pago)
     C* Saldo P.E. empleador
     C*CALCULAR (R) ZSALPE = (PAGVA4 * PAGSA4) / PAGCU2
     C     PAGVA4        MULT      PAGSA4        V$CA1           030 9
     C     V$CA1         DIV(H)    PAGCU2        ZSALPE
     C*MOVER PAGSA3 ZSALPE
     C                   Z-ADD     ZSALPE        PAGSA3
     C*
     C* Registro control empleadores
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C* Saldo P.E. SAE
     C*CALCULAR ZSALPA = ZSALPA - PAGSA3
     C     ZSALPA        SUB       PAGSA3        ZSALPA
     C*PASAR ZSIGNO '-'
     C                   MOVEL     '-'           ZSIGNO
     C* Actualiza P.E. de incons. empl.
     C*LLAMAR TRINCE62(PAGNUM ZSALPA ZSIGNO)
     C                   CALL      'TRINCE62'
     C                   PARM                    PAGNUM
     C                   PARM                    ZSALPA
     C                   PARM                    ZSIGNO
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C* Rollback
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C* Nro. planilla alfanumérico
     C*MOVER ZALPLA PAGNUM
     C                   MOVE      PAGNUM        ZALPLA
     C*OBTENER (1) ZERROR = 'Valor en cuotas del pago en exceso es igual
     C                   CLEAR                   ZERROR
     C     $HIL(115)     CAT       ZALPLA:1      ZERROR
     C*SI Z10592 = 1 Y ZIPEFP = '1'
     C     Z10592        IFEQ      1
     C     ZIPEFP        ANDEQ     '1'
     C* Planilla de PLAA55
     C*MOVER PLANU1 ZLA113
     C                   Z-ADD     ZLA113        PLANU1
     C*FIN SI
     C                   END
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN SI
     C                   END
     C*SI ZSALIR ]= '1'
     C     ZSALIR        IFNE      '1'
     C* Saldo P.E. empleador
     C*SI PAGSA3 = *CERO
     C     PAGSA3        IFEQ      *ZERO
     C* Estado del P.E.
     C*MOVER PAGEST 'RES'
     C                   MOVE      'RES'         PAGEST
     C* Fecha fondo ultimo estado
     C*PASAR PAGFE2 HISFE3
     C                   MOVEL     HISFE3        PAGFE2
     C*SINO
     C                   ELSE
     C* Estado del P.E.
     C*PASAR PAGEST 'CAR'
     C                   MOVEL     'CAR'         PAGEST
     C*FIN
     C                   END
     C* Fecha último estado
     C*PASAR PAGFE1 ZFESIS
     C                   MOVEL     ZFESIS        PAGFE1
     C*
     C* Agregar modificaciones a planillas en MODAR3
     C* Tipo registro : Pagos en exceso
     C*MOVER ZTMOPL 2
     C                   Z-ADD     2             ZTMOPL
     C* Adicionar modif. a planillas
     C*EJECUTAR M00200
     C                   EXSR      M00200
     C*
     C* Actualiza PAGA28
     C*EJECUTAR M00012
     C                   EXSR      M00012
     C*GRABAR PAGARC
     C     *IN70         IFEQ      '0'
     C                   UPDATE    PAGREG                               94
     C                   ELSE
     C                   WRITE     PAGREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Saldo P.E. empleador
     C*SI PAGSA3 = *CERO
     C     PAGSA3        IFEQ      *ZERO
     C* Elimina PAGA30
     C*PASAR ZACC50 'E'
     C                   MOVEL     'E'           ZACC50
     C*LLAMAR RPPEXR50 (PAGNUM ZACC50)
     C                   CALL      'RPPEXR50'
     C                   PARM                    PAGNUM
     C                   PARM                    ZACC50
     C*FIN
     C                   END
     C*SI ZINPEE = 'S'
     C     ZINPEE        IFEQ      'S'
     C* Actualiza pago en exceso de fusión.
     C*EJECUTAR M000FF
     C                   EXSR      M000FF
     C*FIN SI
     C                   END
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C*COMPLETAR
     C     CUEC17        COMMIT                                         94
     C                   MOVE      *IN94         I$NFT
     C*Si ya finalizo
     C*SI ZINLLA <> 'M'
     C     ZINLLA        IFNE      'M'
     C* Modo llamado proceso cesantes
     C*PASAR ZLLAMA 'F'
     C                   MOVEL     'F'           ZLLAMA
     C*** 3er SELECT
     C*CASO ZINDLL = 'C' Y ZCOINT <> *BLANCO
     C                   SELECT
     C     ZINDLL        WHENEQ    'C'
     C     ZCOINT        ANDNE     *BLANK
     C* Cobro comisión cesantes
     C*LLAMAR TRDQCE53 (ZCOINT ZAFILA ZPERCE ZPEFIN ZOPCIO ZNUPER ZLLAMA
     C                   CALL      'TRDQCE53'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPERCE
     C                   PARM                    ZPEFIN
     C                   PARM                    ZOPCIO
     C                   PARM                    ZNUPER
     C                   PARM                    ZLLAMA
     C                   PARM                    ZFEVIG
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C*CASO ZINDLL = 'R' Y ZCOINT <> *BLANCO
     C     ZINDLL        WHENEQ    'R'
     C     ZCOINT        ANDNE     *BLANK
     C* Reversar comisión cesantes
     C*LLAMAR TRAFRC59 (ZCOINT ZAFILA ZPEINI ZPEFIN ZFEVIG ZOPCIO ZLLAMA
     C                   CALL      'TRAFRC59'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPEINI
     C                   PARM                    ZPEFIN
     C                   PARM                    ZFEVIG
     C                   PARM                    ZOPCIO
     C                   PARM                    ZLLAMA
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C*CASO ZINDLL = 'A' Y ZCOINT <> *BLANCO
     C     ZINDLL        WHENEQ    'A'
     C     ZCOINT        ANDNE     *BLANK
     C* Cobro comisión cesantes
     C*LLAMAR TRDQCE53 (ZCOINT ZAFILA ZPERCE ZPEFIN ZOPCIO ZNUPER ZLLAMA
     C                   CALL      'TRDQCE53'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPERCE
     C                   PARM                    ZPEFIN
     C                   PARM                    ZOPCIO
     C                   PARM                    ZNUPER
     C                   PARM                    ZLLAMA
     C                   PARM                    ZFEVIG
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C* Reversar comisión cesantes
     C*LLAMAR TRAFRC59 (ZCOINT ZAFILA ZPEINI ZPEFIN ZFEVIG ZOPCIO ZLLAMA
     C                   CALL      'TRAFRC59'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPEINI
     C                   PARM                    ZPEFIN
     C                   PARM                    ZFEVIG
     C                   PARM                    ZOPCIO
     C                   PARM                    ZLLAMA
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C*FINCASOS
     C                   ENDSL
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Completar/Devolver trans
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C* Rollback
     C*DEVOLVER TRANSACCION
     C                   ROLBK                                          94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  actualizacion final INGARC                                  ==
     C*==                                                              ==
     C*==================================================================
     C     M63001        BEGSR
     C*SI ZINDI2 = '1'
     C     ZINDI2        IFEQ      '1'
     C* Este módulo aplica para el proceso llamado desde TRPAGE30 se pue
     C* dar el caso en el que se pierdan decimales, por lo que se adicio
     C* al INGARC y se actualiza la tx 04-99 en HISAR4
     C*LIMPIAR ZDIFAU ZDIFAV
     C                   CLEAR                   ZDIFAU
     C                   CLEAR                   ZDIFAV
     C*SI ZREING != ZACVLI O ZCRING != ZACCUI
     C     ZREING        IFNE      ZACVLI
     C     ZCRING        ORNE      ZACCUI
     C*CALCULAR ZDIFAU = ZCRING - ZACCUI
     C     ZCRING        SUB       ZACCUI        ZDIFAU
     C*CALCULAR ZDIFAV = ZREING - ZACVLI
     C     ZREING        SUB       ZACVLI        ZDIFAV
     C*FIN
     C                   END
     C*SI ZDIFAU != 0 O ZDIFAV != 0
     C     ZDIFAU        IFNE      0
     C     ZDIFAV        ORNE      0
     C*SUMAR ZDIFAU ZNGCUO
     C                   ADD       ZDIFAU        ZNGCUO
     C*SUMAR ZDIFAV ZNGVLR
     C                   ADD       ZDIFAV        ZNGVLR
     C*CALCULAR (R) ZNGVL1 = ZNGCUO * HISC28
     C     ZNGCUO        MULT(H)   HISC28        ZNGVL1
     C*SQL
     C/EXEC SQL
     C+  UPDATE INGARC
     C+  SET INGCUO = :ZNGCUO,
     C+  INGVLR = :ZNGVLR,
     C+  INGVL1 = :ZNGVL1
     C+  WHERE INGNUM = :ZNGNUM
     C+  AND INGPLA = :ZNGPLA
     C+  AND INGCO2 = :ZNGCO2
     C+  AND INGPAG = :ZNGPAG
     C+  AND INGSE1 = :ZNGSE1
     C/END-EXEC
     C* Redondea INGARC
     C*EJECUTAR M63002
     C                   EXSR      M63002
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Este módulo aplica para el proceso masivo. Por redondeos se pued
     C* dar el caso en el que se pierdan decimales, por lo que se adicio
     C* al INGARC y se actualiza la tx 04-99 en HISAR4
     C*SQL
     C/EXEC SQL
     C+  SELECT SUM(INGVL1)
     C+  INTO :ZVRINA
     C+  FROM INGARC
     C+  WHERE INGNUM = :ZNGNUM
     C+  AND INGPLA = :ZNGPLA
     C+  AND INGFEC = :HISFE3
     C+  AND INGFE1 = ' '
     C/END-EXEC
     C*SI ZSCP22 = 0 Y PAGSA4 != *CERO
     C     ZSCP22        IFEQ      0
     C     PAGSA4        ANDNE     *ZERO
     C* Cuotas INGARC
     C*SUMAR PAGSA4 ZNGCUO
     C                   ADD       PAGSA4        ZNGCUO
     C* Valor histórico INGARC
     C*SUMAR PAGSA3 ZNGVLR
     C                   ADD       PAGSA3        ZNGVLR
     C* Valor real INGARC antes
     C*MOVER ZVALAU ZNGVL1
     C                   Z-ADD     ZNGVL1        ZVALAU
     C* Valor real INGARC
     C*CALCULAR (R) ZNGVL1 = ZNGCUO * HISC28
     C     ZNGCUO        MULT(H)   HISC28        ZNGVL1
     C*  CALCULAR ZDIFAU = ZNGVL1 - ZVALAU ** Diferencia en valor
     C*SQL
     C/EXEC SQL
     C+  UPDATE INGARC
     C+  SET INGCUO = :ZNGCUO,
     C+  INGVLR = :ZNGVLR,
     C+  INGVL1 = :ZNGVL1
     C+  WHERE INGNUM = :ZNGNUM
     C+  AND INGPLA = :ZNGPLA
     C+  AND INGCO2 = :ZNGCO2
     C+  AND INGPAG = :ZNGPAG
     C+  AND INGSE1 = :ZNGSE1
     C/END-EXEC
     C* Redondea INGARC
     C*EJECUTAR M63002
     C                   EXSR      M63002
     C* Rendimientos se van a Ingresos Diversos (HISAR4 transaccion 04 9
     C*PASAR ZCODTX '04'
     C                   MOVEL     '04'          ZCODTX
     C*PASAR ZCONCE '99'
     C                   MOVEL     '99'          ZCONCE
     C* Valor cuotas HISAR4
     C*MOVER ZCUOHI PAGSA4
     C                   Z-ADD     PAGSA4        ZCUOHI
     C*LIMPIAR ZVALHI
     C                   CLEAR                   ZVALHI
     C*SI ZXGVL1 <> ZVRINA
     C     ZXGVL1        IFNE      ZVRINA
     C*CALCULAR ZVALHI = ZXGVL1 - ZVRINA + ZDIFE
     C     ZXGVL1        SUB       ZVRINA        V$CA1           030 9
     C     V$CA1         ADD       ZDIFE         ZVALHI
     C*FIN
     C                   END
     C*EJECUTAR M00055
     C                   EXSR      M00055
     C*LIMPIAR PAGSA4 PAGSA3
     C                   CLEAR                   PAGSA4
     C                   CLEAR                   PAGSA3
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Ejecuta redondeos generales INGARC                          ==
     C*==                                                              ==
     C*==================================================================
     C     M63002        BEGSR
     C*****************************************************************
     C*Ejecuta redondeos generales de INGARC **************************
     C*****************************************************************
     C*SQL
     C/EXEC SQL
     C+  SELECT SUM(INGVLR), SUM(INGCUO), SUM(INGVL1)
     C+  INTO :ZXGVLR, :ZXGCUO, :ZXGVL1
     C+  FROM INGARC
     C+  WHERE INGNUM = :ZNGNUM
     C+  AND INGPLA = :ZNGPLA
     C+  AND INGFEC = :HISFE3
     C+  AND INGFE1 = ' '
     C/END-EXEC
     C*CALCULAR (R) ZVALIN = ZXGCUO * HISC28
     C     ZXGCUO        MULT(H)   HISC28        ZVALIN
     C*LIMPIAR ZDIFE
     C                   CLEAR                   ZDIFE
     C*SI ZVALIN != ZXGVL1
     C     ZVALIN        IFNE      ZXGVL1
     C*CALCULAR ZDIFE = ZVALIN - ZXGVL1
     C     ZVALIN        SUB       ZXGVL1        ZDIFE
     C* Suma Diferencia a Ingreso Div. Valorizado
     C*SUMAR ZDIFE ZNGVL1
     C                   ADD       ZDIFE         ZNGVL1
     C*SQL
     C/EXEC SQL
     C+  UPDATE INGARC
     C+  SET INGVL1 = :ZNGVL1
     C+  WHERE INGNUM = :ZNGNUM
     C+  AND INGPLA = :ZNGPLA
     C+  AND INGCO2 = :ZNGCO2
     C+  AND INGPAG = :ZNGPAG
     C+  AND INGSE1 = :ZNGSE1
     C/END-EXEC
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular totales por concepto - acred. de rezagos           ==
     C*==                                                              ==
     C*==================================================================
     C     M70000        BEGSR
     C*LIMPIAR ZTOCO ZTOCVA ZTOCVE ZTOFS ZTOAR ZINDPA ZTOSFS ZTOFGP ZINR
     C                   CLEAR                   ZTOCO
     C                   CLEAR                   ZTOCVA
     C                   CLEAR                   ZTOCVE
     C                   CLEAR                   ZTOFS
     C                   CLEAR                   ZTOAR
     C                   CLEAR                   ZINDPA
     C                   CLEAR                   ZTOSFS
     C                   CLEAR                   ZTOFGP
     C                   CLEAR                   ZINRZO
     C                   CLEAR                   ZIFRZO
     C*LIMPIAR ZES13P ZCODEE ZTARD ZTARPG ZIGUAR ZTARAC ZAFSP ZVAAUX
     C                   CLEAR                   ZES13P
     C                   CLEAR                   ZCODEE
     C                   CLEAR                   ZTARD
     C                   CLEAR                   ZTARPG
     C                   CLEAR                   ZIGUAR
     C                   CLEAR                   ZTARAC
     C                   CLEAR                   ZAFSP
     C                   CLEAR                   ZVAAUX
     C* Arreglo pesos x depositos acr.rzgos
     C*LIMPIAR ZAR$RE[]
     C                   CLEAR                   $X
     C* Arreglo cuots x depósitos acr.rzgos
     C*LIMPIAR ZARCRE[]
     C                   CLEAR                   $Y
     C* Arreglo fchs depositos - acr.rzgos
     C*LIMPIAR ZARFRE[]
     C                   CLEAR                   $Z
     C* Rezagos finalizados
     C*PASAR ZESTAD 'FIN'
     C                   MOVEL     'FIN'         ZESTAD
     C*MIENTRAS NFA (REZARC18) Y REZEST = ZESTAD Y REZUSU = ZT@008 Y REZ
     C     *IN77         DOWEQ     '0'
     C     REZEST        ANDEQ     ZESTAD
     C     REZUSU        ANDEQ     ZT@008
     C     REZNRO        ANDEQ     ZPLAN1
     C     REZPER        ANDEQ     PLAPER
     C*LIMPIAR ZDITRA ZDILIC
     C                   CLEAR                   ZDITRA
     C                   CLEAR                   ZDILIC
     C*RECUPERARD REZARC (REZNRO REZNR1 REZNR2)
     C     LL$160        KLIST
     C                   KFLD                    REZNRO
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$160        CHAIN     REZARC                             7694
     C                   MOVE      *IN94         I$RND
     C     *IN76         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   REZREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SI REZEST = 'FIN'
     C     REZEST        IFEQ      'FIN'
     C* Estado temporal del rezago
     C*PASAR REZEST 'COP'
     C                   MOVEL     'COP'         REZEST
     C*GRABAR REZARC
     C     *IN76         IFEQ      '0'
     C                   UPDATE    REZREG                               94
     C                   ELSE
     C                   WRITE     REZREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*COMPLETAR
     C     REZNR2        COMMIT                                         94
     C                   MOVE      *IN94         I$NFT
     C*SINO
     C                   ELSE
     C*PASAR ZSALIR '1'
     C                   MOVEL     '1'           ZSALIR
     C*SALIR
     C                   GOTO      T$10
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'REZARC no disponible - M70000'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(116)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*RECUPERARD (N) DETARC (PLANU3 PLANUM REZNR1 REZNR2)
     C     LL$161        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$161        CHAIN     DETARC                             4994
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL
     C+  INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC, PLAARC WHERE
     C+  DETNU3 = PLANUM AND
     C+  PLANU1 = :REZNRO AND
     C+  DETPAG = :REZNR1 AND
     C+  DETSEC = :REZNR2
     C/END-EXEC
     C* Actualizar Interno afiliado forzoso
     C*EJECUTAR M00130
     C                   EXSR      M00130
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C*SI DETTA1<>3 Y REZTI7='09' O DETTA1<>3 Y REZTI7='10'
     C     DETTA1        IFNE      3
     C     REZTI7        ANDEQ     '09'
     C     DETTA1        ORNE      3
     C     REZTI7        ANDEQ     '10'
     C*PASAR ZIGUAR ' '
     C                   MOVEL     ' '           ZIGUAR
     C*LLAMAR RPHDEC558X(DETNU3 DETPAG DETSEC REZPER DETSAL DETCOT ZES13
     C                   MOVEL     'RPHDEC55'    H$L10            10
     C                   MOVE      '8X'          H$L10
     C                   CALL      H$L10
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    REZPER
     C                   PARM                    DETSAL
     C                   PARM                    DETCOT
     C                   PARM                    ZES13P
     C                   PARM                    ZCODEE
     C                   PARM                    ZNJ
     C                   PARM                    ZTARD
     C                   PARM                    ZTARPG
     C                   PARM                    ZIGUAR
     C                   PARM                    ZTARAC
     C                   PARM                    ZAFSP
     C*SI ZCODEE='321'
     C     ZCODEE        IFEQ      '321'
     C*OBTENER (1) ZERROR = 'Detalle decreto 376 sin tarifa especial'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(117)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*PASAR ZDETAL '1'
     C                   MOVEL     '1'           ZDETAL
     C* Calcular valor cotización
     C*EJECUTAR M11100
     C                   EXSR      M11100
     C*SI ZVAESP = '1' O ZTPVAE = '1'
     C     ZVAESP        IFEQ      '1'
     C     ZTPVAE        OREQ      '1'
     C* acum int rez pl O
     C*SUMAR REZINT ZINRZO
     C                   ADD       REZINT        ZINRZO
     C* acum int rezagos PL O
     C*SUMAR REZIN9 ZIFRZO
     C                   ADD       REZIN9        ZIFRZO
     C*FIN
     C                   END
     C* Planilla de tercero
     C*SI PLATIP = '07'
     C     PLATIP        IFEQ      '07'
     C* Grabar cotizaciones detalle
     C*PASAR ZIND '0'
     C                   MOVEL     '0'           ZIND
     C* Identificación del afiliado
     C*MOVER ZID DETNU2
     C                   Z-ADD     DETNU2        ZID
     C* Intereses por concepto
     C*EJECUTAR M12207
     C                   EXSR      M12207
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DETARC no disponible - M70000'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(118)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* Hay error
     C*SI ZSALIR = '1'
     C     ZSALIR        IFEQ      '1'
     C*SALIR
     C                   GOTO      T$10
     C*FIN
     C                   END
     C* Pago adelantado afil.indepen.
     C*SI ZINDPA = '1'
     C     ZINDPA        IFEQ      '1'
     C*LIMPIAR ZTOCO ZTOCVA ZTOCVE ZTOFS ZTOAR ZTOSFS ZTOFGP
     C                   CLEAR                   ZTOCO
     C                   CLEAR                   ZTOCVA
     C                   CLEAR                   ZTOCVE
     C                   CLEAR                   ZTOFS
     C                   CLEAR                   ZTOAR
     C                   CLEAR                   ZTOSFS
     C                   CLEAR                   ZTOFGP
     C*SINO
     C                   ELSE
     C* Total C.O.
     C*SUMAR ZCOTOB ZTOCO
     C                   ADD       ZCOTOB        ZTOCO
     C* Total alto riesgo
     C*SUMAR ZCOTAR ZTOAR
     C                   ADD       ZCOTAR        ZTOAR
     C* Total C.V.A.
     C*SUMAR ZCOTVA ZTOCVA
     C                   ADD       ZCOTVA        ZTOCVA
     C* Total C.V.E.
     C*SUMAR ZCOTVE ZTOCVE
     C                   ADD       ZCOTVE        ZTOCVE
     C* Total F.S.
     C*SUMAR ZCOTFS ZTOFS
     C                   ADD       ZCOTFS        ZTOFS
     C* Total SFSP
     C*SUMAR ZCOTSF ZTOSFS
     C                   ADD       ZCOTSF        ZTOSFS
     C* Total FGPM
     C*SUMAR ZCOTFG ZTOFGP
     C                   ADD       ZCOTFG        ZTOFGP
     C*FIN
     C                   END
     C*SI PLANU8 = *CERO
     C     PLANU8        IFEQ      *ZERO
     C* Acumular valor distrib. x planilla rezagos
     C*EJECUTAR M70100
     C                   EXSR      M70100
     C*FIN
     C                   END
     C*SI PLANU8 <> *CERO O PLANU8 = *CERO Y ZVAAUX = *CERO
     C     PLANU8        IFNE      *ZERO
     C     PLANU8        OREQ      *ZERO
     C     ZVAAUX        ANDEQ     *ZERO
     C*CALCULAR ZVLRRZ = REZCOT+REZCO1+REZCO2+REZCO4+REZVA1+REZINT+REZIN
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZVA1        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     V$CA1         ADD       REZIN9        V$CA1
     C     V$CA1         SUB       REZDEU        V$CA1
     C     V$CA1         ADD       REZVA3        ZVLRRZ
     C*CALCULAR ZCUORZ = REZCUO + REZCU2
     C     REZCUO        ADD       REZCU2        ZCUORZ
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*CALCULAR ZVLRRZ = ZVLRRZ - (ZZAFSP+ZVZFSP+ZVIFSP+ZVISUB)
     C     ZZAFSP        ADD       ZVZFSP        V$CA1           030 9
     C     V$CA1         ADD       ZVIFSP        V$CA1
     C     V$CA1         ADD       ZVISUB        V$CA1
     C     ZVLRRZ        SUB       V$CA1         ZVLRRZ
     C*CALCULAR ZCUORZ = ZCUORZ - (ZZUFSP+ZCSFSP+ZCIFSP+ZCISUB)
     C     ZZUFSP        ADD       ZCSFSP        V$CA1           030 9
     C     V$CA1         ADD       ZCIFSP        V$CA1
     C     V$CA1         ADD       ZCISUB        V$CA1
     C     ZCUORZ        SUB       V$CA1         ZCUORZ
     C*PASAR ZFSPAR '1'
     C                   MOVEL     '1'           ZFSPAR
     C*FIN
     C                   END
     C*CALCULAR ZAR$RE[L] = ZAR$RE[L] + ZVLRRZ
     C     $X(L)         ADD       ZVLRRZ        $X(L)
     C*CALCULAR ZARCRE[L] = ZARCRE[L] + ZCUORZ
     C     $Y(L)         ADD       ZCUORZ        $Y(L)
     C*ASIGNARA ZARFRE[L] ZFECD1
     C                   MOVEA     ZFECD1        $Z(L)
     C* Valor total depòsito
     C*SUMAR ZVLRRZ ZTVDEP
     C                   ADD       ZVLRRZ        ZTVDEP
     C* Cuotas depòsito
     C*SUMAR ZCUORZ ZTCDEP
     C                   ADD       ZCUORZ        ZTCDEP
     C*FIN
     C                   END
     C* Pago adelantado afil.voluntario
     C*SI ZINDPA = '1'
     C     ZINDPA        IFEQ      '1'
     C*SALIR
     C                   GOTO      T$10
     C*FIN
     C                   END
     C*LEER REZARC18
     C                   READ      REZARC18                               77
     C*FIN
     C                   END
     C     T$10          TAG
     C* Saldo cotización obligatoria
     C*MOVER ZSACO  ZTOCO
     C                   Z-ADD     ZTOCO         ZSACO
     C* Saldo alto riesgo
     C*MOVER ZSAAR  ZTOAR
     C                   Z-ADD     ZTOAR         ZSAAR
     C* Saldo voluntaria afiliado
     C*MOVER ZSACVA ZTOCVA
     C                   Z-ADD     ZTOCVA        ZSACVA
     C* Saldo voluntaria empleador
     C*MOVER ZSACVE ZTOCVE
     C                   Z-ADD     ZTOCVE        ZSACVE
     C* Saldo fondo de solidaridad
     C*MOVER ZSAFS  ZTOFS
     C                   Z-ADD     ZTOFS         ZSAFS
     C* Saldo SFSP
     C*MOVER ZSASFS ZTOSFS
     C                   Z-ADD     ZTOSFS        ZSASFS
     C* saldo FGPM
     C*MOVER ZSAFGP ZTOFGP
     C                   Z-ADD     ZTOFGP        ZSAFGP
     C*CALCULAR ZSACOT = ZTOCO + ZTOAR + ZTOCVA + ZTOCVE
     C     ZTOCO         ADD       ZTOAR         V$CA1           030 9
     C     V$CA1         ADD       ZTOCVA        V$CA1
     C     V$CA1         ADD       ZTOCVE        ZSACOT
     C* Total cotizaciones
     C*MOVER ZTOTCO ZSACOT
     C                   Z-ADD     ZSACOT        ZTOTCO
     C* Total calculado de los detalles
     C*CALCULAR ZTOCAL = ZTOTCO + ZTOFS + ZTOSFS + ZTOFGP
     C     ZTOTCO        ADD       ZTOFS         V$CA1           030 9
     C     V$CA1         ADD       ZTOSFS        V$CA1
     C     V$CA1         ADD       ZTOFGP        ZTOCAL
     C*SUMAR 1 L
     C                   ADD       1             L
     C                   ENDSR
     C*==================================================================
     C*==  Acumular valor distrib. x planilla de rezagos               ==
     C*==                                                              ==
     C*==================================================================
     C     M70100        BEGSR
     C* Tipo de registro
     C*PASAR ZTIRED '1'
     C                   MOVEL     '1'           ZTIRED
     C* Se posiciona en el archivo
     C*INICIAR DISAR1 (REZNRO REZNR1 REZNR2 DISTIP)
     C     LL$162        KLIST
     C                   KFLD                    REZNRO
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C                   KFLD                    DISTIP
     C     LL$162        SETLL     DISAR1                             57
     C* Lee el registro
     C*LEER DISAR1
     C                   READ      DISAR1                                 57
     C*MIENTRAS NFA(DISAR1) Y DISNRO=REZNRO Y DISNR1=REZNR1 Y DISNR2=REZ
     C     *IN57         DOWEQ     '0'
     C     DISNRO        ANDEQ     REZNRO
     C     DISNR1        ANDEQ     REZNR1
     C     DISNR2        ANDEQ     REZNR2
     C     DISTIP        ANDEQ     ZTIRED
     C*MOVER K DISCON
     C                   Z-ADD     DISCON        K
     C*CALCULAR ZAR$RE[K] = ZAR$RE[K] + DISVAL
     C     $X(K)         ADD       DISVAL        $X(K)
     C*CALCULAR ZARCRE[K] = ZARCRE[K] + DISCUO
     C     $Y(K)         ADD       DISCUO        $Y(K)
     C*ASIGNARA ZARFRE[K] DISFEC
     C                   MOVEA     DISFEC        $Z(K)
     C* Valor total depòsito
     C*SUMAR DISVAL ZTVDEP
     C                   ADD       DISVAL        ZTVDEP
     C* Cuotas depòsito
     C*SUMAR DISCUO ZTCDEP
     C                   ADD       DISCUO        ZTCDEP
     C*SI K>L
     C     K             IFGT      L
     C*MOVER L K
     C                   Z-ADD     K             L
     C*FIN
     C                   END
     C*SUMAR DISVAL ZVAAUX
     C                   ADD       DISVAL        ZVAAUX
     C* Lee el registro
     C*LEER DISAR1
     C                   READ      DISAR1                                 57
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesar detalles de rezagos                                ==
     C*==                                                              ==
     C*==================================================================
     C     M71000        BEGSR
     C*LIMPIAR ZVRPA ZCUPA ZVLRRA ZCUORA ZVLRMA ZCUOMA ZREZPR ZVLPAC ZCT
     C                   CLEAR                   ZVRPA
     C                   CLEAR                   ZCUPA
     C                   CLEAR                   ZVLRRA
     C                   CLEAR                   ZCUORA
     C                   CLEAR                   ZVLRMA
     C                   CLEAR                   ZCUOMA
     C                   CLEAR                   ZREZPR
     C                   CLEAR                   ZVLPAC
     C                   CLEAR                   ZCTPAC
     C*CALCULAR ZSALDO = ZSACO+ZSAAR+ZSACVA+ZSACVE+ZSAFS+ZSAINT+ZSAIFS+Z
     C     ZSACO         ADD       ZSAAR         V$CA1           030 9
     C     V$CA1         ADD       ZSACVA        V$CA1
     C     V$CA1         ADD       ZSACVE        V$CA1
     C     V$CA1         ADD       ZSAFS         V$CA1
     C     V$CA1         ADD       ZSAINT        V$CA1
     C     V$CA1         ADD       ZSAIFS        V$CA1
     C     V$CA1         ADD       ZSAFGP        V$CA1
     C     V$CA1         ADD       ZSAIFG        V$CA1
     C     V$CA1         ADD       ZSASFS        V$CA1
     C     V$CA1         ADD       ZSAISF        V$CA1
     C     V$CA1         ADD       ZSICVA        V$CA1
     C     V$CA1         ADD       ZSICVE        V$CA1
     C     V$CA1         ADD       ZSINAR        ZSALDO
     C*SI ZSALDO |= *CERO O ZSALCA |= *CERO
     C     ZSALDO        IFNE      *ZERO
     C     ZSALCA        ORNE      *ZERO
     C* Indicador de error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Procesar pagos adelantados
     C*EJECUTAR M13000
     C                   EXSR      M13000
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Limpiar variables
     C*EJECUTAR M14010
     C                   EXSR      M14010
     C* Estado temporal del rezago
     C*PASAR ZESTAD 'COP'
     C                   MOVEL     'COP'         ZESTAD
     C*INICIAR REZARC18 (ZESTAD ZT@008 ZPLAN1 PLATI1 PLANU4 PLAPER)
     C     LL$163        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C                   KFLD                    ZPLAN1
     C                   KFLD                    PLATI1
     C                   KFLD                    PLANU4
     C                   KFLD                    PLAPER
     C     LL$163        SETLL     REZARC18                           77
     C*LEER REZARC18
     C                   READ      REZARC18                               77
     C*MIENTRAS NFA (REZARC18) Y REZEST = ZESTAD Y REZUSU = ZT@008 Y REZ
     C     *IN77         DOWEQ     '0'
     C     REZEST        ANDEQ     ZESTAD
     C     REZUSU        ANDEQ     ZT@008
     C     REZNRO        ANDEQ     ZPLAN1
     C     REZPER        ANDEQ     PLAPER
     C*LIMPIAR ZOVCO1 ZOVTIP ZOVPER ZDITRA ZDILIC
     C                   CLEAR                   ZOVCO1
     C                   CLEAR                   ZOVTIP
     C                   CLEAR                   ZOVPER
     C                   CLEAR                   ZDITRA
     C                   CLEAR                   ZDILIC
     C*LIMPIAR ZES13P ZCODEE ZTARD ZTARPG ZIGUAR ZTARAC ZAFSP
     C                   CLEAR                   ZES13P
     C                   CLEAR                   ZCODEE
     C                   CLEAR                   ZTARD
     C                   CLEAR                   ZTARPG
     C                   CLEAR                   ZIGUAR
     C                   CLEAR                   ZTARAC
     C                   CLEAR                   ZAFSP
     C*SUMAR 1 ZREZPR
     C                   ADD       1             ZREZPR
     C* Limpiar variables de HISAR4
     C*EJECUTAR M00150
     C                   EXSR      M00150
     C*RECUPERARD (N) DETARC (PLANU3 PLANUM REZNR1 REZNR2)
     C     LL$164        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$164        CHAIN     DETARC                             4994
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL
     C+  INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC, PLAARC WHERE
     C+  DETNU3 = PLANUM AND
     C+  PLANU1 = :REZNRO AND
     C+  DETPAG = :REZNR1 AND
     C+  DETSEC = :REZNR2
     C/END-EXEC
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C* proceso para afil decreto 2616
     C*LLAMAR TRDETA64(PLANUM DETTI2 DETNU2 ZI2616)
     C                   CALL      'TRDETA64'
     C                   PARM                    PLANUM
     C                   PARM                    DETTI2
     C                   PARM                    DETNU2
     C                   PARM                    ZI2616
     C* Leer afiliado y cuenta
     C*EJECUTAR M14020
     C                   EXSR      M14020
     C*SI DETTA1<>3 Y REZTI7='09' O DETTA1<>3 Y REZTI7='10'
     C     DETTA1        IFNE      3
     C     REZTI7        ANDEQ     '09'
     C     DETTA1        ORNE      3
     C     REZTI7        ANDEQ     '10'
     C*LLAMAR RPHDEC558C(REZPER ZESDE1)
     C                   MOVEL     'RPHDEC55'    H$L10            10
     C                   MOVE      '8C'          H$L10
     C                   CALL      H$L10
     C                   PARM                    REZPER
     C                   PARM                    ZESDE1
     C*SI ZESDE1='S'
     C     ZESDE1        IFEQ      'S'
     C*PASAR ZIGUAR 'S'
     C                   MOVEL     'S'           ZIGUAR
     C*LLAMAR RPHDEC558X(DETNU3 DETPAG DETSEC PLAPER DETSAL DETCOT ZES13
     C                   MOVEL     'RPHDEC55'    H$L10            10
     C                   MOVE      '8X'          H$L10
     C                   CALL      H$L10
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    PLAPER
     C                   PARM                    DETSAL
     C                   PARM                    DETCOT
     C                   PARM                    ZES13P
     C                   PARM                    ZCODEE
     C                   PARM                    ZNJ
     C                   PARM                    ZTARD
     C                   PARM                    ZTARPG
     C                   PARM                    ZIGUAR
     C                   PARM                    ZTARAC
     C                   PARM                    ZAFSP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*PASAR ZDETAL '1'
     C                   MOVEL     '1'           ZDETAL
     C* Calcular valor cotización
     C*EJECUTAR M11100
     C                   EXSR      M11100
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valida P.E. y planilla voluntar.
     C*EJECUTAR M71010
     C                   EXSR      M71010
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*RECUPERARD REZARC (REZNRO REZNR1 REZNR2)
     C     LL$165        KLIST
     C                   KFLD                    REZNRO
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$165        CHAIN     REZARC                             7694
     C                   MOVE      *IN94         I$RND
     C     *IN76         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   REZREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Estado temp. antes de acreditar
     C*SI REZEST = 'COP'
     C     REZEST        IFEQ      'COP'
     C* Valor retención
     C*MOVER REZVAL DETVA8
     C                   Z-ADD     DETVA8        REZVAL
     C* Fecha fondo último estado
     C*PASAR REZFE2 HISFE3
     C                   MOVEL     HISFE3        REZFE2
     C* Estado acreditado
     C*PASAR REZEST 'ACR'
     C                   MOVEL     'ACR'         REZEST
     C*
     C* Agregar modificaciones a planillas en MODAR3
     C* Tipo registro : Rezagos
     C*MOVER ZTMOPL 1
     C                   Z-ADD     1             ZTMOPL
     C* Adicionar modificaciones a planilla
     C*EJECUTAR M00200
     C                   EXSR      M00200
     C*
     C*GRABAR REZARC
     C     *IN76         IFEQ      '0'
     C                   UPDATE    REZREG                               94
     C                   ELSE
     C                   WRITE     REZREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*
     C* SAE
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C*CALCULAR ZVALRE = (REZCOT+REZCO1+REZCO2+REZCO4+REZINT) + (REZIN9+
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     REZIN9        ADD       REZVA1        V$CA2           030 9
     C     V$CA2         SUB       REZDEU        V$CA2
     C     V$CA2         ADD       REZVA3        V$CA2
     C     V$CA1         ADD       V$CA2         ZVALRE
     C*PASAR ZSIGNO '-'
     C                   MOVEL     '-'           ZSIGNO
     C*LLAMAR TRINCE65(REZNRO REZNR1 REZNR2 REZNR3 ZVALRE ZSIGNO)
     C                   CALL      'TRINCE65'
     C                   PARM                    REZNRO
     C                   PARM                    REZNR1
     C                   PARM                    REZNR2
     C                   PARM                    REZNR3
     C                   PARM                    ZVALRE
     C                   PARM                    ZSIGNO
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Planilla del rezago
     C*MOVER ZPLARE REZNRO
     C                   MOVE      REZNRO        ZPLARE
     C*OBTENER (1) ZERROR = 'Otro trabajo está procesando el rezago'|| Z
     C                   CLEAR                   ZERROR
     C     $HIL(119)     CAT       ZPLARE:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'REZARC no disponible - M71000'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(120)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DETARC no disponible - M71000'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(121)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR ]= '1'
     C     ZSALIR        IFNE      '1'
     C*PASAR ZREZEM '0'
     C                   MOVEL     '0'           ZREZEM
     C* Generar encabezados e históricos
     C*EJECUTAR M15000
     C                   EXSR      M15000
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Anulación deudas por delta
     C*EJECUTAR M15550
     C                   EXSR      M15550
     C* Planilla de traspasos
     C*SI PLATIP |= '05'
     C     PLATIP        IFNE      '05'
     C* Indicador de act. empleador
     C*SI ZACTEM = 'S' Y PLAPER >= ZPERVI
     C     ZACTEM        IFEQ      'S'
     C     PLAPER        ANDGE     ZPERVI
     C*SI PLAPER > EMPPE1 Y EMPPE1 ]= *BLANCO O EMPPE1 = *BLANCO
     C     PLAPER        IFGT      EMPPE1
     C     EMPPE1        ANDNE     *BLANK
     C     EMPPE1        OREQ      *BLANK
     C*SI PLAN09  ]= *CERO
     C     PLAN09        IFNE      *ZERO
     C*SI ZSALIR |= '1' Y PLATIP = '01' Y ERE (EMPAR204) O ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C     PLATIP        ANDEQ     '01'
     C     *IN58         ANDEQ     '0'
     C     ZSALIR        ORNE      '1'
     C     PLATIP        ANDEQ     '04'
     C     *IN58         ANDEQ     '0'
     C*SI ZTIPXX <> 'W' Y ZTLLAM <> 'X'
     C     ZTIPXX        IFNE      'W'
     C     ZTLLAM        ANDNE     'X'
     C*SQL
     C/EXEC SQL
     C+  UPDATE EMPAR204 SET EMPEMP=:PLAN09
     C+  WHERE EMPNU2 = :PLANU4
     C/END-EXEC
     C*SINO
     C                   ELSE
     C*SQL
     C/EXEC SQL
     C+  INSERT INTO TEM708 VALUES (:PLANU1, :PLANU4, :PLAN09,
     C+  '', '', '', '')
     C/END-EXEC
     C* Ind. que ya creo registro
     C*PASAR ZINTEM 'S'
     C                   MOVEL     'S'           ZINTEM
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*              MOVER EMPEMP PLAN09
     C*FIN
     C                   END
     C*SI ZCLASE = 'B' Y ZFORDE = 'G' Y EMPPE1 ]= *BLANCO
     C     ZCLASE        IFEQ      'B'
     C     ZFORDE        ANDEQ     'G'
     C     EMPPE1        ANDNE     *BLANK
     C*SINO
     C                   ELSE
     C*SI ZSALIR |= '1' Y PLATIP = '01' Y ERE (EMPAR204) O ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C     PLATIP        ANDEQ     '01'
     C     *IN58         ANDEQ     '0'
     C     ZSALIR        ORNE      '1'
     C     PLATIP        ANDEQ     '04'
     C     *IN58         ANDEQ     '0'
     C*SI ZTIPXX <> 'W' Y ZTLLAM <> 'X'
     C     ZTIPXX        IFNE      'W'
     C     ZTLLAM        ANDNE     'X'
     C*SQL
     C/EXEC SQL
     C+  UPDATE EMPAR204 SET EMPCLA=:ZCLASE,
     C+  EMPFOR=:ZFORDE, EMPPE1=:PLAPER
     C+  WHERE EMPNU2 = :PLANU4
     C/END-EXEC
     C*SINO
     C                   ELSE
     C*SI ZINTEM = *BLANCO
     C     ZINTEM        IFEQ      *BLANK
     C*SQL
     C/EXEC SQL
     C+  INSERT INTO TEM708 VALUES (:PLANU1, :PLANU4, 0,
     C+  :ZCLASE, :ZFORDE, :PLAPER, '')
     C/END-EXEC
     C*SINO
     C                   ELSE
     C*SQL
     C/EXEC SQL
     C+  UPDATE TEM708 SET TEMCLA=:ZCLASE, TEMFO2=:ZFORDE,
     C+  TEMP57=:PLAPER  WHERE TEM710=:PLANU1 AND
     C+  TEMI83=:PLANU4
     C/END-EXEC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Perìodo ant. instalaciòn cesan.
     C*SI PLAPER < ZPEVIG
     C     PLAPER        IFLT      ZPEVIG
     C* Cesantes COLMENA
     C*EJECUTAR M14095
     C                   EXSR      M14095
     C*FIN
     C                   END
     C* Módulo de cesantes
     C*EJECUTAR M00025
     C                   EXSR      M00025
     C*LEER REZARC18
     C                   READ      REZARC18                               77
     C*FIN
     C                   END
     C* Eliminar datos int. pla terceros
     C*EJECUTAR M00250
     C                   EXSR      M00250
     C                   ENDSR
     C*==================================================================
     C*==  Valida pago en exceso y planilla voluntario                 ==
     C*==                                                              ==
     C*==================================================================
     C     M71010        BEGSR
     C*LIMPIAR ZVLRMV ZCUOMV ZVRPA ZCUPA
     C                   CLEAR                   ZVLRMV
     C                   CLEAR                   ZCUOMV
     C                   CLEAR                   ZVRPA
     C                   CLEAR                   ZCUPA
     C* Si p.e. y planilla voluntario
     C*SI ZINDPA = '1' Y PLATIP = '03' O ZINDPA = '1' Y PLATIP = '02' Y
     C     ZINDPA        IFEQ      '1'
     C     PLATIP        ANDEQ     '03'
     C     ZINDPA        OREQ      '1'
     C     PLATIP        ANDEQ     '02'
     C     PLAPER        ANDLT     ZPEREF
     C*SINO
     C                   ELSE
     C* Rendimientos
     C*MOVER ZRENDI DETV14
     C                   Z-ADD     DETV14        ZRENDI
     C* Calcular fecha límite pago
     C*EJECUTAR M14015
     C                   EXSR      M14015
     C*CALCULAR ZTOCOT = ZCOTAR + ZCOTOB + ZCOTVA + ZCOTVE
     C     ZCOTAR        ADD       ZCOTOB        V$CA1           030 9
     C     V$CA1         ADD       ZCOTVA        V$CA1
     C     V$CA1         ADD       ZCOTVE        ZTOCOT
     C*SI ZTOCOT = 0 Y ZRENDI = 0 Y ZNOSLN = 'X'
     C     ZTOCOT        IFEQ      0
     C     ZRENDI        ANDEQ     0
     C     ZNOSLN        ANDEQ     'X'
     C* Valores subsistencia
     C*LIMPIAR ZVSFSP ZVFGPM
     C                   CLEAR                   ZVSFSP
     C                   CLEAR                   ZVFGPM
     C* Genera movimiento de licencia
     C*EJECUTAR M14030
     C                   EXSR      M14030
     C* Planilla de traspasos
     C*SI PLATIP |= '05'
     C     PLATIP        IFNE      '05'
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C* Período del rezago
     C*PASAR ZPERCO REZPER
     C                   MOVEL     REZPER        ZPERCO
     C*SINO
     C                   ELSE
     C* Período de la planilla
     C*PASAR ZPERCO PLAPER
     C                   MOVEL     PLAPER        ZPERCO
     C*FIN
     C                   END
     C* Tipo de planilla
     C*PASAR ZTIPLA PLATIP
     C                   MOVEL     PLATIP        ZTIPLA
     C* Actualiza relación afil-empl.
     C*EJECUTAR M14040
     C                   EXSR      M14040
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Anula deudas presuntas
     C*EJECUTAR M14050
     C                   EXSR      M14050
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Procesa depósitos por detalle
     C*EJECUTAR M71120
     C                   EXSR      M71120
     C* Acumula valores cotizaciones
     C*EJECUTAR M14085
     C                   EXSR      M14085
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Acreditación del rezago no actualizó la cue
     C                   CLEAR                   ZERROR
     C     $HIL(122)     CAT       ZIDENA:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* Planilla de traspasos
     C*SI PLATIP |= '05'
     C     PLATIP        IFNE      '05'
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C* Período del rezago
     C*PASAR ZPERCO REZPER
     C                   MOVEL     REZPER        ZPERCO
     C*SINO
     C                   ELSE
     C* Período de la planilla
     C*PASAR ZPERCO PLAPER
     C                   MOVEL     PLAPER        ZPERCO
     C*FIN
     C                   END
     C* Tipo de planilla
     C*PASAR ZTIPLA PLATIP
     C                   MOVEL     PLATIP        ZTIPLA
     C* Actualiza relación afil-empl.
     C*EJECUTAR M14040
     C                   EXSR      M14040
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Planilla de traspasos
     C*SI PLATIP |= '05'
     C     PLATIP        IFNE      '05'
     C* Anula deudas presuntas
     C*EJECUTAR M14050
     C                   EXSR      M14050
     C*FIN
     C                   END
     C* Genera registro comisiones
     C*EJECUTAR M14070
     C                   EXSR      M14070
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C* Período del rezago
     C*PASAR ZPERCO REZPER
     C                   MOVEL     REZPER        ZPERCO
     C*SINO
     C                   ELSE
     C* Período de la planilla
     C*PASAR ZPERCO PLAPER
     C                   MOVEL     PLAPER        ZPERCO
     C*FIN
     C                   END
     C* Planilla de traspasos
     C*SI PLATIP |= '05'
     C     PLATIP        IFNE      '05'
     C* Actualiza días cotizados
     C*EJECUTAR M14075
     C                   EXSR      M14075
     C* Verifica si hay deuda
     C*EJECUTAR M14080
     C                   EXSR      M14080
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Planilla de traspasos
     C*SI PLATIP |= '05' Y PLAPER < ZPEVIG
     C     PLATIP        IFNE      '05'
     C     PLAPER        ANDLT     ZPEVIG
     C* Reversa comisión cesantes
     C*EJECUTAR M14090
     C                   EXSR      M14090
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesar depósitos por detalle de rezago                    ==
     C*==                                                              ==
     C*==================================================================
     C     M71120        BEGSR
     C* Posición en el arreglo
     C*MOVER L 1
     C                   Z-ADD     1             L
     C*LIMPIAR ZTDCO ZTDCVA ZTDCVE ZTDAR ZTDINT ZTOREN ZTDFS ZTDIFS
     C                   CLEAR                   ZTDCO
     C                   CLEAR                   ZTDCVA
     C                   CLEAR                   ZTDCVE
     C                   CLEAR                   ZTDAR
     C                   CLEAR                   ZTDINT
     C                   CLEAR                   ZTOREN
     C                   CLEAR                   ZTDFS
     C                   CLEAR                   ZTDIFS
     C*LIMPIAR ZVRREZ ZCUREZ ZINTRE ZIFSRE
     C                   CLEAR                   ZVRREZ
     C                   CLEAR                   ZCUREZ
     C                   CLEAR                   ZINTRE
     C                   CLEAR                   ZIFSRE
     C*LIMPIAR ZCTCVE ZVTVVE ZCTCVA ZVTVVA ZFEDEP
     C                   CLEAR                   ZCTCVE
     C                   CLEAR                   ZVTVVE
     C                   CLEAR                   ZCTCVA
     C                   CLEAR                   ZVTVVA
     C                   CLEAR                   ZFEDEP
     C*LIMPIAR ZINCDE ZGRAMV ZVLRMV ZCUOMV
     C                   CLEAR                   ZINCDE
     C                   CLEAR                   ZGRAMV
     C                   CLEAR                   ZVLRMV
     C                   CLEAR                   ZCUOMV
     C*LIMPIAR ZTDSFS ZTDISF ZTDFGP ZTDIFG ZISFRE ZIFGRE
     C                   CLEAR                   ZTDSFS
     C                   CLEAR                   ZTDISF
     C                   CLEAR                   ZTDFGP
     C                   CLEAR                   ZTDIFG
     C                   CLEAR                   ZISFRE
     C                   CLEAR                   ZIFGRE
     C*LIMPIAR ZCUERZ ZINSUM
     C                   CLEAR                   ZCUERZ
     C                   CLEAR                   ZINSUM
     C* Número depósitos procesados
     C*MIENTRAS L < K
     C     L             DOWLT     K
     C*LIMPIAR ZVDFS ZVDIFS ZVDINT ZVDCVA ZVDREN ZVDAR ZVDCO ZVDCVE
     C                   CLEAR                   ZVDFS
     C                   CLEAR                   ZVDIFS
     C                   CLEAR                   ZVDINT
     C                   CLEAR                   ZVDCVA
     C                   CLEAR                   ZVDREN
     C                   CLEAR                   ZVDAR
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZVDCVE
     C*LIMPIAR ZCUFS ZCUIFS ZCUINT ZCUCVA ZCUREN ZCUAR ZCUCO ZCUCVE
     C                   CLEAR                   ZCUFS
     C                   CLEAR                   ZCUIFS
     C                   CLEAR                   ZCUINT
     C                   CLEAR                   ZCUCVA
     C                   CLEAR                   ZCUREN
     C                   CLEAR                   ZCUAR
     C                   CLEAR                   ZCUCO
     C                   CLEAR                   ZCUCVE
     C*LIMPIAR ZVDSFS ZVDISF ZVDFGP ZVDIFG ZCUSFS ZCUISF ZCUFGP ZCUIFG
     C                   CLEAR                   ZVDSFS
     C                   CLEAR                   ZVDISF
     C                   CLEAR                   ZVDFGP
     C                   CLEAR                   ZVDIFG
     C                   CLEAR                   ZCUSFS
     C                   CLEAR                   ZCUISF
     C                   CLEAR                   ZCUFGP
     C                   CLEAR                   ZCUIFG
     C*LIMPIAR ZVDIVA ZVDIVE ZVDIAR ZCUIVA ZCUIVE ZCUIAR ZVLPA ZCTPAD
     C                   CLEAR                   ZVDIVA
     C                   CLEAR                   ZVDIVE
     C                   CLEAR                   ZVDIAR
     C                   CLEAR                   ZCUIVA
     C                   CLEAR                   ZCUIVE
     C                   CLEAR                   ZCUIAR
     C                   CLEAR                   ZVLPA
     C                   CLEAR                   ZCTPAD
     C*LIMPIAR ZOVCO8 ZOVIN2 ZOVV13 ZOVI06 ZOVCOM ZOVVAL ZOVCO7 ZOVC27 Z
     C                   CLEAR                   ZOVCO8
     C                   CLEAR                   ZOVIN2
     C                   CLEAR                   ZOVV13
     C                   CLEAR                   ZOVI06
     C                   CLEAR                   ZOVCOM
     C                   CLEAR                   ZOVVAL
     C                   CLEAR                   ZOVCO7
     C                   CLEAR                   ZOVC27
     C                   CLEAR                   ZOVRET
     C* Distribuir valor
     C*EJECUTAR M14105
     C                   EXSR      M14105
     C* Hay error
     C*SI ZSALIR = '1'
     C     ZSALIR        IFEQ      '1'
     C*SALIR
     C                   GOTO      T$11
     C*FIN
     C                   END
     C* Calcular vlr del mvto
     C*EJECUTAR M14160
     C                   EXSR      M14160
     C* Validar diferencias por redondeos
     C*EJECUTAR M71128
     C                   EXSR      M71128
     C* Generar movimiento
     C*EJECUTAR M14300
     C                   EXSR      M14300
     C* Hay error
     C*SI ZSALIR = '1'
     C     ZSALIR        IFEQ      '1'
     C*SALIR
     C                   GOTO      T$11
     C*FIN
     C                   END
     C*SUMAR 1 L
     C                   ADD       1             L
     C* Hubo pago adelantado
     C*SI ZINAPA='1' Y L=K
     C     ZINAPA        IFEQ      '1'
     C     L             ANDEQ     K
     C*CALCULAR ZVLPA=ZVDCVA+ZVDFS+ZVDSFS+ZVDIFS+ZVDISF+ZVDFGP+ZVDIFG+ZV
     C     ZVDCVA        ADD       ZVDFS         V$CA1           030 9
     C     V$CA1         ADD       ZVDSFS        V$CA1
     C     V$CA1         ADD       ZVDIFS        V$CA1
     C     V$CA1         ADD       ZVDISF        V$CA1
     C     V$CA1         ADD       ZVDFGP        V$CA1
     C     V$CA1         ADD       ZVDIFG        V$CA1
     C     V$CA1         ADD       ZVDINT        V$CA1
     C     V$CA1         ADD       ZVDREN        V$CA1
     C     V$CA1         ADD       ZVDAR         V$CA1
     C     V$CA1         ADD       ZVDCO         V$CA1
     C     V$CA1         ADD       ZVDCVE        ZVLPA
     C*CALCULAR ZCTPAD=ZCUCVA+ZCUFS+ZCUSFS+ZCUIFS+ZCUISF+ZCUFGP+ZCUIFG+Z
     C     ZCUCVA        ADD       ZCUFS         V$CA1           030 9
     C     V$CA1         ADD       ZCUSFS        V$CA1
     C     V$CA1         ADD       ZCUIFS        V$CA1
     C     V$CA1         ADD       ZCUISF        V$CA1
     C     V$CA1         ADD       ZCUFGP        V$CA1
     C     V$CA1         ADD       ZCUIFG        V$CA1
     C     V$CA1         ADD       ZCUINT        V$CA1
     C     V$CA1         ADD       ZCUREN        V$CA1
     C     V$CA1         ADD       ZCUAR         V$CA1
     C     V$CA1         ADD       ZCUCO         V$CA1
     C     V$CA1         ADD       ZCUCVE        ZCTPAD
     C*SUMAR ZVLPA  ZVLPAC
     C                   ADD       ZVLPA         ZVLPAC
     C*SUMAR ZCTPAD ZCTPAC
     C                   ADD       ZCTPAD        ZCTPAC
     C*FIN
     C                   END
     C*FIN
     C                   END
     C     T$11          TAG
     C*
     C* Hay error
     C*SI ZSALIR != '1'
     C     ZSALIR        IFNE      '1'
     C* Si tiene detalle aportes voluntarios traspasados
     C*SI ZCTCVE |= 0 O ZVTVVE |= 0 O ZCTCVA |= 0 O ZVTVVA |= 0
     C     ZCTCVE        IFNE      0
     C     ZVTVVE        ORNE      0
     C     ZCTCVA        ORNE      0
     C     ZVTVVA        ORNE      0
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Acred. aporte voluntario en rezago no actua
     C                   CLEAR                   ZERROR
     C     $HIL(123)     CAT       ZIDENA:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*GRABAR DETARC
     C     *IN49         IFEQ      '0'
     C                   UPDATE    DETREG                               94
     C                   ELSE
     C                   WRITE     DETREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Crear registro de aporte voluntario
     C* Indicador tipo acreditación
     C*PASAR ZINACR '2'
     C                   MOVEL     '2'           ZINACR
     C*MOVER MOVCON ZMVCON
     C                   Z-ADD     ZMVCON        MOVCON
     C* Acreditación aporte voluntario
     C*EJECUTAR M00210
     C                   EXSR      M00210
     C*RECUPERARD CUEARC (MOVCO4 ZFONDO)
     C     LL$166        KLIST
     C                   KFLD                    MOVCO4
     C                   KFLD                    ZFONDO
     C     LL$166        CHAIN     CUEARC                             4594
     C                   MOVE      *IN94         I$RND
     C     *IN45         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   CUEREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Indicador de error
     C*SI ZINDER = '1'
     C     ZINDER        IFEQ      '1'
     C* Mensaje de error
     C*PASAR ZERROR ZERRET
     C                   CLEAR                   ZERROR
     C                   MOVEL     ZERRET        ZERROR
     C* Imprimir error
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*SINO
     C                   ELSE
     C* Retención contingente
     C*SUMAR MOVRET ZVRRET
     C                   ADD       MOVRET        ZVRRET
     C* Saldo retención conting
     C*SUMAR MOVRET CUESAL
     C                   ADD       MOVRET        CUESAL
     C*INICIARI DETARC(DETNUM DETNU3 DETPAG DETSEC)
     C     LL$167        KLIST
     C                   KFLD                    DETNUM
     C                   KFLD                    DETNU3
     C                   KFLD                    DETPAG
     C                   KFLD                    DETSEC
     C     LL$167        SETLL     DETARC                                 49
     C     *IN49         IFEQ      '1'
     C                   MOVE      '0'           *IN49
     C                   ELSE
     C                   MOVE      '1'           *IN49
     C                   END
     C*SI ERE(DETARC)
     C     *IN49         IFEQ      '0'
     C*LEER DETARC
     C                   READ      DETARC                                 49
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*MOVER ZPLAER PLANUM
     C                   MOVE      PLANUM        ZPLAER
     C*MOVER ZAFIIN MOVCO4
     C                   CLEAR                   ZAFIIN
     C                   MOVE      MOVCO4        ZAFIIN
     C*OBTENER (1) ZERROR = 'CUEARC no disponible - M71120' || ZPLAER ||
     C                   CLEAR                   H$1
     C     $HIL(124)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C* Imprimir error
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Validar diferencias por redondeos                           ==
     C*==                                                              ==
     C*==================================================================
     C     M71128        BEGSR
     C*CALCULAR ZMOVPE=ZVDCO+ZVDAR+ZVDCVA+ZVDCVE+ZVDINT+ZVDREN+ZVDFS+ZVD
     C     ZVDCO         ADD       ZVDAR         V$CA1           030 9
     C     V$CA1         ADD       ZVDCVA        V$CA1
     C     V$CA1         ADD       ZVDCVE        V$CA1
     C     V$CA1         ADD       ZVDINT        V$CA1
     C     V$CA1         ADD       ZVDREN        V$CA1
     C     V$CA1         ADD       ZVDFS         V$CA1
     C     V$CA1         ADD       ZVDIFS        V$CA1
     C     V$CA1         ADD       ZVDFGP        V$CA1
     C     V$CA1         ADD       ZVDIFG        V$CA1
     C     V$CA1         ADD       ZVDISF        V$CA1
     C     V$CA1         ADD       ZVDSFS        ZMOVPE
     C*CALCULAR ZMOVCU=ZCUCO+ZCUAR+ZCUCVA+ZCUCVE+ZCUINT+ZCUFS+ZCUIFS+ZCU
     C     ZCUCO         ADD       ZCUAR         V$CA1           030 9
     C     V$CA1         ADD       ZCUCVA        V$CA1
     C     V$CA1         ADD       ZCUCVE        V$CA1
     C     V$CA1         ADD       ZCUINT        V$CA1
     C     V$CA1         ADD       ZCUFS         V$CA1
     C     V$CA1         ADD       ZCUIFS        V$CA1
     C     V$CA1         ADD       ZCUREN        V$CA1
     C     V$CA1         ADD       ZCUFGP        V$CA1
     C     V$CA1         ADD       ZCUIFG        V$CA1
     C     V$CA1         ADD       ZCUISF        V$CA1
     C     V$CA1         ADD       ZCUSFS        ZMOVCU
     C*CALCULAR ZDFPES=REZCOT+REZCO1+REZCO2+REZCO4+REZVA1+REZINT+REZIN9-
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZVA1        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     V$CA1         ADD       REZIN9        V$CA1
     C     V$CA1         SUB       REZDEU        V$CA1
     C     V$CA1         SUB       ZMOVPE        ZDFPES
     C*CALCULAR ZDFCUO=REZCUO-ZMOVCU
     C     REZCUO        SUB       ZMOVCU        ZDFCUO
     C*SI ZMOVCU<>REZCUO Y ZDFPES>=-2 Y ZDFPES<=2
     C     ZMOVCU        IFNE      REZCUO
     C     ZDFPES        ANDGE     -2
     C     ZDFPES        ANDLE     2
     C*CALCULAR ZVALSU=ZCUCVE+ZDFCUO
     C     ZCUCVE        ADD       ZDFCUO        ZVALSU
     C*SI ZCUCVE<>0 Y ZVALSU>0
     C     ZCUCVE        IFNE      0
     C     ZVALSU        ANDGT     0
     C*MOVER ZCUCVE ZVALSU
     C                   Z-ADD     ZVALSU        ZCUCVE
     C*CALCULAR ZVDCVE=ZVDCVE+ZDFPES
     C     ZVDCVE        ADD       ZDFPES        ZVDCVE
     C*SINO
     C                   ELSE
     C*CALCULAR ZVALSU=ZCUCO+ZDFCUO
     C     ZCUCO         ADD       ZDFCUO        ZVALSU
     C*SI ZCUCO<>0 Y ZVALSU>0
     C     ZCUCO         IFNE      0
     C     ZVALSU        ANDGT     0
     C*MOVER ZCUCO ZVALSU
     C                   Z-ADD     ZVALSU        ZCUCO
     C*CALCULAR ZVDCO=ZVDCO+ZDFPES
     C     ZVDCO         ADD       ZDFPES        ZVDCO
     C*SINO
     C                   ELSE
     C*CALCULAR ZVALSU=ZCUAR+ZDFCUO
     C     ZCUAR         ADD       ZDFCUO        ZVALSU
     C*SI ZCUAR<>0 Y ZVALSU>0
     C     ZCUAR         IFNE      0
     C     ZVALSU        ANDGT     0
     C*MOVER ZCUAR ZVALSU
     C                   Z-ADD     ZVALSU        ZCUAR
     C*CALCULAR ZVDAR=ZVDAR+ZDFPES
     C     ZVDAR         ADD       ZDFPES        ZVDAR
     C*SINO
     C                   ELSE
     C*CALCULAR ZVALSU=ZCUREN+ZDFCUO
     C     ZCUREN        ADD       ZDFCUO        ZVALSU
     C*SI ZCUREN<>0 Y ZVALSU>0
     C     ZCUREN        IFNE      0
     C     ZVALSU        ANDGT     0
     C*MOVER ZCUREN ZVALSU
     C                   Z-ADD     ZVALSU        ZCUREN
     C*CALCULAR ZVDREN=ZVDREN+ZDFPES
     C     ZVDREN        ADD       ZDFPES        ZVDREN
     C*SINO
     C                   ELSE
     C*CALCULAR ZVALSU=ZCUINT+ZDFCUO
     C     ZCUINT        ADD       ZDFCUO        ZVALSU
     C*SI ZCUINT<>0 Y ZVALSU>0
     C     ZCUINT        IFNE      0
     C     ZVALSU        ANDGT     0
     C*MOVER ZCUINT ZVALSU
     C                   Z-ADD     ZVALSU        ZCUINT
     C*CALCULAR ZVDINT=ZVDINT+ZDFPES
     C     ZVDINT        ADD       ZDFPES        ZVDINT
     C*SINO
     C                   ELSE
     C*CALCULAR ZVALSU=ZCUIFG+ZDFCUO
     C     ZCUIFG        ADD       ZDFCUO        ZVALSU
     C*SI ZCUIFG<>0 Y ZVALSU>0
     C     ZCUIFG        IFNE      0
     C     ZVALSU        ANDGT     0
     C*MOVER ZCUIFG ZVALSU
     C                   Z-ADD     ZVALSU        ZCUIFG
     C*CALCULAR ZVDIFG=ZVDIFG+ZDFPES
     C     ZVDIFG        ADD       ZDFPES        ZVDIFG
     C*SINO
     C                   ELSE
     C*CALCULAR ZVALSU=ZCUFGP+ZDFCUO
     C     ZCUFGP        ADD       ZDFCUO        ZVALSU
     C*SI ZCUFGP<>0 Y ZVALSU>0
     C     ZCUFGP        IFNE      0
     C     ZVALSU        ANDGT     0
     C*MOVER ZCUFGP ZVALSU
     C                   Z-ADD     ZVALSU        ZCUFGP
     C*CALCULAR ZVDFGP=ZVDFGP+ZDFPES
     C     ZVDFGP        ADD       ZDFPES        ZVDFGP
     C*SINO
     C                   ELSE
     C*CALCULAR ZVALSU=ZCUISF+ZDFCUO
     C     ZCUISF        ADD       ZDFCUO        ZVALSU
     C*SI ZCUISF<>0 Y ZVALSU>0
     C     ZCUISF        IFNE      0
     C     ZVALSU        ANDGT     0
     C*MOVER ZCUISF ZVALSU
     C                   Z-ADD     ZVALSU        ZCUISF
     C*CALCULAR ZVDISF=ZVDISF+ZDFPES
     C     ZVDISF        ADD       ZDFPES        ZVDISF
     C*SINO
     C                   ELSE
     C*CALCULAR ZVALSU=ZCUIFS+ZDFCUO
     C     ZCUIFS        ADD       ZDFCUO        ZVALSU
     C*SI ZCUIFS<>0 Y ZVALSU>0
     C     ZCUIFS        IFNE      0
     C     ZVALSU        ANDGT     0
     C*MOVER ZCUIFS ZVALSU
     C                   Z-ADD     ZVALSU        ZCUIFS
     C*CALCULAR ZVDIFS=ZVDIFS+ZDFPES
     C     ZVDIFS        ADD       ZDFPES        ZVDIFS
     C*SINO
     C                   ELSE
     C*CALCULAR ZVALSU=ZCUSFS+ZDFCUO
     C     ZCUSFS        ADD       ZDFCUO        ZVALSU
     C*SI ZCUSFS<>0 Y ZVALSU>0
     C     ZCUSFS        IFNE      0
     C     ZVALSU        ANDGT     0
     C*MOVER ZCUSFS ZVALSU
     C                   Z-ADD     ZVALSU        ZCUSFS
     C*CALCULAR ZVDSFS=ZVDSFS+ZDFPES
     C     ZVDSFS        ADD       ZDFPES        ZVDSFS
     C*SINO
     C                   ELSE
     C*CALCULAR ZVALSU=ZCUFS+ZDFCUO
     C     ZCUFS         ADD       ZDFCUO        ZVALSU
     C*SI ZCUFS<>0 Y ZVALSU>0
     C     ZCUFS         IFNE      0
     C     ZVALSU        ANDGT     0
     C*MOVER ZCUFS ZVALSU
     C                   Z-ADD     ZVALSU        ZCUFS
     C*CALCULAR ZVDFS=ZVDFS+ZDFPES
     C     ZVDFS         ADD       ZDFPES        ZVDFS
     C*SINO
     C                   ELSE
     C*CALCULAR ZVALSU=ZCUCVA+ZDFCUO
     C     ZCUCVA        ADD       ZDFCUO        ZVALSU
     C*SI ZCUCVA<>0 Y ZVALSU>0
     C     ZCUCVA        IFNE      0
     C     ZVALSU        ANDGT     0
     C*MOVER ZCUCVA ZVALSU
     C                   Z-ADD     ZVALSU        ZCUCVA
     C*CALCULAR ZVDCVA=ZVDCVA+ZDFPES
     C     ZVDCVA        ADD       ZDFPES        ZVDCVA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular totales x concepto - acred. de rezagos planilla e  ==
     C*==                                                              ==
     C*==================================================================
     C     M72000        BEGSR
     C*LIMPIAR ZTOCO ZTOCVA ZTOCVE ZTOFS ZTOAR ZINDPA ZTOREN ZTOSFS ZTOF
     C                   CLEAR                   ZTOCO
     C                   CLEAR                   ZTOCVA
     C                   CLEAR                   ZTOCVE
     C                   CLEAR                   ZTOFS
     C                   CLEAR                   ZTOAR
     C                   CLEAR                   ZINDPA
     C                   CLEAR                   ZTOREN
     C                   CLEAR                   ZTOSFS
     C                   CLEAR                   ZTOFGP
     C* Arreglo pesos x depositos - acr. rezagos
     C*LIMPIAR ZAR$RE[]
     C                   CLEAR                   $X
     C* Arreglo cuotas x depósitos - acr. rezagos
     C*LIMPIAR ZARCRE[]
     C                   CLEAR                   $Y
     C* Arreglo fechas depositos - acr. rezagos
     C*LIMPIAR ZARFRE[]
     C                   CLEAR                   $Z
     C* Saldo de ints e ints. f.s.
     C*LIMPIAR ZSAINT ZSAIFS ZSAISF ZSAIFG ZVAAUX
     C                   CLEAR                   ZSAINT
     C                   CLEAR                   ZSAIFS
     C                   CLEAR                   ZSAISF
     C                   CLEAR                   ZSAIFG
     C                   CLEAR                   ZVAAUX
     C* Rezagos finalizados
     C*PASAR ZESTAD 'FIN'
     C                   MOVEL     'FIN'         ZESTAD
     C*MIENTRAS NFA (REZARC19) Y REZEST = ZESTAD Y REZUSU = ZT@008 Y REZ
     C     *IN78         DOWEQ     '0'
     C     REZEST        ANDEQ     ZESTAD
     C     REZUSU        ANDEQ     ZT@008
     C     REZNRO        ANDEQ     ZPLAN1
     C     REZPER        ANDEQ     PLAPER
     C*LIMPIAR ZDITRA ZDILIC
     C                   CLEAR                   ZDITRA
     C                   CLEAR                   ZDILIC
     C*RECUPERARD REZARC (REZNRO REZNR1 REZNR2)
     C     LL$168        KLIST
     C                   KFLD                    REZNRO
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$168        CHAIN     REZARC                             7694
     C                   MOVE      *IN94         I$RND
     C     *IN76         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   REZREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SI REZEST = 'FIN'
     C     REZEST        IFEQ      'FIN'
     C* Estado temporal del rezago
     C*PASAR REZEST 'COP'
     C                   MOVEL     'COP'         REZEST
     C*GRABAR REZARC
     C     *IN76         IFEQ      '0'
     C                   UPDATE    REZREG                               94
     C                   ELSE
     C                   WRITE     REZREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*COMPLETAR
     C     REZNR2        COMMIT                                         94
     C                   MOVE      *IN94         I$NFT
     C*SINO
     C                   ELSE
     C*PASAR ZSALIR '1'
     C                   MOVEL     '1'           ZSALIR
     C*SALIR
     C                   GOTO      T$12
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*RECUPERARD (N) DETARC (PLANU3 PLANUM REZNR1 REZNR2)
     C     LL$169        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$169        CHAIN     DETARC                             4994
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL
     C+  INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC, PLAARC WHERE
     C+  DETNU3 = PLANUM AND
     C+  PLANU1 = :REZNRO AND
     C+  DETPAG = :REZNR1 AND
     C+  DETSEC = :REZNR2
     C/END-EXEC
     C* Actualizar Interno afiliado forzoso
     C*EJECUTAR M00130
     C                   EXSR      M00130
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C* proceso para afil decreto 2616
     C*LLAMAR TRDETA64(PLANUM DETTI2 DETNU2 ZI2616)
     C                   CALL      'TRDETA64'
     C                   PARM                    PLANUM
     C                   PARM                    DETTI2
     C                   PARM                    DETNU2
     C                   PARM                    ZI2616
     C* Per.planilla >= Per.reforma
     C*SI PLAPER >  ZPEREF
     C     PLAPER        IFGT      ZPEREF
     C* Período procesar F.S.
     C*PASAR ZPERFS PLAPER
     C                   MOVEL     PLAPER        ZPERFS
     C*PASAR ZINREF 'S'
     C                   MOVEL     'S'           ZINREF
     C* IBC del afiliado
     C*MOVER ZIBCAF DETVA7
     C                   Z-ADD     DETVA7        ZIBCAF
     C* Retorna FGPM Y SFSP
     C*EJECUTAR M77000
     C                   EXSR      M77000
     C*FIN
     C                   END
     C*SI DETTAR |= *CERO
     C     DETTAR        IFNE      *ZERO
     C* Total alto riesgo
     C*CALCULAR ZTOAR = ZTOAR + (DETCOT - ZVFGPM)
     C     DETCOT        SUB       ZVFGPM        V$CA1           030 9
     C     ZTOAR         ADD       V$CA1         ZTOAR
     C*SINO
     C                   ELSE
     C* Total CO
     C*CALCULAR ZTOCO = ZTOCO + (DETCOT - ZVFGPM)
     C     DETCOT        SUB       ZVFGPM        V$CA1           030 9
     C     ZTOCO         ADD       V$CA1         ZTOCO
     C*FIN
     C                   END
     C* Total C.V.A.
     C*SUMAR DETCO1 ZTOCVA
     C                   ADD       DETCO1        ZTOCVA
     C* Total C.V.E.
     C*SUMAR DETCO2 ZTOCVE
     C                   ADD       DETCO2        ZTOCVE
     C* Total fondo solidaridad
     C*CALCULAR ZTOFS = ZTOFS + (DETCTA - ZVSFSP)
     C     DETCTA        SUB       ZVSFSP        V$CA1           030 9
     C     ZTOFS         ADD       V$CA1         ZTOFS
     C* Total FGPM
     C*SUMAR ZVFGPM ZTOFGP
     C                   ADD       ZVFGPM        ZTOFGP
     C* Total SFS
     C*SUMAR ZVSFSP ZTOSFS
     C                   ADD       ZVSFSP        ZTOSFS
     C* Total Rendimientos
     C*SUMAR DETV14 ZTOREN
     C                   ADD       DETV14        ZTOREN
     C* Saldo ints. f.s.
     C*SUMAR REZIN9 ZSAIFS
     C                   ADD       REZIN9        ZSAIFS
     C* Saldo intereses
     C*SUMAR REZINT ZSAINT
     C                   ADD       REZINT        ZSAINT
     C*LIMPIAR $$FSP
     C                   CLEAR                   $$FSP
     C* Fondo
     C*PASAR ZFOFSP ZFONDO
     C                   MOVEL     ZFONDO        ZFOFSP
     C* Planilla
     C*MOVER ZPLFSP DETNU3
     C                   Z-ADD     DETNU3        ZPLFSP
     C* Página
     C*MOVER ZPAFSP DETPAG
     C                   Z-ADD     DETPAG        ZPAFSP
     C* Secuencia
     C*MOVER ZSEFSP DETSEC
     C                   Z-ADD     DETSEC        ZSEFSP
     C* Acción: Consultar detalle
     C*PASAR ZACFSP 'D'
     C                   MOVEL     'D'           ZACFSP
     C*LLAMAR RPFSPR50 ($$FSP)
     C                   CALL      'RPFSPR50'
     C                   PARM                    $$FSP
     C* Existe en FSPARC
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*SI ZTOSFS > *CEROS
     C     ZTOSFS        IFGT      *ZEROS
     C*CALCULAR ZTOSFS = ZTOSFS - ZVZFSP
     C     ZTOSFS        SUB       ZVZFSP        ZTOSFS
     C*CALCULAR ZTOFS  = ZTOFS  - ZZAFSP
     C     ZTOFS         SUB       ZZAFSP        ZTOFS
     C*SINO
     C                   ELSE
     C*CALCULAR ZTOFS  = ZTOFS  - (ZZAFSP+ZVZFSP)
     C     ZZAFSP        ADD       ZVZFSP        V$CA1           030 9
     C     ZTOFS         SUB       V$CA1         ZTOFS
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI PLANU8 = *CERO
     C     PLANU8        IFEQ      *ZERO
     C* Acumular valor distrib. x planilla para rezagos
     C*EJECUTAR M70100
     C                   EXSR      M70100
     C*FIN
     C                   END
     C*SI PLANU8 <> *CERO O PLANU8 = *CERO Y ZVAAUX = *CERO
     C     PLANU8        IFNE      *ZERO
     C     PLANU8        OREQ      *ZERO
     C     ZVAAUX        ANDEQ     *ZERO
     C*CALCULAR ZVLRRZ = REZCOT+REZCO1+REZCO2+REZCO4+REZVA1+REZINT+REZIN
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZVA1        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     V$CA1         ADD       REZIN9        V$CA1
     C     V$CA1         SUB       REZDEU        V$CA1
     C     V$CA1         ADD       REZVA3        ZVLRRZ
     C*CALCULAR ZCUORZ = REZCUO + REZCU2
     C     REZCUO        ADD       REZCU2        ZCUORZ
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*CALCULAR ZVLRRZ = ZVLRRZ - (ZZAFSP+ZVZFSP+ZVIFSP+ZVISUB)
     C     ZZAFSP        ADD       ZVZFSP        V$CA1           030 9
     C     V$CA1         ADD       ZVIFSP        V$CA1
     C     V$CA1         ADD       ZVISUB        V$CA1
     C     ZVLRRZ        SUB       V$CA1         ZVLRRZ
     C*CALCULAR ZCUORZ = ZCUORZ - (ZZUFSP+ZCSFSP+ZCIFSP+ZCISUB)
     C     ZZUFSP        ADD       ZCSFSP        V$CA1           030 9
     C     V$CA1         ADD       ZCIFSP        V$CA1
     C     V$CA1         ADD       ZCISUB        V$CA1
     C     ZCUORZ        SUB       V$CA1         ZCUORZ
     C*PASAR ZFSPAR '1'
     C                   MOVEL     '1'           ZFSPAR
     C*FIN
     C                   END
     C*CALCULAR ZAR$RE[L] = ZAR$RE[L] + ZVLRRZ
     C     $X(L)         ADD       ZVLRRZ        $X(L)
     C*CALCULAR ZARCRE[L] = ZARCRE[L] + ZCUORZ
     C     $Y(L)         ADD       ZCUORZ        $Y(L)
     C*ASIGNARA ZARFRE[L] ZFECD1
     C                   MOVEA     ZFECD1        $Z(L)
     C* Valor total depòsito
     C*SUMAR ZVLRRZ ZTVDEP
     C                   ADD       ZVLRRZ        ZTVDEP
     C* Cuotas depòsito
     C*SUMAR ZCUORZ ZTCDEP
     C                   ADD       ZCUORZ        ZTCDEP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*LEER REZARC19
     C                   READ      REZARC19                               78
     C*FIN
     C                   END
     C     T$12          TAG
     C* Saldo cotización obligatoria
     C*MOVER ZSACO  ZTOCO
     C                   Z-ADD     ZTOCO         ZSACO
     C* Saldo alto riesgo
     C*MOVER ZSAAR  ZTOAR
     C                   Z-ADD     ZTOAR         ZSAAR
     C* Saldo voluntaria afiliado
     C*MOVER ZSACVA ZTOCVA
     C                   Z-ADD     ZTOCVA        ZSACVA
     C* Saldo voluntaria empleador
     C*MOVER ZSACVE ZTOCVE
     C                   Z-ADD     ZTOCVE        ZSACVE
     C* Saldo rendimientos
     C*MOVER ZSAREN ZTOREN
     C                   Z-ADD     ZTOREN        ZSAREN
     C* Saldo fondo de solidaridad
     C*MOVER ZSAFS  ZTOFS
     C                   Z-ADD     ZTOFS         ZSAFS
     C* Saldo SFSP
     C*MOVER ZSASFS ZTOSFS
     C                   Z-ADD     ZTOSFS        ZSASFS
     C* Saldo FGPM
     C*MOVER ZSAFGP ZTOFGP
     C                   Z-ADD     ZTOFGP        ZSAFGP
     C*CALCULAR ZSACOT = ZTOCO + ZTOAR + ZTOCVA + ZTOCVE
     C     ZTOCO         ADD       ZTOAR         V$CA1           030 9
     C     V$CA1         ADD       ZTOCVA        V$CA1
     C     V$CA1         ADD       ZTOCVE        ZSACOT
     C* Total cotizaciones
     C*MOVER ZTOTCO ZSACOT
     C                   Z-ADD     ZSACOT        ZTOTCO
     C*SUMAR 1 L
     C                   ADD       1             L
     C                   ENDSR
     C*==================================================================
     C*==  Procesa detalles de rezagos - plan. extraordinaria          ==
     C*==                                                              ==
     C*==================================================================
     C     M72100        BEGSR
     C*LIMPIAR ZVLRRA ZCUORA ZVLRMA ZCUOMA ZREZPR ZVLPAC ZCTPAC
     C                   CLEAR                   ZVLRRA
     C                   CLEAR                   ZCUORA
     C                   CLEAR                   ZVLRMA
     C                   CLEAR                   ZCUOMA
     C                   CLEAR                   ZREZPR
     C                   CLEAR                   ZVLPAC
     C                   CLEAR                   ZCTPAC
     C* Limpiar variables
     C*EJECUTAR M14010
     C                   EXSR      M14010
     C* Estado temporal del rezago
     C*PASAR ZESTAD 'COP'
     C                   MOVEL     'COP'         ZESTAD
     C*INICIAR REZARC19 (ZESTAD ZT@008 ZPLAN1 PLATI1 PLANU4 PLAPER)
     C     LL$170        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C                   KFLD                    ZPLAN1
     C                   KFLD                    PLATI1
     C                   KFLD                    PLANU4
     C                   KFLD                    PLAPER
     C     LL$170        SETLL     REZARC19                           78
     C*LEER REZARC19
     C                   READ      REZARC19                               78
     C*MIENTRAS NFA (REZARC19) Y REZEST = ZESTAD Y REZUSU = ZT@008 Y REZ
     C     *IN78         DOWEQ     '0'
     C     REZEST        ANDEQ     ZESTAD
     C     REZUSU        ANDEQ     ZT@008
     C     REZNRO        ANDEQ     ZPLAN1
     C     REZPER        ANDEQ     PLAPER
     C*LIMPIAR ZOVCO1 ZOVTIP ZOVPER ZDITRA ZDILIC
     C                   CLEAR                   ZOVCO1
     C                   CLEAR                   ZOVTIP
     C                   CLEAR                   ZOVPER
     C                   CLEAR                   ZDITRA
     C                   CLEAR                   ZDILIC
     C* Limpiar variables de HISAR4
     C*EJECUTAR M00150
     C                   EXSR      M00150
     C*SUMAR 1 ZREZPR
     C                   ADD       1             ZREZPR
     C*RECUPERARD (N) DETARC (PLANU3 PLANUM REZNR1 REZNR2)
     C     LL$171        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$171        CHAIN     DETARC                             4994
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL
     C+  INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC, PLAARC WHERE
     C+  DETNU3 = PLANUM AND
     C+  PLANU1 = :REZNRO AND
     C+  DETPAG = :REZNR1 AND
     C+  DETSEC = :REZNR2
     C/END-EXEC
     C* proceso para afil decreto 2616
     C*LLAMAR TRDETA64(PLANUM DETTI2 DETNU2 ZI2616)
     C                   CALL      'TRDETA64'
     C                   PARM                    PLANUM
     C                   PARM                    DETTI2
     C                   PARM                    DETNU2
     C                   PARM                    ZI2616
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C* Per.planilla >= Per.reforma
     C*SI PLAPER >  ZPEREF
     C     PLAPER        IFGT      ZPEREF
     C* Período procesar F.S.
     C*PASAR ZPERFS PLAPER
     C                   MOVEL     PLAPER        ZPERFS
     C*PASAR ZINREF 'S'
     C                   MOVEL     'S'           ZINREF
     C* IBC del afiliado
     C*MOVER ZIBCAF DETVA7
     C                   Z-ADD     DETVA7        ZIBCAF
     C* Retorna FGPM Y SFSP
     C*EJECUTAR M77000
     C                   EXSR      M77000
     C*FIN
     C                   END
     C* Leer afiliado y cuenta
     C*EJECUTAR M14020
     C                   EXSR      M14020
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DETARC no disponible - M72100'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(125)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*LIMPIAR ZCOTAR ZCOTOB
     C                   CLEAR                   ZCOTAR
     C                   CLEAR                   ZCOTOB
     C* Tarifa alto riesgo
     C*SI DETTAR |= *CERO
     C     DETTAR        IFNE      *ZERO
     C* Cotización alto riesgo
     C*MOVER ZCOTAR DETCOT
     C                   Z-ADD     DETCOT        ZCOTAR
     C* Cotización alto riesgo
     C*CALCULAR ZCOTAR = DETCOT - ZVFGPM
     C     DETCOT        SUB       ZVFGPM        ZCOTAR
     C*SINO
     C                   ELSE
     C* Cotización obligatoria
     C*CALCULAR ZCOTOB = DETCOT - ZVFGPM
     C     DETCOT        SUB       ZVFGPM        ZCOTOB
     C*FIN
     C                   END
     C* Cot. voluntaria afiliado
     C*MOVER ZCOTVA DETCO1
     C                   Z-ADD     DETCO1        ZCOTVA
     C* Cot. voluntaria empleador
     C*MOVER ZCOTVE DETCO2
     C                   Z-ADD     DETCO2        ZCOTVE
     C* Fondo de solidaridad
     C*CALCULAR ZCOTFS = DETCTA - ZVSFSP
     C     DETCTA        SUB       ZVSFSP        ZCOTFS
     C* Cot. subsistencia
     C*MOVER ZCOTSF ZVSFSP
     C                   Z-ADD     ZVSFSP        ZCOTSF
     C* Cotización FGPM
     C*MOVER ZCOTFG ZVFGPM
     C                   Z-ADD     ZVFGPM        ZCOTFG
     C* Rendimientos
     C*MOVER ZRENDI DETV14
     C                   Z-ADD     DETV14        ZRENDI
     C*CALCULAR ZTOCOT = ZCOTAR + ZCOTOB + ZCOTVA + ZCOTVE
     C     ZCOTAR        ADD       ZCOTOB        V$CA1           030 9
     C     V$CA1         ADD       ZCOTVA        V$CA1
     C     V$CA1         ADD       ZCOTVE        ZTOCOT
     C* Procesar depósitos por Rezagos - Ex
     C*EJECUTAR M72120
     C                   EXSR      M72120
     C*SI ZSALIR ]= '1'
     C     ZSALIR        IFNE      '1'
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Acreditación rezago plan. ext. no actualizó
     C                   CLEAR                   ZERROR
     C     $HIL(126)     CAT       ZIDENA:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* Acumula valores cotizaciones
     C*EJECUTAR M14085
     C                   EXSR      M14085
     C*RECUPERARD REZARC (REZNRO REZNR1 REZNR2)
     C     LL$172        KLIST
     C                   KFLD                    REZNRO
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$172        CHAIN     REZARC                             7694
     C                   MOVE      *IN94         I$RND
     C     *IN76         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   REZREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Estado temp. antes de acreditar
     C*SI REZEST = 'COP'
     C     REZEST        IFEQ      'COP'
     C* Valor retención
     C*MOVER REZVAL DETVA8
     C                   Z-ADD     DETVA8        REZVAL
     C* Fecha fondo último estado
     C*PASAR REZFE2 HISFE3
     C                   MOVEL     HISFE3        REZFE2
     C* Estado acreditado
     C*PASAR REZEST 'ACR'
     C                   MOVEL     'ACR'         REZEST
     C*GRABAR REZARC
     C     *IN76         IFEQ      '0'
     C                   UPDATE    REZREG                               94
     C                   ELSE
     C                   WRITE     REZREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C*CALCULAR ZVALRE = (REZCOT+REZCO1+REZCO2+REZCO4+REZINT) + (REZIN9+
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     REZIN9        ADD       REZVA1        V$CA2           030 9
     C     V$CA2         SUB       REZDEU        V$CA2
     C     V$CA2         ADD       REZVA3        V$CA2
     C     V$CA1         ADD       V$CA2         ZVALRE
     C*PASAR ZSIGNO '-'
     C                   MOVEL     '-'           ZSIGNO
     C*LLAMAR TRINCE65(REZNRO REZNR1 REZNR2 REZNR3 ZVALRE ZSIGNO)
     C                   CALL      'TRINCE65'
     C                   PARM                    REZNRO
     C                   PARM                    REZNR1
     C                   PARM                    REZNR2
     C                   PARM                    REZNR3
     C                   PARM                    ZVALRE
     C                   PARM                    ZSIGNO
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Planilla del rezago
     C*MOVER ZPLARE REZNRO
     C                   MOVE      REZNRO        ZPLARE
     C*OBTENER (1) ZERROR = 'Otro trabajo está procesando el rezago'|| Z
     C                   CLEAR                   ZERROR
     C     $HIL(127)     CAT       ZPLARE:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'REZARC no disponible - M72100'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(128)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR ]= '1'
     C     ZSALIR        IFNE      '1'
     C*PASAR ZREZEM '0'
     C                   MOVEL     '0'           ZREZEM
     C* Generar encabezados e históricos
     C*EJECUTAR M15000
     C                   EXSR      M15000
     C*FIN
     C                   END
     C* Módulo de cesantes
     C*EJECUTAR M00025
     C                   EXSR      M00025
     C*LEER REZARC19
     C                   READ      REZARC19                               78
     C*FIN
     C                   END
     C* Se limpia variable para no sumar 2 veces en el listado de totale
     C*LIMPIAR ZTOREN
     C                   CLEAR                   ZTOREN
     C* Eliminar datos int. pla terceros
     C*EJECUTAR M00250
     C                   EXSR      M00250
     C                   ENDSR
     C*==================================================================
     C*==  Procesar depósitos por detalle de rezago . planilla extrao  ==
     C*==                                                              ==
     C*==================================================================
     C     M72120        BEGSR
     C* Posición en el arreglo
     C*MOVER L 1
     C                   Z-ADD     1             L
     C*LIMPIAR ZVRREZ ZCUREZ ZINTRE ZIFSRE
     C                   CLEAR                   ZVRREZ
     C                   CLEAR                   ZCUREZ
     C                   CLEAR                   ZINTRE
     C                   CLEAR                   ZIFSRE
     C*LIMPIAR ZINCDE ZGRAMV ZVLRMV ZCUOMV
     C                   CLEAR                   ZINCDE
     C                   CLEAR                   ZGRAMV
     C                   CLEAR                   ZVLRMV
     C                   CLEAR                   ZCUOMV
     C*LIMPIAR ZCUERZ
     C                   CLEAR                   ZCUERZ
     C* Número depósitos procesados
     C*MIENTRAS L < K Y ZSALIR |= '1'
     C     L             DOWLT     K
     C     ZSALIR        ANDNE     '1'
     C*LIMPIAR ZVDFS ZVDIFS ZVDINT ZVDCVA ZVDREN ZVDCO ZVDCVE ZVDCVA ZVD
     C                   CLEAR                   ZVDFS
     C                   CLEAR                   ZVDIFS
     C                   CLEAR                   ZVDINT
     C                   CLEAR                   ZVDCVA
     C                   CLEAR                   ZVDREN
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZVDCVE
     C                   CLEAR                   ZVDCVA
     C                   CLEAR                   ZVDAR
     C*LIMPIAR ZCUFS ZCUIFS ZCUINT ZCUCVA ZCUREN ZCUCO ZCUCVE ZCUCVA ZCU
     C                   CLEAR                   ZCUFS
     C                   CLEAR                   ZCUIFS
     C                   CLEAR                   ZCUINT
     C                   CLEAR                   ZCUCVA
     C                   CLEAR                   ZCUREN
     C                   CLEAR                   ZCUCO
     C                   CLEAR                   ZCUCVE
     C                   CLEAR                   ZCUCVA
     C                   CLEAR                   ZCUAR
     C*LIMPIAR ZVDSFS ZVDISF ZVDFGP ZVDIFG
     C                   CLEAR                   ZVDSFS
     C                   CLEAR                   ZVDISF
     C                   CLEAR                   ZVDFGP
     C                   CLEAR                   ZVDIFG
     C*LIMPIAR ZCUSFS ZCUISF ZCUFGP ZCUIFG
     C                   CLEAR                   ZCUSFS
     C                   CLEAR                   ZCUISF
     C                   CLEAR                   ZCUFGP
     C                   CLEAR                   ZCUIFG
     C*LIMPIAR ZVDIVA ZVDIVE ZVDIAR ZCUIVA ZCUIVE ZCUIAR
     C                   CLEAR                   ZVDIVA
     C                   CLEAR                   ZVDIVE
     C                   CLEAR                   ZVDIAR
     C                   CLEAR                   ZCUIVA
     C                   CLEAR                   ZCUIVE
     C                   CLEAR                   ZCUIAR
     C*LIMPIAR ZOVCO8 ZOVIN2 ZOVV13 ZOVI06 ZOVCOM ZOVVAL ZOVCO7 ZOVC27 Z
     C                   CLEAR                   ZOVCO8
     C                   CLEAR                   ZOVIN2
     C                   CLEAR                   ZOVV13
     C                   CLEAR                   ZOVI06
     C                   CLEAR                   ZOVCOM
     C                   CLEAR                   ZOVVAL
     C                   CLEAR                   ZOVCO7
     C                   CLEAR                   ZOVC27
     C                   CLEAR                   ZOVRET
     C* Distribuir valor
     C*EJECUTAR M14105
     C                   EXSR      M14105
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Generar movimiento planilla extrao
     C*EJECUTAR M31105
     C                   EXSR      M31105
     C*FIN
     C                   END
     C*SUMAR 1 L
     C                   ADD       1             L
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular totales x concepto - acred. rezagos planilla tras  ==
     C*==                                                              ==
     C*==================================================================
     C     M73000        BEGSR
     C*LIMPIAR ZTOCO ZTOCVA ZTOCVE ZTOFS ZTOAR ZINDPA ZTOREN ZTOSFS ZTOF
     C                   CLEAR                   ZTOCO
     C                   CLEAR                   ZTOCVA
     C                   CLEAR                   ZTOCVE
     C                   CLEAR                   ZTOFS
     C                   CLEAR                   ZTOAR
     C                   CLEAR                   ZINDPA
     C                   CLEAR                   ZTOREN
     C                   CLEAR                   ZTOSFS
     C                   CLEAR                   ZTOFGP
     C                   CLEAR                   ZVAAUX
     C* Arreglo pesos x depositos - acr. rezagos
     C*LIMPIAR ZAR$RE[]
     C                   CLEAR                   $X
     C* Arreglo cuotas x depósitos - acr. rezagos
     C*LIMPIAR ZARCRE[]
     C                   CLEAR                   $Y
     C* Arreglo fechas depositos - acr. rezagos
     C*LIMPIAR ZARFRE[]
     C                   CLEAR                   $Z
     C* Rezagos finalizados
     C*PASAR ZESTAD 'FIN'
     C                   MOVEL     'FIN'         ZESTAD
     C*MIENTRAS NFA (REZARC20) Y REZEST = ZESTAD Y REZUSU = ZT@008 Y REZ
     C     *IN79         DOWEQ     '0'
     C     REZEST        ANDEQ     ZESTAD
     C     REZUSU        ANDEQ     ZT@008
     C     REZNRO        ANDEQ     ZPLAN1
     C     REZPER        ANDEQ     PLAPER
     C*LIMPIAR ZDITRA ZDILIC
     C                   CLEAR                   ZDITRA
     C                   CLEAR                   ZDILIC
     C*RECUPERARD REZARC (REZNRO REZNR1 REZNR2)
     C     LL$173        KLIST
     C                   KFLD                    REZNRO
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$173        CHAIN     REZARC                             7694
     C                   MOVE      *IN94         I$RND
     C     *IN76         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   REZREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SI REZEST = 'FIN'
     C     REZEST        IFEQ      'FIN'
     C* Estado temporal del rezago
     C*PASAR REZEST 'COP'
     C                   MOVEL     'COP'         REZEST
     C*GRABAR REZARC
     C     *IN76         IFEQ      '0'
     C                   UPDATE    REZREG                               94
     C                   ELSE
     C                   WRITE     REZREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI ZT@COM <> 'N'
     C     ZT@COM        IFNE      'N'
     C*COMPLETAR
     C     REZNR2        COMMIT                                         94
     C                   MOVE      *IN94         I$NFT
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*PASAR ZSALIR '1'
     C                   MOVEL     '1'           ZSALIR
     C*SALIR
     C                   GOTO      T$13
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'REZARC no disponible - M73000'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(129)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*RECUPERARD (N) DETARC (PLANU3 PLANUM REZNR1 REZNR2)
     C     LL$174        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$174        CHAIN     DETARC                             4994
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL
     C+  INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC, PLAARC WHERE
     C+  DETNU3 = PLANUM AND
     C+  PLANU1 = :REZNRO AND
     C+  DETPAG = :REZNR1 AND
     C+  DETSEC = :REZNR2
     C/END-EXEC
     C* Actualizar Interno afiliado forzoso
     C*EJECUTAR M00130
     C                   EXSR      M00130
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C*LIMPIAR ZTOCO2
     C                   CLEAR                   ZTOCO2
     C* Busqueda DETA53 plan, pag, sec
     C*PASAR ZOPCI2 '2'
     C                   MOVEL     '2'           ZOPCI2
     C*LLAMAR TRFGPM50 (DETNU3 DETPAG DETSEC ZFGPMP ZOPCI2)
     C                   CALL      'TRFGPM50'
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    ZFGPMP
     C                   PARM                    ZOPCI2
     C* Total FGPM
     C*SUMAR ZFGPMP ZTOFGP
     C                   ADD       ZFGPMP        ZTOFGP
     C*CALCULAR ZTOCO2 = DETCOT - ZTOFGP
     C     DETCOT        SUB       ZTOFGP        ZTOCO2
     C* Total cotización obligatoria
     C*SUMAR ZTOCO2 ZTOCO
     C                   ADD       ZTOCO2        ZTOCO
     C* Total C.V.A.
     C*SUMAR DETCO1 ZTOCVA
     C                   ADD       DETCO1        ZTOCVA
     C* Total C.V.E.
     C*SUMAR DETCO2 ZTOCVE
     C                   ADD       DETCO2        ZTOCVE
     C* Total Rendimientos
     C*SUMAR DETV14 ZTOREN
     C                   ADD       DETV14        ZTOREN
     C*SI PLANU8 = *CERO
     C     PLANU8        IFEQ      *ZERO
     C* Acumular valor distrib. x planilla para rezagos
     C*EJECUTAR M70100
     C                   EXSR      M70100
     C*FIN
     C                   END
     C*SI PLANU8 <> *CERO O PLANU8 = *CERO Y ZVAAUX = *CERO
     C     PLANU8        IFNE      *ZERO
     C     PLANU8        OREQ      *ZERO
     C     ZVAAUX        ANDEQ     *ZERO
     C*CALCULAR ZVLRRZ = REZCOT+REZCO1+REZCO2+REZCO4+REZVA1+REZINT+REZIN
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZVA1        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     V$CA1         ADD       REZIN9        V$CA1
     C     V$CA1         SUB       REZDEU        V$CA1
     C     V$CA1         ADD       REZVA3        ZVLRRZ
     C*CALCULAR ZCUORZ = REZCUO + REZCU2
     C     REZCUO        ADD       REZCU2        ZCUORZ
     C*CALCULAR ZAR$RE[L] = ZAR$RE[L] + ZVLRRZ
     C     $X(L)         ADD       ZVLRRZ        $X(L)
     C*CALCULAR ZARCRE[L] = ZARCRE[L] + ZCUORZ
     C     $Y(L)         ADD       ZCUORZ        $Y(L)
     C*ASIGNARA ZARFRE[L] ZFECD1
     C                   MOVEA     ZFECD1        $Z(L)
     C* Valor total depòsito
     C*SUMAR ZVLRRZ ZTVDEP
     C                   ADD       ZVLRRZ        ZTVDEP
     C* Cuotas depòsito
     C*SUMAR ZCUORZ ZTCDEP
     C                   ADD       ZCUORZ        ZTCDEP
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DETARC no disponible - M73000'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(130)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*LEER REZARC20
     C                   READ      REZARC20                               79
     C*FIN
     C                   END
     C     T$13          TAG
     C* Saldo cotización obligatoria
     C*MOVER ZSACO  ZTOCO
     C                   Z-ADD     ZTOCO         ZSACO
     C* Saldo voluntaria afiliado
     C*MOVER ZSACVA ZTOCVA
     C                   Z-ADD     ZTOCVA        ZSACVA
     C* Saldo voluntaria empleador
     C*MOVER ZSACVE ZTOCVE
     C                   Z-ADD     ZTOCVE        ZSACVE
     C* Saldo rendimientos
     C*MOVER ZSAREN ZTOREN
     C                   Z-ADD     ZTOREN        ZSAREN
     C* Saldo FGPM
     C*MOVER ZSAFGP ZTOFGP
     C                   Z-ADD     ZTOFGP        ZSAFGP
     C*CALCULAR ZSACOT = ZTOCO + ZTOCVA + ZTOCVE + ZTOFGP
     C     ZTOCO         ADD       ZTOCVA        V$CA1           030 9
     C     V$CA1         ADD       ZTOCVE        V$CA1
     C     V$CA1         ADD       ZTOFGP        ZSACOT
     C* Total cotizaciones
     C*MOVER ZTOTCO ZSACOT
     C                   Z-ADD     ZSACOT        ZTOTCO
     C*SUMAR 1 L
     C                   ADD       1             L
     C                   ENDSR
     C*==================================================================
     C*==  Procesar detalles de rezagos - planilla de traspaso         ==
     C*==                                                              ==
     C*==================================================================
     C     M73100        BEGSR
     C*LIMPIAR ZVLRRA ZCUORA ZVLRMA ZCUOMA ZREZPR ZVLPAC ZCTPAC
     C                   CLEAR                   ZVLRRA
     C                   CLEAR                   ZCUORA
     C                   CLEAR                   ZVLRMA
     C                   CLEAR                   ZCUOMA
     C                   CLEAR                   ZREZPR
     C                   CLEAR                   ZVLPAC
     C                   CLEAR                   ZCTPAC
     C* Limpiar variables
     C*EJECUTAR M14010
     C                   EXSR      M14010
     C* Estado temporal del rezago
     C*PASAR ZESTAD 'COP'
     C                   MOVEL     'COP'         ZESTAD
     C*INICIAR REZARC20 (ZESTAD ZT@008 ZPLAN1 PLATI1 PLANU4 PLAPER)
     C     LL$175        KLIST
     C                   KFLD                    ZESTAD
     C                   KFLD                    ZT@008
     C                   KFLD                    ZPLAN1
     C                   KFLD                    PLATI1
     C                   KFLD                    PLANU4
     C                   KFLD                    PLAPER
     C     LL$175        SETLL     REZARC20                           79
     C*LEER REZARC20
     C                   READ      REZARC20                               79
     C*MIENTRAS NFA (REZARC20) Y REZEST = ZESTAD Y REZUSU = ZT@008 Y REZ
     C     *IN79         DOWEQ     '0'
     C     REZEST        ANDEQ     ZESTAD
     C     REZUSU        ANDEQ     ZT@008
     C     REZNRO        ANDEQ     ZPLAN1
     C     REZPER        ANDEQ     PLAPER
     C*LIMPIAR ZDITRA ZDILIC
     C                   CLEAR                   ZDITRA
     C                   CLEAR                   ZDILIC
     C* Limpiar variables de HISAR4
     C*EJECUTAR M00150
     C                   EXSR      M00150
     C*SUMAR 1 ZREZPR
     C                   ADD       1             ZREZPR
     C*RECUPERARD (N) DETARC (PLANU3 PLANUM REZNR1 REZNR2)
     C     LL$176        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$176        CHAIN     DETARC                             4994
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL
     C+  INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC, PLAARC WHERE
     C+  DETNU3 = PLANUM AND
     C+  PLANU1 = :REZNRO AND
     C+  DETPAG = :REZNR1 AND
     C+  DETSEC = :REZNR2
     C/END-EXEC
     C* proceso para afil decreto 2616
     C*LLAMAR TRDETA64(PLANUM DETTI2 DETNU2 ZI2616)
     C                   CALL      'TRDETA64'
     C                   PARM                    PLANUM
     C                   PARM                    DETTI2
     C                   PARM                    DETNU2
     C                   PARM                    ZI2616
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C* Leer afiliado y cuenta
     C*EJECUTAR M14020
     C                   EXSR      M14020
     C* Per.planilla >= Per.reforma
     C*SI PLAPER >  ZPEREF
     C     PLAPER        IFGT      ZPEREF
     C* Período procesar F.S.
     C*PASAR ZPERFS PLAPER
     C                   MOVEL     PLAPER        ZPERFS
     C* IBC del afiliado
     C*MOVER ZIBCAF DETVA7
     C                   Z-ADD     DETVA7        ZIBCAF
     C* Retorna FGPM Y SFSP
     C*EJECUTAR M77000
     C                   EXSR      M77000
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DETARC no disponible - M73100'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(131)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*LIMPIAR ZTOCO2
     C                   CLEAR                   ZTOCO2
     C* Busqueda DETA53 plan, pag, sec
     C*PASAR ZOPCI2 '2'
     C                   MOVEL     '2'           ZOPCI2
     C*LLAMAR TRFGPM50 (DETNU3 DETPAG DETSEC ZFGPMP ZOPCI2)
     C                   CALL      'TRFGPM50'
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    ZFGPMP
     C                   PARM                    ZOPCI2
     C* Total FGPM
     C*MOVER ZCOTFG ZFGPMP
     C                   Z-ADD     ZFGPMP        ZCOTFG
     C*CALCULAR ZTOCO2 = DETCOT - ZTOFGP
     C     DETCOT        SUB       ZTOFGP        ZTOCO2
     C* Total cotización obligatoria
     C*MOVER ZCOTOB ZTOCO2
     C                   Z-ADD     ZTOCO2        ZCOTOB
     C* Cot. voluntaria afiliado
     C*MOVER ZCOTVA DETCO1
     C                   Z-ADD     DETCO1        ZCOTVA
     C* Cot. voluntaria empleador
     C*MOVER ZCOTVE DETCO2
     C                   Z-ADD     DETCO2        ZCOTVE
     C* Rendimientos
     C*MOVER ZRENDI DETV14
     C                   Z-ADD     DETV14        ZRENDI
     C*CALCULAR ZTOCOT = ZCOTOB + ZCOTVA + ZCOTVE + ZCOTFG
     C     ZCOTOB        ADD       ZCOTVA        V$CA1           030 9
     C     V$CA1         ADD       ZCOTVE        V$CA1
     C     V$CA1         ADD       ZCOTFG        ZTOCOT
     C* Procesa depósitos por detalle
     C*EJECUTAR M73120
     C                   EXSR      M73120
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Acreditación rezago plan. traspaso no actua
     C                   CLEAR                   ZERROR
     C     $HIL(132)     CAT       ZIDENA:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* Acumula valores cotizaciones
     C*EJECUTAR M14085
     C                   EXSR      M14085
     C*RECUPERARD REZARC (REZNRO REZNR1 REZNR2)
     C     LL$177        KLIST
     C                   KFLD                    REZNRO
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$177        CHAIN     REZARC                             7694
     C                   MOVE      *IN94         I$RND
     C     *IN76         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   REZREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Estado temp. antes de acreditar
     C*SI REZEST = 'COP'
     C     REZEST        IFEQ      'COP'
     C* Valor retención
     C*MOVER REZVAL MOVRET
     C                   Z-ADD     MOVRET        REZVAL
     C* Fecha fondo último estado
     C*PASAR REZFE2 HISFE3
     C                   MOVEL     HISFE3        REZFE2
     C* Estado acreditado
     C*PASAR REZEST 'ACR'
     C                   MOVEL     'ACR'         REZEST
     C*
     C* Agregar modificaciones a planillas en MODAR3
     C* Tipo registro : Rezagos
     C*MOVER ZTMOPL 1
     C                   Z-ADD     1             ZTMOPL
     C* Adicionar modificac. a planillas
     C*EJECUTAR M00200
     C                   EXSR      M00200
     C*
     C*GRABAR REZARC
     C     *IN76         IFEQ      '0'
     C                   UPDATE    REZREG                               94
     C                   ELSE
     C                   WRITE     REZREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C*CALCULAR ZVALRE = (REZCOT+REZCO1+REZCO2+REZCO4+REZINT) + (REZIN9+
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     REZIN9        ADD       REZVA1        V$CA2           030 9
     C     V$CA2         SUB       REZDEU        V$CA2
     C     V$CA2         ADD       REZVA3        V$CA2
     C     V$CA1         ADD       V$CA2         ZVALRE
     C*PASAR ZSIGNO '-'
     C                   MOVEL     '-'           ZSIGNO
     C*LLAMAR TRINCE65(REZNRO REZNR1 REZNR2 REZNR3 ZVALRE ZSIGNO)
     C                   CALL      'TRINCE65'
     C                   PARM                    REZNRO
     C                   PARM                    REZNR1
     C                   PARM                    REZNR2
     C                   PARM                    REZNR3
     C                   PARM                    ZVALRE
     C                   PARM                    ZSIGNO
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Planilla del rezago
     C*MOVER ZPLARE REZNRO
     C                   MOVE      REZNRO        ZPLARE
     C*OBTENER (1) ZERROR = 'Otro trabajo está procesando el rezago'|| Z
     C                   CLEAR                   ZERROR
     C     $HIL(133)     CAT       ZPLARE:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'REZARC no disponible - M73100'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(134)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR ]= '1'
     C     ZSALIR        IFNE      '1'
     C*PASAR ZREZEM '0'
     C                   MOVEL     '0'           ZREZEM
     C* Generar encabezados e históricos
     C*EJECUTAR M15000
     C                   EXSR      M15000
     C*FIN
     C                   END
     C* Módulo de cesantes
     C*EJECUTAR M00025
     C                   EXSR      M00025
     C*LEER REZARC20
     C                   READ      REZARC20                               79
     C*FIN
     C                   END
     C* Se limpia variable para no sumar 2
     C*LIMPIAR ZTOREN
     C                   CLEAR                   ZTOREN
     C* Eliminar datos int. pla terceros
     C*EJECUTAR M00250
     C                   EXSR      M00250
     C                   ENDSR
     C*==================================================================
     C*==  Procesar depósitos por detalle de rezago - planilla traspa  ==
     C*==                                                              ==
     C*==================================================================
     C     M73120        BEGSR
     C* Posición en el arreglo
     C*MOVER L 1
     C                   Z-ADD     1             L
     C*LIMPIAR ZVRREZ ZCUREZ ZIFSRE ZINTRE ZISFRE ZIFGRE
     C                   CLEAR                   ZVRREZ
     C                   CLEAR                   ZCUREZ
     C                   CLEAR                   ZIFSRE
     C                   CLEAR                   ZINTRE
     C                   CLEAR                   ZISFRE
     C                   CLEAR                   ZIFGRE
     C*LIMPIAR ZINCDE ZGRAMV ZVLRMV ZCUOMV
     C                   CLEAR                   ZINCDE
     C                   CLEAR                   ZGRAMV
     C                   CLEAR                   ZVLRMV
     C                   CLEAR                   ZCUOMV
     C*LIMPIAR ZCTCVE ZVTVVE ZCTCVA ZVTVVA ZFEDEP
     C                   CLEAR                   ZCTCVE
     C                   CLEAR                   ZVTVVE
     C                   CLEAR                   ZCTCVA
     C                   CLEAR                   ZVTVVA
     C                   CLEAR                   ZFEDEP
     C*LIMPIAR ZCUERZ
     C                   CLEAR                   ZCUERZ
     C* Número depósitos procesados
     C*MIENTRAS L < K Y ZSALIR |= '1'
     C     L             DOWLT     K
     C     ZSALIR        ANDNE     '1'
     C*LIMPIAR ZVDFS ZVDIFS ZVDINT ZVDCVA ZVDREN ZVDCO ZVDCVE ZVDAR
     C                   CLEAR                   ZVDFS
     C                   CLEAR                   ZVDIFS
     C                   CLEAR                   ZVDINT
     C                   CLEAR                   ZVDCVA
     C                   CLEAR                   ZVDREN
     C                   CLEAR                   ZVDCO
     C                   CLEAR                   ZVDCVE
     C                   CLEAR                   ZVDAR
     C*LIMPIAR ZCUFS ZCUIFS ZCUINT ZCUCVA ZCUREN ZCUCO ZCUCVE ZCUAR
     C                   CLEAR                   ZCUFS
     C                   CLEAR                   ZCUIFS
     C                   CLEAR                   ZCUINT
     C                   CLEAR                   ZCUCVA
     C                   CLEAR                   ZCUREN
     C                   CLEAR                   ZCUCO
     C                   CLEAR                   ZCUCVE
     C                   CLEAR                   ZCUAR
     C*LIMPIAR ZVDSFS ZVDISF ZVDFGP ZVDIFG ZCUSFS ZCUISF ZCUFGP ZCUIFG
     C                   CLEAR                   ZVDSFS
     C                   CLEAR                   ZVDISF
     C                   CLEAR                   ZVDFGP
     C                   CLEAR                   ZVDIFG
     C                   CLEAR                   ZCUSFS
     C                   CLEAR                   ZCUISF
     C                   CLEAR                   ZCUFGP
     C                   CLEAR                   ZCUIFG
     C*LIMPIAR ZVDIVA ZVDIVE ZVDIAR ZCUIVA ZCUIVE ZCUIAR
     C                   CLEAR                   ZVDIVA
     C                   CLEAR                   ZVDIVE
     C                   CLEAR                   ZVDIAR
     C                   CLEAR                   ZCUIVA
     C                   CLEAR                   ZCUIVE
     C                   CLEAR                   ZCUIAR
     C*LIMPIAR ZOVCO8 ZOVIN2 ZOVV13 ZOVI06 ZOVCOM ZOVVAL ZOVCO7 ZOVC27 Z
     C                   CLEAR                   ZOVCO8
     C                   CLEAR                   ZOVIN2
     C                   CLEAR                   ZOVV13
     C                   CLEAR                   ZOVI06
     C                   CLEAR                   ZOVCOM
     C                   CLEAR                   ZOVVAL
     C                   CLEAR                   ZOVCO7
     C                   CLEAR                   ZOVC27
     C                   CLEAR                   ZOVRET
     C* Distribuir valor
     C*EJECUTAR M14105
     C                   EXSR      M14105
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Generar movimiento
     C*EJECUTAR M51105
     C                   EXSR      M51105
     C*FIN
     C                   END
     C*SUMAR 1 L
     C                   ADD       1             L
     C*FIN
     C                   END
     C* Si tiene detalle aportes voluntarios traspasados
     C*SI ZCTCVE |= 0 O ZVTVVE |= 0 O ZCTCVA |= 0 O ZVTVVA |= 0
     C     ZCTCVE        IFNE      0
     C     ZVTVVE        ORNE      0
     C     ZCTCVA        ORNE      0
     C     ZVTVVA        ORNE      0
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Acred. aportes vol. plan. traspaso no actua
     C                   CLEAR                   ZERROR
     C     $HIL(135)     CAT       ZIDENA:1      ZERROR
     C* Imprimir error
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*GRABAR DETARC
     C     *IN49         IFEQ      '0'
     C                   UPDATE    DETREG                               94
     C                   ELSE
     C                   WRITE     DETREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C* Crear registro de aporte voluntario
     C* Indicador tipo acreditación
     C*PASAR ZINACR '2'
     C                   MOVEL     '2'           ZINACR
     C* Acreditación aporte voluntario
     C*EJECUTAR M00210
     C                   EXSR      M00210
     C*RECUPERARD CUEARC (MOVCO4 ZFONDO)
     C     LL$178        KLIST
     C                   KFLD                    MOVCO4
     C                   KFLD                    ZFONDO
     C     LL$178        CHAIN     CUEARC                             4594
     C                   MOVE      *IN94         I$RND
     C     *IN45         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   CUEREG
     C                   END
     C*SI RND
     C     I$RND         IFEQ      '1'
     C*MOVER ZPLAER PLANUM
     C                   MOVE      PLANUM        ZPLAER
     C*MOVER ZAFIIN MOVCO4
     C                   CLEAR                   ZAFIIN
     C                   MOVE      MOVCO4        ZAFIIN
     C*OBTENER (1) ZERROR = 'CUEARC no disponible - M73120' || ZPLAER ||
     C                   CLEAR                   H$1
     C     $HIL(136)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C* Imprimir error
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*SINO
     C                   ELSE
     C* Indicador de error
     C*SI ZINDER = '1'
     C     ZINDER        IFEQ      '1'
     C* Mensaje de error
     C*PASAR ZERROR ZERRET
     C                   CLEAR                   ZERROR
     C                   MOVEL     ZERRET        ZERROR
     C* Imprimir error
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*SINO
     C                   ELSE
     C* Retención contingente
     C*SUMAR MOVRET ZVRRET
     C                   ADD       MOVRET        ZVRRET
     C* Saldo retención conting
     C*SUMAR MOVRET CUESAL
     C                   ADD       MOVRET        CUESAL
     C*INICIARI DETARC(DETNUM DETNU3 DETPAG DETSEC)
     C     LL$179        KLIST
     C                   KFLD                    DETNUM
     C                   KFLD                    DETNU3
     C                   KFLD                    DETPAG
     C                   KFLD                    DETSEC
     C     LL$179        SETLL     DETARC                                 49
     C     *IN49         IFEQ      '1'
     C                   MOVE      '0'           *IN49
     C                   ELSE
     C                   MOVE      '1'           *IN49
     C                   END
     C*SI ERE(DETARC)
     C     *IN49         IFEQ      '0'
     C*LEER DETARC
     C                   READ      DETARC                                 49
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Calcular totales x concepto - acred. de rezagos rev. mvto   ==
     C*==                                                              ==
     C*==================================================================
     C     M74000        BEGSR
     C*LIMPIAR ZTOCO ZTOCVA ZTOCVE ZTOFS ZTOAR ZINDPA ZTOSFS ZTOFGP
     C                   CLEAR                   ZTOCO
     C                   CLEAR                   ZTOCVA
     C                   CLEAR                   ZTOCVE
     C                   CLEAR                   ZTOFS
     C                   CLEAR                   ZTOAR
     C                   CLEAR                   ZINDPA
     C                   CLEAR                   ZTOSFS
     C                   CLEAR                   ZTOFGP
     C*LIMPIAR ZES13P ZCODEE ZTARD ZTARPG ZIGUAR ZTARAC ZAFSP
     C                   CLEAR                   ZES13P
     C                   CLEAR                   ZCODEE
     C                   CLEAR                   ZTARD
     C                   CLEAR                   ZTARPG
     C                   CLEAR                   ZIGUAR
     C                   CLEAR                   ZTARAC
     C                   CLEAR                   ZAFSP
     C* Arreglo pesos x depositos - acr. rezagos
     C*LIMPIAR ZAR$RE[]
     C                   CLEAR                   $X
     C* Arreglo cuotas x depósitos - acr. rezagos
     C*LIMPIAR ZARCRE[]
     C                   CLEAR                   $Y
     C* Arreglo fechas depositos - acr. rezagos
     C*LIMPIAR ZARFRE[]
     C                   CLEAR                   $Z
     C*RECUPERARD REZARC (REZNRO REZNR1 REZNR2)
     C     LL$180        KLIST
     C                   KFLD                    REZNRO
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$180        CHAIN     REZARC                             7694
     C                   MOVE      *IN94         I$RND
     C     *IN76         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   REZREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SI REZEST <> 'FIN'
     C     REZEST        IFNE      'FIN'
     C* Planilla del rezago
     C*MOVER ZPLARE REZNRO
     C                   MOVE      REZNRO        ZPLARE
     C*OBTENER (1) ZERROR = 'Otro trabajo está procesando el rezago'|| Z
     C                   CLEAR                   ZERROR
     C     $HIL(137)     CAT       ZPLARE:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*SINO
     C                   ELSE
     C* Estado temporal del rezago
     C*PASAR REZEST 'COP'
     C                   MOVEL     'COP'         REZEST
     C*GRABAR REZARC
     C     *IN76         IFEQ      '0'
     C                   UPDATE    REZREG                               94
     C                   ELSE
     C                   WRITE     REZREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*COMPLETAR
     C     REZNR2        COMMIT                                         94
     C                   MOVE      *IN94         I$NFT
     C*RECUPERARD (N) DETARC (PLANU3 PLANUM REZNR1 REZNR2)
     C     LL$181        KLIST
     C                   KFLD                    PLANU3
     C                   KFLD                    PLANUM
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$181        CHAIN     DETARC                             4994
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL
     C+  INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC, PLAARC WHERE
     C+  DETNU3 = PLANUM AND
     C+  PLANU1 = :REZNRO AND
     C+  DETPAG = :REZNR1 AND
     C+  DETSEC = :REZNR2
     C/END-EXEC
     C* Salario reportado
     C*MOVER DETSAL REZREM
     C                   Z-ADD     REZREM        DETSAL
     C* Cotizac. oblig.
     C*MOVER DETCOT REZCOT
     C                   Z-ADD     REZCOT        DETCOT
     C* C.V.A.
     C*MOVER DETCO1 REZCO1
     C                   Z-ADD     REZCO1        DETCO1
     C* C.V.E.
     C*MOVER DETCO2 REZCO2
     C                   Z-ADD     REZCO2        DETCO2
     C* F.S.
     C*MOVER DETCTA REZCO4
     C                   Z-ADD     REZCO4        DETCTA
     C* Salario calculado
     C*MOVER DETVA7 REZSA1
     C                   Z-ADD     REZSA1        DETVA7
     C* Tarifa alto riesgo
     C*MOVER DETTAR REZTAR
     C                   Z-ADD     REZTAR        DETTAR
     C* Tipo de rezago
     C*PASAR DETIN4 REZTI3
     C                   MOVEL     REZTI3        DETIN4
     C* Actualizar Interno afiliado forzoso
     C*EJECUTAR M00130
     C                   EXSR      M00130
     C* Verifica detalle fusion
     C*EJECUTAR M00011
     C                   EXSR      M00011
     C* Manejo de novedades vector
     C*EJECUTAR M14009
     C                   EXSR      M14009
     C*SI DETTA1<>3 Y REZTI7='09' O DETTA1<>3 Y REZTI7='10'
     C     DETTA1        IFNE      3
     C     REZTI7        ANDEQ     '09'
     C     DETTA1        ORNE      3
     C     REZTI7        ANDEQ     '10'
     C*PASAR ZREZ3X 'S'
     C                   MOVEL     'S'           ZREZ3X
     C*F QGRAALD (ZREZ3X 746 1)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZREZ3X        PARM      ZREZ3X        F$2Z1           250
     C                   PARM      746           F$2Z2             4 0
     C                   PARM      1             F$2Z3             4 0
     C*PASAR ZIGUAR ' '
     C                   MOVEL     ' '           ZIGUAR
     C*LLAMAR RPHDEC558X(DETNU3 DETPAG DETSEC REZPER DETSAL DETCOT ZES13
     C                   MOVEL     'RPHDEC55'    H$L10            10
     C                   MOVE      '8X'          H$L10
     C                   CALL      H$L10
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    REZPER
     C                   PARM                    DETSAL
     C                   PARM                    DETCOT
     C                   PARM                    ZES13P
     C                   PARM                    ZCODEE
     C                   PARM                    ZNJ
     C                   PARM                    ZTARD
     C                   PARM                    ZTARPG
     C                   PARM                    ZIGUAR
     C                   PARM                    ZTARAC
     C                   PARM                    ZAFSP
     C*SI ZCODEE='321'
     C     ZCODEE        IFEQ      '321'
     C*OBTENER (1) ZERROR = 'Detalle decreto 376 sin tarifa especial'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(138)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* proceso para afil decreto 2616
     C*LLAMAR TRDETA64(PLANUM DETTI2 DETNU2 ZI2616)
     C                   CALL      'TRDETA64'
     C                   PARM                    PLANUM
     C                   PARM                    DETTI2
     C                   PARM                    DETNU2
     C                   PARM                    ZI2616
     C*PASAR ZDETAL '1'
     C                   MOVEL     '1'           ZDETAL
     C* Calcular valor cotización
     C*EJECUTAR M11100
     C                   EXSR      M11100
     C*SI ZVAESP = '1' O ZTPVAE = '1'
     C     ZVAESP        IFEQ      '1'
     C     ZTPVAE        OREQ      '1'
     C* acum int rez pl O
     C*SUMAR REZINT ZINRZO
     C                   ADD       REZINT        ZINRZO
     C* acum int rezagos PL O
     C*SUMAR REZIN9 ZIFRZO
     C                   ADD       REZIN9        ZIFRZO
     C*FIN
     C                   END
     C* Planilla de tercero
     C*SI PLATIP = '07'
     C     PLATIP        IFEQ      '07'
     C* Grabar cotizaciones detalle
     C*PASAR ZIND '0'
     C                   MOVEL     '0'           ZIND
     C* Identificación del afiliado
     C*MOVER ZID DETNU2
     C                   Z-ADD     DETNU2        ZID
     C* Intereses por concepto
     C*EJECUTAR M12207
     C                   EXSR      M12207
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'DETARC no disponible - M74000'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(139)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'REZARC no disponible - M74000'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(140)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR <> '1'
     C     ZSALIR        IFNE      '1'
     C* Pago adelantado afil.indepen.
     C*SI ZINDPA = '1'
     C     ZINDPA        IFEQ      '1'
     C*LIMPIAR ZTOCO ZTOCVA ZTOCVE ZTOFS ZTOAR ZTOSFS ZTOFGP
     C                   CLEAR                   ZTOCO
     C                   CLEAR                   ZTOCVA
     C                   CLEAR                   ZTOCVE
     C                   CLEAR                   ZTOFS
     C                   CLEAR                   ZTOAR
     C                   CLEAR                   ZTOSFS
     C                   CLEAR                   ZTOFGP
     C*SINO
     C                   ELSE
     C* Total C.O.
     C*SUMAR ZCOTOB ZTOCO
     C                   ADD       ZCOTOB        ZTOCO
     C* Total alto riesgo
     C*SUMAR ZCOTAR ZTOAR
     C                   ADD       ZCOTAR        ZTOAR
     C* Total C.V.A.
     C*SUMAR ZCOTVA ZTOCVA
     C                   ADD       ZCOTVA        ZTOCVA
     C* Total C.V.E.
     C*SUMAR ZCOTVE ZTOCVE
     C                   ADD       ZCOTVE        ZTOCVE
     C* Total F.S.
     C*SUMAR ZCOTFS ZTOFS
     C                   ADD       ZCOTFS        ZTOFS
     C* Total SFSP
     C*SUMAR ZCOTSF ZTOSFS
     C                   ADD       ZCOTSF        ZTOSFS
     C* Total FGPM
     C*SUMAR ZCOTFG ZTOFGP
     C                   ADD       ZCOTFG        ZTOFGP
     C*FIN
     C                   END
     C*CALCULAR ZVLRRZ = REZCOT+REZCO1+REZCO2+REZCO4+REZVA1+REZINT+REZIN
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZVA1        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     V$CA1         ADD       REZIN9        V$CA1
     C     V$CA1         SUB       REZDEU        V$CA1
     C     V$CA1         ADD       REZVA3        ZVLRRZ
     C*CALCULAR ZCUORZ = REZCUO + REZCU2
     C     REZCUO        ADD       REZCU2        ZCUORZ
     C*SI ZEXFSP = 'S'
     C     ZEXFSP        IFEQ      'S'
     C*CALCULAR ZVLRRZ = ZVLRRZ - (ZZAFSP+ZVZFSP+ZVIFSP+ZVISUB)
     C     ZZAFSP        ADD       ZVZFSP        V$CA1           030 9
     C     V$CA1         ADD       ZVIFSP        V$CA1
     C     V$CA1         ADD       ZVISUB        V$CA1
     C     ZVLRRZ        SUB       V$CA1         ZVLRRZ
     C*CALCULAR ZCUORZ = ZCUORZ - (ZZUFSP+ZCSFSP+ZCIFSP+ZCISUB)
     C     ZZUFSP        ADD       ZCSFSP        V$CA1           030 9
     C     V$CA1         ADD       ZCIFSP        V$CA1
     C     V$CA1         ADD       ZCISUB        V$CA1
     C     ZCUORZ        SUB       V$CA1         ZCUORZ
     C*PASAR ZFSPAR '1'
     C                   MOVEL     '1'           ZFSPAR
     C*FIN
     C                   END
     C*CALCULAR ZAR$RE[L] = ZAR$RE[L] + ZVLRRZ
     C     $X(L)         ADD       ZVLRRZ        $X(L)
     C*CALCULAR ZARCRE[L] = ZARCRE[L] + ZCUORZ
     C     $Y(L)         ADD       ZCUORZ        $Y(L)
     C*ASIGNARA ZARFRE[L] ZFECD1
     C                   MOVEA     ZFECD1        $Z(L)
     C* Valor total depòsito
     C*SUMAR ZVLRRZ ZTVDEP
     C                   ADD       ZVLRRZ        ZTVDEP
     C* Cuotas depòsito
     C*SUMAR ZCUORZ ZTCDEP
     C                   ADD       ZCUORZ        ZTCDEP
     C* Saldo cotización obligatoria
     C*MOVER ZSACO  ZTOCO
     C                   Z-ADD     ZTOCO         ZSACO
     C* Saldo alto riesgo
     C*MOVER ZSAAR  ZTOAR
     C                   Z-ADD     ZTOAR         ZSAAR
     C* Saldo voluntaria afiliado
     C*MOVER ZSACVA ZTOCVA
     C                   Z-ADD     ZTOCVA        ZSACVA
     C* Saldo voluntaria empleador
     C*MOVER ZSACVE ZTOCVE
     C                   Z-ADD     ZTOCVE        ZSACVE
     C* Saldo fondo de solidaridad
     C*MOVER ZSAFS  ZTOFS
     C                   Z-ADD     ZTOFS         ZSAFS
     C* Saldo SFSP
     C*MOVER ZSASFS ZTOSFS
     C                   Z-ADD     ZTOSFS        ZSASFS
     C* Saldo FGPM
     C*MOVER ZSAFGP ZTOFGP
     C                   Z-ADD     ZTOFGP        ZSAFGP
     C*CALCULAR ZSACOT = ZTOCO + ZTOAR + ZTOCVA + ZTOCVE
     C     ZTOCO         ADD       ZTOAR         V$CA1           030 9
     C     V$CA1         ADD       ZTOCVA        V$CA1
     C     V$CA1         ADD       ZTOCVE        ZSACOT
     C* Total cotizaciones
     C*MOVER ZTOTCO ZSACOT
     C                   Z-ADD     ZSACOT        ZTOTCO
     C* Total calculado de los detalles
     C*CALCULAR ZTOCAL = ZTOTCO + ZTOFS + ZTOSFS + ZTOFGP
     C     ZTOTCO        ADD       ZTOFS         V$CA1           030 9
     C     V$CA1         ADD       ZTOSFS        V$CA1
     C     V$CA1         ADD       ZTOFGP        ZTOCAL
     C*SUMAR 1 L
     C                   ADD       1             L
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesar detalles de rezagos por rev. de mvto               ==
     C*==                                                              ==
     C*==================================================================
     C     M74100        BEGSR
     C*LIMPIAR ZDITRA ZDILIC
     C                   CLEAR                   ZDITRA
     C                   CLEAR                   ZDILIC
     C*SQL
     C/EXEC SQL
     C+  SELECT DETDRT, DETDRL
     C+  INTO :ZDITRA, :ZDILIC
     C+  FROM SBDETARC, PLAARC WHERE
     C+  DETNU3 = PLANUM AND
     C+  PLANU1 = :REZNRO AND
     C+  DETPAG = :REZNR1 AND
     C+  DETSEC = :REZNR2
     C/END-EXEC
     C*CALCULAR ZSALDO = ZSACO+ZSAAR+ZSACVA+ZSACVE+ZSAFS+ZSAINT+ZSAIFS+Z
     C     ZSACO         ADD       ZSAAR         V$CA1           030 9
     C     V$CA1         ADD       ZSACVA        V$CA1
     C     V$CA1         ADD       ZSACVE        V$CA1
     C     V$CA1         ADD       ZSAFS         V$CA1
     C     V$CA1         ADD       ZSAINT        V$CA1
     C     V$CA1         ADD       ZSAIFS        V$CA1
     C     V$CA1         ADD       ZSAFGP        V$CA1
     C     V$CA1         ADD       ZSAIFG        V$CA1
     C     V$CA1         ADD       ZSASFS        V$CA1
     C     V$CA1         ADD       ZSAISF        V$CA1
     C     V$CA1         ADD       ZSICVA        V$CA1
     C     V$CA1         ADD       ZSICVE        V$CA1
     C     V$CA1         ADD       ZSINAR        ZSALDO
     C*SI ZSALDO |= *CERO O ZSALCA |= *CERO
     C     ZSALDO        IFNE      *ZERO
     C     ZSALCA        ORNE      *ZERO
     C* Indicador de error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Procesar pagos adelantados
     C*EJECUTAR M13000
     C                   EXSR      M13000
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Limpiar variables
     C*EJECUTAR M14010
     C                   EXSR      M14010
     C* Leer afiliado y cuenta
     C*EJECUTAR M14020
     C                   EXSR      M14020
     C*LIMPIAR ZES13P ZCODEE ZTARD ZTARPG ZIGUAR ZTARAC ZAFSP
     C                   CLEAR                   ZES13P
     C                   CLEAR                   ZCODEE
     C                   CLEAR                   ZTARD
     C                   CLEAR                   ZTARPG
     C                   CLEAR                   ZIGUAR
     C                   CLEAR                   ZTARAC
     C                   CLEAR                   ZAFSP
     C*SI DETTA1<>3 Y REZTI7='09' O DETTA1<>3 Y REZTI7='10'
     C     DETTA1        IFNE      3
     C     REZTI7        ANDEQ     '09'
     C     DETTA1        ORNE      3
     C     REZTI7        ANDEQ     '10'
     C*LLAMAR RPHDEC558C(REZPER ZESDE1)
     C                   MOVEL     'RPHDEC55'    H$L10            10
     C                   MOVE      '8C'          H$L10
     C                   CALL      H$L10
     C                   PARM                    REZPER
     C                   PARM                    ZESDE1
     C*SI ZESDE1='S'
     C     ZESDE1        IFEQ      'S'
     C*PASAR ZREZ3X 'S'
     C                   MOVEL     'S'           ZREZ3X
     C*F QGRAALD (ZREZ3X 746 1)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZREZ3X        PARM      ZREZ3X        F$2Z1           250
     C                   PARM      746           F$2Z2             4 0
     C                   PARM      1             F$2Z3             4 0
     C*PASAR ZIGUAR 'S'
     C                   MOVEL     'S'           ZIGUAR
     C*LLAMAR RPHDEC558X(DETNU3 DETPAG DETSEC PLAPER DETSAL DETCOT ZES13
     C                   MOVEL     'RPHDEC55'    H$L10            10
     C                   MOVE      '8X'          H$L10
     C                   CALL      H$L10
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    PLAPER
     C                   PARM                    DETSAL
     C                   PARM                    DETCOT
     C                   PARM                    ZES13P
     C                   PARM                    ZCODEE
     C                   PARM                    ZNJ
     C                   PARM                    ZTARD
     C                   PARM                    ZTARPG
     C                   PARM                    ZIGUAR
     C                   PARM                    ZTARAC
     C                   PARM                    ZAFSP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*PASAR ZDETAL '1'
     C                   MOVEL     '1'           ZDETAL
     C* Calcular valor cotización
     C*EJECUTAR M11100
     C                   EXSR      M11100
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Valida pago adel. y plan indep.
     C*EJECUTAR M74110
     C                   EXSR      M74110
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*RECUPERARD REZARC (REZNRO REZNR1 REZNR2)
     C     LL$182        KLIST
     C                   KFLD                    REZNRO
     C                   KFLD                    REZNR1
     C                   KFLD                    REZNR2
     C     LL$182        CHAIN     REZARC                             7694
     C                   MOVE      *IN94         I$RND
     C     *IN76         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   REZREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Estado temp. antes de acreditar
     C*SI REZEST = 'COP'
     C     REZEST        IFEQ      'COP'
     C* Valor retención
     C*MOVER REZVAL DETVA8
     C                   Z-ADD     DETVA8        REZVAL
     C* Fecha fondo último estado
     C*PASAR REZFE2 HISFE3
     C                   MOVEL     HISFE3        REZFE2
     C* Estado acreditado
     C*PASAR REZEST 'ACR'
     C                   MOVEL     'ACR'         REZEST
     C*
     C* Agregar modificaciones a planillas en MODAR3
     C* Tipo registro : Rezagos
     C*MOVER ZTMOPL 1
     C                   Z-ADD     1             ZTMOPL
     C* Adicionar modificacion a planillas
     C*EJECUTAR M00200
     C                   EXSR      M00200
     C*
     C*GRABAR REZARC
     C     *IN76         IFEQ      '0'
     C                   UPDATE    REZREG                               94
     C                   ELSE
     C                   WRITE     REZREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*
     C* SAE
     C*SI ZREGCE = 1
     C     ZREGCE        IFEQ      1
     C*CALCULAR ZVALRE = (REZCOT+REZCO1+REZCO2+REZCO4+REZINT) + (REZIN9+
     C     REZCOT        ADD       REZCO1        V$CA1           030 9
     C     V$CA1         ADD       REZCO2        V$CA1
     C     V$CA1         ADD       REZCO4        V$CA1
     C     V$CA1         ADD       REZINT        V$CA1
     C     REZIN9        ADD       REZVA1        V$CA2           030 9
     C     V$CA2         SUB       REZDEU        V$CA2
     C     V$CA2         ADD       REZVA3        V$CA2
     C     V$CA1         ADD       V$CA2         ZVALRE
     C*PASAR ZSIGNO '-'
     C                   MOVEL     '-'           ZSIGNO
     C*LLAMAR TRINCE65(REZNRO REZNR1 REZNR2 REZNR3 ZVALRE ZSIGNO)
     C                   CALL      'TRINCE65'
     C                   PARM                    REZNRO
     C                   PARM                    REZNR1
     C                   PARM                    REZNR2
     C                   PARM                    REZNR3
     C                   PARM                    ZVALRE
     C                   PARM                    ZSIGNO
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Planilla del rezago
     C*MOVER ZPLARE REZNRO
     C                   MOVE      REZNRO        ZPLARE
     C*OBTENER (1) ZERROR = 'Otro trabajo está procesando el rezago'|| Z
     C                   CLEAR                   ZERROR
     C     $HIL(141)     CAT       ZPLARE:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'REZARC no disponible - M74100'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(142)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI ZSALIR ]= '1'
     C     ZSALIR        IFNE      '1'
     C*PASAR ZREZEM '0'
     C                   MOVEL     '0'           ZREZEM
     C* Generar encabezados e históricos
     C*EJECUTAR M15000
     C                   EXSR      M15000
     C* Anulación deudas por delta
     C*EJECUTAR M15550
     C                   EXSR      M15550
     C* Periodo ant. instalaciòn cesan.
     C*SI PLAPER < ZPEVIG
     C     PLAPER        IFLT      ZPEVIG
     C* Cesantes COLMENA
     C*EJECUTAR M14095
     C                   EXSR      M14095
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Módulo de cesantes
     C*EJECUTAR M00025
     C                   EXSR      M00025
     C* Eliminar datos int. pla terceros
     C*EJECUTAR M00250
     C                   EXSR      M00250
     C                   ENDSR
     C*==================================================================
     C*==  Valida pago adelantado y planilla voluntario                ==
     C*==                                                              ==
     C*==================================================================
     C     M74110        BEGSR
     C* Si pago adel. y plan. voluntario
     C*SI ZINDPA = '1' Y PLATIP = '03' O ZINDPA = '1' Y PLATIP = '02' Y
     C     ZINDPA        IFEQ      '1'
     C     PLATIP        ANDEQ     '03'
     C     ZINDPA        OREQ      '1'
     C     PLATIP        ANDEQ     '02'
     C     PLAPER        ANDLT     ZPEREF
     C*SINO
     C                   ELSE
     C* Rendimientos
     C*MOVER ZRENDI DETV14
     C                   Z-ADD     DETV14        ZRENDI
     C*CALCULAR ZTOCOT = ZCOTAR + ZCOTOB + ZCOTVA + ZCOTVE
     C     ZCOTAR        ADD       ZCOTOB        V$CA1           030 9
     C     V$CA1         ADD       ZCOTVA        V$CA1
     C     V$CA1         ADD       ZCOTVE        ZTOCOT
     C*SI ZTOCOT = 0 Y ZRENDI = 0 Y ZNOSLN = 'X'
     C     ZTOCOT        IFEQ      0
     C     ZRENDI        ANDEQ     0
     C     ZNOSLN        ANDEQ     'X'
     C* Valores subsistencia
     C*LIMPIAR ZVSFSP ZVFGPM
     C                   CLEAR                   ZVSFSP
     C                   CLEAR                   ZVFGPM
     C* Genera movimiento de licencia
     C*EJECUTAR M14030
     C                   EXSR      M14030
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C* Período del rezago
     C*PASAR ZPERCO REZPER
     C                   MOVEL     REZPER        ZPERCO
     C*SINO
     C                   ELSE
     C* Período de la planilla
     C*PASAR ZPERCO PLAPER
     C                   MOVEL     PLAPER        ZPERCO
     C*FIN
     C                   END
     C* Tipo de planilla
     C*PASAR ZTIPLA PLATIP
     C                   MOVEL     PLATIP        ZTIPLA
     C* Actualiza relación afil-empl.
     C*EJECUTAR M14040
     C                   EXSR      M14040
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Anula deudas presuntas
     C*EJECUTAR M14050
     C                   EXSR      M14050
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Procesa depósitos por detalle
     C*EJECUTAR M71120
     C                   EXSR      M71120
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Acreditación rezago de reversión no actuali
     C                   CLEAR                   ZERROR
     C     $HIL(143)     CAT       ZIDENA:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C* Período del rezago
     C*PASAR ZPERCO REZPER
     C                   MOVEL     REZPER        ZPERCO
     C*SINO
     C                   ELSE
     C* Período de la planilla
     C*PASAR ZPERCO PLAPER
     C                   MOVEL     PLAPER        ZPERCO
     C*FIN
     C                   END
     C* Tipo de planilla
     C*PASAR ZTIPLA PLATIP
     C                   MOVEL     PLATIP        ZTIPLA
     C* Actualiza relación afil-empl.
     C*EJECUTAR M14040
     C                   EXSR      M14040
     C* No hay error
     C*SI ZSALIR |= '1'
     C     ZSALIR        IFNE      '1'
     C* Anula deudas presuntas
     C*EJECUTAR M14050
     C                   EXSR      M14050
     C* Genera registro comisiones
     C*EJECUTAR M14070
     C                   EXSR      M14070
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C* Período del rezago
     C*PASAR ZPERCO REZPER
     C                   MOVEL     REZPER        ZPERCO
     C*SINO
     C                   ELSE
     C* Período de la planilla
     C*PASAR ZPERCO PLAPER
     C                   MOVEL     PLAPER        ZPERCO
     C*FIN
     C                   END
     C* Actualiza días cotizados
     C*EJECUTAR M14075
     C                   EXSR      M14075
     C* Verifica si hay deuda
     C*EJECUTAR M14080
     C                   EXSR      M14080
     C* Acumula valores cotizaciones
     C*EJECUTAR M14085
     C                   EXSR      M14085
     C* Planilla de traspasos
     C*SI PLAPER < ZPEVIG
     C     PLAPER        IFLT      ZPEVIG
     C* Reversar comisión cesantes
     C*EJECUTAR M14090
     C                   EXSR      M14090
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Generación pago adelantado independientes                   ==
     C*==                                                              ==
     C*==================================================================
     C     M74120        BEGSR
     C*RECUPERARD PAGARC (PAGNUM)
     C     PAGNUM        CHAIN     PAGARC                             7094
     C                   MOVE      *IN94         I$RND
     C     *IN70         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   PAGREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Fecha último estado
     C*PASAR PAGFE1 ZFESIS
     C                   MOVEL     ZFESIS        PAGFE1
     C* Valor pago adelantado
     C*MOVER PAGVA6 PAGSA3
     C                   Z-ADD     PAGSA3        PAGVA6
     C* Saldo pago adelantado
     C*MOVER PAGSAL PAGSA3
     C                   Z-ADD     PAGSA3        PAGSAL
     C* Saldo cuotas pago adelantado
     C*MOVER PAGCU3 PAGSA4
     C                   Z-ADD     PAGSA4        PAGCU3
     C* Saldo P.E. empleador
     C*MOVER PAGSA3 *CERO
     C                   MOVE      *ZERO         PAGSA3
     C* Saldo cuota P.E. empleador
     C*MOVER PAGSA4 *CERO
     C                   MOVE      *ZERO         PAGSA4
     C* Fecha fondo generación
     C*PASAR PAGFE2 HISFE3
     C                   MOVEL     HISFE3        PAGFE2
     C* Estado
     C*PASAR PAGEST 'RES'
     C                   MOVEL     'RES'         PAGEST
     C*
     C* Agregar modificaciones a planillas en MODAR3
     C* Tipo registro : Pagos en exceso
     C*MOVER ZTMOPL 2
     C                   Z-ADD     2             ZTMOPL
     C* Adicionar modificaciones a planillas
     C*EJECUTAR M00200
     C                   EXSR      M00200
     C*
     C*SINO
     C                   ELSE
     C*OBTENER (1) ZERROR = 'PAGARC no disponible - M74120'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(144)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*GRABAR PAGARC
     C     *IN70         IFEQ      '0'
     C                   UPDATE    PAGREG                               94
     C                   ELSE
     C                   WRITE     PAGREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C                   ENDSR
     C*==================================================================
     C*==  Cobra o reversa la comisión de cesantes                     ==
     C*==                                                              ==
     C*==================================================================
     C     M74140        BEGSR
     C*PASAR ZENTID 'B'
     C                   MOVEL     'B'           ZENTID
     C* Limpia var. de trabajo
     C*LIMPIAR ZALFA8 ZALFA5 ZINERE ZFITIP
     C                   CLEAR                   ZALFA8
     C                   CLEAR                   ZALFA5
     C                   CLEAR                   ZINERE
     C                   CLEAR                   ZFITIP
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME3 ZNUMI3 ZNUME2
     C                   CLEAR                   ZNUME3
     C                   CLEAR                   ZNUMI3
     C                   CLEAR                   ZNUME2
     C* Limpia var. de trabajo
     C*LIMPIAR ZNUME9 ZNUMI9 ZNUMR9 ZNUM21 ZPEFIN ZALF15 ZALFA1
     C                   CLEAR                   ZNUME9
     C                   CLEAR                   ZNUMI9
     C                   CLEAR                   ZNUMR9
     C                   CLEAR                   ZNUM21
     C                   CLEAR                   ZPEFIN
     C                   CLEAR                   ZALF15
     C                   CLEAR                   ZALFA1
     C* Lectura parámetros acreditador
     C*EJECUTAR M00018
     C                   EXSR      M00018
     C*
     C*LIMPIAR ZRAINI ZRAFIN
     C                   CLEAR                   ZRAINI
     C                   CLEAR                   ZRAFIN
     C* Valor temporal de CUENUM
     C*MOVER ZCUENU CUENUM
     C                   Z-ADD     CUENUM        ZCUENU
     C* Código fondo moderado
     C*PASAR CUEC17 ZFONDO
     C                   MOVEL     ZFONDO        CUEC17
     C*RECUPERARD CUEARC(CUENUM CUEC17)
     C     LL$183        KLIST
     C                   KFLD                    CUENUM
     C                   KFLD                    CUEC17
     C     LL$183        CHAIN     CUEARC                             4594
     C                   MOVE      *IN94         I$RND
     C     *IN45         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   CUEREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Libera el registro
     C*GRABAR CUEARC
     C     *IN45         IFEQ      '0'
     C                   UPDATE    CUEREG                               94
     C                   ELSE
     C                   WRITE     CUEREG                               94
     C                   END
     C                   MOVE      *IN94         I$DUP
     C*SI DUP
     C     I$DUP         IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Para el cobro de comisión de cesantes'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(145)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*MOVER ZPLAER PLANUM
     C                   MOVE      PLANUM        ZPLAER
     C*MOVER ZAFIIN CUENUM
     C                   CLEAR                   ZAFIIN
     C                   MOVE      CUENUM        ZAFIIN
     C*OBTENER (1) ZERROR = 'CUEARC no disponible - M74140' || ZPLAER ||
     C                   CLEAR                   H$1
     C     $HIL(146)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C* Código interno del afiliado
     C*ASIGNAR ZCOINT AFINUM
     C                   MOVEL     AFINUM        ZCOINT
     C* Identificación del afiliado
     C*ASIGNAR ZAFILA AFIC01
     C                   MOVEL     AFIC01        ZAFILA
     C* # períodos no cotizados afil/ind (alfa)
     C*ASIGNAR ZNUPER ZNUMPE
     C                   MOVEL     ZNUMPE        ZNUPER
     C*PASAR ZCODPR 'PL6'
     C                   MOVEL     'PL6'         ZCODPR
     C* Modo de llamado al proceso
     C*PASAR ZLLAMA 'M'
     C                   MOVEL     'M'           ZLLAMA
     C* Período de cesantes
     C*PASAR ZPERCE ZPERCO
     C                   MOVEL     ZPERCO        ZPERCE
     C* Cobra comisión
     C*SI ZINCOM = 'C'
     C     ZINCOM        IFEQ      'C'
     C* Generación
     C*PASAR ZOPCIO 'G'
     C                   MOVEL     'G'           ZOPCIO
     C*SI ZCOINT <> *BLANCO
     C     ZCOINT        IFNE      *BLANK
     C* Cobro comisión cesantes
     C*LLAMAR TRDQCE53 (ZCOINT ZAFILA ZPERCE ZPEFIN ZOPCIO ZNUPER ZLLAMA
     C                   CALL      'TRDQCE53'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPERCE
     C                   PARM                    ZPEFIN
     C                   PARM                    ZOPCIO
     C                   PARM                    ZNUPER
     C                   PARM                    ZLLAMA
     C                   PARM                    ZFEVIG
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C*FIN
     C                   END
     C*SI ZINDLL = 'A' O ZINDLL = 'R'
     C     ZINDLL        IFEQ      'A'
     C     ZINDLL        OREQ      'R'
     C* Se realizó reversión/cobro
     C*PASAR ZINDLL 'A'
     C                   MOVEL     'A'           ZINDLL
     C*SINO
     C                   ELSE
     C* Se realizó cobro
     C*PASAR ZINDLL 'C'
     C                   MOVEL     'C'           ZINDLL
     C*
     C*FIN
     C                   END
     C*
     C*FIN
     C                   END
     C* Reversa comisión
     C*SI ZINCOM = 'R'
     C     ZINCOM        IFEQ      'R'
     C* Período fecha inicio relación
     C*PASAR ZPEINI ZFECPE
     C                   MOVEL     ZFECPE        ZPEINI
     C* No reporta novedad de ingreso
     C*SI ZNOING <> 'X' O ZNOING = 'X' Y DETIN1 = 'N'
     C     ZNOING        IFNE      'X'
     C     ZNOING        OREQ      'X'
     C     DETIN1        ANDEQ     'N'
     C* Período cotizado
     C*PASAR ZPEINI ZPERCO
     C                   MOVEL     ZPERCO        ZPEINI
     C*FIN
     C                   END
     C* Generación
     C*PASAR ZOPCIO 'G'
     C                   MOVEL     'G'           ZOPCIO
     C*SI ZCOINT <> *BLANCO
     C     ZCOINT        IFNE      *BLANK
     C* Reversar comisión cesantes
     C*LLAMAR TRAFRC59 (ZCOINT ZAFILA ZPEINI ZPEFIN ZFEVIG ZOPCIO ZLLAMA
     C                   CALL      'TRAFRC59'
     C                   PARM                    ZCOINT
     C                   PARM                    ZAFILA
     C                   PARM                    ZPEINI
     C                   PARM                    ZPEFIN
     C                   PARM                    ZFEVIG
     C                   PARM                    ZOPCIO
     C                   PARM                    ZLLAMA
     C                   PARM                    ZCODPR
     C                   PARM                    ZNOMTR
     C                   PARM                    ZNUMTR
     C                   PARM                    ZUSUAR
     C                   PARM                    ZRANDO
     C*FIN
     C                   END
     C*SI ZINDLL = 'A' O ZINDLL = 'C'
     C     ZINDLL        IFEQ      'A'
     C     ZINDLL        OREQ      'C'
     C* Se realizó reversión/cobro
     C*PASAR ZINDLL 'A'
     C                   MOVEL     'A'           ZINDLL
     C*SINO
     C                   ELSE
     C* Se realizó reversión
     C*PASAR ZINDLL 'R'
     C                   MOVEL     'R'           ZINDLL
     C*FIN
     C                   END
     C*SI ZLLAMA = 'E'
     C     ZLLAMA        IFEQ      'E'
     C*PASAR ZERROR 'Error al actualizar el HISAR4, revise spool'
     C                   MOVEL     $HIL(147)     ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Recupera el registro
     C*RECUPERARD CUEARC(ZCUENU ZFONDO)
     C     LL$184        KLIST
     C                   KFLD                    ZCUENU
     C                   KFLD                    ZFONDO
     C     LL$184        CHAIN     CUEARC                             4594
     C                   MOVE      *IN94         I$RND
     C     *IN45         IFEQ      '1'
     C     I$RND         OREQ      '1'
     C     *NOKEY        CLEAR                   CUEREG
     C                   END
     C*SI RED
     C     I$RND         IFEQ      '0'
     C*SINO
     C                   ELSE
     C*MOVER ZPLAER PLANUM
     C                   MOVE      PLANUM        ZPLAER
     C*MOVER ZAFIIN ZCUENU
     C                   CLEAR                   ZAFIIN
     C                   MOVE      ZCUENU        ZAFIIN
     C*OBTENER (1) ZERROR = 'CUEARC no disponible - M74140 (2)' || ZPLAE
     C                   CLEAR                   H$1
     C     $HIL(148)     CAT       ZPLAER:1      H$1             256
     C                   CLEAR                   ZERROR
     C     H$1           CAT       ZAFIIN:1      ZERROR
     C*EJECUTAR M00019
     C                   EXSR      M00019
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Recupera valor y porcentajes de FGPM y FSP                  ==
     C*==                                                              ==
     C*==================================================================
     C     M77000        BEGSR
     C* Tipo afiliado
     C*PASAR ZTAFIL 'A'
     C                   MOVEL     'A'           ZTAFIL
     C*SI ZIBCAF <> *CERO
     C     ZIBCAF        IFNE      *ZERO
     C* Asigna IBC
     C*MOVER ZIBFSP ZIBCAF
     C                   Z-ADD     ZIBCAF        ZIBFSP
     C*LIMPIAR ZDECTO ZCOTBA ZNI ZTI
     C                   CLEAR                   ZDECTO
     C                   CLEAR                   ZCOTBA
     C                   CLEAR                   ZNI
     C                   CLEAR                   ZTI
     C*SI ZDILIC>0 Y PLATIP='01' O ZDILIC>0 Y PLATIP='04'
     C     ZDILIC        IFGT      0
     C     PLATIP        ANDEQ     '01'
     C     ZDILIC        ORGT      0
     C     PLATIP        ANDEQ     '04'
     C* FSP
     C*PASAR INDSOL '1'
     C                   MOVEL     '1'           INDSOL
     C* Retroactivo
     C*SI PLAT03 = '09' O PLAT03 = '11' O PLAT03 = '10' O PLAT03 = '12'
     C     PLAT03        IFEQ      '09'
     C     PLAT03        OREQ      '11'
     C     PLAT03        OREQ      '10'
     C     PLAT03        OREQ      '12'
     C* Si es retroactiva, busca cual es la base:
     C*LIMPIAR ZDTNU3 ZDTPAG ZDTSEC
     C                   CLEAR                   ZDTNU3
     C                   CLEAR                   ZDTPAG
     C                   CLEAR                   ZDTSEC
     C* Consulta RETAR2
     C*PASAR ZOPERA 'C'
     C                   MOVEL     'C'           ZOPERA
     C*LLAMAR TRRETO50 (ZOPERA DETNU3 DETPAG DETSEC ZDTNU3 ZDTPAG ZDTSEC
     C                   CALL      'TRRETO50'
     C                   PARM                    ZOPERA
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    ZDTNU3
     C                   PARM                    ZDTPAG
     C                   PARM                    ZDTSEC
     C*RECUPERAR (N) DETAR302(ZDTNU3 ZDTPAG ZDTSEC)
     C     LL$185        KLIST
     C                   KFLD                    ZDTNU3
     C                   KFLD                    ZDTPAG
     C                   KFLD                    ZDTSEC
     C     LL$185        CHAIN     DETAR302                           39
     C*SI ERE (DETAR302)
     C     *IN39         IFEQ      '0'
     C* Guarda DETCOT de la base
     C*MOVER ZCOTBA DETC06
     C                   Z-ADD     DETC06        ZCOTBA
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Variables para HIPO50
     C*EJECUTAR M00VAR
     C                   EXSR      M00VAR
     C* Para retro envia cotiz base + retro
     C*SUMAR ZCOTBA ZCOT
     C                   ADD       ZCOTBA        ZCOT
     C* ind llama acred
     C*PASAR ZINDER 'A'
     C                   MOVEL     'A'           ZINDER
     C*LLAMAR TRHIPO50(ZPERFS ZDITRA PLATIP PLAT03 ZIBCAF DETTAR EMPTI6
     C                   CALL      'TRHIPO50'
     C                   PARM                    ZPERFS
     C                   PARM                    ZDITRA
     C                   PARM                    PLATIP
     C                   PARM                    PLAT03
     C                   PARM                    ZIBCAF
     C                   PARM                    DETTAR
     C                   PARM                    EMPTI6
     C                   PARM                    INDSOL
     C                   PARM                    ZINDER
     C                   PARM                    ZVLOBL
     C                   PARM                    ZVSFSP
     C                   PARM                    ZVFGPM
     C                   PARM                    ZDILIC
     C                   PARM                    DETS12
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    $$HI51
     C* Retroactivo
     C*SI PLAT03 = '09' O PLAT03 = '11' O PLAT03 = '10' O PLAT03 = '12'
     C     PLAT03        IFEQ      '09'
     C     PLAT03        OREQ      '11'
     C     PLAT03        OREQ      '10'
     C     PLAT03        OREQ      '12'
     C* FGPM TMP Total
     C*MOVER ZVFGPX ZVFGPM
     C                   Z-ADD     ZVFGPM        ZVFGPX
     C* FSP TMP Total
     C*MOVER ZVFSPX ZVSFSP
     C                   Z-ADD     ZVSFSP        ZVFSPX
     C* IBC planilla original
     C*CALCULAR ZIBCAF=ZIBCAF-DETSAL
     C     ZIBCAF        SUB       DETSAL        ZIBCAF
     C*SI ZIBCAF>0
     C     ZIBCAF        IFGT      0
     C* Variables para HIPO50
     C*EJECUTAR M00VAR
     C                   EXSR      M00VAR
     C* Cot de la base
     C*MOVER ZCOT ZCOTBA
     C                   Z-ADD     ZCOTBA        ZCOT
     C* ind llama acred
     C*PASAR ZINDER 'A'
     C                   MOVEL     'A'           ZINDER
     C*LLAMAR TRHIPO50(ZPERFS ZDITRA PLATIP PLAT03 ZIBCAF DETTAR EMPTI6
     C                   CALL      'TRHIPO50'
     C                   PARM                    ZPERFS
     C                   PARM                    ZDITRA
     C                   PARM                    PLATIP
     C                   PARM                    PLAT03
     C                   PARM                    ZIBCAF
     C                   PARM                    DETTAR
     C                   PARM                    EMPTI6
     C                   PARM                    INDSOL
     C                   PARM                    ZINDER
     C                   PARM                    ZVLOBL
     C                   PARM                    ZVSFSP
     C                   PARM                    ZVFGPM
     C                   PARM                    ZDILIC
     C                   PARM                    DETS12
     C                   PARM                    ZDTNU3
     C                   PARM                    ZDTPAG
     C                   PARM                    ZDTSEC
     C                   PARM                    $$HI51
     C* FGPM retro
     C*CALCULAR ZVFGPM=ZVFGPX-ZVFGPM
     C     ZVFGPX        SUB       ZVFGPM        ZVFGPM
     C* FSP retro
     C*CALCULAR ZVSFSP=ZVFSPX-ZVSFSP
     C     ZVFSPX        SUB       ZVSFSP        ZVSFSP
     C*SINO
     C                   ELSE
     C* FGPM retro
     C*CALCULAR ZVFGPM=ZVFGPX
     C                   Z-ADD     ZVFGPX        ZVFGPM
     C* FSP retro
     C*CALCULAR ZVSFSP=ZVFSPX
     C                   Z-ADD     ZVFSPX        ZVSFSP
     C*FIN
     C                   END
     C*SI DETTA1=4 Y ZES13P<>'S'
     C     DETTA1        IFEQ      4
     C     ZES13P        ANDNE     'S'
     C* Salario de la diferencia
     C*MOVER ZIBCAF DETSAL
     C                   Z-ADD     DETSAL        ZIBCAF
     C* Calcula FGPM para retro que aumenta el 4% sobre cot de licencia
     C*CALCULAR (R) ZVFGPM= ZIBCAF*(ZPFGPM/100)*(DETTA1/ZHPPOR)
     C     ZPFGPM        DIV       100           V$CA1           030 9
     C     ZIBCAF        MULT      V$CA1         V$CA1
     C     DETTA1        DIV       ZHPPOR        V$CA2           030 9
     C     V$CA1         MULT(H)   V$CA2         ZVFGPM
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*LLAMAR TRRFSP50 (ZPERFS ZIBFSP ZVSFSP ZVFGPM ZSALIR ZTAFIL ZPSFSP
     C                   CALL      'TRRFSP50'
     C                   PARM                    ZPERFS
     C                   PARM                    ZIBFSP
     C                   PARM                    ZVSFSP
     C                   PARM                    ZVFGPM
     C                   PARM                    ZSALIR
     C                   PARM                    ZTAFIL
     C                   PARM                    ZPSFSP
     C                   PARM                    ZPOFGP
     C* Retroactivo
     C*SI PLAT03 = '09' O PLAT03 = '11' O PLAT03 = '10' O PLAT03 = '12'
     C     PLAT03        IFEQ      '09'
     C     PLAT03        OREQ      '11'
     C     PLAT03        OREQ      '10'
     C     PLAT03        OREQ      '12'
     C* Aplica SFSP al 100% salario
     C*SI ZVSFSP > *CERO
     C     ZVSFSP        IFGT      *ZERO
     C* Salario planilla origen
     C*CALCULAR (R) ZIBCAF = DETVA7 - DETSAL
     C     DETVA7        SUB(H)    DETSAL        ZIBCAF
     C*LLAMAR TRRFSP50 (ZPERFS ZIBCAF ZVSFSO ZVFGPM ZSALIR ZTAFIL ZPSFSP
     C                   CALL      'TRRFSP50'
     C                   PARM                    ZPERFS
     C                   PARM                    ZIBCAF
     C                   PARM                    ZVSFSO
     C                   PARM                    ZVFGPM
     C                   PARM                    ZSALIR
     C                   PARM                    ZTAFIL
     C                   PARM                    ZPSFSP
     C                   PARM                    ZPOFGP
     C* Aplica SFSP al salario original
     C*SI ZVSFSO > *CERO
     C     ZVSFSO        IFGT      *ZERO
     C* Substencia del 100% del salario - Subsistencia del salario origi
     C* SFSP faltante
     C*CALCULAR (R) ZVSFSP = ZVSFSP - ZVSFSO
     C     ZVSFSP        SUB(H)    ZVSFSO        ZVSFSP
     C********************************
     C* Se limpia el campo si no viene reportado FSP detalle
     C*SI ZVSFSP > 0 Y DETCTA = 0 Y DETIN3 =*BLANCO O ZVSFSP > 0 Y DETCT
     C     ZVSFSP        IFGT      0
     C     DETCTA        ANDEQ     0
     C     DETIN3        ANDEQ     *BLANK
     C     ZVSFSP        ORGT      0
     C     DETCTA        ANDGT     0
     C     DETCTA        ANDEQ     DETDI5
     C     DETIN3        ANDEQ     '3'
     C*LIMPIAR ZVSFSP
     C                   CLEAR                   ZVSFSP
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Salario de la diferencia
     C*MOVER ZIBCAF DETSAL
     C                   Z-ADD     DETSAL        ZIBCAF
     C*FIN
     C                   END
     C* Si no es planilla extraord.
     C*SI PLAT03 <> '06'
     C     PLAT03        IFNE      '06'
     C*SI ZNOSLN<>'X' O ZHPN26<=ZDITRA
     C     ZNOSLN        IFNE      'X'
     C     ZHPN26        ORLE      ZDITRA
     C* Valor F.G.P.M.
     C*CALCULAR (R) ZVFGPM = (ZIBCAF * ZPFGPM)/100
     C     ZIBCAF        MULT      ZPFGPM        V$CA1           030 9
     C     V$CA1         DIV(H)    100           ZVFGPM
     C* Retroactivo
     C*SI PLAT03 = '09' O PLAT03 = '11' O PLAT03 = '10' O PLAT03 = '12'
     C     PLAT03        IFEQ      '09'
     C     PLAT03        OREQ      '11'
     C     PLAT03        OREQ      '10'
     C     PLAT03        OREQ      '12'
     C*SI DETTA1=4 Y ZES13P<>'S'
     C     DETTA1        IFEQ      4
     C     ZES13P        ANDNE     'S'
     C* Calcula FGPM para retro que aumenta el 4% sobre cot de licencia
     C*CALCULAR (R) ZVFGPM= ZIBCAF*(ZPFGPM/100)*(DETTA1/ZHPPOR)
     C     ZPFGPM        DIV       100           V$CA1           030 9
     C     ZIBCAF        MULT      V$CA1         V$CA1
     C     DETTA1        DIV       ZHPPOR        V$CA2           030 9
     C     V$CA1         MULT(H)   V$CA2         ZVFGPM
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Días de licencia
     C*MOVER ZDIALI ZDILIC
     C                   Z-ADD     ZDILIC        ZDIALI
     C*SI ZDITRA<>0
     C     ZDITRA        IFNE      0
     C*CALCULAR (R) ZSALPX = (DETVA7 * ZHPN26) / ZDITRA
     C     DETVA7        MULT      ZHPN26        V$CA1           030 9
     C     V$CA1         DIV(H)    ZDITRA        ZSALPX
     C*CALCULAR ZVCOT1 = (ZPFGPM * DETVA7) / 100
     C     ZPFGPM        MULT      DETVA7        V$CA1           030 9
     C     V$CA1         DIV       100           ZVCOT1
     C*SINO
     C                   ELSE
     C*CALCULAR (R) ZSALPX = DETVA7
     C                   Z-ADD(H)  DETVA7        ZSALPX
     C*CALCULAR ZVCOT1 = 0
     C                   Z-ADD     0             ZVCOT1
     C*FIN
     C                   END
     C*CALCULAR (R) ZSALIC = (ZSALPX * ZDIALI) / ZHPN26
     C     ZSALPX        MULT      ZDIALI        V$CA1           030 9
     C     V$CA1         DIV(H)    ZHPN26        ZSALIC
     C*CALCULAR ZVCOT2 = ((ZPFGPM/100) * (ZPORLR/100)) * ZSALIC
     C     ZPFGPM        DIV       100           V$CA1           030 9
     C     ZPORLR        DIV       100           V$CA2           030 9
     C     V$CA1         MULT      V$CA2         V$CA1
     C     V$CA1         MULT      ZSALIC        ZVCOT2
     C*CALCULAR ZVFGPM = (ZVCOT1 + ZVCOT2)
     C     ZVCOT1        ADD       ZVCOT2        V$CA1           030 9
     C                   Z-ADD     V$CA1         ZVFGPM
     C*FIN
     C                   END
     C*FIN
     C                   END
     C* Acreditación de razagos
     C*SI ZT@002 = '3' Y PLATIP = '05'
     C     ZT@002        IFEQ      '3'
     C     PLATIP        ANDEQ     '05'
     C*LIMPIAR ZTOCO2
     C                   CLEAR                   ZTOCO2
     C* Busqueda DETA53 plan, pag, sec
     C*PASAR ZOPCI2 '2'
     C                   MOVEL     '2'           ZOPCI2
     C*LLAMAR TRFGPM50 (DETNU3 DETPAG DETSEC ZFGPMP ZOPCI2)
     C                   CALL      'TRFGPM50'
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    ZFGPMP
     C                   PARM                    ZOPCI2
     C* Valor F.G.P.M.
     C*MOVER ZVFGPM ZFGPMP
     C                   Z-ADD     ZFGPMP        ZVFGPM
     C*FIN
     C                   END
     C* IBC del afiliado
     C*MOVER ZIBCAF DETVA7
     C                   Z-ADD     DETVA7        ZIBCAF
     C*SI ZSALIR = '1'
     C     ZSALIR        IFEQ      '1'
     C*OBTENER (1) ZERROR = 'Error al retornar valores de SFSP y FGPM.'
     C                   CLEAR                   ZERROR
     C                   MOVEL     $HIL(149)     ZERROR
     C*IMPRIMIR  FMT@D3
     C                   EXCEPT    FMT@D3
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C* Acreditación de razagos
     C*SI ZT@002 = '3' Y PLATIP = '05'
     C     ZT@002        IFEQ      '3'
     C     PLATIP        ANDEQ     '05'
     C*LIMPIAR ZTOCO2
     C                   CLEAR                   ZTOCO2
     C* Busqueda DETA53 plan, pag, sec
     C*PASAR ZOPCI2 '2'
     C                   MOVEL     '2'           ZOPCI2
     C*LLAMAR TRFGPM50 (DETNU3 DETPAG DETSEC ZFGPMP ZOPCI2)
     C                   CALL      'TRFGPM50'
     C                   PARM                    DETNU3
     C                   PARM                    DETPAG
     C                   PARM                    DETSEC
     C                   PARM                    ZFGPMP
     C                   PARM                    ZOPCI2
     C* Valor F.G.P.M.
     C*MOVER ZVFGPM ZFGPMP
     C                   Z-ADD     ZFGPMP        ZVFGPM
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*SI PLAT03 = '04' O PLAT03 = '11' O ZES13P='S' Y ZAFSP<>'S'
     C     PLAT03        IFEQ      '04'
     C     PLAT03        OREQ      '11'
     C     ZES13P        OREQ      'S'
     C     ZAFSP         ANDNE     'S'
     C* Valor subsistencia
     C*LIMPIAR ZVSFSP
     C                   CLEAR                   ZVSFSP
     C*FIN
     C                   END
     C* ya hubo pago que cubrio FGPM
     C*SI ZTARAC>0
     C     ZTARAC        IFGT      0
     C* se pasa a cero
     C*MOVER ZVFGPM 0
     C                   Z-ADD     0             ZVFGPM
     C*FIN
     C                   END
     C*SI ZTIPLP = 'Z'
     C     ZTIPLP        IFEQ      'Z'
     C*LIMPIAR ZVFGPM ZVSFSP
     C                   CLEAR                   ZVFGPM
     C                   CLEAR                   ZVSFSP
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Actuliza archivo gestión del depósito para la Tx 04-43      ==
     C*==                                                              ==
     C*==================================================================
     C     M79000        BEGSR
     C* Actualiza Gesar8 con para pago adelantado
     C* Donde se encuentra el dep.
     C*PASAR ZDONES '1'
     C                   MOVEL     '1'           ZDONES
     C* Donde quedó el depósito
     C*PASAR ZADOND '5'
     C                   MOVEL     '5'           ZADOND
     C* Acción acreditación
     C*PASAR ZACCIO 'PA'
     C                   MOVEL     'PA'          ZACCIO
     C* Consecutivo
     C*MOVER ZCONDE '00001'
     C                   MOVE      '00001'       ZCONDE
     C* Lote (alfa)
     C*LIMPIAR ZLOTED ZNUMDE
     C                   CLEAR                   ZLOTED
     C                   CLEAR                   ZNUMDE
     C* Actualiza el archivo de gestión sobre depósitos
     C*LLAMAR TRACGE50 (HISFE3 ZLOTED ZNUMDE ZCONDE ZACCIO ZADOND ZDONES
     C                   CALL      'TRACGE50'
     C                   PARM                    HISFE3
     C                   PARM                    ZLOTED
     C                   PARM                    ZNUMDE
     C                   PARM                    ZCONDE
     C                   PARM                    ZACCIO
     C                   PARM                    ZADOND
     C                   PARM                    ZDONES
     C                   PARM                    ZVRPEX
     C                   PARM                    ZCUPEX
     C* Total valor depòsitos
     C*SUMAR ZVRPEX ZTVDEP
     C                   ADD       ZVRPEX        ZTVDEP
     C* Total cuotas depòsitos
     C*SUMAR ZCUPEX ZTCDEP
     C                   ADD       ZCUPEX        ZTCDEP
     C                   ENDSR
     C*==================================================================
     C*==  Acreditación por rango de fechas                            ==
     C*==                                                              ==
     C*==================================================================
     C     M80000        BEGSR
     C* Si 13136 está activo
     C*SI Z13136 = 1
     C     Z13136        IFEQ      1
     C* Nombre cola acreditación
     C*PASAR ZNDTAQ 'DTAQPLAACR'
     C                   MOVEL     $HIL(150)     ZNDTAQ
     C* Librería de la DTAQ
     C*PASAR ZLDTAQ '*LIBL'
     C                   CLEAR                   ZLDTAQ
     C                   MOVEL     '*LIBL'       ZLDTAQ
     C* Longitud DTAQ
     C*MOVER ZLONG 12
     C                   Z-ADD     12            ZLONG
     C* Entrada de la DTAQ
     C*LIMPIAR ZDATO
     C                   CLEAR                   ZDATO
     C* Tiempo de espera infinito DTAQ
     C*MOVER ZTIEMP -1
     C                   MOVE      -1            ZTIEMP
     C* Indicador ciclo infinito
     C*PASAR ZINDDT '1'
     C                   MOVEL     '1'           ZINDDT
     C* Ciclo infinito
     C*MIENTRAS ZINDDT = '1'
     C     ZINDDT        DOWEQ     '1'
     C*LLAMAR QRCVDTAQ (ZNDTAQ ZLDTAQ ZLONG ZDATO ZTIME)
     C                   CALL      'QRCVDTAQ'
     C                   PARM                    ZNDTAQ
     C                   PARM                    ZLDTAQ
     C                   PARM                    ZLONG
     C                   PARM                    ZDATO
     C                   PARM                    ZTIME
     C*SI ZDATO |= 'FINAL'
     C     ZDATO         IFNE      'FINAL'
     C* Número de planilla a procesar
     C*MOVER PLANU1 ZDATO
     C                   MOVE      ZDATO         PLANU1
     C*INICIARI PLAARC04 (PLANU1)
     C     PLANU1        SETLL     PLAARC04                               74
     C     *IN74         IFEQ      '1'
     C                   MOVE      '0'           *IN74
     C                   ELSE
     C                   MOVE      '1'           *IN74
     C                   END
     C*LEER PLAARC04
     C                   READ      PLAARC04                               74
     C*SI PLAEST='CON'
     C     PLAEST        IFEQ      'CON'
     C* Proceso principal
     C*EJECUTAR M00010
     C                   EXSR      M00010
     C*FIN
     C                   END
     C*SINO
     C                   ELSE
     C*SALIR
     C                   GOTO      T$14
     C*FIN
     C                   END
     C*FIN
     C                   END
     C     T$14          TAG
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Recupera fecha depósito                                     ==
     C*==                                                              ==
     C*==================================================================
     C     M80100        BEGSR
     C*PASAR ZINDAR 'F'
     C                   MOVEL     'F'           ZINDAR
     C*PASAR ZPLPE1 ZT@001
     C                   MOVEL     ZT@001        ZPLPE1
     C*LLAMAR TRFEQA50(ZPLPE1 ZPAGIN ZSECUE ZTIPDE ZESTAD ZIDENT ZPERIO
     C                   CALL      'TRFEQA50'
     C                   PARM                    ZPLPE1
     C                   PARM                    ZPAGIN
     C                   PARM                    ZSECUE
     C                   PARM                    ZTIPDE
     C                   PARM                    ZESTAD
     C                   PARM                    ZIDENT
     C                   PARM                    ZPERIO
     C                   PARM                    ZFECH3
     C                   PARM                    ZFONDO
     C                   PARM                    ZTIPOD
     C                   PARM                    ZINDAR
     C                   PARM                    ZINDER
     C*SI ZINDER = '1'
     C     ZINDER        IFEQ      '1'
     C* Fecha de depósito PLAARC
     C*SQL
     C/EXEC SQL
     C+  SELECT PLAFEC INTO :ZFECDE
     C+  FROM PLAARC
     C+  WHERE PLANUM =: ZPLPE1
     C/END-EXEC
     C*FIN
     C                   END
     C* Si la fecha de depósito blanco se busca en archivo origen de Col
     C*SI ZFECDE = *BLANCO
     C     ZFECDE        IFEQ      *BLANK
     C*SQL
     C/EXEC SQL
     C+  SELECT PLAFEC
     C+  INTO :ZFECDE
     C+  FROM COLOBLDAT/PLAARC, FEQA04
     C+  WHERE :ZPLPE1 = FEQNU2
     C+  AND FEQN17 = PLANU1
     C+  AND FEQN17 <> 0
     C/END-EXEC
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Valida si detalle de planilla retroactiva no tiene aporte   ==
     C*==                                                              ==
     C*==================================================================
     C     M81000        BEGSR
     C*SI PLAT03 = '09'
     C     PLAT03        IFEQ      '09'
     C*LIMPIAR ZMARCA
     C                   CLEAR                   ZMARCA
     C*LLAMAR RPDETA50(DETNUM DETNU3 DETTI2 DETNU2 ZMARCA)
     C                   CALL      'RPDETA50'
     C                   PARM                    DETNUM
     C                   PARM                    DETNU3
     C                   PARM                    DETTI2
     C                   PARM                    DETNU2
     C                   PARM                    ZMARCA
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Procesamiento planillas validación especial                 ==
     C*==                                                              ==
     C*==================================================================
     C     M82000        BEGSR
     C*LIMPIAR ZNUEMA
     C                   CLEAR                   ZNUEMA
     C* Lee empleador área de datos
     C*F QLEEALD (ZNUEMA 401 9)
     C                   CALL      'F079SNAP'                                   QLEEALD
     C     ZNUEMA        PARM      ZNUEMA        F$371           250
     C                   PARM      401           F$372             4 0
     C                   PARM      9             F$373             4 0
     C* Pasa a número
     C*F QCONVNUM (ZNUEMA ZNUEMP)
     C                   CALL      'F083SNAP'                                   QCONVNUM
     C     ZNUEMA        PARM      ZNUEMA        F$261           200
     C     ZNUEMP        PARM      ZNUEMP        F$262            30 0
     C* Pasa a número
     C*F QCONVNUM (ZT@007 ZNUMID)
     C                   CALL      'F083SNAP'                                   QCONVNUM
     C     ZT@007        PARM      ZT@007        F$261           200
     C     ZNUMID        PARM      ZNUMID        F$262            30 0
     C* Periodo inicial
     C*F QLEEALD (ZPERII 410 6)
     C                   CALL      'F079SNAP'                                   QLEEALD
     C     ZPERII        PARM      ZPERII        F$371           250
     C                   PARM      410           F$372             4 0
     C                   PARM      6             F$373             4 0
     C* Periodo final
     C*F QLEEALD (ZPERIF 416 6)
     C                   CALL      'F079SNAP'                                   QLEEALD
     C     ZPERIF        PARM      ZPERIF        F$371           250
     C                   PARM      416           F$372             4 0
     C                   PARM      6             F$373             4 0
     C*SI ZPERII = *BLANCO
     C     ZPERII        IFEQ      *BLANK
     C*PASAR ZPERII '000000'
     C                   MOVEL     '000000'      ZPERII
     C*FIN
     C                   END
     C*SI ZPERIF = *BLANCO
     C     ZPERIF        IFEQ      *BLANK
     C*PASAR ZPERIF '999999'
     C                   MOVEL     '999999'      ZPERIF
     C*FIN
     C                   END
     C* Recorrido planillas J
     C*SQL
     C/EXEC SQL
     C+  DECLARE CURJ CURSOR FOR
     C+  SELECT PLANU1 FROM PLAARCA1
     C+  WHERE PLATI1 = :ZT@006 AND
     C+  PLANU4 = :ZNUMID AND PLAEST = 'CON' AND
     C+  PLAPER BETWEEN :ZPERII AND :ZPERIF
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  OPEN CURJ
     C/END-EXEC
     C*SQL
     C/EXEC SQL
     C+  FETCH CURJ INTO :ZNUMPJ
     C/END-EXEC
     C*MIENTRAS SQLCOD = 0
     C     SQLCOD        DOWEQ     0
     C*RECUPERARD (N) PLAARC04 (ZNUMPJ)
     C     ZNUMPJ        CHAIN     PLAARC04                           7494
     C                   MOVE      *IN94         I$RND
     C*SI RED
     C     I$RND         IFEQ      '0'
     C* Proceso principal
     C*EJECUTAR M00010
     C                   EXSR      M00010
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  FETCH CURJ INTO :ZNUMPJ
     C/END-EXEC
     C*FIN
     C                   END
     C*SQL
     C/EXEC SQL
     C+  CLOSE CURJ
     C/END-EXEC
     C*LIMPIAR ZNUEMA ZPERII ZPERIF
     C                   CLEAR                   ZNUEMA
     C                   CLEAR                   ZPERII
     C                   CLEAR                   ZPERIF
     C*FUNCION QGRAALD (ZNUEMA 401 9)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZNUEMA        PARM      ZNUEMA        F$2Z1           250
     C                   PARM      401           F$2Z2             4 0
     C                   PARM      9             F$2Z3             4 0
     C*FUNCION QGRAALD (ZPERII 410 6)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZPERII        PARM      ZPERII        F$2Z1           250
     C                   PARM      410           F$2Z2             4 0
     C                   PARM      6             F$2Z3             4 0
     C*FUNCION QGRAALD (ZPERIF 416 6)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZPERIF        PARM      ZPERIF        F$2Z1           250
     C                   PARM      416           F$2Z2             4 0
     C                   PARM      6             F$2Z3             4 0
     C                   ENDSR
     C*==================================================================
     C*==  Calculo de intereses planilla tipo O                        ==
     C*==                                                              ==
     C*==================================================================
     C     M83000        BEGSR
     C* Val especial según tipo
     C*SI ZVAESP = '1'
     C     ZVAESP        IFEQ      '1'
     C*LIMPIAR ZTISF
     C                   CLEAR                   ZTISF
     C* Acreditación de rezagos
     C*SI ZT@002 = '3'
     C     ZT@002        IFEQ      '3'
     C*CALCULAR ZTAIFG=ZINRZO*ZHPP49/ZHPPOR
     C     ZINRZO        MULT      ZHPP49        V$CA1           030 9
     C     V$CA1         DIV       ZHPPOR        ZTAIFG
     C*CALCULAR (R) ZTAINT=ZINRZO-ZTAIFG
     C     ZINRZO        SUB(H)    ZTAIFG        ZTAINT
     C*MOVER ZTIFS ZIFRZO
     C                   Z-ADD     ZIFRZO        ZTIFS
     C*SINO
     C                   ELSE
     C*SI ZCOTOB > 0
     C     ZCOTOB        IFGT      0
     C*CALCULAR (R) ZTAIFG = PLAREC * ZHPP49/ZHPPOR
     C     PLAREC        MULT      ZHPP49        V$CA1           030 9
     C     V$CA1         DIV(H)    ZHPPOR        ZTAIFG
     C*MOVER ZIITFG ZTAIFG
     C                   Z-ADD     ZTAIFG        ZIITFG
     C*CALCULAR ZTAINT = PLAREC - ZTAIFG
     C     PLAREC        SUB       ZTAIFG        ZTAINT
     C*FIN
     C                   END
     C*SI ZCOTFS > 0
     C     ZCOTFS        IFGT      0
     C* Se aceptan reportados
     C*MOVER ZTIFS PLAIN7
     C                   Z-ADD     PLAIN7        ZTIFS
     C*FIN
     C                   END
     C*FIN
     C                   END
     C*MOVER ZIITER ZTAINT
     C                   Z-ADD     ZTAINT        ZIITER
     C*MOVER ZIITFS ZTIFS
     C                   Z-ADD     ZTIFS         ZIITFS
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Parametro dec 558                                           ==
     C*==                                                              ==
     C*==================================================================
     C     M98415        BEGSR
     C*FUNCION QGRAALD (ZPLAAA 630 12)
     C                   CALL      'F024SNAP'                                   QGRAALD
     C     ZPLAAA        PARM      ZPLAAA        F$2Z1           250
     C                   PARM      630           F$2Z2             4 0
     C                   PARM      12            F$2Z3             4 0
     C*LLAMAR RPHDEC558 (ZHPPE1 ZPLAAA ZAPLDE ZPARAD)
     C                   MOVEL     'RPHDEC55'    H$L10            10
     C                   MOVE      '8 '          H$L10
     C                   CALL      H$L10
     C                   PARM                    ZHPPE1
     C                   PARM                    ZPLAAA
     C                   PARM                    ZAPLDE
     C                   PARM                    ZPARAD
     C*SI ZAPLDE='S'
     C     ZAPLDE        IFEQ      'S'
     C* porc C.O
     C*MOVER ZHPPOR ZI0P14
     C                   Z-ADD     ZI0P14        ZHPPOR
     C* % comis AFP
     C*MOVER ZHPPO1 ZI0P15
     C                   Z-ADD     ZI0P15        ZHPPO1
     C* Porcen Prima seg
     C*MOVER ZHPPO2 ZI0P16
     C                   Z-ADD     ZI0P16        ZHPPO2
     C* Solidaridad
     C*MOVER ZHPPO4 ZI0P18
     C                   Z-ADD     ZI0P18        ZHPPO4
     C* % FGPM
     C*MOVER ZHPP49 ZI0P20
     C                   Z-ADD     ZI0P20        ZHPP49
     C* % distr Subsisnte
     C*MOVER ZHPP50 ZI0P21
     C                   Z-ADD     ZI0P21        ZHPP50
     C* num sal min FSP
     C*MOVER ZHPN05 ZI0N12
     C                   Z-ADD     ZI0N12        ZHPN05
     C*FIN
     C                   END
     C                   ENDSR
     C*==================================================================
     C*==  Imprime detalle reporte de totales                          ==
     C*==                                                              ==
     C*==================================================================
     C     TOT@01        BEGSR
     C* Subtotal y total por acreditación
     C*
     C*SI ZT@002 <> 'F'
     C     ZT@002        IFNE      'F'
     C*CALCULAR ZVASCA = ZVACOA + ZVAARA + ZVAVAA + ZVAVEA + ZTOREN + ZV
     C     ZVACOA        ADD       ZVAARA        V$CA1           030 9
     C     V$CA1         ADD       ZVAVAA        V$CA1
     C     V$CA1         ADD       ZVAVEA        V$CA1
     C     V$CA1         ADD       ZTOREN        V$CA1
     C     V$CA1         ADD       ZVAINA        ZVASCA
     C*CALCULAR ZCUSCA = ZCUCOA + ZCUARA + ZCUVAA + ZCUVEA + ZCUREN + ZC
     C     ZCUCOA        ADD       ZCUARA        V$CA1           030 9
     C     V$CA1         ADD       ZCUVAA        V$CA1
     C     V$CA1         ADD       ZCUVEA        V$CA1
     C     V$CA1         ADD       ZCUREN        V$CA1
     C     V$CA1         ADD       ZCUINA        ZCUSCA
     C*CALCULAR ZVASTA = ZVACCA + ZVAPRA + ZVACAA + ZVACEA + ZVAFGA + ZV
     C     ZVACCA        ADD       ZVAPRA        V$CA1           030 9
     C     V$CA1         ADD       ZVACAA        V$CA1
     C     V$CA1         ADD       ZVACEA        V$CA1
     C     V$CA1         ADD       ZVAFGA        V$CA1
     C     V$CA1         ADD       ZVIFGA        ZVASTA
     C*CALCULAR ZCUSTA = ZCUCCA + ZCUPRA + ZCUCAA + ZCUCEA + ZCUFGA + ZC
     C     ZCUCCA        ADD       ZCUPRA        V$CA1           030 9
     C     V$CA1         ADD       ZCUCAA        V$CA1
     C     V$CA1         ADD       ZCUCEA        V$CA1
     C     V$CA1         ADD       ZCUFGA        V$CA1
     C     V$CA1         ADD       ZCIFGA        ZCUSTA
     C*CALCULAR ZVASFA = ZVAFSA + ZVAISA + ZVSFSA + ZVISFA
     C     ZVAFSA        ADD       ZVAISA        V$CA1           030 9
     C     V$CA1         ADD       ZVSFSA        V$CA1
     C     V$CA1         ADD       ZVISFA        ZVASFA
     C*CALCULAR ZCUSFA = ZCUFSA + ZCUISA + ZCSFSA + ZCISFA
     C     ZCUFSA        ADD       ZCUISA        V$CA1           030 9
     C     V$CA1         ADD       ZCSFSA        V$CA1
     C     V$CA1         ADD       ZCISFA        ZCUSFA
     C*CALCULAR ZVATOA = ZVASCA + ZVASTA + ZVASFA + ZPEEMP
     C     ZVASCA        ADD       ZVASTA        V$CA1           030 9
     C     V$CA1         ADD       ZVASFA        V$CA1
     C     V$CA1         ADD       ZPEEMP        ZVATOA
     C*CALCULAR ZCUTOA = ZCUSCA + ZCUSTA + ZCUSFA + ZCUPEE
     C     ZCUSCA        ADD       ZCUSTA        V$CA1           030 9
     C     V$CA1         ADD       ZCUSFA        V$CA1
     C     V$CA1         ADD       ZCUPEE        ZCUTOA
     C*
     C* Subtotal y total deuda
     C*
     C*CALCULAR ZVASTD = ZVACOD + ZVAARD + ZVAVAD + ZVAVED + ZVAIND
     C     ZVACOD        ADD       ZVAARD        V$CA1           030 9
     C     V$CA1         ADD       ZVAVAD        V$CA1
     C     V$CA1         ADD       ZVAVED        V$CA1
     C     V$CA1         ADD       ZVAIND        ZVASTD
     C*CALCULAR ZVASUD = ZVAFSD + ZVASFD
     C     ZVAFSD        ADD       ZVASFD        ZVASUD
     C*CALCULAR ZVATOD = ZVASTD + ZVAFSD + ZVASFD + ZVAFGD + ZVISFD + ZV
     C     ZVASTD        ADD       ZVAFSD        V$CA1           030 9
     C     V$CA1         ADD       ZVASFD        V$CA1
     C     V$CA1         ADD       ZVAFGD        V$CA1
     C     V$CA1         ADD       ZVISFD        V$CA1
     C     V$CA1         ADD       ZVIFSD        V$CA1
     C     V$CA1         ADD       ZVIFGD        ZVATOD
     C*
     C* Subtotal y total rezagos
     C*
     C*CALCULAR ZVASTR = ZVACOR + ZVAARR + ZVAVAR + ZVAVER + ZVARER + ZV
     C     ZVACOR        ADD       ZVAARR        V$CA1           030 9
     C     V$CA1         ADD       ZVAVAR        V$CA1
     C     V$CA1         ADD       ZVAVER        V$CA1
     C     V$CA1         ADD       ZVARER        V$CA1
     C     V$CA1         ADD       ZVAINR        ZVASTR
     C*CALCULAR ZCUSTR = ZCUCOR + ZCUARR + ZCUVAR + ZCUVER + ZCURER + ZC
     C     ZCUCOR        ADD       ZCUARR        V$CA1           030 9
     C     V$CA1         ADD       ZCUVAR        V$CA1
     C     V$CA1         ADD       ZCUVER        V$CA1
     C     V$CA1         ADD       ZCURER        V$CA1
     C     V$CA1         ADD       ZCUINR        ZCUSTR
     C*CALCULAR ZVASFR = ZVAFSR + ZVAISR
     C     ZVAFSR        ADD       ZVAISR        ZVASFR
     C*CALCULAR ZCUSFR = ZCUFSR + ZCUISR
     C     ZCUFSR        ADD       ZCUISR        ZCUSFR
     C*CALCULAR ZVATOR = ZVASTR + ZVASFR + ZVAPER
     C     ZVASTR        ADD       ZVASFR        V$CA1           030 9
     C     V$CA1         ADD       ZVAPER        ZVATOR
     C*CALCULAR ZCUTOR = ZCUSTR + ZCUSFR + ZCUPER
     C     ZCUSTR        ADD       ZCUSFR        V$CA1           030 9
     C     V$CA1         ADD       ZCUPER        ZCUTOR
     C*FIN
     C                   END
     C* Valor total acreditado reporte
     C*SUMAR ZVATOA ZVATRE
     C                   ADD       ZVATOA        ZVATRE
     C* Total cuotas acreditadas
     C*SUMAR ZCUTOA ZCUTRE
     C                   ADD       ZCUTOA        ZCUTRE
     C* Total deuda
     C*SUMAR ZVATOD ZVADRE
     C                   ADD       ZVATOD        ZVADRE
     C* Valor total rezagos
     C*SUMAR ZVATOR ZVTRRE
     C                   ADD       ZVATOR        ZVTRRE
     C* Cuotas total rezagos
     C*SUMAR ZCUTOR ZCUTRR
     C                   ADD       ZCUTOR        ZCUTRR
     C*
     C*SI ZT@002 <> '2' Y ZINLLA <> 'M'
     C     ZT@002        IFNE      '2'
     C     ZINLLA        ANDNE     'M'
     C* Linea de detalle
     C*IMPRIMIR FMT@T1
     C                   EXCEPT    FMT@T1
     C*FIN
     C                   END
     C                   ENDSR
     C*=========================================================
     C*DEFINICION DE VARIABLES, ARCHIVOS, PANTALLAS Y FORMATOS
     C*=========================================================
     C     S$Z999        BEGSR
     C                   Z-ADD     *ZERO         $0                             Valor pagado por alt
     C                   Z-ADD     *ZERO         $1                             Valor pagado por cot
     C                   Z-ADD     *ZERO         $2                             Valor pagado por cot
     C                   Z-ADD     *ZERO         $3                             Valor pagado por vol
     C                   Z-ADD     *ZERO         $4                             Valor pagado fondo d
     C                   Z-ADD     *ZERO         $5                             Valor pagado interes
     C                   Z-ADD     *ZERO         $6                             Valor pagado interes
     C                   Z-ADD     *ZERO         $7                             Valor pagado por ren
     C                   Z-ADD     *ZERO         $8                             Cuotas pagadas por a
     C                   Z-ADD     *ZERO         $9                             Cuotas pagadas por c
     C                   Z-ADD     *ZERO         $A                             Cuotas pagadas por c
     C                   Z-ADD     *ZERO         $B                             Cuotas pagadas por v
     C                   Z-ADD     *ZERO         $C                             Cuotas pagadas fondo
     C                   Z-ADD     *ZERO         $D                             Cuotas pagadas inter
     C                   Z-ADD     *ZERO         $E                             Cuotas pagadas por i
     C                   Z-ADD     *ZERO         $F                             Cuotas pagadas por r
     C                   MOVE      *BLANK        $G                             Fechas de depósito
     C                   Z-ADD     *ZERO         $H                             Cuotas distribuidas
     C                   Z-ADD     *ZERO         $I                             Cuotas distribuidas
     C                   Z-ADD     *ZERO         $J                             Cuotas distribuidas
     C                   Z-ADD     *ZERO         $K                             Cuotas distribuidas
     C                   Z-ADD     *ZERO         $L                             Cuotas distribuidas
     C                   Z-ADD     *ZERO         $M                             Cuotas distribuidas
     C                   Z-ADD     *ZERO         $N                             Cuotas distribuidas
     C                   Z-ADD     *ZERO         $O                             Cuotas distribuidas
     C                   Z-ADD     *ZERO         $P                             Valor distribuido al
     C                   Z-ADD     *ZERO         $Q                             Valor ditribuido C.O
     C                   Z-ADD     *ZERO         $R                             Valor distribuido po
     C                   Z-ADD     *ZERO         $S                             Valor distribuido c.
     C                   Z-ADD     *ZERO         $T                             Valor distribuido fo
     C                   Z-ADD     *ZERO         $U                             Valor distribuido po
     C                   Z-ADD     *ZERO         $V                             Valor distribuido po
     C                   Z-ADD     *ZERO         $W                             Valor distribuido po
     C                   Z-ADD     *ZERO         $X                             Arr. de valores x de
     C                   Z-ADD     *ZERO         $Y                             Arr. de cuotas x dep
     C                   MOVE      *BLANK        $Z                             Arr. fecha de deposi
     C                   MOVE      *BLANK        $HIL                           Hileras > 8
     C                   MOVE      I$BOUL        I$BOUL            1            BOULRE()
     C                   MOVE      I$DUP         I$DUP             1            DUP()/RND()
     C                   MOVE      I$RND         I$RND             1            RND()/RED()
     C                   MOVE      I$NFT         I$NFT             1            NFT()/FDT()
     C                   MOVEA     '0'           *IN                            Indicadores RPG
     C                   MOVE      RSG           RSG              50            Mensaje de error
     C                   Z-ADD     *ZERO         AFPCDI            5 0          Código de la AFP de
     C                   MOVE      *BLANK        FUNCIO           10            Nombre del programa
     C                   Z-ADD     *ZERO         HISC28           21 8          Cuotas de operación
     C                   MOVE      *BLANK        HISFE3            8            Fecha del fondo (Par
     C                   MOVE      *BLANK        I                 1            Ind. para llamado TR
     C                   Z-ADD     *ZERO         INDMRA            5 0          numero de meses rela
     C                   MOVE      *BLANK        INDMRX            5            numero de meses rela
     C                   MOVE      *BLANK        INDSOL            1            indicador de solidar
     C                   Z-ADD     *ZERO         J                 3 0          Indice de colocación
     C                   Z-ADD     *ZERO         K                 3 0          Indice de colocación
     C                   Z-ADD     *ZERO         L                 3 0          Posición en el arreg
     C                   MOVE      *BLANK        NCOÑÑÑ           50            zsalacade la compani
     C                   MOVE      *BLANK        NSIÑÑÑ           50            Nombre del sistema
     C                   MOVE      *BLANK        OK                1            Indicador de error
     C                   MOVE      *BLANK        SEG$$$            1            Identificador de opc
     C                   Z-ADD     *ZERO         SQLCOD            9 0          Código de error de S
     C                   Z-ADD     *ZERO         SQLCOZ            9 0          Código de error de S
     C                   MOVE      *BLANK        USUÑÑÑ           10            Usuario
     C                   Z-ADD     *ZERO         Z$DHOY           11 0          Saldo del p.e. valor
     C                   Z-ADD     *ZERO         Z@INFG           15 0          Deuda intereses F.G.
     C                   Z-ADD     *ZERO         Z@INFS           15 0          Deuda intereses F.S.
     C                   Z-ADD     *ZERO         Z@INSF           15 0          Deuda intereses S.F.
     C                   MOVE      *BLANK        ZACCIO            2            Acción realizada sob
     C                   MOVE      *BLANK        ZACCIX            1            Acción TRCORZ50
     C                   Z-ADD     *ZERO         ZACCUI           21 8          Acumulado de cuotas
     C                   MOVE      *BLANK        ZACC50            1            Acción RPPEXR50
     C                   MOVE      *BLANK        ZACC53            1            Accion RECA53
     C                   MOVE      *BLANK        ZACFSP            1            FSPARC Accion
     C                   MOVE      *BLANK        ZACRCD            1            Config. acred planil
     C                   MOVE      *BLANK        ZACRVO            1            Var. config. para vo
     C                   MOVE      *BLANK        ZACTEM            1            Indicador actual. em
     C                   Z-ADD     *ZERO         ZACUDI           21 8          @movcuo - Acumulado
     C                   Z-ADD     *ZERO         ZACVLI           15 0          Acumulado de valor I
     C                   Z-ADD     *ZERO         ZADEPR            9 0          @detsa1 - Acumulado
     C                   MOVE      *BLANK        ZADOND            1            a donde va el depósi
     C                   MOVE      *BLANK        ZAFIIN           11            Código interno afili
     C                   MOVE      *BLANK        ZAFILA           11            Identificación del a
     C                   MOVE      *BLANK        ZAFILI            9            Código interno afili
     C                   Z-ADD     *ZERO         ZAFINU            9 0          código interno del m
     C                   Z-ADD     *ZERO         ZAFRES            5 0          Numero de detalles r
     C                   MOVE      *BLANK        ZAFSP             1            indicador de aplica
     C                   MOVE      *BLANK        ZAFUL2            8            Fecha último período
     C                   MOVE      *BLANK        ZAGF95            8            Fecha generación
     C                   MOVE      *BLANK        ZAGF97            8            Fecha depósito
     C                   Z-ADD     *ZERO         ZAGPL5           12 0          Planilla
     C                   Z-ADD     *ZERO         ZAGS16           15 2          Saldo P.E
     C                   Z-ADD     *ZERO         ZAGS17           15 2          Saldo P.A
     C                   Z-ADD     *ZERO         ZAGV56           15 2          Valor P.E
     C                   Z-ADD     *ZERO         ZAGV57           15 2          Valor P.A
     C                   Z-ADD     *ZERO         ZAGV58           15 2          Rendimientos pago en
     C                   Z-ADD     *ZERO         ZAG019           21 8          Cuotas P.E
     C                   Z-ADD     *ZERO         ZAG020           21 8          Cuotas saldos P.E
     C                   Z-ADD     *ZERO         ZAG021           21 8          Cuotas P.A
     C                   Z-ADD     *ZERO         ZAG022           21 8          Cuotas saldo P.A
     C                   Z-ADD     *ZERO         ZAJCPE           21 8          @pagsa4 - ajuste x c
     C                   Z-ADD     *ZERO         ZAJUPE           15 0          Ajuste en $ x cub. c
     C                   MOVE      *BLANK        ZALFA1            1            Var. alfa de 1 posic
     C                   MOVE      *BLANK        ZALFA5            5            Campo Alfa de 5
     C                   MOVE      *BLANK        ZALFA8            8            Campo Alfa de 8
     C                   MOVE      *BLANK        ZALFE1            1            Alfabetico de 1 cara
     C                   MOVE      *BLANK        ZALF15           15            Var. alfa de 15 posi
     C                   MOVE      *BLANK        ZALPLA           12            Número de planilla -
     C                   MOVE      *BLANK        ZAMNPA            1            Indicador de amnisti
     C                   MOVE      *BLANK        ZAMP              1            Ind. amnistia de pag
     C                   MOVE      *BLANK        ZANDEP            1            Ind. cancel deud.pre
     C                   Z-ADD     *ZERO         ZANFSP            9 0          Anterior valor subsi
     C                   Z-ADD     *ZERO         ZANGPM            9 0          Anterior valor garan
     C                   Z-ADD     *ZERO         ZANIBC            9 0          @detva7 - Anterior I
     C                   MOVE      *BLANK        ZANO              4            Año de búsqueda de d
     C                   Z-ADD     *ZERO         ZANOBI            4 0          Año bisiesto o no
     C                   Z-ADD     *ZERO         ZANOPE            4 0          Año del periodo
     C                   MOVE      *BLANK        ZANUDE            1            Indicador de anular
     C                   Z-ADD     *ZERO         ZAPFSP            5 2          Anterior pct. Subsis
     C                   MOVE      *BLANK        ZAPLDE            1            es planilla decreto
     C                   Z-ADD     *ZERO         ZAUMCC            8 0          temporal acumulado i
     C                   Z-ADD     *ZERO         ZAUNFG            8 0          Acumulado FS agrem i
     C                   Z-ADD     *ZERO         ZAUNFS            8 0          Acumulado FS agrem i
     C                   Z-ADD     *ZERO         ZAVRDI            9 0          @detsa1 - Acumulado
     C                   MOVE      *BLANK        ZBDINT            1            Posee desarrollo bas
     C                   MOVE      *BLANK        ZCAAND            3            @detc56 causal anulñ
     C                   MOVE      *BLANK        ZCADDU            1            Ind. cancelo un deta
     C                   MOVE      *BLANK        ZCADPE            2            Causal de gen. deuda
     C                   MOVE      *BLANK        ZCALVD            1            Calcular valor distr
     C                   Z-ADD     *ZERO         ZCANRE            5 0          Cantidad de registro
     C                   Z-ADD     *ZERO         ZCAPER           21 8          Cuotas p.e. acred. r
     C                   MOVE      *BLANK        ZCARAC          255            Caranteres
     C                   Z-ADD     *ZERO         ZCAREZ           12 0          Cantidad rezagos a a
     C                   Z-ADD     *ZERO         ZCARIN            1 0          Var. cargue de varia
     C                   MOVE      *BLANK        ZCAUSA            3            @DETC56 - Causal de
     C                   Z-ADD     *ZERO         ZCCPE            21 8          @pagcu2 - Cuotas cub
     C                   Z-ADD     *ZERO         ZCD               5 0          Consecutivo
     C                   Z-ADD     *ZERO         ZCDFSP            5 0          FSPARC ConsecDep
     C                   Z-ADD     *ZERO         ZCDIAS            5 0          total dias normales
     C                   Z-ADD     *ZERO         ZCDIFC           21 8          Cuotas de la diferen
     C                   Z-ADD     *ZERO         ZCFSRE           21 8          Cuotas FSPARC rezago
     C                   Z-ADD     *ZERO         ZCIEMP            9 0          Código interno emple
     C                   Z-ADD     *ZERO         ZCIFGA           21 8          Cuotas intereses FGP
     C                   Z-ADD     *ZERO         ZCIFG2           21 8          Cuotas interes FGPM
     C                   Z-ADD     *ZERO         ZCIFSP           21 8          FSPARC CuoIntFsp
     C                   Z-ADD     *ZERO         ZCIREC            9 0          Codigo interno RPRED
     C                   Z-ADD     *ZERO         ZCISF            21 8          Cuotas de int a grab
     C                   Z-ADD     *ZERO         ZCISFA           21 8          Cuotas intereses SFS
     C                   Z-ADD     *ZERO         ZCISUB           21 8          FSPARC CuoIntSub
     C                   MOVE      *BLANK        ZCL               1            Clase aportante temp
     C                   MOVE      *BLANK        ZCLASE            1            Clase de aportante
     C                   Z-ADD     *ZERO         ZCMAR            21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMCCA           21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMCCE           21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMCCO           21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMCO            21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMCVA           21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMCVE           21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMFGP           21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMFS            21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMFSD           21 8          @movcuo - Diferencia
     C                   Z-ADD     *ZERO         ZCMIFD           11 0          Cuotas Mvto int. f.s
     C                   Z-ADD     *ZERO         ZCMIFG           21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMIFS           21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMINT           21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMISF           21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMPS            21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMREN           21 8          @movcuo - Cuotas mov
     C                   Z-ADD     *ZERO         ZCMSFS           21 8          @movcuo - Cuotas mov
     C                   MOVE      *BLANK        ZCNACC            1            Acción a consultar
     C                   Z-ADD     *ZERO         ZCNC48            3 0          Consecutivo contrato
     C                   MOVE      *BLANK        ZCNERR            1            Ind. de error (0:No
     C                   MOVE      *BLANK        ZCNFIL          255            Campo FILLER/extra p
     C                   MOVE      *BLANK        ZCNF84            8            Fecha inicio del con
     C                   MOVE      *BLANK        ZCNF85            8            Fecha fin contrato
     C                   MOVE      *BLANK        ZCNF86            8            Fecha creaciòn
     C                   MOVE      *BLANK        ZCNH16            6            Hora de creación
     C                   Z-ADD     *ZERO         ZCNIBC           15 2          Ingreso base cotizac
     C                   MOVE      *BLANK        ZCNI15            1            Indicador de vigenci
     C                   MOVE      *BLANK        ZCNNOV            1            Novedad de retiro
     C                   Z-ADD     *ZERO         ZCNN22            9 0          Código interno del a
     C                   Z-ADD     *ZERO         ZCNN23           11 0          Número identificació
     C                   MOVE      *BLANK        ZCNPL8           18            Planilla Inicial TRC
     C                   MOVE      *BLANK        ZCNPL9           18            Planilla final TRCOR
     C                   Z-ADD     *ZERO         ZCNSQL            9 0          Error que retorna SQ
     C                   MOVE      *BLANK        ZCNT37            3            Tipo de identificaci
     C                   MOVE      *BLANK        ZCNT38            1            Tipo de contrato
     C                   MOVE      *BLANK        ZCNU25           10            Usuario creación
     C                   Z-ADD     *ZERO         ZCNV18           15 2          Valor del contrato
     C                   Z-ADD     *ZERO         ZCOBLI            9 0          Cotiz.obligatoria ca
     C                   Z-ADD     *ZERO         ZCOBL1            9 0          Cotización obligator
     C                   Z-ADD     *ZERO         ZCOBL2            9 0          Cotización obligator
     C                   Z-ADD     *ZERO         ZCOBRO           15 2          Trabajo Valor pago
     C                   Z-ADD     *ZERO         ZCODAF            9 0          Código interno afili
     C                   MOVE      *BLANK        ZCODEE            3            codigo de error
     C                   Z-ADD     *ZERO         ZCODEM            9 0          @empco6 - Código int
     C                   MOVE      *BLANK        ZCODER            3            Código de error
     C                   Z-ADD     *ZERO         ZCODFO            9 0          @consec - Código del
     C                   Z-ADD     *ZERO         ZCODIN            9 0          Código interno AUXIL
     C                   Z-ADD     *ZERO         ZCODI2            9 0          Cpodigo interno afil
     C                   Z-ADD     *ZERO         ZCODMO            2 0          @MOVC26 - Código de
     C                   MOVE      *BLANK        ZCODPR            3            codigo proceso que i
     C                   MOVE      *BLANK        ZCODTX            2            Código de transacció
     C                   Z-ADD     *ZERO         ZCOEMP            9 0          @empco6 - Código int
     C                   Z-ADD     *ZERO         ZCOFSP            5 0          FSPARC consecutivo
     C                   Z-ADD     *ZERO         ZCOHOS            5 3          HISPOR - Cotización
     C                   MOVE      *BLANK        ZCOI              1            Indicador estado COI
     C                   MOVE      *BLANK        ZCOINT            9            Código interno afili
     C                   Z-ADD     *ZERO         ZCOMHO            7 5          Comisión hospitales
     C                   MOVE      *BLANK        ZCOMPL            1            Indicador de complet
     C                   Z-ADD     *ZERO         ZCOMSI            7 5          Comisión situados
     C                   MOVE      *BLANK        ZCONCE            2            Concepto
     C                   MOVE      *BLANK        ZCOND             2            Condición de cesante
     C                   MOVE      *BLANK        ZCONDE            5            Consecutivo del depó
     C                   Z-ADD     *ZERO         ZCONMI            5 0          Primer consecutivo M
     C                   Z-ADD     *ZERO         ZCONRE            4 0          Consecutivo de la re
     C                   Z-ADD     *ZERO         ZCONSE            5 0          @conco4 - Consecutiv
     C                   MOVE      *BLANK        ZCONSU            5            Trabajo - Consecutiv
     C                   Z-ADD     *ZERO         ZCONVE            5 0          Días convertidos sem
     C                   Z-ADD     *ZERO         ZCON53            5 0          Consecutivo RECA53
     C                   Z-ADD     *ZERO         ZCOREC            5 0          Consecutivo RPREDI50
     C                   Z-ADD     *ZERO         ZCOSIT            5 3          HISPOR Cotización ob
     C                   Z-ADD     *ZERO         ZCOT              9 0          @detcot - cotizacion
     C                   Z-ADD     *ZERO         ZCOTAR           11 0          Valor alto riesgo
     C                   Z-ADD     *ZERO         ZCOTBA            9 0          @DETCOT - Cotizacion
     C                   Z-ADD     *ZERO         ZCOTCO           11 0          Valor cotización cor
     C                   Z-ADD     *ZERO         ZCOTFG           11 0          Valor cot. F. garant
     C                   Z-ADD     *ZERO         ZCOTFS           11 0          Valor cot. fondo de
     C                   Z-ADD     *ZERO         ZCOTOB           11 0          movcot - Valor cot.
     C                   Z-ADD     *ZERO         ZCOTSF           11 0          Valor cot. f.solidar
     C                   Z-ADD     *ZERO         ZCOTTO           16 0          Total cotizaciones
     C                   Z-ADD     *ZERO         ZCOTVA           11 0          Valor cot. vol. afil
     C                   Z-ADD     *ZERO         ZCOTVE           11 0          Valor cot. vol. empl
     C                   Z-ADD     *ZERO         ZCPECS           21 8          Cuotas P.E. plan. ca
     C                   Z-ADD     *ZERO         ZCPXRZ           21 8          Cuotas rezago PEE
     C                   Z-ADD     *ZERO         ZCP229           22 9          Cuotas valor a pagar
     C                   Z-ADD     *ZERO         ZCREAC            1 0          Crear contrato
     C                   Z-ADD     *ZERO         ZCRING           21 8          Valor cuotas fecha f
     C                   Z-ADD     *ZERO         ZCR229           22 9          Valor cuotas rendimi
     C                   Z-ADD     *ZERO         ZCSFSA           21 8          Cuotas fondo de subs
     C                   Z-ADD     *ZERO         ZCSFSP           21 8          FSPARC CuotasSub
     C                   Z-ADD     *ZERO         ZCTCVA           21 8          Acumulado cuotas acr
     C                   Z-ADD     *ZERO         ZCTCVE           21 8          Acumulado cuotas acr
     C                   Z-ADD     *ZERO         ZCTDIS           21 8          Cuotas total a distr
     C                   Z-ADD     *ZERO         ZCTPAC           21 8          Cuotas pago adelanta
     C                   Z-ADD     *ZERO         ZCTPAD           21 8          cuotas pago adelanta
     C                   Z-ADD     *ZERO         ZCTPEE           21 8          delta interno contro
     C                   Z-ADD     *ZERO         ZCUAR            21 8          @movcuo - Cuotas alt
     C                   Z-ADD     *ZERO         ZCUARA           21 8          @movc25 - Cuotas acr
     C                   Z-ADD     *ZERO         ZCUARR           21 8          @rezcuo - Cuotas A.R
     C                   Z-ADD     *ZERO         ZCUCAA           21 8          Cuotas comisión C.V.
     C                   Z-ADD     *ZERO         ZCUCCA           21 8          Cuotas comisión C.O.
     C                   Z-ADD     *ZERO         ZCUCEA           21 8          Cuotas comisión C.V.
     C                   Z-ADD     *ZERO         ZCUCO            21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUCOA           21 8          Cuotas cotización ob
     C                   Z-ADD     *ZERO         ZCUCOD            9 0          Código interno del e
     C                   Z-ADD     *ZERO         ZCUCOM           21 8          @rezcuo - cuotas par
     C                   Z-ADD     *ZERO         ZCUCOR           21 8          @rezcuo - Cuotas C.O
     C                   Z-ADD     *ZERO         ZCUCVA           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUCVE           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUDEP           21 8          @movcuo - Cuotas dep
     C                   Z-ADD     *ZERO         ZCUDIF           21 8          Cuotas de la diferen
     C                   Z-ADD     *ZERO         ZCUDIT           21 8          @depnu3 - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUENU            9 0          Valor temporar de CU
     C                   Z-ADD     *ZERO         ZCUERZ            1 0          Ya leyó CUEARC del a
     C                   Z-ADD     *ZERO         ZCUFGA           21 8          Cuotas FGPM acredita
     C                   Z-ADD     *ZERO         ZCUFGP           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUFG2           21 8          Cuotas FGPM - DETA52
     C                   Z-ADD     *ZERO         ZCUFS            21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUFSA           21 8          Cuotas fondo de soli
     C                   Z-ADD     *ZERO         ZCUFSD           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUFSP           21 8          Cuotas FSP
     C                   Z-ADD     *ZERO         ZCUFSR           21 8          @rezcuo - Cuotas F.S
     C                   Z-ADD     *ZERO         ZCUIAR           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUIDE            3 0          Código del acuerdo
     C                   Z-ADD     *ZERO         ZCUIFD           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUIFG           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUIFS           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUINA           21 8          Cuotas intereses acr
     C                   Z-ADD     *ZERO         ZCUINR           21 8          @rezcuo - Cuotas int
     C                   Z-ADD     *ZERO         ZCUINT           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUISA           21 8          Cuotas intereses fon
     C                   Z-ADD     *ZERO         ZCUISF           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUISR           21 8          @rezcuo - Cuotas I.F
     C                   Z-ADD     *ZERO         ZCUIVA           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUIVE           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUO             21 8          Cuotas
     C                   Z-ADD     *ZERO         ZCUOAC           21 8          Cuotas del P.E actua
     C                   Z-ADD     *ZERO         ZCUODI           21 8          Cuotas dif
     C                   Z-ADD     *ZERO         ZCUOHI           21 8          @movcuo - Cuotas his
     C                   Z-ADD     *ZERO         ZCUOMA           21 8          Cuotas acumuladas mo
     C                   Z-ADD     *ZERO         ZCUOMO           21 8          Suma de cuotas movim
     C                   Z-ADD     *ZERO         ZCUOMV           21 8          Cuotas acumuladas mo
     C                   Z-ADD     *ZERO         ZCUOPE           21 8          Cuotas P.E antes del
     C                   Z-ADD     *ZERO         ZCUOPR           21 8          Cuota prorrateada
     C                   Z-ADD     *ZERO         ZCUORA           21 8          Cuotas acumuladas re
     C                   Z-ADD     *ZERO         ZCUORE           21 8          @rezcuo - cuotas del
     C                   Z-ADD     *ZERO         ZCUORZ           21 8          @rezcuo - Cuotas de
     C                   Z-ADD     *ZERO         ZCUOTA           21 8          @movcuo - Variable t
     C                   Z-ADD     *ZERO         ZCUOTE           21 8          @movcuo - Cuotas tem
     C                   Z-ADD     *ZERO         ZCUPA            21 8          @movcuo - Cuotas pag
     C                   Z-ADD     *ZERO         ZCUPAD           21 8          @movcuo - Cuotas pag
     C                   Z-ADD     *ZERO         ZCUPAG           21 8          @movcuo - Cuotas pag
     C                   Z-ADD     *ZERO         ZCUPE            21 8          @pagcu2 - Cuotas pag
     C                   Z-ADD     *ZERO         ZCUPEE           21 8          Cuotas pago en exces
     C                   Z-ADD     *ZERO         ZCUPER           21 8          @rezcuo - Cuotas P.E
     C                   Z-ADD     *ZERO         ZCUPEX           21 8          Cuotas del pago adel
     C                   Z-ADD     *ZERO         ZCUPRA           21 8          Cuotas prima de segu
     C                   Z-ADD     *ZERO         ZCUREN           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUREP           21 8          @rezcu2 - Cuotas rep
     C                   Z-ADD     *ZERO         ZCURER           21 8          @rezcuo - Cuotas ren
     C                   Z-ADD     *ZERO         ZCUREZ           21 8          @movcuo - Cuotas rez
     C                   Z-ADD     *ZERO         ZCURFS           21 8          @movcuo - Cuotas ren
     C                   Z-ADD     *ZERO         ZCUSA4           21 8          Cuotas DETSA4
     C                   Z-ADD     *ZERO         ZCUSCA           21 8          @movcuo - Subtotal c
     C                   Z-ADD     *ZERO         ZCUSF            21 8          Cuotas a grabar en D
     C                   Z-ADD     *ZERO         ZCUSFA           21 8          Subtotal cuotas fond
     C                   Z-ADD     *ZERO         ZCUSFR           21 8          @rezcuo - Cuotas sub
     C                   Z-ADD     *ZERO         ZCUSFS           21 8          @movcuo - Cuotas dis
     C                   Z-ADD     *ZERO         ZCUSTA           21 8          Subtotal cuotas acre
     C                   Z-ADD     *ZERO         ZCUSTR           21 8          @rezcuo - Cuotas sub
     C                   Z-ADD     *ZERO         ZCUS07           21 8          Cuotas DETS07
     C                   Z-ADD     *ZERO         ZCUS97           21 8          Cuotas DETS97
     C                   Z-ADD     *ZERO         ZCUS98           21 8          Cuotas DETS98
     C                   Z-ADD     *ZERO         ZCUTEM           21 8          @movcuo - Variable t
     C                   Z-ADD     *ZERO         ZCUTER           21 8          @depnu3 - Cuotas ter
     C                   MOVE      *BLANK        ZCUTIP            1            Tipo de acuerdo
     C                   Z-ADD     *ZERO         ZCUTOA           21 8          Total cuotas acredit
     C                   Z-ADD     *ZERO         ZCUTOR           21 8          @rezcuo - Cuotas tot
     C                   Z-ADD     *ZERO         ZCUTRE           21 8          Total cuotas acredit
     C                   Z-ADD     *ZERO         ZCUTRR           21 8          @rezcuo - Cuotas tot
     C                   Z-ADD     *ZERO         ZCUVAA           21 8          Cuotas C.V.A. acredi
     C                   Z-ADD     *ZERO         ZCUVAR           21 8          @rezcuo - Cuotas C.V
     C                   Z-ADD     *ZERO         ZCUVEA           21 8          Cuotas C.V.E acredit
     C                   Z-ADD     *ZERO         ZCUVER           21 8          @rezcuo - Cuotas C.V
     C                   Z-ADD     *ZERO         ZCU120           21 8          Cuotas DET120
     C                   Z-ADD     *ZERO         ZCU127           21 8          Cuotas DET127
     C                   Z-ADD     *ZERO         ZCVPAG           21 8          Cuotas a fec.Deposit
     C                   MOVE      *BLANK        ZDATO            12            Entrada de la DTAQ
     C                   Z-ADD     *ZERO         ZDECTO            9 0          descuento a IBC por
     C                   Z-ADD     *ZERO         ZDEINF           21 8          delta inferior dif c
     C                   Z-ADD     *ZERO         ZDELDI           15 0          Delta dinámico
     C                   Z-ADD     *ZERO         ZDELIN            6 0          Delta inferior para
     C                   Z-ADD     *ZERO         ZDELPO           15 2          Delta por porcentaje
     C                   Z-ADD     *ZERO         ZDELTA           21 8          @conval - Valor del
     C                   MOVE      *BLANK        ZDELTX           21            Valor del delta TRCO
     C                   MOVE      *BLANK        ZDENAC            1            Detalle de deuda dif
     C                   Z-ADD     *ZERO         ZDEPO             7 0          @planu9 - Número de
     C                   MOVE      *BLANK        ZDEPR1            1            Descargar programas
     C                   Z-ADD     *ZERO         ZDEREZ            9 0          Deuda prorrateada pa
     C                   MOVE      *BLANK        ZDESDB            1            Trabajo - Indicador
     C                   MOVE      *BLANK        ZDESOC           50            Desc. ocupación
     C                   Z-ADD     *ZERO         ZDESUP           21 8          delta superior dif c
     C                   MOVE      *BLANK        ZDETAL            1            Ind calculo interese
     C                   MOVE      *BLANK        ZDETFU            1            Indica si detalle de
     C                   MOVE      *BLANK        ZDET65            1            Indicador busqueda D
     C                   MOVE      *BLANK        ZDEUDA            2            @DEUTIP - Trabajo -
     C                   Z-ADD     *ZERO         ZDEUDE           13 0          Saldo deuda
     C                   Z-ADD     *ZERO         ZDEURE           15 0          Deuda rezago
     C                   Z-ADD     *ZERO         ZDEUSA            9 0          Saldo de deuda a anu
     C                   Z-ADD     *ZERO         ZDEUTE           15 0          Deuda temporal
     C                   Z-ADD     *ZERO         ZDFCUO           21 8          diferencia en cuotas
     C                   Z-ADD     *ZERO         ZDFPES           15 0          diferencia en pesos
     C                   Z-ADD     *ZERO         ZDIACO            2 0          Dias reportados labo
     C                   Z-ADD     *ZERO         ZDIALI            2 0          Días de licencia
     C                   Z-ADD     *ZERO         ZDIAME            2 0          Días del mes de la p
     C                   Z-ADD     *ZERO         ZDIAPE            3 0          Días del período
     C                   Z-ADD     *ZERO         ZDIARE            2 0          Dias reportados
     C                   Z-ADD     *ZERO         ZDIAS             2 0          Días límite de pago
     C                   Z-ADD     *ZERO         ZDIASC            5 0          Días cotizados
     C                   MOVE      *BLANK        ZDIASM            2            Días del mes en alfa
     C                   Z-ADD     *ZERO         ZDIASR            5 0          Dias a restar
     C                   Z-ADD     *ZERO         ZDIAS1            2 0          Día de pago del empl
     C                   Z-ADD     *ZERO         ZDIATO            5 0          Numero dias totales
     C                   Z-ADD     *ZERO         ZDICCR           21 8          @comsa1 - Dif. cuota
     C                   Z-ADD     *ZERO         ZDICVA           21 8          Diferencia en cotiz.
     C                   Z-ADD     *ZERO         ZDIDEC            3 0          Número de días Acr.
     C                   Z-ADD     *ZERO         ZDIF             15 0          Diferencia
     C                   Z-ADD     *ZERO         ZDIFAR           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDIFAU           21 8          Diferencia INGARC cu
     C                   Z-ADD     *ZERO         ZDIFAV           15 2          Diferencia INGARC va
     C                   Z-ADD     *ZERO         ZDIFCO           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDIFDE           21 8          Diferencia
     C                   Z-ADD     *ZERO         ZDIFE             9 0          Valor diferencia
     C                   Z-ADD     *ZERO         ZDIFED           11 0          Diferencia entre tot
     C                   Z-ADD     *ZERO         ZDIFFS           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDIFGP           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDIFPA            9 0          Diferencia en cotiza
     C                   Z-ADD     *ZERO         ZDIFPL           11 0          Diferencia entre tot
     C                   Z-ADD     *ZERO         ZDIFVA           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDIFVE           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDIIAR           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDIIFG           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDIIFS           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDIINT           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDIISF           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDIIVA           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDIIVE           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDILIC            2 0          Dias licencia report
     C                   Z-ADD     *ZERO         ZDIPAG            2 0          Dias recalculados RP
     C                   Z-ADD     *ZERO         ZDIREN           11 0          Diferencia cotizació
     C                   Z-ADD     *ZERO         ZDISE1            2 0          Días 1 semana decret
     C                   Z-ADD     *ZERO         ZDISE2            2 0          Días 2 semanas decre
     C                   Z-ADD     *ZERO         ZDISE3            2 0          Días 3 semanas decre
     C                   Z-ADD     *ZERO         ZDISE4            2 0          Días 4 semanas decre
     C                   Z-ADD     *ZERO         ZDISFS           11 0          Diferencia cotizació
     C                   MOVE      *BLANK        ZDISPE            1            Indicador de distrib
     C                   MOVE      *BLANK        ZDIS1X            2            Días semana 1 TRCONF
     C                   MOVE      *BLANK        ZDIS2X            2            Días semana 2 TRCONF
     C                   MOVE      *BLANK        ZDIS3X            2            Días semana 3 TRCONF
     C                   MOVE      *BLANK        ZDIS4X            2            Días semana 4 TRCONF
     C                   Z-ADD     *ZERO         ZDITRA            2 0          Dias trabajados repo
     C                   Z-ADD     *ZERO         ZDIVIS            4 0          divisor
     C                   Z-ADD     *ZERO         ZDLA53            2 0          Dias licencia actual
     C                   Z-ADD     *ZERO         ZDLC53            2 0          Dias licencia recalc
     C                   MOVE      *BLANK        ZDOCUM            3            Documento de certifi
     C                   MOVE      *BLANK        ZDONES            1            Donde se encuentra e
     C                   Z-ADD     *ZERO         ZDPLAN           12 0          Número de la planill
     C                   MOVE      *BLANK        ZDRACC            1            Acción a realizar
     C                   Z-ADD     *ZERO         ZDRCDI            9 0          Código interno afili
     C                   MOVE      *BLANK        ZDRERR            1            Indicador de error
     C                   MOVE      *BLANK        ZDRFSI            8            Fecha de siniestro o
     C                   Z-ADD     *ZERO         ZDRNID           11 0          Número identificació
     C                   Z-ADD     *ZERO         ZDRPAG            3 0          Número de pagina
     C                   MOVE      *BLANK        ZDRPER            6            Periodo del aporte
     C                   Z-ADD     *ZERO         ZDRPLA           12 0          Número de planilla
     C                   MOVE      *BLANK        ZDRREZ            2            Rezago a registrar
     C                   Z-ADD     *ZERO         ZDRSEC            3 0          Numero de secuencia
     C                   MOVE      *BLANK        ZDRTID            3            Tipo identificación
     C                   Z-ADD     *ZERO         ZDTA53            2 0          Dias trabajados actu
     C                   Z-ADD     *ZERO         ZDTC53            2 0          Dias trabajados reca
     C                   Z-ADD     *ZERO         ZDTNU3           12 0          numero planilla
     C                   Z-ADD     *ZERO         ZDTPAG            3 0          Pagina
     C                   Z-ADD     *ZERO         ZDTSEC            3 0          secuencia
     C                   Z-ADD     *ZERO         ZDTVA8            9 0          Valor retención cont
     C                   Z-ADD     *ZERO         ZD1199            1 0          Desarrollo especial
     C                   Z-ADD     *ZERO         ZD7046            1 0          Desarrollo especial
     C                   Z-ADD     *ZERO         ZE                9 0          @PLACOD - Codigo emp
     C                   Z-ADD     *ZERO         ZEMPAR            1 0          Indica lectura de EM
     C                   Z-ADD     *ZERO         ZEMPLA            9 0          Código interno emple
     C                   Z-ADD     *ZERO         ZEMPLE           11 0          @PLANU4 - Identifica
     C                   Z-ADD     *ZERO         ZEMPPL            9 0          @PLACOD - Cód emplea
     C                   MOVE      *BLANK        ZENTI             2            Identifica la entida
     C                   MOVE      *BLANK        ZENTID            1            Número de entidad a
     C                   MOVE      *BLANK        ZENTIX            9            Código del cliente T
     C                   Z-ADD     *ZERO         ZENTI1            9 0          @consec - Código del
     C                   MOVE      *BLANK        ZENTRA            1            Ind. entrar a proces
     C                   MOVE      *BLANK        ZER              67            Mensaje de error - t
     C                   MOVE      *BLANK        ZERCON            1            Indicador de error c
     C                   MOVE      *BLANK        ZERRAN            1            Indicador de error a
     C                   MOVE      *BLANK        ZERRDE            1            Error al recuperar d
     C                   MOVE      *BLANK        ZERRET           60            Mensaje error en apl
     C                   MOVE      *BLANK        ZERROR           67            Mensaje de error
     C                   MOVE      *BLANK        ZERROX           67            Mensaje de error TRC
     C                   MOVE      *BLANK        ZERRO2            1            Indicador error HSSU
     C                   MOVE      *BLANK        ZERR1            67            Mensaje de error
     C                   MOVE      *BLANK        ZESDE1            1            Ind. periodo Covid
     C                   MOVE      *BLANK        ZESRAE            1            Ind. estado relacion
     C                   MOVE      *BLANK        ZESTA             3            Estado de bloqueo in
     C                   MOVE      *BLANK        ZESTAD            3            V. de trabajo - Esta
     C                   MOVE      *BLANK        ZESTPL            1            Estado del movimient
     C                   MOVE      *BLANK        ZESTPR            1            Estado del proceso
     C                   MOVE      *BLANK        ZES13P            1            ind de 13% en retroa
     C                   MOVE      *BLANK        ZES3P             1            es una acred del 3%
     C                   MOVE      *BLANK        ZETNOV            1            Indicador de novedad
     C                   Z-ADD     *ZERO         ZETNU9           12 0          Planilla
     C                   Z-ADD     *ZERO         ZETPA2            3 0          Página
     C                   MOVE      *BLANK        ZETPER            6            Periodo
     C                   Z-ADD     *ZERO         ZETSA1            9 0          Saldo CO detalle de
     C                   Z-ADD     *ZERO         ZETSA4            9 0          @DETSA4
     C                   Z-ADD     *ZERO         ZETSE4            3 0          Secuencia
     C                   MOVE      *BLANK        ZETSUB            3            Auxiliar de subestad
     C                   Z-ADD     *ZERO         ZETS07            9 0          @DETS07
     C                   Z-ADD     *ZERO         ZET120           15 2          @det120
     C                   MOVE      *BLANK        ZEVALU            1            Indicador evaluar de
     C                   MOVE      *BLANK        ZEXFSP            1            FSPARC IndExiste
     C                   MOVE      *BLANK        ZEXIST            1            Indica si existe reg
     C                   MOVE      *BLANK        ZEXITT            1            indicador de que exi
     C                   MOVE      *BLANK        ZEXI53            1            Ind. existe RECA53
     C                   MOVE      *BLANK        ZEXREG            1            Existencia de duplic
     C                   Z-ADD     *ZERO         ZEZNRO           12 0          Numero rezago aux
     C                   MOVE      *BLANK        ZF                8            Fecha de interés ley
     C                   MOVE      *BLANK        ZFAFIR            8            Fecha anterior al in
     C                   MOVE      *BLANK        ZFD               8            @plafec-Fecha deposi
     C                   MOVE      *BLANK        ZFDARC            1            Indica fin de archiv
     C                   MOVE      *BLANK        ZFDE              8            @depfec - Fecha de d
     C                   MOVE      *BLANK        ZFDEFO            8            Fecha depósito fondo
     C                   MOVE      *BLANK        ZFDEPA            8            @DEPFEC - fecha dep.
     C                   MOVE      *BLANK        ZFDING            8            Fecha Deposito Pago
     C                   MOVE      *BLANK        ZFDREC            3            Fondo RPREDI50
     C                   MOVE      *BLANK        ZFEC              8            Fecha a grabar de re
     C                   MOVE      *BLANK        ZFECDE            8            @depfec - Fecha de d
     C                   MOVE      *BLANK        ZFECD1            8            Fecha de depósito pa
     C                   MOVE      *BLANK        ZFECED           10            Fecha del sistema ed
     C                   MOVE      *BLANK        ZFECFU            8            Fecha Fusion ING-Pro
     C                   MOVE      *BLANK        ZFECHA            8            Fecha límite de pago
     C                   MOVE      *BLANK        ZFECH1            8            V. de trabajo - Fech
     C                   MOVE      *BLANK        ZFECH2            8            Fecha de trabajo
     C                   MOVE      *BLANK        ZFECH3            8            Fecha TRFEQA48
     C                   MOVE      *BLANK        ZFECOM            1            Indicador de fecha a
     C                   MOVE      *BLANK        ZFECPA            8            Fecha primer pago
     C                   MOVE      *BLANK        ZFECPE            8            Fecha del período
     C                   MOVE      *BLANK        ZFECPR            8            Fecha primer pago re
     C                   MOVE      *BLANK        ZFECP1            8            fecha del perioso
     C                   MOVE      *BLANK        ZFEC01            8            Fecha inicio relacio
     C                   MOVE      *BLANK        ZFEC53            8            Fecha RECA53
     C                   MOVE      *BLANK        ZFEDEP            8            Fecha depósito de la
     C                   MOVE      *BLANK        ZFEDPE            8            Fecha para calcular
     C                   MOVE      *BLANK        ZFEFIR            8            Fecha final rezagos
     C                   MOVE      *BLANK        ZFEFON            8            Fecha fondo TRDAPV58
     C                   MOVE      *BLANK        ZFEFSP            8            FSPARC Fecha
     C                   MOVE      *BLANK        ZFEIND            8            @detf10 - Fecha inic
     C                   MOVE      *BLANK        ZFEINI            8            Fecha de comparación
     C                   MOVE      *BLANK        ZFEINR            8            Fecha inicial rezago
     C                   MOVE      *BLANK        ZFEINX            8            Fecha inicial relaci
     C                   MOVE      *BLANK        ZFEINY            8            Fecha inicial relaci
     C                   MOVE      *BLANK        ZFEIN2            8            Fecha ley 1607
     C                   MOVE      *BLANK        ZFEL              8            Fecha límite en cálc
     C                   MOVE      *BLANK        ZFEPER            8            Trabajo- Fecha mes a
     C                   MOVE      *BLANK        ZFEPGG            8            fecha pago plan a la
     C                   MOVE      *BLANK        ZFEREC            8            Fecha DIAREC
     C                   MOVE      *BLANK        ZFEREF            8            Fecha de vigencia re
     C                   MOVE      *BLANK        ZFERIN            8            Fecha para independi
     C                   MOVE      *BLANK        ZFESIS            8            Fecha del sistema
     C                   MOVE      *BLANK        ZFETMP            8            fecha temp meses MES
     C                   MOVE      *BLANK        ZFETRA            8            Fecha de trabajo
     C                   MOVE      *BLANK        ZFEVIG            8            Fecha vigencia proce
     C                   Z-ADD     *ZERO         ZFGPHO            6 4          Porcentaje FGPM hosp
     C                   Z-ADD     *ZERO         ZFGPMP           15 0          Valor FGPM en planil
     C                   Z-ADD     *ZERO         ZFGPSI            6 4          Porcentaje FGPM situ
     C                   MOVE      *BLANK        ZFI               1            Descargar programas
     C                   MOVE      *BLANK        ZFINDE            8            Menor fecha inicio d
     C                   MOVE      *BLANK        ZFINOK            1            Ind. finalización de
     C                   MOVE      *BLANK        ZFIRVO            1            Finalizar relación d
     C                   MOVE      *BLANK        ZFITIP            1            Tipo de afiliado
     C                   MOVE      *BLANK        ZFLQIN            8            Menor fecha de liq.
     C                   MOVE      *BLANK        ZFO               1            forma de presentacio
     C                   MOVE      *BLANK        ZFOFSP            3            FSPARC fondo
     C                   MOVE      *BLANK        ZFONDO            3            Código de fondo
     C                   MOVE      *BLANK        ZFONDX            3            Código de fondo TRCO
     C                   MOVE      *BLANK        ZFON53            3            Fondo RECA53
     C                   MOVE      *BLANK        ZFORDE            1            Forma de presentació
     C                   Z-ADD     *ZERO         ZFQN17           12 0          Planilla original
     C                   Z-ADD     *ZERO         ZFS              15 2          Valor FSP
     C                   Z-ADD     *ZERO         ZFSCON            5 0          Consecutivo para FSP
     C                   Z-ADD     *ZERO         ZFSP             15 2          FSP
     C                   MOVE      *BLANK        ZFSPAR            1            Ind. existe FSPARC
     C                   Z-ADD     *ZERO         ZFSPAU           11 0          Fondo solidaridad au
     C                   Z-ADD     *ZERO         ZFSPCO           11 0          FSP correcta
     C                   MOVE      *BLANK        ZFSPRE            1            Ind. FSPARC para rez
     C                   Z-ADD     *ZERO         ZFSTOT           16 0          Total FSP
     C                   MOVE      *BLANK        ZFUCDA            1            Indicador de desarro
     C                   MOVE      *BLANK        ZFUCHO            1            Indicador fusión Col
     C                   MOVE      *BLANK        ZFUEIN            3            Fte de inactivación
     C                   MOVE      *BLANK        ZFUNC             1            Tipo de proceso
     C                   MOVE      *BLANK        ZFVFI1            8            Fecha fin FVIADI 001
     C                   MOVE      *BLANK        ZFVFI2            8            Fecha fin FVIADI 002
     C                   MOVE      *BLANK        ZFVIN1            8            Fecha inicio FVIADI
     C                   MOVE      *BLANK        ZFVIN2            8            Fecha inicio FVIADI
     C                   MOVE      *BLANK        ZFVRET            8            Fecha vigencia FVIRE
     C                   MOVE      *BLANK        ZFVTPR            1            Tipo proceso TRCONF6
     C                   MOVE      *BLANK        ZGENMV            1            Indic. de generación
     C                   MOVE      *BLANK        ZGENPE            1            Ind.de gen.P.E.plan.
     C                   MOVE      *BLANK        ZGNCON            1            Variable GENCON
     C                   MOVE      *BLANK        ZGRAMV            1            Indicador - grabació
     C                   MOVE      *BLANK        ZGRDSF            1            Ind. grabar deudas p
     C                   Z-ADD     *ZERO         ZHAYDT            9 0          Hay detalles deuda A
     C                   MOVE      *BLANK        ZHOFSP            6            FSPARC Hora
     C                   MOVE      *BLANK        ZHOR              6            Hora del sistema
     C                   MOVE      *BLANK        ZHORA             8            Hora del sistema
     C                   MOVE      *BLANK        ZHOR53            6            Hora RECA53
     C                   Z-ADD     *ZERO         ZHPDE1            6 0          Delta inferior (Hoja
     C                   Z-ADD     *ZERO         ZHPDE3            6 0          Delta superior (Hoja
     C                   Z-ADD     *ZERO         ZHPDIA            2 0          Día pago nit ter. (0
     C                   Z-ADD     *ZERO         ZHPDI2            2 0          Día pago nit ter. (1
     C                   Z-ADD     *ZERO         ZHPDI3            2 0          Día pago nit ter. (2
     C                   Z-ADD     *ZERO         ZHPDI4            2 0          Día pago nit ter. (3
     C                   Z-ADD     *ZERO         ZHPDI5            2 0          Día pago nit ter. (4
     C                   Z-ADD     *ZERO         ZHPDI6            2 0          Día pago nit ter. (5
     C                   Z-ADD     *ZERO         ZHPDI7            2 0          Día pago nit ter. (6
     C                   Z-ADD     *ZERO         ZHPDI8            2 0          Día pago nit ter. (7
     C                   Z-ADD     *ZERO         ZHPDI9            2 0          Día pago nit ter. (8
     C                   Z-ADD     *ZERO         ZHPD01            2 0          Día pago nit ter. (9
     C                   MOVE      *BLANK        ZHPIND            1            Indicador de error (
     C                   Z-ADD     *ZERO         ZHPINT            5 2          Interes anual de mor
     C                   Z-ADD     *ZERO         ZHPMAX            2 0          Número máximo de sal
     C                   Z-ADD     *ZERO         ZHPN05            2 0          Número de salarios m
     C                   Z-ADD     *ZERO         ZHPN24            2 0          Número de salarios m
     C                   Z-ADD     *ZERO         ZHPN26            3 0          Núemro días período
     C                   MOVE      *BLANK        ZHPPE1            6            @PLAPER - Período (H
     C                   Z-ADD     *ZERO         ZHPPOR            5 2          Porcentaje (Hoja I)
     C                   Z-ADD     *ZERO         ZHPPO1            7 5          Porcentaje comisión
     C                   Z-ADD     *ZERO         ZHPPO2            7 5          Porcentaje prima de
     C                   Z-ADD     *ZERO         ZHPPO3            5 2          Porcentaje com. cot.
     C                   Z-ADD     *ZERO         ZHPPO4            5 2          Porcentaje solidarid
     C                   Z-ADD     *ZERO         ZHPPO5            5 2          Porcentaje comisión
     C                   Z-ADD     *ZERO         ZHPP49            5 2          Porcentaje FGPM (Hoj
     C                   Z-ADD     *ZERO         ZHPP50            5 2          Porc. a ditribuir su
     C                   Z-ADD     *ZERO         ZHPVA2            9 0          Valor salario mínimo
     C                   Z-ADD     *ZERO         ZHPV14            9 0          Valor límite para re
     C                   Z-ADD     *ZERO         ZIADIA            3 0          Días acreditados aux
     C                   Z-ADD     *ZERO         ZIBCAF            9 0          Salario base de coti
     C                   Z-ADD     *ZERO         ZIBFSP            9 0          IBC para FSP
     C                   Z-ADD     *ZERO         ZICCVA           11 0          Intereses compuestos
     C                   Z-ADD     *ZERO         ZICCVE           11 0          Intereses compuestos
     C                   MOVE      *BLANK        ZICL            105            intereses compuestos
     C                   MOVE      *BLANK        ZICRSF            1            Ind. cruce comp. del
     C                   Z-ADD     *ZERO         ZID              11 0          Identificación del a
     C                   MOVE      *BLANK        ZIDENA           11            Ident. afiliado
     C                   Z-ADD     *ZERO         ZIDENT           11 0          @AFIC01 - Ident. afi
     C                   Z-ADD     *ZERO         ZIDPLA           11 0          @PLANU4 - Identifica
     C                   Z-ADD     *ZERO         ZIFGRE            9 0          @rezint - Int.FGPM d
     C                   Z-ADD     *ZERO         ZIFRZO           15 0          intereses FSP rezago
     C                   Z-ADD     *ZERO         ZIFSRE            9 0          @rezint - Int.f.s. d
     C                   MOVE      *BLANK        ZIGUAR            1            indicador guardar
     C                   Z-ADD     *ZERO         ZIICVA           11 0          Int simple fondo cva
     C                   Z-ADD     *ZERO         ZIICVE           11 0          Int simple fondo cve
     C                   Z-ADD     *ZERO         ZIITAR           11 0          Int simple fondo AR
     C                   Z-ADD     *ZERO         ZIITER           11 0          Int simple fondo obl
     C                   Z-ADD     *ZERO         ZIITFG           11 0          Int simple fondo FGP
     C                   Z-ADD     *ZERO         ZIITFS           11 0          Int simple fondo sol
     C                   Z-ADD     *ZERO         ZIITSF           11 0          Int simple fondo sub
     C                   MOVE      *BLANK        ZINACC            1            Indicador de acción
     C                   MOVE      *BLANK        ZINACR            1            Ind acred 1. Planill
     C                   MOVE      *BLANK        ZINACT            1            Trabajo - Ind. de ac
     C                   MOVE      *BLANK        ZINANU            1            Indicador de anular
     C                   MOVE      *BLANK        ZINAPA            1            Indic. acred. pago a
     C                   MOVE      *BLANK        ZINARC            1            Indicador archivo TR
     C                   MOVE      *BLANK        ZINARE            1            Ind. inactivar rel.
     C                   MOVE      *BLANK        ZINC            105            intereses compuestos
     C                   MOVE      *BLANK        ZINCAD            1            Indicador cancelació
     C                   Z-ADD     *ZERO         ZINCAR           11 0          Intereses compuestos
     C                   MOVE      *BLANK        ZINCDE            1            Ind. canc. deudas an
     C                   MOVE      *BLANK        ZINCES            1            Indicador D.E Cesant
     C                   Z-ADD     *ZERO         ZINCFG           11 0          Intereses compuestos
     C                   Z-ADD     *ZERO         ZINCFS           11 0          Intereses compuestos
     C                   Z-ADD     *ZERO         ZINCNT           11 0          Intereses compuestos
     C                   MOVE      *BLANK        ZINCOM            1            Indica debe o no cob
     C                   Z-ADD     *ZERO         ZINCSF           11 0          Intereses compuestos
     C                   Z-ADD     *ZERO         ZINCVA           11 0          movcot - Intereses c
     C                   Z-ADD     *ZERO         ZINCVE           11 0          movcot - Intereses c
     C                   MOVE      *BLANK        ZIND              1            Indicador de proceso
     C                   MOVE      *BLANK        ZINDAJ            1            Indicador deuda acue
     C                   MOVE      *BLANK        ZINDAN            1            Indicador de anular
     C                   MOVE      *BLANK        ZINDAR            1            Ind. fusión archivo
     C                   MOVE      *BLANK        ZINDAS            1            Indicador afiliado e
     C                   Z-ADD     *ZERO         ZINDAU            1 0          ind. de autorización
     C                   MOVE      *BLANK        ZINDBO            1            Indicador borrado re
     C                   MOVE      *BLANK        ZINDCA            1            Código causal. Deuda
     C                   MOVE      *BLANK        ZINDCE            1            indicador cobro cesa
     C                   MOVE      *BLANK        ZINDCO            1            Indicador existe con
     C                   MOVE      *BLANK        ZINDDT            1            Indicador ciclo infi
     C                   MOVE      *BLANK        ZINDEL            1            Indicador calculo de
     C                   MOVE      *BLANK        ZINDER            1            Indicador de error
     C                   Z-ADD     *ZERO         ZINDES            1 0          Ind. Acceso a Desar-
     C                   MOVE      *BLANK        ZINDEU            1            Indicador deuda
     C                   MOVE      *BLANK        ZINDE2            1            Indicador de error 7
     C                   MOVE      *BLANK        ZINDE3            1            Indicador Pago en ex
     C                   MOVE      *BLANK        ZINDFE            1            Indicador de error p
     C                   MOVE      *BLANK        ZINDFO            2            Indicador para cance
     C                   MOVE      *BLANK        ZINDFS            1            FSPARC Indicador
     C                   MOVE      *BLANK        ZINDGR            1            Ind. grabación 1=com
     C                   Z-ADD     *ZERO         ZINDIA            5 0          contador movimientos
     C                   MOVE      *BLANK        ZINDIC            1            Indicador de encontr
     C                   MOVE      *BLANK        ZINDIF            1            Ind. diferencia
     C                   MOVE      *BLANK        ZINDI2            1            Indicador confirma I
     C                   MOVE      *BLANK        ZINDLI            1            Indicador de liquida
     C                   MOVE      *BLANK        ZINDLL            1            Indicador de llamado
     C                   MOVE      *BLANK        ZINDMI            1            Indica pago en exces
     C                   MOVE      *BLANK        ZINDMS            1            Indicador marcar sub
     C                   MOVE      *BLANK        ZINDNI            1            Indicador no identif
     C                   MOVE      *BLANK        ZINDOP            1            Indicador de llamado
     C                   MOVE      *BLANK        ZINDP             1            Indicador
     C                   MOVE      *BLANK        ZINDPA            1            Indicador pago adela
     C                   MOVE      *BLANK        ZINDPE            1            Indicador pago en ex
     C                   MOVE      *BLANK        ZINDPL            1            Ind. Existe planilla
     C                   MOVE      *BLANK        ZINDRS            1            Ind. recálculo salar
     C                   Z-ADD     *ZERO         ZINDSO            1 0          Ind. sol. estado cta
     C                   MOVE      *BLANK        ZINDSX            1            Ind. sol. estado cta
     C                   MOVE      *BLANK        ZINDTE            1            Indicador proceso po
     C                   MOVE      *BLANK        ZINDUL            1            Indicador de ultimo
     C                   MOVE      *BLANK        ZIND05            1            Indicador de conc. C
     C                   MOVE      *BLANK        ZIND48            1            Indicador encontro r
     C                   MOVE      *BLANK        ZINEER            1            Indicador de error
     C                   MOVE      *BLANK        ZINEP5            1            Indicador no encuent
     C                   MOVE      *BLANK        ZINERE            1            Indicador de ERE o N
     C                   Z-ADD     *ZERO         ZINFDE           15 0          Intereses fsp detall
     C                   MOVE      *BLANK        ZINFH3            1            Indicador Existencia
     C                   Z-ADD     *ZERO         ZINFSP            9 0          FSPARC interno
     C                   MOVE      *BLANK        ZINFUS            1            Indicador archivo
     C                   Z-ADD     *ZERO         ZINIFG           11 0          movcot - Intereses F
     C                   Z-ADD     *ZERO         ZINIFS           11 0          movcot - Intereses f
     C                   MOVE      *BLANK        ZININA            1            Indicador DE Cesante
     C                   Z-ADD     *ZERO         ZININT           11 0          movcot - Intereses c
     C                   Z-ADD     *ZERO         ZINISF           11 0          movcot - Intereses s
     C                   MOVE      *BLANK        ZINLLA            1            Ind llamado
     C                   Z-ADD     *ZERO         ZINMIC           11 0          Intereses minimos CO
     C                   Z-ADD     *ZERO         ZINMIF           11 0          Intereses minimos FS
     C                   Z-ADD     *ZERO         ZINNAR           11 0          movcot - Intereses a
     C                   MOVE      *BLANK        ZINOAF            1            Indicador de Envío o
     C                   MOVE      *BLANK        ZINOCU            1            Indicador ocupación
     C                   Z-ADD     *ZERO         ZINPAA            1 0          Ind. pago adelantado
     C                   MOVE      *BLANK        ZINPAG            2            Indicador para actua
     C                   MOVE      *BLANK        ZINPAV            1            Indicador de P.A. vá
     C                   MOVE      *BLANK        ZINPAX            1            Ind. pago adelantado
     C                   MOVE      *BLANK        ZINPEA            1            indicador periodo ac
     C                   MOVE      *BLANK        ZINPED            1            Indicador de P.E de
     C                   MOVE      *BLANK        ZINPEE            1            Ind. valorización pa
     C                   MOVE      *BLANK        ZINPIN            1            Ind. de pago de inte
     C                   MOVE      *BLANK        ZINPLA            1            Indicador del tipo d
     C                   Z-ADD     *ZERO         ZINPLO           12 0          Valor de interes min
     C                   MOVE      *BLANK        ZINPRO            1            Indicador de proceso
     C                   MOVE      *BLANK        ZINREF            1            Indicador si se ejec
     C                   MOVE      *BLANK        ZINRTN            1            Indicador de retorna
     C                   Z-ADD     *ZERO         ZINRZO           15 0          intereses normales p
     C                   MOVE      *BLANK        ZINS             77            intereses simples un
     C                   Z-ADD     *ZERO         ZINSF             9 0          Intereses a grabar e
     C                   Z-ADD     *ZERO         ZINSFS            9 0          Intereses SFSub
     C                   MOVE      *BLANK        ZINSQC            1            indicador de cursor
     C                   MOVE      *BLANK        ZINSUM            1            Indicador suma a rez
     C                   MOVE      *BLANK        ZINSU1            1            Indicador suma tipo
     C                   Z-ADD     *ZERO         ZINTCO           11 0          Trabajo - Intereses
     C                   Z-ADD     *ZERO         ZINTDE           15 0          Intereses detalle
     C                   MOVE      *BLANK        ZINTEM            1            Indicador temporal d
     C                   Z-ADD     *ZERO         ZINTER           15 2          @plarec - Intereses
     C                   MOVE      *BLANK        ZINTEX            1            Indicador terminó TR
     C                   Z-ADD     *ZERO         ZINTFG           15 2          @plarec - Intereses
     C                   Z-ADD     *ZERO         ZINTFS           15 2          @plarec - Intereses
     C                   Z-ADD     *ZERO         ZINTRE            9 0          @rezint - Intereses
     C                   Z-ADD     *ZERO         ZINTSF           15 2          @Plarec - Intereses
     C                   Z-ADD     *ZERO         ZINTTC            9 0          intereses
     C                   Z-ADD     *ZERO         ZINTTF            9 0          intereses FSP
     C                   Z-ADD     *ZERO         ZINT53            9 0          Interno RECA53
     C                   MOVE      *BLANK        ZINVAL            1            Indicador de validac
     C                   MOVE      *BLANK        ZINVA1            1            Indicador de validac
     C                   MOVE      *BLANK        ZINVA2            1            INDICADOR DE VALIDAC
     C                   MOVE      *BLANK        ZINVER            1            Indicador de verific
     C                   MOVE      *BLANK        ZIPEFP            1            Indicador existe PAG
     C                   MOVE      *BLANK        ZIRNPE            1            Indicador reste las
     C                   MOVE      *BLANK        ZIRRES            1            Indicador para inact
     C                   Z-ADD     *ZERO         ZISFRE            9 0          @rezint - Int.SFSP d
     C                   MOVE      *BLANK        ZISL             77            Intereses simples li
     C                   Z-ADD     *ZERO         ZISP60            5 2          Porcentaje comision
     C                   Z-ADD     *ZERO         ZI0INT            5 2          Porcentaje de intere
     C                   Z-ADD     *ZERO         ZI0N12            2 0          Número de salarios m
     C                   Z-ADD     *ZERO         ZI0P14            5 2          Porcentaje de cotiza
     C                   Z-ADD     *ZERO         ZI0P15            7 5          Porcentaje comisión
     C                   Z-ADD     *ZERO         ZI0P16            7 5          Porcentaje prima de
     C                   Z-ADD     *ZERO         ZI0P18            5 2          Porcentaje de solida
     C                   Z-ADD     *ZERO         ZI0P20            5 2          Porcentaje Fondo Gar
     C                   Z-ADD     *ZERO         ZI0P21            5 2          Porcentaje a distrib
     C                   MOVE      *BLANK        ZI1858            1            Indicador decreto 18
     C                   MOVE      *BLANK        ZI2616            1            indicador decreto 26
     C                   Z-ADD     *ZERO         ZI9120            1 0          Indicador de desarro
     C                   MOVE      *BLANK        ZLAAGE            5            Estado para la conci
     C                   MOVE      *BLANK        ZLABA7           10            Nombre del Banco de
     C                   MOVE      *BLANK        ZLACI8           30            Ciudad
     C                   MOVE      *BLANK        ZLACI9            5            CIUDAD
     C                   MOVE      *BLANK        ZLAD08           50            Dirección
     C                   MOVE      *BLANK        ZLAD09           30            Departamento
     C                   Z-ADD     *ZERO         ZLAD10            9 0          Deuda o pago en exce
     C                   MOVE      *BLANK        ZLAD11            5            Depto del Empleador
     C                   MOVE      *BLANK        ZLAE08            3            Estado
     C                   MOVE      *BLANK        ZLAE09            3            Estado de la Planill
     C                   MOVE      *BLANK        ZLAF39            8            Fecha Pago
     C                   MOVE      *BLANK        ZLAF40            1            Forma presentacion
     C                   MOVE      *BLANK        ZLAF41            8            Fecha Ultima Modific
     C                   MOVE      *BLANK        ZLAF42            8            Fecha del fondo en l
     C                   MOVE      *BLANK        ZLAF43            8            Fecha del sistema cu
     C                   MOVE      *BLANK        ZLAF44            8            Fecha fondo acredita
     C                   MOVE      *BLANK        ZLAI21            1            Ind. de generación p
     C                   Z-ADD     *ZERO         ZLAI22           15 2          Intereses fondo sol.
     C                   Z-ADD     *ZERO         ZLAI23           15 2          Int. saldo a cargo
     C                   MOVE      *BLANK        ZLAI24            1            Indicador planilla a
     C                   MOVE      *BLANK        ZLALO8           15            Lote de Planilla
     C                   MOVE      *BLANK        ZLAP29            6            Período Cotización
     C                   MOVE      *BLANK        ZLAP30            6            'Período corrección
     C                   MOVE      *BLANK        ZLAP31            6            Periodo desde retroa
     C                   MOVE      *BLANK        ZLAP32            6            Periodo hasta retroa
     C                   Z-ADD     *ZERO         ZLAR68           15 2          Recargos Intereses
     C                   Z-ADD     *ZERO         ZLAS09           15 2          Total cotizaciones
     C                   Z-ADD     *ZERO         ZLAS10           15 2          Sumatoria P.E. coti.
     C                   Z-ADD     *ZERO         ZLAS11           15 2          Sumatoria P.E. fondo
     C                   Z-ADD     *ZERO         ZLAS12           15 2          Saldo a cargo
     C                   MOVE      *BLANK        ZLATE9           12            Teléfono
     C                   MOVE      *BLANK        ZLAU05           10            Usuario Ultima Modif
     C                   Z-ADD     *ZERO         ZLAVL6           15 2          Valor devuelto por s
     C                   Z-ADD     *ZERO         ZLAV16           15 2          Valor a pagado en  e
     C                   Z-ADD     *ZERO         ZLAV17           15 2          Valor de Planilla Co
     C                   Z-ADD     *ZERO         ZLAV18           15 2          Valor detalles dev.
     C                   Z-ADD     *ZERO         ZLA112           12 0          Número Planilla Int.
     C                   Z-ADD     *ZERO         ZLA113           12 0          Número de Planilla F
     C                   MOVE      *BLANK        ZLA114            2            Tipo Planilla
     C                   MOVE      *BLANK        ZLA115            2            Tipo de Pago
     C                   Z-ADD     *ZERO         ZLA116           11 0          Nro. identificación
     C                   Z-ADD     *ZERO         ZLA117            9 0          Código int.afil/emp
     C                   MOVE      *BLANK        ZLA118            3            Tipo Identifcacion
     C                   Z-ADD     *ZERO         ZLA119           12 0          Número de planilla a
     C                   MOVE      *BLANK        ZLA120          120            Razon social emplead
     C                   MOVE      *BLANK        ZLA121           50            Nombre Rep. Legal
     C                   MOVE      *BLANK        ZLA122            3            Tipo ID.Rep.Legal
     C                   Z-ADD     *ZERO         ZLA123           11 0          Nro. identificación
     C                   MOVE      *BLANK        ZLA124           50            Nombre jefe personal
     C                   MOVE      *BLANK        ZLA125            1            Clase aportante
     C                   MOVE      *BLANK        ZLA126           10            Codigo de sucursal
     C                   Z-ADD     *ZERO         ZLA127            5 0          Numero total emplead
     C                   Z-ADD     *ZERO         ZLA128            5 0          Numero afiliados
     C                   MOVE      *BLANK        ZLA129            5            Código Entidad Rec.
     C                   Z-ADD     *ZERO         ZLA130            7 0          Número lote depósito
     C                   Z-ADD     *ZERO         ZLA131            7 0          Número de depósito
     C                   Z-ADD     *ZERO         ZLA132            5 0          Consecutivo deposito
     C                   MOVE      *BLANK        ZLA133            5            Codigo oficina
     C                   MOVE      *BLANK        ZLA134            3            Codigo causa
     C                   MOVE      *BLANK        ZLA135            3            Codigo tipo liquidac
     C                   Z-ADD     *ZERO         ZLA136            2 0          Codigo operador
     C                   Z-ADD     *ZERO         ZLA137           15 2          Total Cotizac.Oblig.
     C                   Z-ADD     *ZERO         ZLA138           15 2          Total Cot.Volunta.
     C                   Z-ADD     *ZERO         ZLA139           15 2          Total Cot.Vol.Empl.
     C                   Z-ADD     *ZERO         ZLA140           15 2          Total fondo solidari
     C                   Z-ADD     *ZERO         ZLA141           15 2          Total a Pagar al Fon
     C                   Z-ADD     *ZERO         ZLA142           15 2          Total pagado por pag
     C                   Z-ADD     *ZERO         ZLA143           12 0          Número planilla oríg
     C                   Z-ADD     *ZERO         ZLA144           15 2          Total planilla
     C                   Z-ADD     *ZERO         ZLA145            5 0          Total de Afiliados R
     C                   Z-ADD     *ZERO         ZLA146           15 2          Total pagado en cheq
     C                   MOVE      *BLANK        ZLA147           10            Número de Cheque de
     C                   MOVE      *BLANK        ZLA148           17            Número de Cuenta de
     C                   Z-ADD     *ZERO         ZLA149           21 8          Número de Cuotas Con
     C                   Z-ADD     *ZERO         ZLA150           15 2          Total calculado al f
     C                   Z-ADD     *ZERO         ZLA151           15 2          Total sumado para la
     C                   Z-ADD     *ZERO         ZLA152            9 0          Costos de Cobranza
     C                   Z-ADD     *ZERO         ZLA153           21 8          Cuotas dev. rezagos
     C                   Z-ADD     *ZERO         ZLA154           15 2          Total sumado F.S.
     C                   Z-ADD     *ZERO         ZLA155           15 2          Total rendimientos
     C                   Z-ADD     *ZERO         ZLA156           15 2          Total sumado rendim.
     C                   Z-ADD     *ZERO         ZLA157           21 8          Cuotas apli. pago a.
     C                   MOVE      *BLANK        ZLA158            4            Cod. sucursal riesgo
     C                   MOVE      *BLANK        ZLA159            1            Tipo retroactivo
     C                   MOVE      *BLANK        ZLA180            1            Tipo planilla PLAA66
     C                   Z-ADD     *ZERO         ZLD               7 0          Lote deposito
     C                   Z-ADD     *ZERO         ZLDFSP            7 0          FSPARC LoteDep
     C                   MOVE      *BLANK        ZLDTAQ           10            Librería de la DTAQ
     C                   Z-ADD     *ZERO         ZLINFC           21 8          @comsa1 - Limite inf
     C                   MOVE      *BLANK        ZLIQIN            1            Indicador calculo in
     C                   MOVE      *BLANK        ZLLAMA            1            Modo de llamado al p
     C                   MOVE      *BLANK        ZLLAM1            1            Tipo de llamado
     C                   MOVE      *BLANK        ZLLFSP            1            Llamado RPFSP1858
     C                   MOVE      *BLANK        ZLLPLZ            1            Indicador llamado de
     C                   Z-ADD     *ZERO         ZLONG             5 0          Longitud DTAQ
     C                   MOVE      *BLANK        ZLOT             15            @planu3 - Lote de la
     C                   Z-ADD     *ZERO         ZLOTE             7 0          @planu8 - Número del
     C                   MOVE      *BLANK        ZLOTED            7            Lote del depósito (a
     C                   Z-ADD     *ZERO         ZLSUFC           21 8          @comsa1 - Límite sup
     C                   MOVE      *BLANK        ZMARCA            1            Marcación sin aporte
     C                   MOVE      *BLANK        ZMDACC            1            Acción a realizar
     C                   Z-ADD     *ZERO         ZMDCO3            9 0          Código interno afili
     C                   MOVE      *BLANK        ZMDFE7            8            Fecha sistema modifi
     C                   MOVE      *BLANK        ZMDFE8            8            Fecha fondo última m
     C                   MOVE      *BLANK        ZMDHO4            6            Hora de modificación
     C                   Z-ADD     *ZERO         ZMDNU7           11 0          Numero id afiliado
     C                   MOVE      *BLANK        ZMDTI7            3            Tipo id afiliado
     C                   MOVE      *BLANK        ZMES              2            Mes de la planilla
     C                   MOVE      *BLANK        ZMESCO            2            Mes cotización
     C                   Z-ADD     *ZERO         ZMESDI            2 0          Meses de diferencia
     C                   Z-ADD     *ZERO         ZMESES            8 0          Meses a sumar
     C                   MOVE      *BLANK        ZMESPE            2            Mes de cotización de
     C                   Z-ADD     *ZERO         ZMICOM           11 0          Valor de intereses c
     C                   MOVE      *BLANK        ZMODO             1            Modo de ejecución
     C                   Z-ADD     *ZERO         ZMODUL            4 0          modulo de la divisio
     C                   Z-ADD     *ZERO         ZMOVCU           21 8          movimiento en cuotas
     C                   Z-ADD     *ZERO         ZMOVPE           15 0          valor en pesos del m
     C                   MOVE      *BLANK        ZMPI20            1            Aux indicador ilocal
     C                   MOVE      *BLANK        ZMPTI6            1            Tipo de empresa
     C                   Z-ADD     *ZERO         ZMVCNN            5 0          ultimo consec de mov
     C                   Z-ADD     *ZERO         ZMVCON            5 0          Consecutivo MOVARC
     C                   Z-ADD     *ZERO         ZMVINT            9 0          ult codigo interno g
     C                   Z-ADD     *ZERO         ZMVPAG            3 0          pagina MV
     C                   Z-ADD     *ZERO         ZMVPLA           12 0          Planilla ajuste
     C                   Z-ADD     *ZERO         ZMVSEC            3 0          secuencua ajuste
     C                   Z-ADD     *ZERO         ZND               7 0          Numero deposito
     C                   Z-ADD     *ZERO         ZNDFSP            7 0          FSPARC NumDep
     C                   MOVE      *BLANK        ZNDTAQ           10            Nombre de la DTAQ
     C                   MOVE      *BLANK        ZNFCL2            1            Clase aportante PILA
     C                   Z-ADD     *ZERO         ZNFCV3            9 0          Valor cot. voluntari
     C                   Z-ADD     *ZERO         ZNFCV4            9 0          Valor Coti. voluntar
     C                   Z-ADD     *ZERO         ZNFC24            9 0          Código int. afiliado
     C                   Z-ADD     *ZERO         ZNFC25            9 0          Código int. empl.
     C                   Z-ADD     *ZERO         ZNFDE7            9 0          Deuda ISS
     C                   Z-ADD     *ZERO         ZNFDE8            9 0          Deuda empleador
     C                   Z-ADD     *ZERO         ZNFDE9            9 0          Deuda por rendimient
     C                   Z-ADD     *ZERO         ZNFDI8            2 0          Dias reportados
     C                   Z-ADD     *ZERO         ZNFDI9            9 0          Diferencia FSP
     C                   Z-ADD     *ZERO         ZNFD01            2 0          Días de incapacidad
     C                   MOVE      *BLANK        ZNFES8            3            Período
     C                   Z-ADD     *ZERO         ZNFFS2            9 0          Valor del fondo soli
     C                   MOVE      *BLANK        ZNFI17            2            Indicador para tipo
     C                   Z-ADD     *ZERO         ZNFI18            2 0          Ind. detalle devuelt
     C                   MOVE      *BLANK        ZNFI19            1            Ind. nov. no aplica
     C                   MOVE      *BLANK        ZNFI20            1            Ind. diferencia CO
     C                   MOVE      *BLANK        ZNFI21            1            Ind. diferencia FSP
     C                   Z-ADD     *ZERO         ZNFI22            9 0          Intereses mora CO
     C                   Z-ADD     *ZERO         ZNFI23            9 0          Intereses mora FSP
     C                   MOVE      *BLANK        ZNFI24            2            Indicador RPM origen
     C                   MOVE      *BLANK        ZNFLO2           15            Lote de planilla ISS
     C                   Z-ADD     *ZERO         ZNFNI3           11 0          Secuencia
     C                   Z-ADD     *ZERO         ZNFN35           12 0          Número planilla ISS
     C                   Z-ADD     *ZERO         ZNFN36           11 0          Estado del detalle
     C                   Z-ADD     *ZERO         ZNFN37           11 0          Nro. patronal
     C                   Z-ADD     *ZERO         ZNFN38            9 0          Nro. afiliación ISS
     C                   MOVE      *BLANK        ZNFN39            1            Novedad reportada
     C                   Z-ADD     *ZERO         ZNFPA4            3 0          Número de planilla d
     C                   MOVE      *BLANK        ZNFP08            6            Nit empleador
     C                   MOVE      *BLANK        ZNFP09           20            Tipo identif. afil.
     C                   MOVE      *BLANK        ZNFP10           20            Primer nombre
     C                   Z-ADD     *ZERO         ZNFP11            5 2          Por. tarifa alto rie
     C                   Z-ADD     *ZERO         ZNFP12            5 2          Porcentaje cobrado I
     C                   Z-ADD     *ZERO         ZNFS22            3 0          Página
     C                   MOVE      *BLANK        ZNFS23           20            Segundo apellido
     C                   MOVE      *BLANK        ZNFS24           20            Segundo nombre
     C                   Z-ADD     *ZERO         ZNFS25            9 0          Salario base
     C                   Z-ADD     *ZERO         ZNFS26            2 0          Subtipo cotizante
     C                   MOVE      *BLANK        ZNFT26            3            Estado
     C                   MOVE      *BLANK        ZNFT27            2            Tipo pago
     C                   MOVE      *BLANK        ZNFT28            2            Tipo de planilla
     C                   MOVE      *BLANK        ZNFT29            1            Tipo planilla PILA
     C                   Z-ADD     *ZERO         ZNFT30            1 0          Tipo aportante PILA'
     C                   Z-ADD     *ZERO         ZNFT31            2 0          Tipo cotizante PILA
     C                   MOVE      *BLANK        ZNFT32            3            Tipo identificación
     C                   Z-ADD     *ZERO         ZNFV82            9 0          Valor aporte cot.obl
     C                   Z-ADD     *ZERO         ZNFV83            9 0          Valor devolucion ISS
     C                   Z-ADD     *ZERO         ZNFV84            9 0          Valor rendimientos
     C                   Z-ADD     *ZERO         ZNFV85            9 0          Valor dev. total ISS
     C                   Z-ADD     *ZERO         ZNFV86            9 0          Valor retención cont
     C                   Z-ADD     *ZERO         ZNFV87            9 0          Valor comisión'
     C                   MOVE      *BLANK        ZNF001            8            Fecha pago planilla
     C                   MOVE      *BLANK        ZNF002            8            Fecha pago empleador
     C                   Z-ADD     *ZERO         ZNGCO2            5 0          Consecutivo deuda
     C                   Z-ADD     *ZERO         ZNGCUO           21 8          Cuotas ingreso diver
     C                   MOVE      *BLANK        ZNGFEC            8            Fecha fondo generaci
     C                   MOVE      *BLANK        ZNGFE1            8            Fecha fondo reversió
     C                   Z-ADD     *ZERO         ZNGNUM           12 0          Número de planilla
     C                   Z-ADD     *ZERO         ZNGPAG            3 0          Página deuda
     C                   Z-ADD     *ZERO         ZNGPLA           12 0          Planilla deuda
     C                   Z-ADD     *ZERO         ZNGSE1            3 0          Secuencia deuda
     C                   Z-ADD     *ZERO         ZNGTIP            1 0          Tipo de reversión
     C                   Z-ADD     *ZERO         ZNGVLR            9 0          Valor hist.ingreso d
     C                   Z-ADD     *ZERO         ZNGVL1            9 0          Valor real fecha gen
     C                   Z-ADD     *ZERO         ZNGVL2            9 0          Valor real fecha gen
     C                   Z-ADD     *ZERO         ZNI              11 0          @detnu2 - Num id afi
     C                   MOVE      *BLANK        ZNJ               1            Naturaleza 1:Publico
     C                   MOVE      *BLANK        ZNOAVP            1            indicador de novedad
     C                   MOVE      *BLANK        ZNOIGE            1            indicador de novedad
     C                   MOVE      *BLANK        ZNOING            1            indicador de novedad
     C                   MOVE      *BLANK        ZNOLMA            1            indicador de novedad
     C                   MOVE      *BLANK        ZNOMSI           10            Nombre del sistema
     C                   MOVE      *BLANK        ZNOMTR           10            nombre del trabajo
     C                   MOVE      *BLANK        ZNORET            1            indicador de novedad
     C                   MOVE      *BLANK        ZNOSLN            1            indicador de novedad
     C                   MOVE      *BLANK        ZNOTAA            1            indicador novedad de
     C                   MOVE      *BLANK        ZNOTDA            1            indicador novedad de
     C                   MOVE      *BLANK        ZNOVAC            1            indicador de novedad
     C                   MOVE      *BLANK        ZNOVSP            1            indicador de novedad
     C                   MOVE      *BLANK        ZNOVST            1            indicador novedad va
     C                   MOVE      *BLANK        ZNOVTE            1            indicador novedad va
     C                   Z-ADD     *ZERO         ZNPLDE           12 0          @DEUNUM -- Número pl
     C                   Z-ADD     *ZERO         ZNROFP            3 0          Numero de fechas de
     C                   Z-ADD     *ZERO         ZNROID           11 0          @detnu2 - Número de
     C                   Z-ADD     *ZERO         ZNROSE            3 0          Numero sentencia jud
     C                   MOVE      *BLANK        ZNRTRA            6            Número de trabajo
     C                   MOVE      *BLANK        ZNTRAB           10            Nombre del trabajo
     C                   MOVE      *BLANK        ZNUEMA            9            Cod empleador alfa
     C                   Z-ADD     *ZERO         ZNUEMP            9 0          Cod empleador planil
     C                   MOVE      *BLANK        ZNUIDE           11            Numero de identifica
     C                   MOVE      *BLANK        ZNUMAL           11            Número de identifica
     C                   Z-ADD     *ZERO         ZNUMCA            3 0          Número de caracteres
     C                   MOVE      *BLANK        ZNUMDE            7            No del depósito (alf
     C                   Z-ADD     *ZERO         ZNUMEM           11 0          @EMPNU2 - Número ide
     C                   Z-ADD     *ZERO         ZNUME1            8 0          Número de meses a re
     C                   Z-ADD     *ZERO         ZNUME2            2 0          Campo numérico de 2
     C                   Z-ADD     *ZERO         ZNUME3            3 0          Campo numérico de 3
     C                   Z-ADD     *ZERO         ZNUME5            5 0          Númerico de 5 caract
     C                   Z-ADD     *ZERO         ZNUME9            9 0          Campo numérico de 9
     C                   Z-ADD     *ZERO         ZNUMID           11 0          @planu4 - Número de
     C                   Z-ADD     *ZERO         ZNUMI3            3 0          Campo numérico de 3
     C                   Z-ADD     *ZERO         ZNUMI9            9 0          Campo numérico de 9
     C                   Z-ADD     *ZERO         ZNUMPE            2 0          # de período no coti
     C                   Z-ADD     *ZERO         ZNUMPJ           12 0          Numero de planilla t
     C                   MOVE      *BLANK        ZNUMPX            2            # período no cotizad
     C                   Z-ADD     *ZERO         ZNUMRE            9 0          Número del requerimi
     C                   Z-ADD     *ZERO         ZNUMR9            9 0          Campo numérico de 9
     C                   MOVE      *BLANK        ZNUMTR            6            numero del trabajo
     C                   Z-ADD     *ZERO         ZNUM12           12 0          Campo Numérico de 12
     C                   Z-ADD     *ZERO         ZNUM21           21 8          Campo numérico 21 po
     C                   MOVE      *BLANK        ZNUPER            2            Vatiable alfa (refer
     C                   Z-ADD     *ZERO         ZNUPEX           12 0          Planilla del PE
     C                   MOVE      *BLANK        ZNUPLA           12            Número internno de p
     C                   Z-ADD     *ZERO         ZNUREQ            9 0          Número de requerimie
     C                   MOVE      *BLANK        ZNUTOE            5            Numero total de empl
     C                   MOVE      *BLANK        ZOBSER           50            @HISOBS - Observació
     C                   MOVE      *BLANK        ZOPCIO            1            Opción de generación
     C                   MOVE      *BLANK        ZOPCI2            1            OPcion calculo DETA5
     C                   MOVE      *BLANK        ZOPERA            1            ind de operacion
     C                   Z-ADD     *ZERO         ZOVCOM           13 0          Temporal para comisi
     C                   MOVE      *BLANK        ZOVCO1            2            concepto
     C                   Z-ADD     *ZERO         ZOVCO7           13 0          Temporal comisión c.
     C                   Z-ADD     *ZERO         ZOVCO8           13 0          Temporal F.S.P sin d
     C                   Z-ADD     *ZERO         ZOVCU8           21 8          @MOVCU8 Temporal
     C                   Z-ADD     *ZERO         ZOVC16           21 8          @MOVC16 Temporal
     C                   Z-ADD     *ZERO         ZOVC27           13 0          Temporal comisión cv
     C                   Z-ADD     *ZERO         ZOVIN2           13 0          Temporal Int F.S.P s
     C                   Z-ADD     *ZERO         ZOVI06           13 0          Temporal sin decimal
     C                   MOVE      *BLANK        ZOVPER            6            periodo
     C                   Z-ADD     *ZERO         ZOVRET           13 0          Temporal retención c
     C                   MOVE      *BLANK        ZOVTIP            2            tipo tx
     C                   Z-ADD     *ZERO         ZOVVAL           13 0          Temporal prima segur
     C                   Z-ADD     *ZERO         ZOVV13           13 0          Temporal sin decimal
     C                   Z-ADD     *ZERO         ZOV058           21 8          @MOV058 - Temporal
     C                   Z-ADD     *ZERO         ZOV059           21 8          @MOV059 - temporal
     C                   MOVE      *BLANK        ZP                2            Tipo de planilla
     C                   MOVE      *BLANK        ZPAFIR            6            Período anterior al
     C                   Z-ADD     *ZERO         ZPAFSP            3 0          FSPARC Pagina
     C                   Z-ADD     *ZERO         ZPAG              3 0          @detpag - Página
     C                   Z-ADD     *ZERO         ZPAGE5            4 0          Páginas reporte deud
     C                   Z-ADD     *ZERO         ZPAGE6            4 0          Pàginas reporte deud
     C                   Z-ADD     *ZERO         ZPAGIN            3 0          Página
     C                   MOVE      *BLANK        ZPAG30            1            Indicador generar PA
     C                   Z-ADD     *ZERO         ZPAG53            3 0          Pagina consulta RECA
     C                   Z-ADD     *ZERO         ZPAIFS            9 0          Pago int FSP
     C                   MOVE      *BLANK        ZPARAD           41            parametros decreto
     C                   Z-ADD     *ZERO         ZPAREC            3 0          Pagina RPREDI50
     C                   Z-ADD     *ZERO         ZPASAL           15 2          @PAGSAL - Saldo P.A.
     C                   Z-ADD     *ZERO         ZPASA1           15 2          @PAGSAL - Vlr. P.A.
     C                   Z-ADD     *ZERO         ZPATEM           13 0          Valor del pago en ex
     C                   Z-ADD     *ZERO         ZPCOCO            7 5          Porcentaje com. C.O.
     C                   Z-ADD     *ZERO         ZPCT              5 2          Pct. cotización afil
     C                   Z-ADD     *ZERO         ZPCTCO            5 3          Pct. cotización obli
     C                   Z-ADD     *ZERO         ZPCTFS            5 2          hispor - Pct. cotiza
     C                   Z-ADD     *ZERO         ZPDSFS            5 2          Porc. a ditribuir su
     C                   MOVE      *BLANK        ZPEAIR            6            Período anterior ini
     C                   Z-ADD     *ZERO         ZPEANT            6 0          Período anterior al
     C                   Z-ADD     *ZERO         ZPECRU           12 0          Planilla PE para cru
     C                   MOVE      *BLANK        ZPEDEM            1            Cruce PE con deuda m
     C                   Z-ADD     *ZERO         ZPEEMP           11 0          Valor pago en exceso
     C                   MOVE      *BLANK        ZPEFEI            6            Período fecha inicio
     C                   MOVE      *BLANK        ZPEFIN            6            Ultimo período cobro
     C                   MOVE      *BLANK        ZPEFUS            6            Período de fusión PR
     C                   MOVE      *BLANK        ZPEINC            6            @plaper - periodo fe
     C                   MOVE      *BLANK        ZPEINI            6            Período inicial (rev
     C                   MOVE      *BLANK        ZPEINY            6            Periodo inicio calcu
     C                   MOVE      *BLANK        ZPEORI            6            Periodo original de
     C                   MOVE      *BLANK        ZPER              6            Período para calculo
     C                   MOVE      *BLANK        ZPERCE            6            Período de cesantes
     C                   MOVE      *BLANK        ZPERCO            6            @DIAPER - Período de
     C                   MOVE      *BLANK        ZPEREF            6            Período de vigencia
     C                   MOVE      *BLANK        ZPERER            6            Período para el mens
     C                   MOVE      *BLANK        ZPERFI            6            Período final
     C                   MOVE      *BLANK        ZPERFS            6            @plaper - Período pa
     C                   MOVE      *BLANK        ZPERIF            6            Periodo final
     C                   MOVE      *BLANK        ZPERII            6            Periodo inicial
     C                   MOVE      *BLANK        ZPERIN            6            Período inicial
     C                   MOVE      *BLANK        ZPERIO            6            hispe1 - Período de
     C                   MOVE      *BLANK        ZPERI2            6            Período hasta revers
     C                   MOVE      *BLANK        ZPERMN            1            Indicador periodo me
     C                   MOVE      *BLANK        ZPERMY            1            Indicador periodo ma
     C                   MOVE      *BLANK        ZPERPL            6            @PLAPER - Período de
     C                   MOVE      *BLANK        ZPERT1            6            periodo temp 1
     C                   MOVE      *BLANK        ZPERT2            6            periodo temp 2
     C                   MOVE      *BLANK        ZPERVI            6            hispe1 - Período vig
     C                   MOVE      *BLANK        ZPER02            6            Periodo planilla '02
     C                   MOVE      *BLANK        ZPER1             6            Periodo para situado
     C                   MOVE      *BLANK        ZPEVIG            6            @plaper - Perìodo vi
     C                   MOVE      *BLANK        ZPFGPL            1            parametro FGPM lic
     C                   Z-ADD     *ZERO         ZPFGPM            6 4          Procentaje F.G.P.M.
     C                   MOVE      *BLANK        ZPFICO            6            Ultimo periodo de co
     C                   MOVE      *BLANK        ZPFSPL            1            parametro FSP lic
     C                   Z-ADD     *ZERO         ZPGSEC            3 0          Auxiliar Nr. pag./se
     C                   MOVE      *BLANK        ZPINCO            6            Primer periodo de co
     C                   Z-ADD     *ZERO         ZPLA             12 0          @planum - planilla -
     C                   MOVE      *BLANK        ZPLAAA           12            numero planilla alfa
     C                   Z-ADD     *ZERO         ZPLACA           12 0          @planu1 - Número pla
     C                   Z-ADD     *ZERO         ZPLADE           12 0          @DEUNUM
     C                   MOVE      *BLANK        ZPLAER           12            Planilla para mensaj
     C                   MOVE      *BLANK        ZPLAFE            8            Fecha pago infar4
     C                   Z-ADD     *ZERO         ZPLAFI           12 0          Planilla final rezag
     C                   Z-ADD     *ZERO         ZPLAFO           12 0          Planilla de fondo or
     C                   MOVE      *BLANK        ZPLAFU            1            Planilla fusionada
     C                   Z-ADD     *ZERO         ZPLAGE           12 0          @REZNRO - Planilla d
     C                   Z-ADD     *ZERO         ZPLAG1           12 0          @reznro - Planilla d
     C                   Z-ADD     *ZERO         ZPLAIN           12 0          Planilla inicial rez
     C                   Z-ADD     *ZERO         ZPLANA           12 0          @REZNRO - planilla p
     C                   Z-ADD     *ZERO         ZPLANI           12 0          @planu1 - Número de
     C                   Z-ADD     *ZERO         ZPLANU           12 0          Número de planilla c
     C                   Z-ADD     *ZERO         ZPLAN1           12 0          V. de trabajo - Plan
     C                   Z-ADD     *ZERO         ZPLAOR           12 0          Planilla origen de p
     C                   Z-ADD     *ZERO         ZPLAPR           12 0          Planilla a preacredi
     C                   MOVE      *BLANK        ZPLARE           12            Planilla del rezago
     C                   MOVE      *BLANK        ZPLART            2            Tipo planilla retroa
     C                   MOVE      *BLANK        ZPLAUX            2            Tipo de planilla ret
     C                   Z-ADD     *ZERO         ZPLA02            1 0          Indicador planilla 0
     C                   Z-ADD     *ZERO         ZPLA07            1 0          Indicador planilla 0
     C                   Z-ADD     *ZERO         ZPLA08            1 0          Indicador planilla 0
     C                   Z-ADD     *ZERO         ZPLA53           12 0          Planilla consulta RE
     C                   MOVE      *BLANK        ZPLCAN            1            Ind. de planillas ca
     C                   Z-ADD     *ZERO         ZPLCFS           12 0          FSPARC planilla canc
     C                   MOVE      *BLANK        ZPLCND            1            Planilla de cancelac
     C                   MOVE      *BLANK        ZPLCPR            4            Prefijo planilla can
     C                   MOVE      *BLANK        ZPLDNP            1            Validar planillas de
     C                   MOVE      *BLANK        ZPLFIN           12            Temporal de planilla
     C                   Z-ADD     *ZERO         ZPLFSP           12 0          FSPARC Planilla
     C                   MOVE      *BLANK        ZPLFUS            1            Indica si planilla d
     C                   MOVE      *BLANK        ZPLINI           12            Temporal de planilla
     C                   Z-ADD     *ZERO         ZPLNU1           12 0          REcibe el parametro
     C                   Z-ADD     *ZERO         ZPLORF           12 0          Planilla original de
     C                   MOVE      *BLANK        ZPLOTE            4            Prefijo de lote
     C                   Z-ADD     *ZERO         ZPLPE1           12 0          Numero de planilla P
     C                   Z-ADD     *ZERO         ZPLP22           12 0          Planilla pago en exc
     C                   Z-ADD     *ZERO         ZPLREC           12 0          Planilla RPREDI50
     C                   Z-ADD     *ZERO         ZPLTO8           12 0          Total planilla
     C                   Z-ADD     *ZERO         ZPOAIN            5 2          Porcentaje anterior
     C                   MOVE      *BLANK        ZPOAIX            5            Porcentaje anterior
     C                   Z-ADD     *ZERO         ZPOFGP            5 2          Porcentaje F.G,P,M
     C                   Z-ADD     *ZERO         ZPONIN            5 2          Porcentaje nuevo ind
     C                   MOVE      *BLANK        ZPONIX            5            Porcentaje nuevo ind
     C                   Z-ADD     *ZERO         ZPORBT            5 0          Porcentaje con BT
     C                   Z-ADD     *ZERO         ZPORCE            7 5          Porcentaje fsp
     C                   Z-ADD     *ZERO         ZPORCV            5 2          hispo3 - Porcentaje
     C                   Z-ADD     *ZERO         ZPORDE            5 2          Porcentaje dependien
     C                   MOVE      *BLANK        ZPORDX            5            Porcentaje dependien
     C                   Z-ADD     *ZERO         ZPORET            5 2          Porcentaje retención
     C                   Z-ADD     *ZERO         ZPORLR            5 2          Porcentaje de licenc
     C                   Z-ADD     *ZERO         ZPORPS            7 5          hispo2 - Porcentaje
     C                   Z-ADD     *ZERO         ZPORRE            5 0          Porcentaje retención
     C                   Z-ADD     *ZERO         ZPORSB            5 0          Porcentaje sin BT
     C                   MOVE      *BLANK        ZPREFI            4            Prefijo de lote
     C                   MOVE      *BLANK        ZPREF1           10            Prefijo de lote auxi
     C                   MOVE      *BLANK        ZPRF              2            Proceso tipo planill
     C                   Z-ADD     *ZERO         ZPRIHO            7 5          HISPO2 - Prima segur
     C                   Z-ADD     *ZERO         ZPRISI            7 5          HISPO2 - Prima segur
     C                   MOVE      *BLANK        ZPROAC            1            Proceso desde acredi
     C                   MOVE      *BLANK        ZPROCJ            1            Indicador módulo de
     C                   MOVE      *BLANK        ZPRODU            2            Producto
     C                   MOVE      *BLANK        ZPROEJ            1            Proceso que ejecuta
     C                   Z-ADD     *ZERO         ZPSFSP            5 2          Procentaje subsisten
     C                   MOVE      *BLANK        ZPUA01            3            Validación de planil
     C                   MOVE      *BLANK        ZRAFIN            9            Rango final (Parámet
     C                   MOVE      *BLANK        ZRAINI            9            Rango inicial (Parám
     C                   MOVE      *BLANK        ZRANDO           12            numero aleatorio de
     C                   Z-ADD     *ZERO         ZRAR              9 0          Reporte valor A.R.
     C                   MOVE      *BLANK        ZRAZON           50            Razópn social del em
     C                   Z-ADD     *ZERO         ZRCCO             9 0          Reporte valor comisi
     C                   Z-ADD     *ZERO         ZRCO              9 0          Reporte valor C.O.
     C                   Z-ADD     *ZERO         ZRCOCV            9 0          Reporte valor com. c
     C                   Z-ADD     *ZERO         ZRCVA             9 0          Reporte valor C.V.A.
     C                   Z-ADD     *ZERO         ZRCVE             9 0          Reporte valor C.V.E.
     C                   Z-ADD     *ZERO         ZRDERE            9 0          @rezdeu - Reporte de
     C                   MOVE      *BLANK        ZRECAL            1            Indicador recalculo
     C                   MOVE      *BLANK        ZRECRE            1            Recalcular retención
     C                   Z-ADD     *ZERO         ZREGCE            1 0          Registro control de
     C                   MOVE      *BLANK        ZREGCX            1            Registro control de
     C                   Z-ADD     *ZERO         ZREING           15 0          Valor rendimientos I
     C                   Z-ADD     *ZERO         ZRENDI           11 0          Saldo por rendimient
     C                   MOVE      *BLANK        ZRENTR            1            Indicador reentrante
     C                   Z-ADD     *ZERO         ZRESTA           11 0          Resta
     C                   Z-ADD     *ZERO         ZRETCO           15 2          @movret - Valor de r
     C                   MOVE      *BLANK        ZREZEM            1            Indicador rezago no
     C                   MOVE      *BLANK        ZREZMS            1            Es rezago masivo
     C                   Z-ADD     *ZERO         ZREZPR           12 0          Contador rezagos pro
     C                   MOVE      *BLANK        ZREZ3X            1            es indicador de reza
     C                   Z-ADD     *ZERO         ZRFS              9 0          Reporte valor fondo
     C                   Z-ADD     *ZERO         ZRIFS             9 0          Reporte valor int. f
     C                   Z-ADD     *ZERO         ZRING9            9 0          Rendimientos ING 9,0
     C                   Z-ADD     *ZERO         ZRPEEM            9 0          Valor pago en exceso
     C                   Z-ADD     *ZERO         ZRPS              9 0          Reporte valor prima
     C                   Z-ADD     *ZERO         ZRREIN            9 0          Reporte valor rendim
     C                   Z-ADD     *ZERO         ZR3422            1 0          Indicador desarrollo
     C                   MOVE      *BLANK        ZR7421            1            Desarrollo especial
     C                   MOVE      *BLANK        ZR7436            1            Trabajo - Desarrollo
     C                   Z-ADD     *ZERO         ZR8305            1 0          Indicador desarrollo
     C                   Z-ADD     *ZERO         ZR8565            1 0          Indicador req 8565 a
     C                   Z-ADD     *ZERO         ZR9072            1 0          Desarrollo especial
     C                   Z-ADD     *ZERO         ZR9601            1 0          Desarrollo especial
     C                   Z-ADD     *ZERO         ZSAAR            15 2          @movcot - Saldo por
     C                   Z-ADD     *ZERO         ZSACO            15 2          @movcot - Saldo por
     C                   Z-ADD     *ZERO         ZSACOT           15 2          @movcot - Saldo coti
     C                   Z-ADD     *ZERO         ZSACVA           15 2          @movcot - Saldo por
     C                   Z-ADD     *ZERO         ZSACVE           15 2          @movcot - Saldo por
     C                   Z-ADD     *ZERO         ZSADET           15 2          @movcot - Saldo deta
     C                   Z-ADD     *ZERO         ZSAFGP           15 2          @movcot - Saldo por
     C                   Z-ADD     *ZERO         ZSAFS            15 2          @movcot - Saldo por
     C                   Z-ADD     *ZERO         ZSAIFG           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZSAIFS           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZSAIF1           11 0          Saldo intereses f.s.
     C                   Z-ADD     *ZERO         ZSAIF2           11 0          Saldo intereses f.s.
     C                   Z-ADD     *ZERO         ZSAIF3           11 0          Valor distribuido in
     C                   Z-ADD     *ZERO         ZSAIF4           11 0          Total intereses f.s.
     C                   Z-ADD     *ZERO         ZSAIF5           11 0          Saldo intereses f.s.
     C                   Z-ADD     *ZERO         ZSAIG1           11 0          Saldo intereses FGPM
     C                   Z-ADD     *ZERO         ZSAIG2           11 0          Saldo intereses FGPM
     C                   Z-ADD     *ZERO         ZSAIG3           11 0          Valor distribuido in
     C                   Z-ADD     *ZERO         ZSAIG4           11 0          Total intereses FGPM
     C                   Z-ADD     *ZERO         ZSAIG5           11 0          Saldo intereses FGPM
     C                   Z-ADD     *ZERO         ZSAINT           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZSAIN1           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZSAIN2           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZSAIN3           11 0          Valor distribuido in
     C                   Z-ADD     *ZERO         ZSAIN4           11 0          Total intereses C.O
     C                   Z-ADD     *ZERO         ZSAIN5           11 0          Saldo intereses C.O
     C                   Z-ADD     *ZERO         ZSAISF           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZSAIS1           11 0          Saldo intereses SFSP
     C                   Z-ADD     *ZERO         ZSAIS2           11 0          Saldo intereses SFSP
     C                   Z-ADD     *ZERO         ZSAIS3           11 0          Valor distribuido in
     C                   Z-ADD     *ZERO         ZSAIS4           11 0          Total intereses SFSP
     C                   Z-ADD     *ZERO         ZSAIS5           11 0          Saldo intereses SFSP
     C                   Z-ADD     *ZERO         ZSALAN            9 0          Saldo comp. antes de
     C                   Z-ADD     *ZERO         ZSALAR           15 0          ultimo salario de co
     C                   Z-ADD     *ZERO         ZSALCA           15 2          @movcot - Saldo coti
     C                   Z-ADD     *ZERO         ZSALDD            9 0          @detsa1 - Saldo deta
     C                   Z-ADD     *ZERO         ZSALDE           15 2          @movcot - Saldo de l
     C                   Z-ADD     *ZERO         ZSALDI           15 2          Trabajo - Saldo deud
     C                   Z-ADD     *ZERO         ZSALDO           15 2          @movcot - Saldo coti
     C                   Z-ADD     *ZERO         ZSALDT           15 2          Saldo detalles de de
     C                   Z-ADD     *ZERO         ZSALFS            9 0          Salario para fondo d
     C                   Z-ADD     *ZERO         ZSALIC            9 0          Salario de licencia
     C                   MOVE      *BLANK        ZSALIR            1            Indicador de error
     C                   MOVE      *BLANK        ZSALIX            1            Indicador de error T
     C                   Z-ADD     *ZERO         ZSALMA            9 0          Salario máximo de co
     C                   Z-ADD     *ZERO         ZSALMI            9 0          Valor salario mínimo
     C                   Z-ADD     *ZERO         ZSALPA           13 0          Saldo p.e sae
     C                   Z-ADD     *ZERO         ZSALPE           11 0          Saldo pago en exceso
     C                   Z-ADD     *ZERO         ZSALPX            9 0          Saliario proyectado
     C                   Z-ADD     *ZERO         ZSALVA            9 0          Salario vacaciones
     C                   Z-ADD     *ZERO         ZSAMAX            9 0          Salario máximo para
     C                   Z-ADD     *ZERO         ZSAMII            9 0          Salario mímino para
     C                   Z-ADD     *ZERO         ZSAMIN            9 0          Salario mínimo para
     C                   Z-ADD     *ZERO         ZSAREN           15 2          @movcot - Saldo por
     C                   Z-ADD     *ZERO         ZSASFS           15 2          @movcot - Saldo por
     C                   Z-ADD     *ZERO         ZSCP22           21 8          Saldo en cuotas pago
     C                   Z-ADD     *ZERO         ZSEC              3 0          @detsec - Secuencia
     C                   Z-ADD     *ZERO         ZSECUE            3 0          @DETSE4 - Secuencia
     C                   Z-ADD     *ZERO         ZSEC53            3 0          Secuencia consulta R
     C                   Z-ADD     *ZERO         ZSEFSP            3 0          FSPARC Secuencia
     C                   Z-ADD     *ZERO         ZSEMAN            2 0          Días de la semana co
     C                   MOVE      *BLANK        ZSEMAX            2            Semanas TRCONF61
     C                   Z-ADD     *ZERO         ZSEREC            3 0          Secuencia RPREDI50
     C                   Z-ADD     *ZERO         ZSE229           22 9          Saldo Empleador 22,9
     C                   Z-ADD     *ZERO         ZSGCUO           21 8          Sumatoria cuotas Ing
     C                   Z-ADD     *ZERO         ZSGVLR           15 0          Sumatoria valor Ingr
     C                   Z-ADD     *ZERO         ZSIAGR            1 0          Si agregar relacione
     C                   Z-ADD     *ZERO         ZSICVA           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZSICVE           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZSIDEP            1 0          Encontró depósito pa
     C                   MOVE      *BLANK        ZSIGNO            1            Signo
     C                   MOVE      *BLANK        ZSIMUL            1            Indicador módulo sim
     C                   Z-ADD     *ZERO         ZSINAR           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZSINR1           11 0          Saldo intereses Alto
     C                   Z-ADD     *ZERO         ZSINR2           11 0          Saldo intereses Alto
     C                   Z-ADD     *ZERO         ZSINR3           11 0          Valor ditribuido int
     C                   Z-ADD     *ZERO         ZSINR4           11 0          Total intereses Alto
     C                   Z-ADD     *ZERO         ZSINR5           11 0          Saldo intereses Alto
     C                   MOVE      *BLANK        ZSISTE           10            Nombre del sistema
     C                   Z-ADD     *ZERO         ZSIVA1           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZSIVA2           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZSIVA3           11 0          Valor distrido inter
     C                   Z-ADD     *ZERO         ZSIVA4           11 0          Total intereses CVA
     C                   Z-ADD     *ZERO         ZSIVA5           11 0          Saldo intereses CVA
     C                   Z-ADD     *ZERO         ZSIVE1           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZSIVE2           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZSIVE3           11 0          Valor distribuiro in
     C                   Z-ADD     *ZERO         ZSIVE4           11 0          Total intereses CVE
     C                   Z-ADD     *ZERO         ZSIVE5           11 0          Saldo intereses CVE
     C                   MOVE      *BLANK        ZSMACC            1            Indicador de acción
     C                   Z-ADD     *ZERO         ZSMCDI            9 0          Código interno afili
     C                   MOVE      *BLANK        ZSMERR            1            Indicador de error
     C                   MOVE      *BLANK        ZSMLOT           15            Número de lote
     C                   Z-ADD     *ZERO         ZSMNID           11 0          Numero Id. afiliado
     C                   MOVE      *BLANK        ZSMNOV            1            Novedad simulada
     C                   Z-ADD     *ZERO         ZSMPAG            3 0          Numero de pagina
     C                   MOVE      *BLANK        ZSMPER            6            Periodo de rezago
     C                   Z-ADD     *ZERO         ZSMPLA           12 0          Numero de planilla
     C                   MOVE      *BLANK        ZSMREZ            2            Tipo de rezago
     C                   Z-ADD     *ZERO         ZSMSEC            3 0          Numero de secuencia
     C                   MOVE      *BLANK        ZSMTID            3            Tipo id. afiliado
     C                   Z-ADD     *ZERO         ZSSMOC           21 8          Sumatoria cuotas Mov
     C                   Z-ADD     *ZERO         ZSSMOV           15 2          Sumatoria Movimiento
     C                   Z-ADD     *ZERO         ZSUB             15 2          Subsistencia
     C                   Z-ADD     *ZERO         ZSUBSI            9 0          Total subsistencia
     C                   MOVE      *BLANK        ZSUCPR           10            @EMPCOS - Código suc
     C                   Z-ADD     *ZERO         ZSUIBC           12 0          Suma de los IBC
     C                   Z-ADD     *ZERO         ZSUMOC           21 8          Suma de las cuotas
     C                   Z-ADD     *ZERO         ZSUMOV           15 0          Suma de valores movi
     C                   Z-ADD     *ZERO         ZSU229           22 9          Suma de movimientos
     C                   Z-ADD     *ZERO         ZSVP22           15 0          Saldo pago en exceso
     C                   Z-ADD     *ZERO         ZSV152           15 2          Saldo PAGA22 15,2 pa
     C                   Z-ADD     *ZERO         ZS1P22           22 9          Saldo Pago en exceso
     C                   Z-ADD     *ZERO         ZT                5 2          Tasa interés simple
     C                   MOVE      *BLANK        ZT@COM            1            N no completar trans
     C                   MOVE      *BLANK        ZT@IPV            1            Indicador período vá
     C                   MOVE      *BLANK        ZT@PRO            1            Procesar relación
     C                   MOVE      *BLANK        ZT@001           12            planum - Número de p
     C                   MOVE      *BLANK        ZT@002            1            Tipo de llamado
     C                   MOVE      *BLANK        ZT@003           12            detnu9 - Nro. planil
     C                   MOVE      *BLANK        ZT@004            3            detpa2 - Nro. página
     C                   MOVE      *BLANK        ZT@005            3            detse4 - Secuencia a
     C                   MOVE      *BLANK        ZT@006            3            @plati1 - Tipo de id
     C                   MOVE      *BLANK        ZT@007           11            planu4 - Número de i
     C                   MOVE      *BLANK        ZT@008           10            Usuario - Parámetro
     C                   MOVE      *BLANK        ZT@009            2            @deutip - Tipo de de
     C                   Z-ADD     *ZERO         ZT@010           12 0          VT. Numero de planil
     C                   Z-ADD     *ZERO         ZT@011            3 0          VT.Pagina
     C                   Z-ADD     *ZERO         ZT@012            3 0          VT. Secuencia
     C                   MOVE      *BLANK        ZT@013            2            VT.Transacción
     C                   MOVE      *BLANK        ZT@014            2            VT. Concepto
     C                   MOVE      *BLANK        ZT@015            8            VT. Fecha fondo
     C                   Z-ADD     *ZERO         ZT@016           15 2          VT. Valor
     C                   Z-ADD     *ZERO         ZT@017           21 8          VT. Cuotas
     C                   Z-ADD     *ZERO         ZT@018           12 0          VT. Planilla pago ad
     C                   MOVE      *BLANK        ZTAFIL            1            Tipo de afiliado A=a
     C                   Z-ADD     *ZERO         ZTAFIR            9 0          total afiliados
     C                   Z-ADD     *ZERO         ZTAFIS            9 0          total afiliados con
     C                   Z-ADD     *ZERO         ZTAIFG           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZTAIF1           15 2          Valor liquidado inte
     C                   Z-ADD     *ZERO         ZTAIF2           15 2          Valor liquidado inte
     C                   Z-ADD     *ZERO         ZTAIG1           15 2          Valor liquidado inte
     C                   Z-ADD     *ZERO         ZTAIG2           15 2          Valor liquidado inte
     C                   Z-ADD     *ZERO         ZTAINS            5 2          Tasa interés simple
     C                   Z-ADD     *ZERO         ZTAINT           11 0          movcot - Saldo inter
     C                   MOVE      *BLANK        ZTAINX            5            Tasa interés simple
     C                   Z-ADD     *ZERO         ZTAIN1           15 2          Valor liquidado inte
     C                   Z-ADD     *ZERO         ZTAIN2           15 2          Valor liquidado inte
     C                   Z-ADD     *ZERO         ZTAIS1           15 2          Valor liquidado inte
     C                   Z-ADD     *ZERO         ZTAIS2           15 2          Valor liquidado inte
     C                   Z-ADD     *ZERO         ZTARAC            9 0          tarifa acumulada ya
     C                   Z-ADD     *ZERO         ZTARD             9 5          tarifa calculada
     C                   Z-ADD     *ZERO         ZTARPG            9 5          tarifa ya pagada de
     C                   Z-ADD     *ZERO         ZTCCVA           15 2          Int comp fondo cva
     C                   Z-ADD     *ZERO         ZTCCVE           15 2          Int comp fondo cve
     C                   Z-ADD     *ZERO         ZTCDEP           21 8          @depnu3 - Total cuot
     C                   Z-ADD     *ZERO         ZTCHIS           21 8          @depnu3 - Total cuot
     C                   Z-ADD     *ZERO         ZTCOTI           13 0          total cotizacion
     C                   Z-ADD     *ZERO         ZTCPA            21 8          @CONCUO cuotas con.
     C                   Z-ADD     *ZERO         ZTCTAR           15 2          Int comp fondo AR
     C                   Z-ADD     *ZERO         ZTCTER           15 2          Int comp fondo obl
     C                   Z-ADD     *ZERO         ZTCTFG           15 2          Int comp fondo FGPGM
     C                   Z-ADD     *ZERO         ZTCTFS           15 2          Int comp fondo sol
     C                   Z-ADD     *ZERO         ZTCTSF           15 2          Int comp fondo subs
     C                   Z-ADD     *ZERO         ZTDAR            15 2          @movcot - Total dist
     C                   Z-ADD     *ZERO         ZTDCO            15 2          @movcot - Total dist
     C                   Z-ADD     *ZERO         ZTDCVA           15 2          @movcot - Total dist
     C                   Z-ADD     *ZERO         ZTDCVE           15 2          @movcot - Total dist
     C                   Z-ADD     *ZERO         ZTDFGP           15 2          @movcot - Total dist
     C                   Z-ADD     *ZERO         ZTDFS            15 2          @movcot - Total dist
     C                   Z-ADD     *ZERO         ZTDIFG           15 2          @movcot - Total dist
     C                   Z-ADD     *ZERO         ZTDIFS           15 2          @movcot - Total dist
     C                   Z-ADD     *ZERO         ZTDINT           15 2          @movcot - Total dist
     C                   Z-ADD     *ZERO         ZTDISF           15 2          @movcot - Total dist
     C                   Z-ADD     *ZERO         ZTDREN           15 2          @movcot - Total dist
     C                   Z-ADD     *ZERO         ZTDSFS           15 2          @movcot - Total dist
     C                   MOVE      *BLANK        ZTERMX            1            Indicador terminaron
     C                   MOVE      *BLANK        ZTEXTO           50            Error TRCONF62
     C                   MOVE      *BLANK        ZTI               3            @DETTI2 - Tipo de id
     C                   MOVE      *BLANK        ZTIACR            1            Tipo de acreditación
     C                   Z-ADD     *ZERO         ZTICOP            2 0          tipo de cotizante  P
     C                   Z-ADD     *ZERO         ZTICVA           11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZTICVE           11 0          movcot - Saldo inter
     C                   MOVE      *BLANK        ZTIEMP            2            Tipo de planilla INF
     C                   Z-ADD     *ZERO         ZTIFS            11 0          movcot - Saldo inter
     C                   MOVE      *BLANK        ZTIG53            1            Tipo generacion RECA
     C                   MOVE      *BLANK        ZTILLA            1            Tipo de llamado (Acr
     C                   Z-ADD     *ZERO         ZTIME             5 0          Tiempo de espera
     C                   Z-ADD     *ZERO         ZTINAR           11 0          movcot - Saldo int.
     C                   Z-ADD     *ZERO         ZTINA1           15 2          Valor liquidado inte
     C                   Z-ADD     *ZERO         ZTINA2           15 2          Valor liquidado inte
     C                   MOVE      *BLANK        ZTIPAG            2            @PLAT03 - Tipo de pa
     C                   MOVE      *BLANK        ZTIPDE            2            @deutip - tipo de la
     C                   MOVE      *BLANK        ZTIPEM            3            @EMPTI1 - Tipo ident
     C                   MOVE      *BLANK        ZTIPLA            2            @PLATIP - Trabajo -
     C                   MOVE      *BLANK        ZTIPLL            1            Tipo de llamado pgm
     C                   MOVE      *BLANK        ZTIPLN            2            Tipo de planilla env
     C                   MOVE      *BLANK        ZTIPLP            1            Tipo de planilla PIL
     C                   MOVE      *BLANK        ZTIPO             3            @PLATI1 - Tipo ident
     C                   MOVE      *BLANK        ZTIPOD            1            Tipo d. TRFEQA50
     C                   MOVE      *BLANK        ZTIPOP            2            Tipo de planilla
     C                   MOVE      *BLANK        ZTIPPL            2            @PLATIP - Tipo de pl
     C                   MOVE      *BLANK        ZTIPRO            1            Indicador de tipo de
     C                   MOVE      *BLANK        ZTIPRX            1            Tipo proceso TRCORZ5
     C                   MOVE      *BLANK        ZTIPVL            1            Tipo validación CONA
     C                   MOVE      *BLANK        ZTIPXX            3            Temporal de proceso
     C                   MOVE      *BLANK        ZTIRE             2            @rezti3 - Tipo de re
     C                   MOVE      *BLANK        ZTIRED            1            @DISTIP -- Tipo de r
     C                   MOVE      *BLANK        ZTIREX            1            Indicador rezago TRC
     C                   MOVE      *BLANK        ZTIREZ            2            Cod. Rezago (06, 07,
     C                   Z-ADD     *ZERO         ZTISF            11 0          movcot - Saldo inter
     C                   Z-ADD     *ZERO         ZTIVA1           15 2          Valor liquidado inte
     C                   Z-ADD     *ZERO         ZTIVA2           15 2          Valor liquidado inte
     C                   Z-ADD     *ZERO         ZTIVE1           15 2          Valor liquidado inte
     C                   Z-ADD     *ZERO         ZTIVE2           15 2          Valor liquidado inte
     C                   MOVE      *BLANK        ZTLLAM            1            Tipo de llamado
     C                   Z-ADD     *ZERO         ZTMOPL            1 0          Tipo de modificación
     C                   Z-ADD     *ZERO         ZTOAR            11 0          Total alto riesgo
     C                   Z-ADD     *ZERO         ZTOCAL           11 0          Total calculado en d
     C                   Z-ADD     *ZERO         ZTOCNI           21 8          @depnu3 - Cuotas no
     C                   Z-ADD     *ZERO         ZTOCO            15 2          @movcot - Total c.o.
     C                   Z-ADD     *ZERO         ZTOCOT            9 0          @detcot - Total coti
     C                   Z-ADD     *ZERO         ZTOCO2           15 2          Auxiliar Total c.o.
     C                   Z-ADD     *ZERO         ZTOCRE           21 8          @movcuo - Total cuot
     C                   Z-ADD     *ZERO         ZTOCRN           21 8          @movcuo - total cuot
     C                   Z-ADD     *ZERO         ZTOCRP           21 8          @depnu3 - Cuotas no
     C                   Z-ADD     *ZERO         ZTOCUR           21 8          Total cuotas rendimi
     C                   Z-ADD     *ZERO         ZTOCVA           11 0          Total c.v.a.
     C                   Z-ADD     *ZERO         ZTOCVE           11 0          Total c.v.e.
     C                   Z-ADD     *ZERO         ZTODDP            9 0          @detsa1 - Total deta
     C                   Z-ADD     *ZERO         ZTODET           12 0          Total detalle
     C                   Z-ADD     *ZERO         ZTODE1           12 0          Total detalle aux
     C                   Z-ADD     *ZERO         ZTOFGP           11 0          Total fondo garantia
     C                   Z-ADD     *ZERO         ZTOFS            11 0          Total fondo de solid
     C                   Z-ADD     *ZERO         ZTOFSP           15 0          Total fondo solidari
     C                   Z-ADD     *ZERO         ZTOINT           11 0          Total de los interes
     C                   Z-ADD     *ZERO         ZTOPAG           15 2          Vr a cancelar por ac
     C                   Z-ADD     *ZERO         ZTOPLA           12 0          Valor total de la pl
     C                   Z-ADD     *ZERO         ZTOREN           11 0          Total rendimientos
     C                   Z-ADD     *ZERO         ZTORIG            1 0          Origen de planilla (
     C                   Z-ADD     *ZERO         ZTOSFS           11 0          Total f.de solidarid
     C                   Z-ADD     *ZERO         ZTOSUM           12 0          Total sumado
     C                   Z-ADD     *ZERO         ZTOTCO           15 2          @movcot - Valor tota
     C                   Z-ADD     *ZERO         ZTOTDE            9 0          @detsa1 - Total deud
     C                   Z-ADD     *ZERO         ZTOTDP            9 0          @detsa1 - Total deud
     C                   Z-ADD     *ZERO         ZTOTD1            9 0          @detsal - Total deud
     C                   Z-ADD     *ZERO         ZTOTER           12 0          Total procesado terc
     C                   Z-ADD     *ZERO         ZTOTIN            9 0          @DEUSA1 - Total inte
     C                   Z-ADD     *ZERO         ZTOTI1            9 0          @DEUSA1 - Total inte
     C                   Z-ADD     *ZERO         ZTOTI2            9 0          @DEUSA1 - Total inte
     C                   Z-ADD     *ZERO         ZTOTI3            9 0          @DEUSA1 - Total int.
     C                   Z-ADD     *ZERO         ZTOTNI           12 0          @depva8 - Valor no i
     C                   Z-ADD     *ZERO         ZTOTRP           12 0          @depva8 - Valor reca
     C                   Z-ADD     *ZERO         ZTOVRE           15 0          Total valor rezagos
     C                   Z-ADD     *ZERO         ZTOVRN            9 0          @rezcot - Total valo
     C                   MOVE      *BLANK        ZTPAG             2            @PLAT03 - Tipo pago
     C                   MOVE      *BLANK        ZTPGRT            2            Tipo de pago planill
     C                   MOVE      *BLANK        ZTPLA             2            @PLATIP - Tipo plani
     C                   Z-ADD     *ZERO         ZTPLAE            4 0          Total planillas erra
     C                   Z-ADD     *ZERO         ZTPROC            1 0          Proceso que genera m
     C                   MOVE      *BLANK        ZTPVAE            1            Planilla de validaci
     C                   MOVE      *BLANK        ZTPVDF            1            Tipo validación por
     C                   MOVE      *BLANK        ZTRABN           10            Nombre del trabajo
     C                   MOVE      *BLANK        ZTRANS            2            Transacción
     C                   Z-ADD     *ZERO         ZTVCU6           21 8          @MOVCU6 - Cuotas int
     C                   Z-ADD     *ZERO         ZTVC16           21 8          @MOVC16 - Cuotas Int
     C                   Z-ADD     *ZERO         ZTVDEP           12 0          @DEPVA8 -
     C                   Z-ADD     *ZERO         ZTVHIS           12 0          @depva8 - Total valo
     C                   Z-ADD     *ZERO         ZTVPA            12 0          @CONVA1 Valor concil
     C                   Z-ADD     *ZERO         ZTV057           21 8          @MOV057 - Cuotas int
     C                   Z-ADD     *ZERO         ZTV059           21 8          @MOVC16 - Cuotas Int
     C                   Z-ADD     *ZERO         ZUL               2 0          Último dígito del NI
     C                   MOVE      *BLANK        ZULFDE            8            @depfec - Última fec
     C                   Z-ADD     *ZERO         ZULNIT            2 0          Último dígito del NI
     C                   MOVE      *BLANK        ZULPER            6            Último período bien
     C                   Z-ADD     *ZERO         ZULTDE            3 0          Calcula ultimo depos
     C                   MOVE      *BLANK        ZULTPE            8            Último período cotiz
     C                   MOVE      *BLANK        ZULTP1            6            Último período
     C                   MOVE      *BLANK        ZUSAUT            1            Usuario autorizado f
     C                   MOVE      *BLANK        ZUSFSP           10            FSPARC Usuario
     C                   MOVE      *BLANK        ZUSUAR           10            usuario que somete e
     C                   MOVE      *BLANK        ZUSURZ           10            Usuario de configura
     C                   MOVE      *BLANK        ZUSU53           10            Usuario RECA53
     C                   Z-ADD     *ZERO         ZVAAR            13 0          Valor acumulado a.r.
     C                   Z-ADD     *ZERO         ZVAARA           11 0          Valor alto riesgo
     C                   Z-ADD     *ZERO         ZVAARD            9 0          @dets17 - Valor deud
     C                   Z-ADD     *ZERO         ZVAARR            9 0          @rezcot - Valor reza
     C                   Z-ADD     *ZERO         ZVAAUX           15 0          Valor auxiliar depos
     C                   Z-ADD     *ZERO         ZVACAA           11 0          Valor comisión C.V.A
     C                   Z-ADD     *ZERO         ZVACCA           11 0          Valor comisión C.O.
     C                   Z-ADD     *ZERO         ZVACEA           11 0          Valor comisión C.V.E
     C                   Z-ADD     *ZERO         ZVACED           11 0          Valor acumulado enca
     C                   Z-ADD     *ZERO         ZVACO            13 0          detcot - Valor acumu
     C                   Z-ADD     *ZERO         ZVACOA           11 0          Valor cotización obl
     C                   Z-ADD     *ZERO         ZVACOD            9 0          Valor deuda por C.O.
     C                   Z-ADD     *ZERO         ZVACOR           13 0          Valor C.O. rezagos
     C                   Z-ADD     *ZERO         ZVACOT           13 0          detv14 - Valor acumu
     C                   Z-ADD     *ZERO         ZVACUD           21 8          Cuotas acumuladas po
     C                   Z-ADD     *ZERO         ZVACVA           13 0          Valor acumulado c.v.
     C                   Z-ADD     *ZERO         ZVACVE           13 0          Valor acumulado c.v.
     C                   Z-ADD     *ZERO         ZVADRE            9 0          Total deuda reporte
     C                   MOVE      *BLANK        ZVAESP            1            Validacion especial
     C                   Z-ADD     *ZERO         ZVAFGA           11 0          Valor FGPM acreditad
     C                   Z-ADD     *ZERO         ZVAFGD            9 0          Valor deuda fondo de
     C                   Z-ADD     *ZERO         ZVAFGP           13 0          Valor acumulado FGPM
     C                   Z-ADD     *ZERO         ZVAFS            13 0          Valor acumulado f.s.
     C                   Z-ADD     *ZERO         ZVAFSA           11 0          Valor fondo de solid
     C                   Z-ADD     *ZERO         ZVAFSD            9 0          Valor deuda fondo de
     C                   Z-ADD     *ZERO         ZVAFSP           16 2          Valor FSP
     C                   Z-ADD     *ZERO         ZVAFSR           13 0          Valor fondo de solid
     C                   Z-ADD     *ZERO         ZVAIFS            9 0          @detcot - Valor acum
     C                   Z-ADD     *ZERO         ZVAINA           11 0          Valor intereses
     C                   Z-ADD     *ZERO         ZVAIND            9 0          Valor deuda por inte
     C                   Z-ADD     *ZERO         ZVAINR           13 0          Valor intereses reza
     C                   Z-ADD     *ZERO         ZVAINT            9 0          @detcot - Valor acum
     C                   Z-ADD     *ZERO         ZVAISA           11 0          Valor intereses fond
     C                   Z-ADD     *ZERO         ZVAISR           13 0          Valor intereses F.S.
     C                   Z-ADD     *ZERO         ZVAL             15 2          Valor deposito
     C                   Z-ADD     *ZERO         ZVALAC           15 0          Valor del P.E actual
     C                   Z-ADD     *ZERO         ZVALAU           15 0          Valor auxiliar
     C                   Z-ADD     *ZERO         ZVALCO           15 2          @plaval - Valor conc
     C                   Z-ADD     *ZERO         ZVALDE           11 0          detcot - valor cot.
     C                   Z-ADD     *ZERO         ZVALHI           15 2          Valor histórico
     C                   Z-ADD     *ZERO         ZVALIN            9 0          @DEUSA1 - Valor inte
     C                   Z-ADD     *ZERO         ZVALI1            9 0          Valor intereses comp
     C                   Z-ADD     *ZERO         ZVALOR           15 0          Valor para calculos
     C                   Z-ADD     *ZERO         ZVALPE           15 0          Valor P.E antes del
     C                   Z-ADD     *ZERO         ZVALPO            5 2          Delta por porcentaje
     C                   Z-ADD     *ZERO         ZVALRE           13 0          Valor de rezagos
     C                   Z-ADD     *ZERO         ZVALRZ            9 0          @REZDEU - Total deud
     C                   Z-ADD     *ZERO         ZVALSU           21 8          valor sumado tempora
     C                   Z-ADD     *ZERO         ZVALTE           15 2          @movcot - Valor temp
     C                   Z-ADD     *ZERO         ZVALVA           15 2          Delta por valor de a
     C                   Z-ADD     *ZERO         ZVAPAU           15 0          Valor auxiliar
     C                   Z-ADD     *ZERO         ZVAPER           11 0          Valor pago en exceso
     C                   Z-ADD     *ZERO         ZVAPRA           11 0          Valor prima de segur
     C                   Z-ADD     *ZERO         ZVARDI            8 0          Numero de dias según
     C                   MOVE      *BLANK        ZVARDX            8            Numero dias según va
     C                   Z-ADD     *ZERO         ZVAREN           13 0          Valor acumulado rend
     C                   Z-ADD     *ZERO         ZVARER           13 0          Valor rendimientos r
     C                   Z-ADD     *ZERO         ZVAREZ           15 2          Valor rezago
     C                   Z-ADD     *ZERO         ZVASCA           11 0          Valor subtotal cotiz
     C                   Z-ADD     *ZERO         ZVASF             9 0          Valor a grabar en DE
     C                   Z-ADD     *ZERO         ZVASFA           11 0          Subtotal fondo de so
     C                   Z-ADD     *ZERO         ZVASFD            9 0          Valor deuda fondo de
     C                   Z-ADD     *ZERO         ZVASFR           11 0          Subtotal fondo de so
     C                   Z-ADD     *ZERO         ZVASFS           13 0          Valor acumulado SFSP
     C                   Z-ADD     *ZERO         ZVASTA           11 0          Subtotal acreditado
     C                   Z-ADD     *ZERO         ZVASTD            9 0          Subtotal deuda
     C                   Z-ADD     *ZERO         ZVASTR           11 0          Subtotal rezagos
     C                   Z-ADD     *ZERO         ZVASUD            9 0          Subtotal deuda F.S y
     C                   Z-ADD     *ZERO         ZVATOA           11 0          Valor total acredita
     C                   Z-ADD     *ZERO         ZVATOD            9 0          Total deuda
     C                   Z-ADD     *ZERO         ZVATOR           11 0          Valor total rezagos
     C                   Z-ADD     *ZERO         ZVATRE           11 0          Valor total acredita
     C                   Z-ADD     *ZERO         ZVAVAA           11 0          Valor cotizacion vol
     C                   Z-ADD     *ZERO         ZVAVAD            9 0          Valor deuda por C.V.
     C                   Z-ADD     *ZERO         ZVAVAR           13 0          Valor C.V.A. rezagos
     C                   Z-ADD     *ZERO         ZVAVEA           11 0          Valor C.V.E. acredit
     C                   Z-ADD     *ZERO         ZVAVED            9 0          Valor deuda por C.V.
     C                   Z-ADD     *ZERO         ZVAVER           13 0          Valor C.V.E. rezagos
     C                   Z-ADD     *ZERO         ZVCDIS           21 8          Cuotas a distribuir
     C                   Z-ADD     *ZERO         ZVCFDI           21 8          Valor cuotas fecha d
     C                   Z-ADD     *ZERO         ZVCFFI           21 8          Valor cuota fecha fu
     C                   Z-ADD     *ZERO         ZVCFFP           21 8          Valor cuota fecha fu
     C                   MOVE      *BLANK        ZVCFFX           21            Valor cuota fecha fu
     C                   Z-ADD     *ZERO         ZVCOT1            9 0          Valor cot. obligator
     C                   Z-ADD     *ZERO         ZVCOT2            9 0          Valor cot. obligator
     C                   Z-ADD     *ZERO         ZVDAR            11 0          Valor distribuido al
     C                   Z-ADD     *ZERO         ZVDCO            11 0          Valor distribuido c.
     C                   Z-ADD     *ZERO         ZVDCVA           11 0          Valor distribuido c.
     C                   Z-ADD     *ZERO         ZVDCVE           11 0          Valor distribuido c.
     C                   Z-ADD     *ZERO         ZVDETD            9 0          @detv15 - Existe val
     C                   Z-ADD     *ZERO         ZVDFGP            9 0          Valor distribuido FG
     C                   Z-ADD     *ZERO         ZVDFS            11 0          Valor distribuido f.
     C                   Z-ADD     *ZERO         ZVDFSD           11 0          Valor distribuido f.
     C                   Z-ADD     *ZERO         ZVDIAR           11 0          Valor distribuido in
     C                   Z-ADD     *ZERO         ZVDIFD           11 0          Valor distribuido in
     C                   Z-ADD     *ZERO         ZVDIFG            9 0          Valor distribuido in
     C                   Z-ADD     *ZERO         ZVDIFS           11 0          Valor distribuido in
     C                   Z-ADD     *ZERO         ZVDINT           11 0          Valor distribuido in
     C                   Z-ADD     *ZERO         ZVDISF           11 0          Valor distribuido in
     C                   Z-ADD     *ZERO         ZVDIVA           11 0          Valor distribuido in
     C                   Z-ADD     *ZERO         ZVDIVE           11 0          Valor distribuido in
     C                   Z-ADD     *ZERO         ZVDREN           11 0          Valor distribuido re
     C                   Z-ADD     *ZERO         ZVDRFS           15 0          Valor rendimientos F
     C                   Z-ADD     *ZERO         ZVDSFS           11 0          Valor distribuido SF
     C                   MOVE      *BLANK        ZVECNO           12            Vector de novedades
     C                   Z-ADD     *ZERO         ZVEING           15 3          Valor rendimientos I
     C                   Z-ADD     *ZERO         ZVFGPM            9 0          Valor fondo garantia
     C                   Z-ADD     *ZERO         ZVFGPX            9 0          Valor fondo garantia
     C                   Z-ADD     *ZERO         ZVFGP2           11 0          Valor FGPM - DETA52
     C                   Z-ADD     *ZERO         ZVFSPX            9 0          Valor solidaridad F.
     C                   Z-ADD     *ZERO         ZVFSRE           15 2          Valor FSPARC rezagos
     C                   Z-ADD     *ZERO         ZVGVLR           15 3          Valor ingreso divers
     C                   Z-ADD     *ZERO         ZVIFGA           11 0          Valor intereses FGPM
     C                   Z-ADD     *ZERO         ZVIFGD            9 0          Valor intereses F.G
     C                   Z-ADD     *ZERO         ZVIFG2           11 0          Valor interes FGPM -
     C                   Z-ADD     *ZERO         ZVIFSD            9 0          Valor deuda int. F.S
     C                   Z-ADD     *ZERO         ZVIFSP           15 2          FSPARC ValIntFsp
     C                   Z-ADD     *ZERO         ZVINTE           11 0          Valot total de los i
     C                   Z-ADD     *ZERO         ZVISFA           11 0          Valor intereses SFSP
     C                   Z-ADD     *ZERO         ZVISFD            9 0          Valor deuda int. sub
     C                   Z-ADD     *ZERO         ZVISUB           15 2          FSPARC ValIntSub
     C                   Z-ADD     *ZERO         ZVLCOM            9 0          @comsal - valor a cu
     C                   Z-ADD     *ZERO         ZVLDET           11 0          Valor del detalle de
     C                   Z-ADD     *ZERO         ZVLOBL            9 0          Cotizacion obligator
     C                   Z-ADD     *ZERO         ZVLPA             9 0          valor del pago adela
     C                   Z-ADD     *ZERO         ZVLPAC            9 0          Valor pago adelantad
     C                   Z-ADD     *ZERO         ZVLRMA            9 0          Valor acumulado movi
     C                   Z-ADD     *ZERO         ZVLRMV            9 0          Valor acumulado movi
     C                   Z-ADD     *ZERO         ZVLRRA            9 0          Valor acumulado reza
     C                   Z-ADD     *ZERO         ZVLRRZ            9 0          @rezcot - Valor de u
     C                   Z-ADD     *ZERO         ZVMAR            15 0          Valor movimiento alt
     C                   Z-ADD     *ZERO         ZVMCCA           15 0          Valor movimiento com
     C                   Z-ADD     *ZERO         ZVMCCE           15 0          Valor movimiento com
     C                   Z-ADD     *ZERO         ZVMCCO           15 0          Valor movimiento com
     C                   Z-ADD     *ZERO         ZVMCO            15 0          Valor movimiento c.o
     C                   Z-ADD     *ZERO         ZVMCVA           15 0          Valor movimiento c.v
     C                   Z-ADD     *ZERO         ZVMCVE           15 0          Valor movimiento c.v
     C                   Z-ADD     *ZERO         ZVMFGP           15 0          Valor movimiento FGP
     C                   Z-ADD     *ZERO         ZVMFS            15 0          Valor movimiento f.s
     C                   Z-ADD     *ZERO         ZVMFSD           21 8          @movcuo - diferencia
     C                   Z-ADD     *ZERO         ZVMIFD           11 0          Valor movimiento int
     C                   Z-ADD     *ZERO         ZVMIFG           15 0          Valor movimiento int
     C                   Z-ADD     *ZERO         ZVMIFS           15 0          Valor movimiento int
     C                   Z-ADD     *ZERO         ZVMINT           15 0          Valor movimiento int
     C                   Z-ADD     *ZERO         ZVMISF           15 0          Valor movimiento int
     C                   Z-ADD     *ZERO         ZVMPS            15 0          Valor movimiento pri
     C                   Z-ADD     *ZERO         ZVMREN           15 0          Valor movimiento ren
     C                   Z-ADD     *ZERO         ZVMSFS           15 0          Valor movimiento SFS
     C                   Z-ADD     *ZERO         ZVPECS           11 0          Valor P.E. plan. can
     C                   Z-ADD     *ZERO         ZVPXRZ           15 2          Valor rezago PEE
     C                   Z-ADD     *ZERO         ZVRAND            9 0          @deusal - Valor deud
     C                   Z-ADD     *ZERO         ZVRCAR           11 0          Valor real a dist. e
     C                   Z-ADD     *ZERO         ZVRDCO           11 0          Valor real a dist. p
     C                   Z-ADD     *ZERO         ZVRDEP           12 0          @depva8 - Valor depó
     C                   Z-ADD     *ZERO         ZVRDEU           11 0          detsal - Valor de la
     C                   Z-ADD     *ZERO         ZVRDFG           11 0          Valor real a dist. e
     C                   Z-ADD     *ZERO         ZVRECO           11 0          Valor retención cont
     C                   Z-ADD     *ZERO         ZVRFSP           11 0          Valor real a distrib
     C                   Z-ADD     *ZERO         ZVRHIS            9 0          Valor histórico p.e.
     C                   Z-ADD     *ZERO         ZVRIA9            9 0          Valor rendimientos a
     C                   Z-ADD     *ZERO         ZVRINA           15 0          Valor a fecha fondo
     C                   Z-ADD     *ZERO         ZVRINC           11 0          Trabajo - Valor inte
     C                   Z-ADD     *ZERO         ZVRINT           11 0          Trabajo - Valor inte
     C                   Z-ADD     *ZERO         ZVRPA             9 0          Valor pago en exceso
     C                   Z-ADD     *ZERO         ZVRPAD           15 0          Valor pagado detalle
     C                   Z-ADD     *ZERO         ZVRPAG           11 0          Valor pagado
     C                   Z-ADD     *ZERO         ZVRPE            11 0          Valor pago en exceso
     C                   Z-ADD     *ZERO         ZVRPER            9 0          Valor p.e. de la acr
     C                   Z-ADD     *ZERO         ZVRPEX           12 0          Valor pago en exceso
     C                   Z-ADD     *ZERO         ZVRPRO            9 0          @rezva3 - Valor proc
     C                   Z-ADD     *ZERO         ZVRREP            9 0          @rezva3 - Valor repa
     C                   Z-ADD     *ZERO         ZVRRET           15 0          Valor retención cont
     C                   Z-ADD     *ZERO         ZVRREZ            9 0          @rezcot - Valor tota
     C                   Z-ADD     *ZERO         ZVRSFS           11 0          Valor real a distrib
     C                   Z-ADD     *ZERO         ZVRTEM            9 0          Valor temp. para apl
     C                   Z-ADD     *ZERO         ZVSFSA           11 0          Valor fondo de subsi
     C                   Z-ADD     *ZERO         ZVSFSO            9 0          Valor subs. F.S.P. s
     C                   Z-ADD     *ZERO         ZVSFSP            9 0          Valor solidaridad F.
     C                   Z-ADD     *ZERO         ZVSIAR           11 0          Trabajo - Valor dist
     C                   Z-ADD     *ZERO         ZVSIA1           11 0          Tr. - Valor dist. sa
     C                   Z-ADD     *ZERO         ZVSICO           11 0          Trabajo - Valor dist
     C                   Z-ADD     *ZERO         ZVSIC1           11 0          Tr. - Valor dist. sa
     C                   Z-ADD     *ZERO         ZVSIE1           11 0          Tr. - Valor dist. sa
     C                   Z-ADD     *ZERO         ZVSIFG           11 0          Trabajo - Valor dist
     C                   Z-ADD     *ZERO         ZVSIFS           11 0          Trabajo - Valor dist
     C                   Z-ADD     *ZERO         ZVSIF1           11 0          Tr. - Valor dist. sa
     C                   Z-ADD     *ZERO         ZVSIG1           11 0          Tr. - Valor dist. sa
     C                   Z-ADD     *ZERO         ZVSIR1           11 0          Tr. - Valor dist. sa
     C                   Z-ADD     *ZERO         ZVSISF           11 0          Trabajo - Valor dist
     C                   Z-ADD     *ZERO         ZVSIS1           11 0          Tr. - Valor dist. sa
     C                   Z-ADD     *ZERO         ZVSIVA           11 0          Trabajo - Valor dist
     C                   Z-ADD     *ZERO         ZVSIVE           11 0          Trabajo - Valor dist
     C                   Z-ADD     *ZERO         ZVTDIS           12 0          Valor total a distri
     C                   Z-ADD     *ZERO         ZVTRRE           11 0          Valor total rezagos
     C                   Z-ADD     *ZERO         ZVTVVA           11 0          Acumulado valores ac
     C                   Z-ADD     *ZERO         ZVTVVE           11 0          Acumulado valores ac
     C                   Z-ADD     *ZERO         ZVUINC           15 0          Valor utilizado Inte
     C                   Z-ADD     *ZERO         ZVUINF           15 0          Valor utilizado inte
     C                   Z-ADD     *ZERO         ZVZFSP           15 2          FSPARC ValorSub
     C                   Z-ADD     *ZERO         ZXGCUO           21 8          Cuotas INGARC - redo
     C                   Z-ADD     *ZERO         ZXGVLR            9 0          Valor real INGARC -
     C                   Z-ADD     *ZERO         ZXGVL1            9 0          Valor INGARC - redon
     C                   Z-ADD     *ZERO         ZZAFSP           15 2          FSPARC ValorFsp
     C                   MOVE      *BLANK        ZZATIP            2            Tipo planilla
     C                   MOVE      *BLANK        ZZAT03            2            Tipo pago
     C                   Z-ADD     *ZERO         ZZUFSP           21 8          FSPARC CuotasFsp
     C                   Z-ADD     *ZERO         Z01CAR           21 8          Salida - Cuotas Alto
     C                   Z-ADD     *ZERO         Z01CBO           21 8          Salida - Cuotas Bono
     C                   Z-ADD     *ZERO         Z01CCO           21 8          Salida - Cuotas Coti
     C                   Z-ADD     *ZERO         Z01CIN           21 8          Salida - Cuotas Inte
     C                   Z-ADD     *ZERO         Z01CRE           21 8          Salida - Cuotas Rend
     C                   Z-ADD     *ZERO         Z01CVA           21 8          Salida - Cuotas CVA
     C                   Z-ADD     *ZERO         Z01CVE           21 8          Salida - Cuotas CVE
     C                   Z-ADD     *ZERO         Z01HAR           15 2          Salida - Valor hist.
     C                   Z-ADD     *ZERO         Z01HBN           15 2          Salida - Valor hist.
     C                   Z-ADD     *ZERO         Z01HCO           15 2          Salida - Valor hist.
     C                   Z-ADD     *ZERO         Z01HIN           15 2          Salida - Valor hist.
     C                   Z-ADD     *ZERO         Z01HRE           15 2          Salida - Valor hist.
     C                   Z-ADD     *ZERO         Z01HVA           15 2          Salida - Valor Hist.
     C                   Z-ADD     *ZERO         Z01HVE           15 2          Salida - Valor Hist.
     C                   Z-ADD     *ZERO         Z05CER            5 0          Codigo de error - Pa
     C                   Z-ADD     *ZERO         Z05COI            9 0          Codigo interno
     C                   Z-ADD     *ZERO         Z05CON            3 0          Consecutivo
     C                   MOVE      *BLANK        Z05FED            8            Fecha de depósito ap
     C                   MOVE      *BLANK        Z05FOR            3            Fondo origen de la d
     C                   Z-ADD     *ZERO         Z05NIB           11 0          Número de id bono
     C                   Z-ADD     *ZERO         Z05PAG            3 0          Pagina
     C                   Z-ADD     *ZERO         Z05PLA           12 0          Número de planilla
     C                   Z-ADD     *ZERO         Z05SEC            3 0          Secuencia
     C                   MOVE      *BLANK        Z05TIB            3            Tipo de id bono
     C                   MOVE      *BLANK        Z05TIE            1            Tipo de error E=Erro
     C                   MOVE      *BLANK        Z05TIP            3            Indicador de tipo de
     C                   Z-ADD     *ZERO         Z10592            1 0          Ind. desarrollo espe
     C                   Z-ADD     *ZERO         Z11433            1 0          Desarrollo especial
     C                   Z-ADD     *ZERO         Z12541            1 0          Especial Colfondos 1
     C                   Z-ADD     *ZERO         Z13136            1 0          Indicador desarrollo
     C                   Z-ADD     *ZERO         Z13783            1 0          Desarrollo especial
     C                   Z-ADD     *ZERO         Z14006            1 0          Desarrollo especial
     C                   MOVE      *BLANK        Z51               8            @CONFEC - Fecha inic
     C                   MOVE      *BLANK        Z59ACC            1            Acción a consultar
     C                   Z-ADD     *ZERO         Z59CU5           21 8          Cuotas pago
     C                   MOVE      *BLANK        Z59ERR            1            Ind. de error (0:No
     C                   MOVE      *BLANK        Z59FE9            8            Fecha fondo pago
     C                   MOVE      *BLANK        Z59FIL          255            Campo FILLER/extra p
     C                   MOVE      *BLANK        Z59F01            8            Fecha generación fon
     C                   MOVE      *BLANK        Z59F02            8            Fecha sistema pago
     C                   MOVE      *BLANK        Z59F03            8            Fecha del depósito d
     C                   Z-ADD     *ZERO         Z59PLA           12 0          Planilla
     C                   Z-ADD     *ZERO         Z59SQL            9 0          Error que retorna SQ
     C                   MOVE      *BLANK        Z59SUB            2            Subtipo
     C                   MOVE      *BLANK        Z59TI2            2            Tipo de pago
     C                   MOVE      *BLANK        Z59US2           10            Usuario
     C                   Z-ADD     *ZERO         Z59VA2           15 2          Valor pago
     C                   READ      AFIAR2                                 95
     C                   READ      AFIARC                                 95
     C                   WRITE     AFIREG                               94
     C                   READ      AFIARC01                               95
     C                   READ      AFIAR1                                 95
     C                   WRITE     AFIRE1                               94
     C                   READ      COMAR2                                 95
     C                   WRITE     COMRE2                               94
     C                   READ      COMAR5                                 95
     C                   WRITE     COMRE5                               94
     C                   READ      CONAR2                                 95
     C                   WRITE     CONRE2                               94
     C                   READ      CONAR202                               95
     C                   READ      CONAR203                               95
     C                   WRITE     CONRE203                             94
     C                   READ      CONAR205                               95
     C                   WRITE     CONRE205                             94
     C                   READ      CONARC                                 95
     C                   READ      CUEARC                                 95
     C                   WRITE     CUEREG                               94
     C                   READ      DEPAR3                                 95
     C                   WRITE     DEPRE2                               94
     C                   READ      DETAR302                               95
     C                   READ      DETAR2                                 95
     C                   WRITE     DETRE1                               94
     C                   READ      DETAR201                               95
     C                   WRITE     DETRE101                             94
     C                   READ      DETARC                                 95
     C                   WRITE     DETREG                               94
     C                   READ      DEUARC                                 95
     C                   WRITE     DEUREG                               94
     C                   READ      DEUARC03                               95
     C                   READ      DEUARC04                               95
     C                   READ      DEUARC08                               95
     C                   WRITE     DEUREG08                             94
     C                   READ      DEUARC10                               95
     C                   WRITE     DEUREG10                             94
     C                   READ      DEUARC51                               95
     C                   READ      DIAAR1                                 95
     C                   WRITE     DIARE1                               94
     C                   READ      DISAR1                                 95
     C                   WRITE     DISRE1                               94
     C                   READ      EMPAR204                               95
     C                   READ      ESTAR1                                 95
     C                   WRITE     ESTRE1                               94
     C                   READ      HISA01                                 95
     C                   WRITE     HISR04                               94
     C                   READ      HISAR1                                 95
     C                   READ      HISAR7                                 95
     C                   WRITE     HISRE7                               94
     C                   READ      INFAR402                               95
     C                   READ      LOTAR5                                 95
     C                   WRITE     LOTRE5                               94
     C                   READ      MOVARC                                 95
     C                   WRITE     MOVREG                               94
     C                   READ      MOVARC06                               95
     C                   READ      MOVAR2                                 95
     C                   WRITE     MOVRE3                               94
     C                   READ      PAGARC                                 95
     C                   WRITE     PAGREG                               94
     C                   READ      PAGARC06                               95
     C                   WRITE     PAGREG06                             94
     C                   READ      PLAARC                                 95
     C                   WRITE     PLAREG                               94
     C                   READ      PLAARC04                               95
     C                   READ      PLAARC15                               95
     C                   READ      PLAAR601                               95
     C                   READ      PLAAR603                               95
     C                   READ      REZARC                                 95
     C                   WRITE     REZREG                               94
     C                   READ      REZARC01                               95
     C                   READ      REZARC18                               95
     C                   READ      REZARC19                               95
     C                   READ      REZARC20                               95
     C                   READ      REZARC21                               95
     C                   EXCEPT    FMT@D1
     C                   EXCEPT    FMT@D3
     C                   EXCEPT    FMT@D4
     C                   EXCEPT    FMT@D5
     C                   EXCEPT    FMT@D6
     C                   EXCEPT    FMT@E1
     C                   EXCEPT    FMT@E2
     C                   EXCEPT    FMT@E3
     C                   EXCEPT    FMT@E5
     C                   EXCEPT    FMT@E6
     C                   EXCEPT    FMT@F1
     C                   EXCEPT    FMT@F2
     C                   EXCEPT    FMT@F3
     C                   EXCEPT    FMT@F5
     C                   EXCEPT    FMT@F6
     C                   EXCEPT    FMT@TI
     C                   EXCEPT    FMT@T1
     C                   EXCEPT    FMT@T3
     C                   EXCEPT    FMT@T4
     C                   EXCEPT    FMT@T5
     C                   EXCEPT    FMT@T6
     C                   ENDSR
     OPRN198    E            FMT@D1
     O                       ZRPEEM        2    198
     O                       ZRDERE        2    186
     O                       ZRIFS         2    174
     O                       ZRFS          2    162
     O                       ZRCOCV        2    150
     O                       ZRPS          2    138
     O                       ZRCCO         2    126
     O                       ZRREIN        2    114
     O                       ZRCVE         2    102
     O                       ZRCVA         2     90
     O                       ZRAR          2     78
     O                       ZRCO          2     66
     O                       ZNROID        4     54
     O                       ZTIRE               42
     O                       ZPLACA        4     39
     O                       ZSEC          4     26
     O                       ZPAG          4     22
     O                       ZPLANI        4     18
     O                       ZCONCE               5
     O                       ZTRANS               2
     OPRN80     E            FMT@D3         1
     O                       ZERROR              80
     O                       PLANU1        4     12
     OPRN80     E            FMT@D4         1
     O                       ZPLADE        4     32
     O                                           18 'Planilla de deuda:'
     OPRN198B   E            FMT@D5
     O                       ZVALVA        2    195
     O                       ZVALPO        2    170
     O                       ZVRDEU        2    152
     O                       ZVALRZ        2    136
     O                       ZPLTO8        2    121
     O                       PLAPER             103
     O                       PLANU1        4     95
     O                       ZTIPDE              73
     O                       ZRAZON              69
     O                       ZNUMEM        4     17
     O                       ZTIPEM               3
     OPRN198C   E            FMT@D6
     O                       ZOBSER             172
     O                       ZVRDEU        2    120
     O                       PLAPER             103
     O                       PLANU1        4     95
     O                       ZTIPDE              73
     O                       ZRAZON              69
     O                       ZNUMEM        4     17
     O                       ZTIPEM               3
     OPRN198    E            FMT@E1         1 01
     O                       PAGE1         2    198
     O                                          187 'Página'
     O                       USUÑÑÑ             102
     O                                           90 'Usuario'
     O                       NCOÑÑÑ              50
     OPRN198    E            FMT@E1         1
     O                       ZFESIS             198
     O                                          186 'Fecha'
     O                       NSIÑÑÑ              50
     OPRN198    E            FMT@E1         1
     O                       ZHORA              198
     O                                          185 'Hora'
     O                                           25 'Listado de detalle'
     O                                            6 'PLAN64'
     OPRN198    E            FMT@E1         1
     O                                          183 '======================='
     O                                          198 '==============='
     O                                          143 '======================='
     O                                          160 '================='
     O                                          103 '======================='
     O                                          120 '================='
     O                                          063 '======================='
     O                                           80 '================='
     O                                          023 '======================='
     O                                           40 '================='
     OPRN132    E            FMT@E2         1 01
     O                       PAGE          2    132
     O                                          123 'Página'
     O                       USUÑÑÑ              70
     O                                           59 'Usuario'
     O                       NCOÑÑÑ              50
     OPRN132    E            FMT@E2         1
     O                       ZFESIS             132
     O                                          122 'Fecha'
     O                       NSIÑÑÑ              50
     OPRN132    E            FMT@E2         1
     O                       ZHORA              132
     O                                          121 'Hora'
     O                                           25 'Listado de totales'
     O                                            6 'PLAN64'
     OPRN132    E            FMT@E2         1
     O                                          132 '============'
     O                                          103 '======================='
     O                                          120 '================='
     O                                          063 '======================='
     O                                           80 '================='
     O                                          023 '======================='
     O                                           40 '================='
     OPRN80     E            FMT@E3         1 01
     O                       PAGE2         2     80
     O                                           71 'Página'
     O                       USUÑÑÑ              61
     O                       NCOÑÑÑ              50
     OPRN80     E            FMT@E3         1
     O                       ZFESIS              80
     O                                           70 'Fecha'
     O                       NSIÑÑÑ              50
     OPRN80     E            FMT@E3         1
     O                       ZHORA               80
     O                                           69 'Hora'
     O                                          030 'Reporte de errores de a'
     O                                           41 'creditación'
     O                                            6 'PLAN64'
     OPRN80     E            FMT@E3         1
     O                                          063 '======================='
     O                                           80 '================='
     O                                          023 '======================='
     O                                           40 '================='
     OPRN198B   E            FMT@E5         1 01
     O                       ZPAGE5        2    198
     O                                          187 'Página'
     O                       USUÑÑÑ             102
     O                                           90 'Usuario'
     O                       NCOÑÑÑ              50
     OPRN198B   E            FMT@E5         1
     O                       ZFESIS             198
     O                                          186 'Fecha'
     O                       NSIÑÑÑ              50
     OPRN198B   E            FMT@E5         1
     O                       ZHORA              198
     O                                          185 'Hora'
     O                                          031 'Listado de deudas anula'
     O                                           44 'das por delta'
     O                                            6 'PLAN64'
     OPRN198B   E            FMT@E5         1
     O                                          183 '======================='
     O                                          198 '==============='
     O                                          143 '======================='
     O                                          160 '================='
     O                                          103 '======================='
     O                                          120 '================='
     O                                          063 '======================='
     O                                           80 '================='
     O                                          023 '======================='
     O                                           40 '================='
     OPRN198C   E            FMT@E6         1 01
     O                       ZPAGE6        2    198
     O                                          187 'Página'
     O                       USUÑÑÑ             102
     O                                           90 'Usuario'
     O                       NCOÑÑÑ              50
     OPRN198C   E            FMT@E6         1
     O                       ZFESIS             198
     O                                          186 'Fecha'
     O                       NSIÑÑÑ              50
     OPRN198C   E            FMT@E6         1
     O                       ZHORA              198
     O                                          185 'Hora'
     O                                          031 'Listado de deudas no an'
     O                                           47 'uladas por delta'
     O                                            6 'PLAN64'
     OPRN198C   E            FMT@E6         1
     O                                          183 '======================='
     O                                          198 '==============='
     O                                          143 '======================='
     O                                          160 '================='
     O                                          103 '======================='
     O                                          120 '================='
     O                                          063 '======================='
     O                                           80 '================='
     O                                          023 '======================='
     O                                           40 '================='
     OPRN198    E            FMT@F1      1  0
     O                                            5 'Nota:'
     OPRN198    E            FMT@F1         1
     O                                            5 'Nota:'
     OPRN198    E            FMT@F1         1
     O                                          023 'Ren/Int/Int.FG = Rendi.'
     O                                           39 '+ Int.(C.O/FGPM)'
     OPRN198    E            FMT@F1
     O                                          023 'Comi CO + FGPM = Comisi'
     O                                           36 'ón C.O + FGPM'
     OPRN198    E            FMT@F1
     O                                          023 'F.soli + F.subs = Solid'
     O                                           40 'arid.+ Subsisten.'
     OPRN198    E            FMT@F1
     O                                          023 'Int FS + Int Subs = Int'
     O                                           40 '(Solidad + Subsi)'
     OPRN198    E            FMT@F1      2
     O                                          110 '+++ FIN DEL REPORTE +++'
     OPRN132    E            FMT@F2      2
     O                                           71 '+++ FIN DEL REPORTE +++'
     OPRN80     E            FMT@F3      2
     O                                           56 '+++ FIN DEL REPORTE +++'
     OPRN198B   E            FMT@F5      2
     O                                          110 '+++ FIN DEL REPORTE +++'
     OPRN198C   E            FMT@F6      2
     O                                          110 '+++ FIN DEL REPORTE +++'
     OPRN198    E            FMT@TI
     O                                          198 'Pago en'
     O                                          186 'Deuda'
     O                                          174 'Int. FS +'
     O                                          162 'F.Soli +'
     O                                          150 'Comisión'
     O                                          138 'Prima'
     O                                          126 'Comi. CO +'
     O                                          114 'Ren/Int/+'
     O                                          102 'C. V. E.'
     O                                           90 'C. V. A.'
     O                                           78 'Alto riesgo'
     O                                           66 'C.O.'
     O                                           54 'Identific.'
     O                                           42 'Tip'
     O                                           36 'Planilla'
     O                                           26 'Sec'
     O                                           22 'Pag'
     O                                           18 'Planilla'
     O                                            5 'Tran.'
     OPRN198    E            FMT@TI
     O                                          198 'Exceso'
     O                                          186 'Rezagos'
     O                                          174 'Int. Subs.'
     O                                          162 'F. Subsis.'
     O                                          150 'Cot. volun.'
     O                                          138 'Seguros'
     O                                          126 'FGPM'
     O                                          114 'Int. FGPM'
     O                                           54 'Afiliado'
     O                                           42 'Rez'
     O                                           38 'Cancelación'
     OPRN132    E            FMT@T1
     O                                          111 '--------------- Rezagos'
     O                                          126 ' --------------'
     O                                           85 '-- Deudas --'
     O                                          056 '------------ Acreditaci'
     O                                           71 'ón ------------'
     O                                            8 'Concepto'
     OPRN132    E            FMT@T1
     O                                          126 'Cuotas'
     O                                           99 'Valor'
     O                                           71 'Cuotas'
     O                                           44 'Valor'
     OPRN132    E            FMT@T1
     O                       ZCUCOR        2    126
     O                       ZVACOR        2     99
     O                       ZVACOD        2     85
     O                       ZCUCOA        2     71
     O                       ZVACOA        2     44
     O                                          025 'Cotización obligatoria '
     O                                           30 '.....'
     OPRN132    E            FMT@T1
     O                       ZCUARR        2    126
     O                       ZVAARR        2     99
     O                       ZVAARD        2     85
     O                       ZCUARA        2     71
     O                       ZVAARA        2     44
     O                                          025 'Cotización alto riesgo '
     O                                           30 '.....'
     OPRN132    E            FMT@T1
     O                       ZCUVAR        2    126
     O                       ZVAVAR        2     99
     O                       ZVAVAD        2     85
     O                       ZCUVAA        2     71
     O                       ZVAVAA        2     44
     O                                          025 'Cotización vol. afiliad'
     O                                           30 'o ...'
     OPRN132    E            FMT@T1
     O                       ZCUVER        2    126
     O                       ZVAVER        2     99
     O                       ZVAVED        2     85
     O                       ZCUVEA        2     71
     O                       ZVAVEA        2     44
     O                                          025 'Cotización vol. emplead'
     O                                           30 'or ..'
     OPRN132    E            FMT@T1
     O                       ZCURER        2    126
     O                       ZVARER        2     99
     O                       ZTOCUR        2     71
     O                       ZTOREN        2     44
     O                                          025 'Rendimientos planilla e'
     O                                           30 'xtra.'
     OPRN132    E            FMT@T1
     O                       ZCUINR        2    126
     O                       ZVAINR        2     99
     O                       ZVAIND        2     85
     O                       ZCUINA        2     71
     O                       ZVAINA        2     44
     O                                          025 'Intereses cotizaciones '
     O                                           30 '.....'
     OPRN132    E            FMT@T1
     O                                          123 '-----------------------'
     O                                          126 '---'
     O                                           99 '-----------'
     O                                           85 '-----------'
     O                                          068 '-----------------------'
     O                                           71 '---'
     O                                           44 '-----------'
     OPRN132    E            FMT@T1
     O                       ZCUSTR        2    126
     O                       ZVASTR        2     99
     O                       ZVASTD        2     85
     O                       ZCUSCA        2     71
     O                       ZVASCA        2     44
     O                                          023 'Subtotal cotizaciones .'
     O                                           30 '.......'
     OPRN132    E            FMT@T1
     O                                           10 'DESCUENTOS'
     OPRN132    E            FMT@T1
     O                       ZCUCCA        2     71
     O                       ZVACCA        2     44
     O                                          025 'Comisión C.O. .........'
     O                                           30 '.....'
     OPRN132    E            FMT@T1
     O                       ZCUPRA        2     71
     O                       ZVAPRA        2     44
     O                                          025 'Prima de seguros ......'
     O                                           30 '.....'
     OPRN132    E            FMT@T1
     O                       ZVAFGD        2     85
     O                       ZCUFGA        2     71
     O                       ZVAFGA        2     44
     O                                          025 'F.G.P.M. ..............'
     O                                           30 '.....'
     OPRN132    E            FMT@T1
     O                       ZVIFGD        2     85
     O                       ZCIFGA        2     71
     O                       ZVIFGA        2     44
     O                                          025 'Intereses F.G.P.M. ....'
     O                                           30 '.....'
     OPRN132    E            FMT@T1
     O                       ZCUCAA        2     71
     O                       ZVACAA        2     44
     O                                          025 'Comisión C.V.A. .......'
     O                                           30 '.....'
     OPRN132    E            FMT@T1
     O                       ZCUCEA        2     71
     O                       ZVACEA        2     44
     O                                          025 'Comisión C.V.E. .......'
     O                                           30 '.....'
     OPRN132    E            FMT@T1
     O                                           85 '-----------'
     O                                          068 '-----------------------'
     O                                           71 '---'
     O                                           44 '-----------'
     OPRN132    E            FMT@T1
     O                       ZVAFGD        2     85
     O                       ZCUSTA        2     71
     O                       ZVASTA        2     44
     O                                          023 'Subtotal descuentos ...'
     O                                           30 '.......'
     OPRN132    E            FMT@T1
     O                       ZCUFSR        2    126
     O                       ZVAFSR        2     99
     O                       ZVAFSD        2     85
     O                       ZCUFSA        2     71
     O                       ZVAFSA        2     44
     O                                          025 'Fondo de solidaridad ..'
     O                                           30 '.....'
     OPRN132    E            FMT@T1
     O                       ZCUISR        2    126
     O                       ZVAISR        2     99
     O                       ZVIFSD        2     85
     O                       ZCUISA        2     71
     O                       ZVAISA        2     44
     O                                          025 'Intereses F.S. ........'
     O                                           30 '.....'
     OPRN132    E            FMT@T1
     O                       ZVASFD        2     85
     O                       ZCSFSA        2     71
     O                       ZVSFSA        2     44
     O                                          025 'Subsistencia ..........'
     O                                           30 '.....'
     OPRN132    E            FMT@T1
     O                       ZVISFD        2     85
     O                       ZCISFA        2     71
     O                       ZVISFA        2     44
     O                                          025 'Intereses Subsistencia '
     O                                           30 '.....'
     OPRN132    E            FMT@T1
     O                                          123 '-----------------------'
     O                                          126 '---'
     O                                           99 '-----------'
     O                                           85 '-----------'
     O                                          068 '-----------------------'
     O                                           71 '---'
     O                                           44 '-----------'
     OPRN132    E            FMT@T1
     O                       ZCUSFR        2    126
     O                       ZVASFR        2     99
     O                       ZVASUD        2     85
     O                       ZCUSFA        2     71
     O                       ZVASFA        2     44
     O                                          023 'Subtotal fondo de solid'
     O                                           30 'aridad.'
     OPRN132    E            FMT@T1
     O                       ZCUPER        2    126
     O                       ZVAPER        2     99
     O                       ZCUPEE        2     71
     O                       ZPEEMP        2     44
     O                                          023 'Pagos en exceso emplead'
     O                                           30 'or ....'
     OPRN132    E            FMT@T1
     O                                          123 '======================='
     O                                          126 '==='
     O                                           99 '==========='
     O                                           85 '==========='
     O                                          068 '======================='
     O                                           71 '==='
     O                                           44 '==========='
     OPRN132    E            FMT@T1
     O                       ZCUTRR        2    126
     O                       ZVTRRE        2     99
     O                       ZVADRE        2     85
     O                       ZCUTRE        2     71
     O                       ZVATRE        2     44
     O                                          023 'Total .................'
     O                                           30 '.......'
     OPRN80     E            FMT@T3         2
     O                                           34 'Descripción del error'
     O                                           12 'Planilla/afi'
     OPRN80     E            FMT@T4      1  1
     O                       ZTPLAE        2     36
     O                                          023 'Total planillas no acre'
     O                                           30 'ditadas'
     OPRN198B   E            FMT@T5         0
     O                                          195 'Delta valor'
     O                                          170 'Delta porcentaje'
     O                                          152 'Deuda planilla'
     O                                          136 'Total rezagos'
     O                                          121 'Total planilla'
     O                                          104 'Período'
     O                                           95 'Planilla'
     O                                           81 'Tipo deuda'
     O                                           31 'Razón social'
     O                                            9 'Empleador'
     OPRN198B   E            FMT@T5         1
     O                                          195 'Delta valor'
     O                                          170 'Delta porcentaje'
     O                                          152 'Deuda planilla'
     O                                          136 'Total rezagos'
     O                                          121 'Total planilla'
     O                                          104 'Período'
     O                                           95 'Planilla'
     O                                           81 'Tipo deuda'
     O                                           31 'Razón social'
     O                                            9 'Empleador'
     OPRN198C   E            FMT@T6         0
     O                                          135 'Observaciones'
     O                                          120 'Valor deuda'
     O                                          104 'Período'
     O                                           95 'Planilla'
     O                                           81 'Tipo deuda'
     O                                           31 'Razón social'
     O                                            9 'Empleador'
     OPRN198C   E            FMT@T6         1
     O                                          135 'Observaciones'
     O                                          120 'Valor deuda'
     O                                          104 'Período'
     O                                           95 'Planilla'
     O                                           81 'Tipo deuda'
     O                                           31 'Razón social'
     O                                            9 'Empleador'
** $HIL
ACRED.MASI
Planilla no encontrada
Planilla en estado diferente a Conciliado
No existe histórico de parámetros para el período
No existe histórico de parám. fusión PRO período
No se encontró información en el fondo origen
No existe histórico de parám. fusión PRO período
No existe fecha de depósito a calcular
PLAARC04 no disponible - M00006
DEUARC no disponible - M00006
No existe histórico de parámetros para el período
No existe histórico de parámetros para el período
No existe histórico de parám. fusión PRO período
DEPAR3 no disponible - M00010
PLAARC no disponible - M00010
DEPAR3 no disponible - M00013
No existe histórico de parámetros para el período
No existe histórico de parámetros para el período
No existen registros en archivo forma liq. intereses
Período de vigencia eliminada para afiliado
REZARC no disponible - M00025
LOTAR5 no disponible - M00030
Planilla en estado ACR
PLAARC no disponible - M00030
Error al actualizar el HIS782, revise spool
El saldo de la deuda es negativo
Descuadre en saldo de encabezado de deuda contra detalles
999999999999
Otro trabajo está procesando el rezago
Otro trabajo está procesando el rezago
Otro trabajo está procesando el rezago
DETARC no disponible - M00130
No se pudo calcular fecha depósito
No se encontró planilla del rezago
CUEARC no disponible - M09000
Acreditación aportes voluntarios no actualizó cuenta
CUEARC no disponible - M09000
El valor conciliado no alcanza para cubrir los intereses
Detalle decreto 376 sin tarifa especial
No existe afiliado
Registro AFIARC no disponible M11101
No existe fecha de depósito a calcular
Registro PAGARC06 no disponible M11110
No existe depósito
Depósito en estado diferente a conciliado
Planilla sin respuesta del empleador (circular 42)
DEUARC no disponible - M12030
Movimiento de acreditación no actualizó la cuenta
No existe afiliado
CUEARC no disponible - M14020
AFIARC no disponible - M14020
Error al actualizar HISAR4 en DEUD79, revise spool
Período de planilla en vinculación eliminada del afiliado
0000000000
No existe relación afiliado-empleador del afiliado
DEUDA/DETALLE ANULADA POR ACREDITACION
No existe planilla origen para el situado
COMAR5 no disponible - M14062
ESTAR1 no disponible - M14065
No se actualizó ind. cruce compensación para el rezago
DIAAR1 no disponible - M14075
DETAR2 no disponible - M14082
Para el cobro de comisión de cesantes
CUEARC no disponible - M14090
CUEARC no disponible - M14090 (2)
Error en el proceso de distribución de C.V.A.
Error en el proceso de distribución de F.S.
Error en el proceso de distribución de F.Subsistencia.
Error en el proceso de distribución de Intereses F.S.
Error en el proceso de distribuir Int. de subsistencia.
Error en el proceso de distribución Int. C.O.
Error en el proceso de distribución Int. C.V.A.
Error en el proceso de distribución Int. C.V.E.
Error en el proceso de distribución Int. A.R.
Error en el proceso de distribución de rendimientos
Error en el proceso de distribución de alto riesgo
Error en el proceso de distribución de cot. oblig.
Error en el proceso de distribución de C.V.E.
Error en el proceso de distribución garantía pens.
Error en el proceso de distribución Int.Garantía
CUEARC no disponible - M14385
Pl de agrem/Pensión temp/Vol T. no puede generar deuda
COMAR5 no disponible - M15027
ESTAR1 no disponible - M15028
Total depósitos diferente a total acreditado
Saldo deuda no aplica para deltas de anulación
Planilla tiene plan. de cancelación. Ver TRPLAN6B
No existen deltas de anulación para año de deuda
Saldo deuda a anular no es mayor a cero
DEUDA/DETALLE ANULADO POR DELTA ACREDITADOR
Detalles de deuda no aplican para delta anulación
No existen deltas de anulación para año de deuda
Saldo deuda a anular no es mayor a cero
DEUDA/DETALLE ANULADO POR DELTA ACREDITADOR
Error al actualizar HISAR4 en DEUD77, revise spool
Planilla no tiene deudas ya anuladas por delta
DEUARC no disponible - M21001
No existe histórico de parámetros para el período
No se encontraron deudas anteriores a reforma
No existe afiliado
Registro AFIARC no disponible M21015
CUEARC no disponible - M21015
Error en el proceso de distribución detalle deuda
DEUARC no disponible - M21100
Acreditación de cancel. de deuda no actualizó la cuenta
Descuadre en saldo de encabezado de deuda contra detalle
Mov. acreditación planilla ext. no actualizó la cuenta
Mov. acreditación plan. traspaso no actualizó la cuenta
Acred. aportes vol. plan. traspaso no actualizó cuenta
CUEARC no disponible - M51100
Canc. deuda con pago en exceso no actualizó la cuenta
Canc. deuda con pago en exceso no actualizó la cuenta
CUEARC no disponible - M61000
Valor en cuotas del pago en exceso es igual a cero
Valor en cuotas del pago en exceso es igual a cero
REZARC no disponible - M70000
Detalle decreto 376 sin tarifa especial
DETARC no disponible - M70000
Otro trabajo está procesando el rezago
REZARC no disponible - M71000
DETARC no disponible - M71000
Acreditación del rezago no actualizó la cuenta
Acred. aporte voluntario en rezago no actualizó cuenta
CUEARC no disponible - M71120
DETARC no disponible - M72100
Acreditación rezago plan. ext. no actualizó la cuenta
Otro trabajo está procesando el rezago
REZARC no disponible - M72100
REZARC no disponible - M73000
DETARC no disponible - M73000
DETARC no disponible - M73100
Acreditación rezago plan. traspaso no actualizó cuenta
Otro trabajo está procesando el rezago
REZARC no disponible - M73100
Acred. aportes vol. plan. traspaso no actualizó cuenta
CUEARC no disponible - M73120
Otro trabajo está procesando el rezago
Detalle decreto 376 sin tarifa especial
DETARC no disponible - M74000
REZARC no disponible - M74000
Otro trabajo está procesando el rezago
REZARC no disponible - M74100
Acreditación rezago de reversión no actualizó la cuenta
PAGARC no disponible - M74120
Para el cobro de comisión de cesantes
CUEARC no disponible - M74140
Error al actualizar el HISAR4, revise spool
CUEARC no disponible - M74140 (2)
Error al retornar valores de SFSP y FGPM.
DTAQPLAACR
